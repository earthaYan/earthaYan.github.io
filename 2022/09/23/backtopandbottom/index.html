<!DOCTYPE html>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="backTopAndBottom" />
    <meta name="hexo-theme-A4" content="v1.7.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Diary</title>

    
        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Diary</a> 
            <span class="description">å¤‡å¿˜å½•/ç¬”è®°æœ¬</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            backTopAndBottom
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BC%BA%E9%99%B7%E9%93%BE%E6%8E%A5"><span class="post-toc-text">ç¼ºé™·é“¾æ¥</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%9C%80%E6%B1%82"><span class="post-toc-text">éœ€æ±‚</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%80%9D%E8%B7%AF"><span class="post-toc-text">æ€è·¯</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%9B%B8%E5%85%B3%E4%BB%A3%E7%A0%81"><span class="post-toc-text">ç›¸å…³ä»£ç </span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%81%87%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98"><span class="post-toc-text">é‡åˆ°çš„é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3"><span class="post-toc-text">é—®é¢˜è§£å†³</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%8C%9C%E6%83%B3"><span class="post-toc-text">çŒœæƒ³</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%9F%A5%E8%AF%86%E7%82%B9"><span class="post-toc-text">çŸ¥è¯†ç‚¹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8F%82%E8%80%83%E6%96%87%E7%AB%A0%E9%93%BE%E6%8E%A5"><span class="post-toc-text">å‚è€ƒæ–‡ç« é“¾æ¥</span></a></li></ol>
        
        <h2 id="ç¼ºé™·é“¾æ¥"><a href="#ç¼ºé™·é“¾æ¥" class="headerlink" title="ç¼ºé™·é“¾æ¥"></a>ç¼ºé™·é“¾æ¥</h2><p><a target="_blank" rel="noopener" href="http://10.186.18.11/jira/browse/DMP-13892">http://10.186.18.11/jira/browse/DMP-13892</a></p>
<h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å·¡æ£€æŠ¥å‘Šé¡µé¢ã€åº“è¡¨æ£€æŸ¥é¡µé¢å¢åŠ ç½®é¡¶ã€ç½®åº•åŠŸèƒ½</p>
<h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol>
<li>ä¸¤ä¸ªé¡µé¢éƒ½éœ€è¦å¢åŠ è¿™ä¸ªåŠŸèƒ½,é‚£å°±åšæˆä¸€ä¸ªç»„ä»¶,é¿å…å†™é‡å¤ä»£ç </li>
<li>umc-uié¡¹ç›®ä¸­å·²ç»æœ‰è¿™éƒ¨åˆ†åŠŸèƒ½çš„å®ç°,æ‰€ä»¥åªéœ€è¦æ•´åˆä¸€ä¸‹ç›¸å…³çš„ä»£ç å°è£…æˆç»„ä»¶</li>
<li>ç½®é¡¶åŠŸèƒ½åœ¨antdä¸­å·²ç»å®ç°,æ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°çš„åªæœ‰ç½®åº•åŠŸèƒ½</li>
<li>é€šè¿‡scrollInViewæ–¹æ³•å®ç°</li>
</ol>
<h2 id="ç›¸å…³ä»£ç "><a href="#ç›¸å…³ä»£ç " class="headerlink" title="ç›¸å…³ä»£ç "></a>ç›¸å…³ä»£ç </h2><pre><code class="React">import &#123;
  VerticalAlignBottomOutlined,
  VerticalAlignTopOutlined,
&#125; from &#39;@ant-design/icons&#39;;
import &#123; BackTop, Button &#125; from &#39;antd&#39;;
import &#123; useEffect, useState &#125; from &#39;react&#39;;

const BackTopAndBottom: React.FC&lt;&#123; contentRef: HTMLDivElement | null &#125;&gt; = (&#123;
  contentRef,
&#125;) =&gt; &#123;
  const [toBottomButtonVisible, setToBottomButtonVisible] = useState(true);
  const moveToBottom = () =&gt; &#123;
    if (contentRef) &#123;
      contentRef.scrollIntoView(&#123;
        block: &#39;end&#39;,
        behavior: &#39;smooth&#39;,
      &#125;);
    &#125;
  &#125;;
  useEffect(() =&gt; &#123;
    const dom = document.querySelector(
      &#39;#root main.ant-layout-content.action-content&#39;
    );
    const handleScrollChange = () =&gt; &#123;
      const interval =
        (dom?.scrollHeight ?? 0) -
        (dom?.scrollTop ?? 0) -
        (dom?.clientHeight ?? 0);
      setToBottomButtonVisible(interval &gt; 80);
    &#125;;
    dom?.addEventListener(&#39;scroll&#39;, handleScrollChange);
    return () =&gt; &#123;
      dom?.removeEventListener(&#39;scroll&#39;, handleScrollChange);
    &#125;;
  &#125;, []);
  return (
    &lt;&gt;
      &#123;toBottomButtonVisible &amp;&amp; (
        &lt;Button
          shape=&quot;circle&quot;
          icon=&#123;&lt;VerticalAlignBottomOutlined /&gt;&#125;
          onClick=&#123;moveToBottom&#125;
          type=&quot;primary&quot;
        /&gt;
      )&#125;
      &lt;BackTop
        visibilityHeight=&#123;250&#125;
        className=&quot;back-top&quot;
        target=&#123;() =&gt; document.querySelector(&#39;.action-content&#39;) as HTMLElement&#125;
      &gt;
        &lt;Button
          shape=&quot;circle&quot;
          type=&quot;primary&quot;
          icon=&#123;&lt;VerticalAlignTopOutlined /&gt;&#125;
        &gt;&lt;/Button&gt;
      &lt;/BackTop&gt;
    &lt;/&gt;
  );
&#125;;
export default BackTopAndBottom;
</code></pre>
<h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>è¿™ä¸ªç»„ä»¶æ·»åŠ ä»¥å,åœ¨åº“è¡¨æ£€æŸ¥é¡µé¢æ²¡æœ‰é—®é¢˜,ä½†æ˜¯åœ¨å·¡æ£€æŠ¥å‘Šé¡µé¢,å‡ºç°äº†ä¸‹é¢çš„bug:</p>
<pre><code class="TypeScript">  contentRef.scrollIntoView(&#123;
    block: &#39;end&#39;,
    behavior: &#39;smooth&#39;,
  &#125;);
</code></pre>
<p>å½“behaviorè®¾ç½®ä¸ºsmoothçš„æ—¶å€™ç‚¹å‡»ç½®åº•æŒ‰é’®,é¢„æœŸæ˜¯æ‹‰åˆ°é¡µé¢åº•éƒ¨,ä½†æ˜¯å®é™…æƒ…å†µæ˜¯åœåœ¨äº†é¡µé¢çš„ç¬¬ä¸€å¼ canvaså›¾éƒ¨åˆ†,å¹¶æ²¡æœ‰ä¸€ç›´æ‹‰åˆ°é¡µé¢åº•éƒ¨;ä½†æ˜¯è®¾ç½®ä¸ºautoä»¥å,å³å–æ¶ˆåŠ¨ç”»,ç‚¹å‡»å¯ä»¥æ‹‰åˆ°é¡µé¢åº•éƒ¨ã€‚</p>
<h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>æ¯”è¾ƒä¸¤ä¸ªé¡µé¢è°ƒç”¨ç»„ä»¶çš„çˆ¶ç»„ä»¶çš„ä»£ç ï¼Œå‘ç°å·¡æ£€æŠ¥å‘Šé¡µé¢ç›‘å¬äº†é¡µé¢çš„æ»šåŠ¨äº‹ä»¶ï¼Œè€Œåº“è¡¨æ£€æŸ¥é¡µé¢æ²¡æœ‰,äºæ˜¯æ³¨é‡Šäº†å¯¹åº”çš„ä»£ç ï¼Œå‘ç°é—®é¢˜è¢«è§£å†³äº†ã€‚</p>
<pre><code class="TypeScript">  let setScroll = true;
  useLayoutEffect(() =&gt; &#123;
    const content = document.querySelector&lt;HTMLElement&gt;(&#39;.action-content&#39;);

    if (setScroll &amp;&amp; content) &#123;
      setScroll = false;
      // æ­¤å¤„æ˜¯é—®é¢˜äº§ç”Ÿçš„åŸå› ï¼Œå¢åŠ é˜²æŠ–å¯è§£å†³é—®é¢˜
      content.addEventListener(&#39;scroll&#39;,scrollChange);
      // ä¿®æ”¹å
       content.addEventListener(&#39;scroll&#39;,lodash.debounce(scrollChange,100));
    &#125;

    return () =&gt; &#123;
      if (content) &#123;
        content.removeEventListener(&#39;scroll&#39;, scrollChange);
      &#125;
    &#125;;
  &#125;);

  const scrollChange = () =&gt; &#123;
    const ball = document.querySelector&lt;HTMLSpanElement&gt;(
      &#39;.ant-anchor-ink-ball&#39;
    );

    if (ball) &#123;
      const top = Number.parseInt(ball.style.top || &#39;&#39;);
      const wrapper = document.querySelector&lt;HTMLDivElement&gt;(
        &#39;.ant-anchor-wrapper&#39;
      );
      const height = wrapper ? wrapper.clientHeight : 0;
      if (wrapper) &#123;
        if (top &gt; height) &#123;
          wrapper.scrollTop = top - height + 100;
        &#125; else if (top &lt; wrapper.scrollTop) &#123;
          wrapper.scrollTop = top - 100;
        &#125;
      &#125;
    &#125;
  &#125;;
</code></pre>
<h2 id="çŒœæƒ³"><a href="#çŒœæƒ³" class="headerlink" title="çŒœæƒ³"></a>çŒœæƒ³</h2><p>å­ç»„ä»¶å’Œçˆ¶ç»„ä»¶éƒ½ç›‘å¬äº†action-contentå®¹å™¨çš„æ»šåŠ¨äº‹ä»¶ï¼Œå¹¶ä¸”æœ‰ä¸åŒçš„å›è°ƒå‡½æ•°ï¼ŒåŒæ—¶æ‰§è¡Œä¼šå¯¼è‡´å†²çªï¼Œæœ€ç»ˆæ»šåŠ¨çš„é«˜åº¦æ²¡æœ‰è¾¾åˆ°é¢„æœŸã€‚ä½¿ç”¨debounceé˜²æŠ–ï¼Œå»¶è¿Ÿæ‰§è¡Œï¼Œå¯ä»¥æ¶ˆé™¤è¿™ä¸€é—®é¢˜</p>
<h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ul>
<li>debounce é˜²æŠ–<blockquote>
<ul>
<li>_.debounce(func, [wait&#x3D;0], [options&#x3D;])</li>
<li>åœ¨ä¸€æ®µè¿ç»­æ“ä½œç»“æŸåï¼Œå¤„ç†å›è°ƒ</li>
<li>åˆ›å»ºä¸€ä¸ª debouncedï¼ˆé˜²æŠ–åŠ¨ï¼‰å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šä»ä¸Šä¸€æ¬¡è¢«è°ƒç”¨åï¼Œå»¶è¿Ÿ wait æ¯«ç§’åè°ƒç”¨ func æ–¹æ³•</li>
<li>å¦‚æœ wait ä¸º 0 å¹¶ä¸” leading ä¸º false, funcè°ƒç”¨å°†è¢«æ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªç‚¹ï¼Œç±»ä¼¼setTimeoutä¸º0çš„è¶…æ—¶</li>
</ul>
</blockquote>
</li>
<li>throttle èŠ‚æµ<blockquote>
<ul>
<li>_.throttle(func, [wait&#x3D;0], [options&#x3D;])</li>
<li>åˆ›å»ºä¸€ä¸ªèŠ‚æµå‡½æ•°ï¼Œåœ¨ wait ç§’å†…æœ€å¤šæ‰§è¡Œ func ä¸€æ¬¡çš„å‡½æ•°</li>
<li>åœ¨ä¸€æ®µè¿ç»­æ“ä½œä¸­ï¼Œæ¯ä¸€æ®µæ—¶é—´åªæ‰§è¡Œä¸€æ¬¡</li>
</ul>
</blockquote>
</li>
<li>åŸç”ŸJSå®ç°</li>
</ul>
<pre><code class="TypeScript">//é˜²æŠ– debounce
function debounce(fn, delay) &#123;
    var timer; // ç»´æŠ¤ä¸€ä¸ª timer
    return function () &#123;
        var _this = this; // å–debounceæ‰§è¡Œä½œç”¨åŸŸçš„this
        var args = arguments;
        if (timer) &#123;
            clearTimeout(timer);
        &#125;
        timer = setTimeout(function () &#123;
            fn.apply(_this, args); // ç”¨applyæŒ‡å‘è°ƒç”¨debounceçš„å¯¹è±¡ï¼Œç›¸å½“äº_this.fn(args);
        &#125;, delay);
    &#125;;
&#125;
//èŠ‚æµ throttle
function throttle(fn, delay) &#123;
    var timer;
    return function () &#123;
        var _this = this;
        var args = arguments;
        if (timer) &#123;
            return;
        &#125;
        timer = setTimeout(function () &#123;
            fn.apply(_this, args);
            timer = null; // åœ¨delayåæ‰§è¡Œå®Œfnä¹‹åæ¸…ç©ºtimerï¼Œæ­¤æ—¶timerä¸ºå‡ï¼Œthrottleè§¦å‘å¯ä»¥è¿›å…¥è®¡æ—¶å™¨
        &#125;, delay)
    &#125;
&#125;
</code></pre>
<h2 id="å‚è€ƒæ–‡ç« é“¾æ¥"><a href="#å‚è€ƒæ–‡ç« é“¾æ¥" class="headerlink" title="å‚è€ƒæ–‡ç« é“¾æ¥"></a>å‚è€ƒæ–‡ç« é“¾æ¥</h2><ol>
<li><a target="_blank" rel="noopener" href="https://juejin.cn/post/6844903669389885453">https://juejin.cn/post/6844903669389885453</a></li>
<li><a target="_blank" rel="noopener" href="https://segmentfault.com/a/1190000018445196">https://segmentfault.com/a/1190000018445196</a></li>
</ol>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2022-09-23</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Moon</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/%E7%BD%AE%E9%A1%B6%E5%8A%9F%E8%83%BD%E5%AE%9E%E7%8E%B0/'>
                            ç½®é¡¶åŠŸèƒ½å®ç°
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%B7%A5%E4%BD%9C/'>
                            å·¥ä½œ
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        ä»¥ä¸Šã€‚ 
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://comment-hexo-waline.vercel.app/',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ­£ç¡®çš„é‚®ç®±åœ°å€ï¼Œå›å¤å°†èƒ½å¾—åˆ°é‚®ä»¶é€šçŸ¥ã€‚', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â©2021-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
    
</div>


    
<link rel="stylesheet" href="/css/a11y-dark.min.css">

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>