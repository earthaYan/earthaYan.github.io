<!DOCTYPE html>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="Reactçš„createPortal" />
    <meta name="hexo-theme-A4" content="v1.7.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Diary | just try it</title>

    
        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Diary</a> 
            <span class="description">é»˜å¥¥æ²™</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            Reactçš„createPortal
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#React-createPortal"><span class="post-toc-text">React.createPortal()</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="post-toc-text">åŸºæœ¬ä½¿ç”¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%99%90%E5%88%B6"><span class="post-toc-text">é™åˆ¶</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%87%BD%E6%95%B0"><span class="post-toc-text">å‡½æ•°</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%85%A5%E5%8F%82"><span class="post-toc-text">å…¥å‚</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="post-toc-text">è¿”å›å€¼</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="post-toc-text">æ³¨æ„ç‚¹</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%BD%BF%E7%94%A8"><span class="post-toc-text">ä½¿ç”¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%88%9B%E5%BB%BA-portal"><span class="post-toc-text">åˆ›å»º portal</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BD%BF%E7%94%A8-portal-%E6%B8%B2%E6%9F%93%E5%AF%B9%E8%AF%9D%E6%A1%86%E5%BC%B9%E7%AA%97"><span class="post-toc-text">ä½¿ç”¨ portal æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8%E9%9D%9E-React-%E6%9C%8D%E5%8A%A1%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%A0%87%E8%AE%B0%E6%B8%B2%E6%9F%93-React-%E7%BB%84%E4%BB%B6"><span class="post-toc-text">åœ¨é React æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“ React ç»„ä»¶</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8%E9%9D%9E-React-%E7%9A%84-DOM-%E8%8A%82%E7%82%B9%E6%B8%B2%E6%9F%93-React-%E7%BB%84%E4%BB%B6"><span class="post-toc-text">åœ¨é React çš„ DOM èŠ‚ç‚¹æ¸²æŸ“ React ç»„ä»¶</span></a></li></ol></li></ol></li></ol>
        
        <h1 id="React-createPortal"><a href="#React-createPortal" class="headerlink" title="React.createPortal()"></a>React.createPortal()</h1><p>ä½œç”¨ï¼šæŠŠéƒ¨åˆ†å­ç»„ä»¶æ¸²æŸ“åˆ°ä¸åŒäºçˆ¶ç»„ä»¶ DOM èŠ‚ç‚¹çš„æŒ‡å®š DOM èŠ‚ç‚¹</p>
<p>ä½¿ç”¨ï¼š<br><code>React.createPortal(children,domNode)</code></p>
<h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><pre><code class="javascript">import &#123; createPortal &#125; from &#39;react-dom&#39;;
&lt;div&gt;
  &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;
  &#123;createPortal(
    &lt;p&gt;This child is placed in the document body.&lt;/p&gt;,
    document.body
  )&#125;
&lt;/div&gt;;
</code></pre>
<h2 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h2><p>portal åªä¼šæ”¹å˜ DOM èŠ‚ç‚¹çš„ç‰©ç†ä½ç½®ï¼Œä½†æ˜¯æ¸²æŸ“æˆ portal çš„ JSX ä»ç„¶æ˜¯æ¸²æŸ“ JSX çš„ React ç»„ä»¶çš„å­èŠ‚ç‚¹ã€‚</p>
<ul>
<li>å­ç»„ä»¶ä»ç„¶å¯ä»¥è®¿é—®çˆ¶ç»„ä»¶æ ‘æä¾›çš„ä¸Šä¸‹æ–‡</li>
<li>äº‹ä»¶æ ¹æ® React æ ‘ä»å­çº§å†’æ³¡åˆ°çˆ¶çº§</li>
</ul>
<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="å…¥å‚"><a href="#å…¥å‚" class="headerlink" title="å…¥å‚"></a>å…¥å‚</h3><ol>
<li>children:å¯ä»¥ä½¿ç”¨ React æ¸²æŸ“çš„ï¼šJSX ç‰‡æ®µï¼Œ&lt;&gt;&lt;&#x2F;&gt;,å­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œæˆ–è€…ä¸€ç»„è¿™äº›å…ƒç´ </li>
<li>domNode:å·²ç»å­˜åœ¨çš„ DOM èŠ‚ç‚¹ï¼Œåœ¨æ›´æ–°æœŸé—´ä¼ ä¸åŒçš„ DOM èŠ‚ç‚¹ä¼šå¯¼è‡´ä¸æ–­é‡å»º portal å†…å®¹</li>
</ol>
<h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>è¿”å›ä¸€ä¸ªå¯ä»¥åŒ…å«åœ¨ JSX ä¸­æˆ–è€…å¯ä»¥ä» React ç»„ä»¶è¿”å›çš„ React èŠ‚ç‚¹</p>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><ul>
<li>æ¥è‡ª portal çš„äº‹ä»¶æ˜¯æ ¹æ® React æ ‘ä¼ æ’­è€Œä¸æ˜¯ DOM æ ‘ã€‚</li>
</ul>
<pre><code class="html">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;
&lt;div id=&quot;name&quot;&gt;111&lt;/div&gt;
&lt;script&gt;
  //ç‚¹å‡»Demoç»„ä»¶portalç»„ä»¶ä¸­çš„pæ—¶ï¼Œç‚¹å‡»äº‹ä»¶ä¸ä¼šå†’æ³¡åˆ°domæ ‘çš„èŠ‚ç‚¹ï¼Œè¿™é‡Œä¸ä¼šæ‰§è¡Œ
  document.getElementById(&#39;name&#39;).onclick = function () &#123;
    console.log(&#39;hello world&#39;);
  &#125;;
&lt;/script&gt;
</code></pre>
<pre><code class="jsx">import &#123; createPortal &#125; from &#39;react-dom&#39;;

const Demo = () =&gt; &#123;
  return (
    // ç‚¹å‡»Demoç»„ä»¶portalç»„ä»¶ä¸­çš„pæ—¶ï¼Œè¿™é‡Œçš„onClickä¼šæ‰§è¡Œï¼Œå› ä¸ºReactç»„ä»¶æ ‘çš„äº‹ä»¶å†’æ³¡
    &lt;div style=&#123;&#123; border: '2px solid black' &#125;&#125; onClick=&#123;()=&gt;console.log(&quot;root div click&quot;)&#125;&gt;
      &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;
      &#123;createPortal(
        &lt;p onClick=&#123;() =&gt; console.log(&#39;portal click&#39;)&#125;&gt;
          This child is placed in the name
        &lt;/p&gt;,
        document.getElementById(&#39;name&#39;) as Element
      )&#125;
    &lt;/div&gt;
  );
&#125;;
</code></pre>
<ul>
<li>æŒ‚è½½èŠ‚ç‚¹å¿…é¡»æ˜¯å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œä¸å¯ä»¥æ˜¯å½“å‰ JSX ç‰‡æ®µä¸­çš„ dom èŠ‚ç‚¹</li>
</ul>
<pre><code class="jsx">// æ­£å¸¸å±•ç¤º
const App1 = () =&gt; &#123;
  const [popupContainer, setPopupContainer] = React.useState(null);

  React.useEffect(() =&gt; &#123;
    const popupDiv = document.getElementById(&#39;sister&#39;);
    setPopupContainer(popupDiv);
  &#125;, []);
  return (
    &lt;React.Fragment&gt;
      &lt;div id=&quot;sister&quot;&gt;å¤–éƒ¨å…„å¼Ÿ&lt;/div&gt;
      &lt;div id=&quot;container&quot;&gt;
        &lt;div id=&quot;inner&quot;&gt;å†…éƒ¨å…„å¼Ÿ&lt;/div&gt;
        &#123;/* æ­£å¸¸å±•ç¤º1 */&#125;
        &#123;!!popupContainer &amp;&amp; createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, popupContainer)&#125;
        &#123;/* æ­£å¸¸å±•ç¤º2 */&#125;
        &#123;document.getElementById(&#39;sister&#39;) &amp;&amp;
          createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, document.getElementById(&#39;sister&#39;))&#125;
        &#123;/* æŠ¥é”™:Target container is not a DOM element. */&#125;
        &#123;createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, document.getElementById(&#39;sister&#39;))&#125;
      &lt;/div&gt;
    &lt;/React.Fragment&gt;
  );
&#125;;
export default App1;
</code></pre>
<h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="åˆ›å»º-portal"><a href="#åˆ›å»º-portal" class="headerlink" title="åˆ›å»º portal"></a>åˆ›å»º portal</h3><pre><code class="jsx">import &#123; createPortal &#125; from &#39;react-dom&#39;;
export default function MyComponent() &#123;
  return (
    &lt;div style=&#123;&#123; border: '2px solid black' &#125;&#125;&gt;
      &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;
      &#123;createPortal(
        &lt;p&gt;This child is placed in the document body.&lt;/p&gt;,
        document.body
      )&#125;
    &lt;/div&gt;
  );
&#125;
</code></pre>
<img src="/2023/04/25/react-de-createportal/portal1.jpg" class="">

<h3 id="ä½¿ç”¨-portal-æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—"><a href="#ä½¿ç”¨-portal-æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—" class="headerlink" title="ä½¿ç”¨ portal æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—"></a>ä½¿ç”¨ portal æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—</h3><p>å¯ä»¥é¿å…è°ƒç”¨åœ¨å¯¹è¯æ¡†çš„ç»„ä»¶ä½¿ç”¨äº† overflow:hidden æˆ–è€…å…¶ä»–æ ·å¼çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å±•ç¤ºæ‚¬æµ®å¯¹è¯æ¡†</p>
<h3 id="åœ¨é-React-æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“-React-ç»„ä»¶"><a href="#åœ¨é-React-æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“-React-ç»„ä»¶" class="headerlink" title="åœ¨é React æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“ React ç»„ä»¶"></a>åœ¨é React æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“ React ç»„ä»¶</h3><p>React root å¦‚æœæ˜¯é React æ„å»ºçš„é™æ€é¡µé¢æˆ–è€…æœåŠ¡ç«¯æ¸²æŸ“é¡µé¢çš„ä¸€éƒ¨åˆ†ï¼Œå°±å¯ä»¥åˆ©ç”¨ portals åœ¨é™æ€åŒºåŸŸåˆ›å»ºäº¤äº’åŒºåŸŸï¼Œæ¯”å¦‚ sideBars</p>
<p>ä¸å¤š React root çš„åŒºåˆ«ï¼š</p>
<ul>
<li>å³ä½¿å†…éƒ¨æ¸²æŸ“æˆ DOM çš„ä¸åŒéƒ¨åˆ†ï¼Œportal ä¹Ÿå¯ä»¥å°†è¿™ä¸ªåº”ç”¨ä½œä¸ºä¸€ä¸ª<font color="red">çŠ¶æ€å…±äº«</font>çš„ React æ ‘å»å¯¹å¾…</li>
</ul>
<p>å®Œæ•´ä»£ç è§:<a target="_blank" rel="noopener" href="https://stackblitz.com/edit/react-ts-cwfhhp?file=index.html,style.css">https://stackblitz.com/edit/react-ts-cwfhhp?file=index.html,style.css</a></p>
<h3 id="åœ¨é-React-çš„-DOM-èŠ‚ç‚¹æ¸²æŸ“-React-ç»„ä»¶"><a href="#åœ¨é-React-çš„-DOM-èŠ‚ç‚¹æ¸²æŸ“-React-ç»„ä»¶" class="headerlink" title="åœ¨é React çš„ DOM èŠ‚ç‚¹æ¸²æŸ“ React ç»„ä»¶"></a>åœ¨é React çš„ DOM èŠ‚ç‚¹æ¸²æŸ“ React ç»„ä»¶</h3><p>ç”¨ portal ç®¡ç† React å¤–éƒ¨çš„ DOM èŠ‚ç‚¹çš„å†…å®¹ã€‚</p>
<pre><code class="jsx">const App = () =&gt; &#123;
  // 1. å®šä¹‰çŠ¶æ€å˜é‡popupContainerå­˜å‚¨è¦æ¸²æŸ“çš„ç›®æ ‡èŠ‚ç‚¹
  const [popupContainer, setPopupContainer] = useState(null);
  useEffect(() =&gt; &#123;
    if (mapRef.current === null) &#123;
      const map = createMapWidget(containerRef.current);
      mapRef.current = map;
      // 2. å½“åˆ›å»ºç¬¬ä¸‰æ–¹ç»„ä»¶æ—¶ï¼Œå­˜å‚¨ç»„ä»¶è¿”å›çš„DOM èŠ‚ç‚¹ï¼Œè¿™æ ·ä½ å¯ä»¥å°†å†…å®¹æ¸²æŸ“åˆ°è¿™ä¸ªDOMèŠ‚ç‚¹
      const popupDiv = addPopupToMapWidget(map);
      setPopupContainer(popupDiv);
    &#125;
  &#125;, []);
  return (
    &lt;div style=&#123;&#123; width: 250, height: 250 &#125;&#125; ref=&#123;containerRef&#125;&gt;
      &#123;/* ä¸€æ—¦popupContainerå˜æˆå¯è®¿é—®çŠ¶æ€ï¼Œ
    ä½¿ç”¨createPortalæ¸²æŸ“Reactå†…å®¹åˆ°popupContainerå®¹å™¨ä¸­ */&#125;
      &#123;popupContainer !== null &amp;&amp;
        createPortal(&lt;p&gt;Hello from React!&lt;/p&gt;, popupContainer)&#125;
    &lt;/div&gt;
  );
&#125;;
</code></pre>
<p>å®Œæ•´ä¾‹å­è§ï¼š<a target="_blank" rel="noopener" href="https://stackblitz.com/edit/react-ts-cwfhhp?file=App.tsx">https://stackblitz.com/edit/react-ts-cwfhhp?file=App.tsx</a></p>
<pre><code class="jsx">// æ ¸å¿ƒä»£ç 
export default function App() &#123;
  const containerRef = React.useRef(null);
  const mapRef = React.useRef(null);
  const [popupContainer, setPopupContainer] = React.useState(null);
  React.useEffect(() =&gt; &#123;
    if (mapRef.current === null) &#123;
      const map = createMapWidget(containerRef.current);
      mapRef.current = map;
      const popupDiv = addPopupToMapWidget(map);
      setPopupContainer(popupDiv);
    &#125;
  &#125;, []);
  return (
    &lt;div style=&#123;&#123; width: 250, height: 250 &#125;&#125; ref=&#123;containerRef&#125;&gt;
      &#123;popupContainer !== null &amp;&amp;
        createPortal(&lt;p&gt;Hello from React!&lt;/p&gt;, popupContainer)&#125;
    &lt;/div&gt;
  );
&#125;
</code></pre>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-04-25</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Moon</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/react/'>
                            react
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%89%8D%E7%AB%AF/'>
                            å‰ç«¯
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        ä»¥ä¸Šã€‚ 
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://comment-hexo-waline.vercel.app/',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ­£ç¡®çš„é‚®ç®±åœ°å€ï¼Œå›å¤å°†èƒ½å¾—åˆ°é‚®ä»¶é€šçŸ¥ã€‚', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â©2021-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
    
</div>


    
<link rel="stylesheet" href="/css/a11y-dark.min.css">

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>