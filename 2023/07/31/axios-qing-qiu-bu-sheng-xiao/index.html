<!DOCTYPE html>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="umc-uiè¡¨æ ¼ç­›é€‰ä¸ç”Ÿæ•ˆ" />
    <meta name="hexo-theme-A4" content="v1.7.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Diary | just try it</title>

    
        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Diary</a> 
            <span class="description">é»˜å¥¥æ²™</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            umc-uiè¡¨æ ¼ç­›é€‰ä¸ç”Ÿæ•ˆ
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%83%8C%E6%99%AF%EF%BC%9A"><span class="post-toc-text">èƒŒæ™¯ï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88%EF%BC%9A"><span class="post-toc-text">è§£å†³æ–¹æ¡ˆï¼š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%B1%BB%E4%BC%BC%E9%97%AE%E9%A2%98"><span class="post-toc-text">ç±»ä¼¼é—®é¢˜</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%90%8E%E7%BB%AD"><span class="post-toc-text">åç»­</span></a></li></ol>
        
        <h2 id="èƒŒæ™¯ï¼š"><a href="#èƒŒæ™¯ï¼š" class="headerlink" title="èƒŒæ™¯ï¼š"></a>èƒŒæ™¯ï¼š</h2><p>å¶ç„¶å‘ç°é¡¹ç›®ä¸­ä¸€ä¸ªè¡¨æ ¼ç­›é€‰æ²¡æœ‰ç”Ÿæ•ˆ,ä¼ å‚å­—æ®µå€¼ä¸º<code> filter_redis_sentinel_instance_ids: tableFilterInfo.redis_sentinel_instance_id ?? undefined</code></p>
<img src="/2023/07/31/axios-qing-qiu-bu-sheng-xiao/fail.jpg" class="" title="è¡¨æ ¼ç­›é€‰ä¸ç”Ÿæ•ˆ">
<p>ä¸ŠæŠ¥ç¼ºé™·ä»¥åï¼Œè‡ªå·±ç”¨ postman è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ¥å£<code>v4/redis/sentinel_instance/list?page_index=1&amp;page_size=20&amp;filter_redis_sentinel_instance_ids[]=redis-sentinel-u97bvd</code>,å½“<code>filter_redis_sentinel_instance_ids</code>å­—æ®µä¼ å…¥å•ä¸ªå€¼çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æœ‰æ•ˆç­›é€‰å‡ºå¯¹åº”çš„èŠ‚ç‚¹ ID æ•°æ®çš„ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h2><p>å¯»æ±‚åç«¯å¸®åŠ©ï¼Œåç«¯å‘ç°å¦‚æœå°†<code>filter_redis_sentinel_instance_ids</code>å‚æ•°å€¼ç”¨é€—å·åˆ†éš”å¼€ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ æ•°ç»„ï¼Œæ­¤æ—¶ç­›é€‰æ˜¯æœ‰æ•ˆçš„ã€‚ä½†æ˜¯å®è·µåå‘ç°ç”±äºåç«¯å°†å…¶å®šä¹‰ä¸ºå­—ç¬¦ä¸²æ•°ç»„ç±»å‹ï¼Œæ‰€ä»¥å‰ç«¯å°†å®ƒä½¿ç”¨<code>join()</code>æ–¹æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸²åï¼ŒTS è¯­æ³•æ£€æŸ¥è¿‡ä¸å»ã€‚æ­¤æ—¶è§£å†³æ–¹æ¡ˆæ˜¯åç«¯é‡æ–°å®šä¹‰æ¥å£å­—æ®µç±»å‹ï¼Œå°†å…¶ä»<code>string[]</code>è½¬æ¢ä¸º<code>string</code>,å°†å‚æ•°ä¿®æ”¹ä¸º<code>filter_redis_sentinel_instance_ids:tableFilterInfo.redis_sentinel_instance_id?.[0]</code>ã€‚æ­¤æ—¶å¯ä»¥ä¿®å¤é—®é¢˜ã€‚</p>
<h2 id="ç±»ä¼¼é—®é¢˜"><a href="#ç±»ä¼¼é—®é¢˜" class="headerlink" title="ç±»ä¼¼é—®é¢˜"></a>ç±»ä¼¼é—®é¢˜</h2><p>å‘ç°é¡¹ç›®ä¸­æœ‰å¾ˆå¤šç±»ä¼¼çš„é—®é¢˜ï¼Œæ¯”å¦‚ uProxy é¡µé¢å®ä¾‹åˆ—è¡¨æœ‰ä¸€ä¸ªå®ä¾‹ id ç­›é€‰:</p>
<pre><code class="javascript">  React.useEffect(() =&gt; &#123;
    if (!!selectData) &#123;
      const groupId = selectData?.uproxy_group_id ?? &#39;&#39;;
      UproxyService.listUproxyInstancesV6(&#123;
        // è¯¥å‚æ•°ç±»å‹å®šä¹‰ä¸ºArray&lt;string&gt;ï¼Œä½†ä¼ é€’æ•°ç»„æ˜¯æ— æ•ˆçš„ï¼Œåªèƒ½ä¼ é€’å­—ç¬¦ä¸²ã€‚
        filter_uproxy_group_ids: groupId as any,
      &#125;).then((res) =&gt; &#123;
        if (res.data &amp;&amp; res.data.length === 1) &#123;
          setIsLast(true);
        &#125; else &#123;
          setIsLast(false);
        &#125;
      &#125;);
    &#125;
  &#125;, [selectData]);
</code></pre>
<p>è¿™é‡Œæ ¹æ®åç«¯ swagger æ–‡æ¡£ç”Ÿæˆçš„ api æ¥å£å®šä¹‰é‡Œ,<code>filter_uproxy_group_ids</code>å­—æ®µæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œä½†æ˜¯æ­¤æ—¶å‰ç«¯ä¼ é€’æ•°ç»„æ˜¯æ— æ•ˆçš„ï¼Œåªèƒ½ä¼ é€’å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ TS æ£€æŸ¥è¿‡ä¸å»ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨äº†<code>as any</code>ï¼Œè¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ†åŒç±»é—®é¢˜æ²¡æœ‰å‡ºç°é—®é¢˜çš„åŸå› ï¼Œæ¯”å¦‚ï¼š</p>
<pre><code class="javascript">const params: IListUproxyInstancesV6Params = &#123;
  filter_uproxy_group_ids: info.uproxy_group_id?.[0],
&#125;;
</code></pre>
<p>ç”±äº<code>info</code>æ˜¯<code>FilteredInfo</code>ç±»å‹,æ‰€ä»¥æ­¤æ—¶ä¼ ç»™<code>filter_uproxy_group_ids</code>çš„å®é™…ä¸Šæ˜¯<code>any</code>ç±»å‹,èº²è¿‡äº† TS æ£€æŸ¥ã€‚ä½†å¦‚æœåç»­éœ€æ±‚æœ‰å¤šå€¼ç­›é€‰çš„æ—¶å€™ï¼Œå°±æ— æ³•èº²è¿‡ TS æ£€æŸ¥ï¼š</p>
<pre><code class="javascript">export type FilteredInfo = &#123;
  [key: string]: any[] | null,
&#125;;
</code></pre>
<h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>æœ‰åç«¯åŒäº‹åé¦ˆï¼Œè¿™ç§é‡æ–°å®šä¹‰æ¥å£çš„è§£å†³æ–¹æ¡ˆä¿®å¤æˆæœ¬è¾ƒé«˜ï¼Œå› ä¸ºæ¯æ¬¡ä¿®æ”¹æ¥å£å®šä¹‰éƒ½éœ€è¦æ–°å¢ä¸€ä¸ª v1-&gt;v2 è¿™ç§ç±»ä¼¼çš„æ¥å£ï¼Œä½†æ˜¯å†…éƒ¨é€»è¾‘æ˜¯ä¸å˜çš„ã€‚æ‰€ä»¥éœ€è¦ä»å‰ç«¯è§’åº¦å†æ‰¾ä¸€æ‰¾å…¶ä»–çš„è§£å†³æ–¹æ¡ˆï¼Œé™ä½ä»¥åä¿®æ”¹é¡¹ç›®é‡Œå…¶ä»–ç±»ä¼¼ç¼ºé™·çš„ä¿®å¤æˆæœ¬ã€‚è¯¢é—®å…¶ä»–å‰ç«¯åŒäº‹å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p>
<blockquote>
<p>é—®é¢˜æœ¬è´¨åŸå› æ˜¯ axios å¯¹ query ç±»å‹çš„å‚æ•°çš„ format æ ¼å¼ä¸åç«¯ä½¿ç”¨çš„ parse params æ–¹å¼ä¸åŒ¹é…ã€‚axios é»˜è®¤ä¼šå°† query ä¸­çš„ array æ ¼å¼åŒ–åŸ?a[]&#x3D;1&amp;a[]&#x3D;2 çš„æ ¼å¼ï¼Œä½†æ˜¯åç«¯ä½¿ç”¨çš„ parse åªæ”¯æŒ ?a&#x3D;1,2 çš„æ ¼å¼ã€‚</p>
</blockquote>
<p>æŸ¥é˜…äº†<a target="_blank" rel="noopener" href="https://axios-http.com/zh/docs/req_config">axios çš„å®˜æ–¹æ–‡æ¡£</a> ,å‘ç°äº†é…ç½®é¡¹ï¼š</p>
<pre><code class="javascript">import qs from &#39;query-string&#39;
paramsSerializer: function (params) &#123;
  return qs.stringify(params, &#123;arrayFormat: &#39;brackets&#39;&#125;)
&#125;
</code></pre>
<p><code>arrayFormat</code>çš„é»˜è®¤å€¼æ˜¯<code>brackets</code>,æ‰€ä»¥å‡ºç°äº† url ä¸­ a[]&#x3D;1 è¿™ç§ç°è±¡ï¼Œå¯¼è‡´ç­›é€‰å¤±è´¥ï¼Œå°†å…¶ä¿®æ”¹ä¸º<code>comma</code>å³å¯ã€‚</p>
<pre><code class="javascript">qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;indices&#39; &#125;);
// &#39;a[0]=b&amp;a[1]=c&#39;
qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;brackets&#39; &#125;);
// &#39;a[]=b&amp;a[]=c&#39;
qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;repeat&#39; &#125;);
// &#39;a=b&amp;a=c&#39;
qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;comma&#39; &#125;);
// &#39;a=b,c&#39;
</code></pre>
<p>æ‰€ä»¥æœ€ç»ˆä¿®æ”¹æ–¹å¼æ˜¯ä¿®æ”¹ request å±æ€§å€¼</p>
<pre><code class="javascript">return handleTableRequestError(
  RedisService.ListRedisSentinelInstancesV5(cleanEmptyParams(params))
);
// ----å˜æ›´ä¸º--------
return handleTableRequestError(
  RedisService.ListRedisSentinelInstancesV5(cleanEmptyParams(params), &#123;
    paramsSerializer(paramsAll) &#123;
      return qs.stringify(paramsAll, &#123;
        arrayFormat: &#39;comma&#39;,
      &#125;);
    &#125;,
  &#125;)
);
</code></pre>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-07-31</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Moon</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/http%E8%AF%B7%E6%B1%82/'>
                            httpè¯·æ±‚
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/%E5%B7%A5%E4%BD%9C/'>
                            å·¥ä½œ
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        ä»¥ä¸Šã€‚ 
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://comment-hexo-waline.vercel.app/',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ­£ç¡®çš„é‚®ç®±åœ°å€ï¼Œå›å¤å°†èƒ½å¾—åˆ°é‚®ä»¶é€šçŸ¥ã€‚', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â©2021-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
    
</div>


    
<link rel="stylesheet" href="/css/a11y-dark.min.css">

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>