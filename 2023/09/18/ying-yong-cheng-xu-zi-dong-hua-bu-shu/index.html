<!DOCTYPE html>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="åº”ç”¨ç¨‹åºè‡ªåŠ¨åŒ–éƒ¨ç½²" />
    <meta name="hexo-theme-A4" content="v1.7.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Diary</title>

    
        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Diary</a> 
            <span class="description">å¤‡å¿˜å½•/ç¬”è®°æœ¬</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            åº”ç”¨ç¨‹åºè‡ªåŠ¨åŒ–éƒ¨ç½²
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-1"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%88%9B%E5%BB%BA%E5%B7%A5%E4%BD%9C%E6%B5%81%E7%9B%B8%E5%85%B3%E6%96%87%E4%BB%B6"><span class="post-toc-text">ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%B8%A9%E5%9D%91%EF%BC%9A"><span class="post-toc-text">è¸©å‘ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E5%88%9B%E5%BB%BA%E9%95%9C%E5%83%8F%E6%9E%84%E5%BB%BA%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-build-image-yml"><span class="post-toc-text">ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶ build-image.yml</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE%E9%A1%B9"><span class="post-toc-text">ä¸€äº›é…ç½®é¡¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#build-vue-app-image-%E6%80%BB%E5%85%B1%E6%9C%89-3-%E4%B8%AA%E6%AD%A5%E9%AA%A4%EF%BC%9A"><span class="post-toc-text">build_vue_app_image,æ€»å…±æœ‰ 3 ä¸ªæ­¥éª¤ï¼š</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%AD%A4%E5%A4%84%E6%9C%89%E4%B8%A4%E4%B8%AA%E5%9C%B0%E6%96%B9%E9%9C%80%E8%A6%81%E6%B3%A8%E6%84%8F%E3%80%90%E5%AE%B9%E6%98%93%E8%B8%A9%E5%9D%91%E3%80%91%EF%BC%9A"><span class="post-toc-text">æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E5%88%9B%E5%BB%BA-deploy-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6-deploy-yml"><span class="post-toc-text">ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º deploy é…ç½®æ–‡ä»¶ deploy.yml</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%80%E4%BA%9B%E9%85%8D%E7%BD%AE%E9%A1%B9-1"><span class="post-toc-text">ä¸€äº›é…ç½®é¡¹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#push-to-private-machine%E6%80%BB%E5%85%B1%E6%9C%89%E4%B8%AA%E6%AD%A5%E9%AA%A4"><span class="post-toc-text">push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%80%E4%BA%9B%E5%91%BD%E4%BB%A4"><span class="post-toc-text">ä¸€äº›å‘½ä»¤</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%B9%E6%98%93%E8%B8%A9%E5%9D%91%E7%9A%84%E7%82%B9"><span class="post-toc-text">å®¹æ˜“è¸©å‘çš„ç‚¹</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E8%99%9A%E6%8B%9F%E6%9C%BA%E4%B8%8A%E5%AE%89%E8%A3%85%E4%BA%86-git%EF%BC%8C%E4%BD%86%E6%98%AF%E6%89%A7%E8%A1%8C%E5%88%B0git-pull-xx%E5%8D%B4%E6%8A%A5%E9%94%99"><span class="post-toc-text">è™šæ‹Ÿæœºä¸Šå®‰è£…äº† gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git pull xxå´æŠ¥é”™:</span></a></li><li class="post-toc-item post-toc-level-4"><a class="post-toc-link" href="#%E7%AC%AC%E4%B8%80%E4%B8%AA%E6%B5%81%E7%A8%8B%E6%89%A7%E8%A1%8C%E5%AE%8C%E4%B9%8B%E5%90%8E%E5%B9%B6%E6%B2%A1%E6%9C%89%E6%89%A7%E8%A1%8C%E8%87%AA%E5%8A%A8%E5%8C%96%E9%83%A8%E7%BD%B2"><span class="post-toc-text">ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²</span></a></li></ol></li></ol></li></ol></li></ol>
        
        <p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ä½¿ç”¨ Dokcer è¿›è¡Œå‰åç«¯ç¨‹åºçš„éƒ¨ç½²å·²ç»æˆä¸ºä¸€ç§å¸¸è§çš„åšæ³•ã€‚ä½†æ˜¯æ¯æ¬¡ push ä»£ç åéƒ½éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒå¹¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œè¿™ä¸ä»…éº»çƒ¦ä¸”æµªè´¹æ—¶é—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ github actions å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹ã€‚</p>
<h1 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶</h1><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»º <code>.github/workflows/xxx.yaml</code>æ–‡ä»¶<br>æˆ‘ä»¬çš„é¢„æœŸæœ‰ä¸¤ä¸ªï¼š</p>
<ol>
<li>æ ¹æ®æœ€æ–°çš„ä»£ç æ„å»ºæœ€æ–°çš„å‰åç«¯é•œåƒ</li>
<li>å°†å®¹å™¨éƒ¨ç½²åˆ°è™šæ‹Ÿæœºä¸Š<br>æ‰€ä»¥æ–°å»ºä¸¤ä¸ªæ–‡ä»¶<code>build-image.yaml</code>å’Œ<code>deploy.yml</code></li>
</ol>
<h3 id="è¸©å‘ï¼š"><a href="#è¸©å‘ï¼š" class="headerlink" title="è¸©å‘ï¼š"></a>è¸©å‘ï¼š</h3><p>æ–‡ä»¶å¤¹åç§°å¿…é¡»æ˜¯<code>.github/workflows</code>ï¼Œä¸”å¿…é¡»æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹,å¦åˆ™ github ä¸ä¼šå°†å…¶è¯†åˆ«ä¸º github actions çš„é…ç½®æ–‡ä»¶ã€‚</p>
<h2 id="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶-build-image-yml"><a href="#ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶-build-image-yml" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶ build-image.yml"></a>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶ build-image.yml</h2><h3 id="ä¸€äº›é…ç½®é¡¹"><a href="#ä¸€äº›é…ç½®é¡¹" class="headerlink" title="ä¸€äº›é…ç½®é¡¹"></a>ä¸€äº›é…ç½®é¡¹</h3><ul>
<li>on:æŒ‡å®šè§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶,å¤§éƒ¨åˆ†æƒ…å†µä¸‹è®¾ç½®ä¸º pushï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–å¯é€‰å€¼ï¼špull_request,issue_comment ç­‰</li>
<li>jobs:å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ª job</li>
<li>runs-on:æŒ‡å®š job è¿è¡Œçš„æ“ä½œç³»ç»Ÿç¯å¢ƒ</li>
<li>steps:å®šä¹‰å®Œæˆå½“å‰ job æ‰€éœ€è¦çš„æ­¥éª¤<ul>
<li>name: æ­¥éª¤åç§°</li>
<li>usesï¼šæŒ‡å®šé¢„å®šä¹‰çš„åŠ¨ä½œæˆ–è‡ªå®šä¹‰çš„æ“ä½œæ‰€åœ¨çš„ä»“åº“å’Œç‰ˆæœ¬ï¼Œä¸€èˆ¬å½¢å¼ä¸º<code>ä»“åº“æ‰€æœ‰è€…/ä»“åº“åœ°å€@ç‰ˆæœ¬</code></li>
<li>run:æŒ‡å®šå…·ä½“çš„å‘½ä»¤æˆ–è„šæœ¬æ¥æ‰§è¡Œ</li>
<li>envï¼šå®šä¹‰ç¯å¢ƒå˜é‡</li>
</ul>
</li>
</ul>
<h3 id="build-vue-app-image-æ€»å…±æœ‰-3-ä¸ªæ­¥éª¤ï¼š"><a href="#build-vue-app-image-æ€»å…±æœ‰-3-ä¸ªæ­¥éª¤ï¼š" class="headerlink" title="build_vue_app_image,æ€»å…±æœ‰ 3 ä¸ªæ­¥éª¤ï¼š"></a>build_vue_app_image,æ€»å…±æœ‰ 3 ä¸ªæ­¥éª¤ï¼š</h3><ol>
<li>é€šè¿‡<code>actions/checkout@v3</code>æ‹‰å–ä»£ç ä»“åº“</li>
<li>æ„å»ºå‰ç«¯é•œåƒ</li>
<li>æ„å»ºåç«¯é•œåƒ</li>
</ol>
<p>æ­¤å¤„æœ‰ä¸¤ä¸ªç¯å¢ƒå˜é‡<code>DOCKER_USERNAME</code>,<code>DOCKER_PASSWORD</code>,è¿™ä¸¤ä¸ªå˜é‡éƒ½æ˜¯é€šè¿‡é…ç½® github è¯¥é¡¹ç›®ä»“åº“çš„<code>secrets</code>è·å–åˆ°çš„ï¼Œè®¾ç½®è·¯å¾„ä¸ºï¼š<a target="_blank" rel="noopener" href="https://github.com/earthaYan/resume_generator_front/settings/secrets/actions">é¡¹ç›®-settings-Security-Actions secrets and variables-Repository secrets</a></p>
<h3 id="æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š"><a href="#æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š" class="headerlink" title="æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š"></a>æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š</h3><ol>
<li>è¿™é‡Œä¸¤ä¸ªç¯å¢ƒå˜é‡åº”è¯¥è®¾ç½®çš„æ˜¯ä¸¤ä¸ª<code>secret</code>ï¼Œè€Œä¸æ˜¯Name ä¸ºä½ çš„ Docker Hub è´¦å·ï¼ŒValue ä¸º Docker Hub çš„ access token<table>
<thead>
<tr>
<th>Name</th>
<th>Value</th>
</tr>
</thead>
<tbody><tr>
<td>DOCKER_USERNAME</td>
<td>Docker Hub è´¦å·å</td>
</tr>
<tr>
<td>DOCKER_PASSWORD</td>
<td>Docker Hub Access Token</td>
</tr>
</tbody></table>
</li>
<li>ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™æŠ¥é”™ï¼š<code>invalid workflow file,you have error in your yaml syntax on line11</code>ï¼ŒæŠ¥é”™éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</li>
</ol>
<pre><code class="yaml">env:  DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;
      DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;
</code></pre>
<p>é”™è¯¯çš„åŸå› æ˜¯ yaml æ–‡ä»¶ä¸­ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œç›¸åŒå±‚çº§çš„å…ƒç´ å¿…é¡»å·¦å¯¹é½ï¼Œè€Œè¿™é‡Œ envä¸‹é¢çš„ç¯å¢ƒå˜é‡æ˜¯ env çš„ä¸‹ä¸€çº§ï¼Œä½†æ˜¯å´å’Œå®ƒæ”¾åœ¨äº†åŒä¸€è¡Œï¼Œæ‰€ä»¥æŠ¥é”™äº†ï¼Œä¿®æ”¹ä¸ºï¼š</p>
<pre><code class="yml">name: Build vue_app image
env:
    DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;
    DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;
</code></pre>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="yml">name: build-image
run-name: $&#123;&#123; github.actor &#125;&#125; is building latest image
on: [push]
jobs:
  build_vue_app_image:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Build vue_app image
        env:
          DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;
          DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;
        run: |
          docker build -t yanyue1215/vue_app .
          docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
          docker push yanyue1215/vue_app
      - name: build_resume_service
        env:
          DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;
          DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;
        run: |
          cd Backend/    # åç«¯ä»£ç æ‰€åœ¨ç›®å½•
          docker build -t yanyue1215/resume_service .
          docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD
          docker push yanyue1215/resume_service
</code></pre>
<h2 id="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º-deploy-é…ç½®æ–‡ä»¶-deploy-yml"><a href="#ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º-deploy-é…ç½®æ–‡ä»¶-deploy-yml" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º deploy é…ç½®æ–‡ä»¶ deploy.yml"></a>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º deploy é…ç½®æ–‡ä»¶ deploy.yml</h2><p>å¦‚æ­¤ä¹‹åï¼Œæ¯å½“ push ä»£ç åˆ°å¯¹åº”åˆ†æ”¯åï¼Œgithub å°±ä¼šè‡ªåŠ¨æ„å»ºæœ€æ–°é•œåƒå¹¶æ¨é€åˆ° Docker Hubã€‚ä½†æ˜¯è¿™ä¸ªæ—¶å€™ä½ è¿˜æ˜¯éœ€è¦è‡ªå·±å»è™šæ‹Ÿæœºä¸Šæ‹‰å–æœ€æ–°é•œåƒå¹¶é‡å»ºå®¹å™¨ï¼Œä¾æ—§å¾ˆéº»çƒ¦ï¼Œå¦‚æœè¿™ä¸ªè¿‡ç¨‹ä¹Ÿèƒ½èƒ½è‡ªåŠ¨åŒ–å°±æœ€å¥½äº†ã€‚<br>ä¸€å¼€å§‹è€ƒè™‘æ˜¯å¦å’Œ umc-ui é¡¹ç›®ä¸€æ ·ä½¿ç”¨MakeFile,ä½†æ˜¯æœ€åè¿˜æ˜¯å¸Œæœ›èƒ½æŠŠæ›´æ–°å’Œéƒ¨ç½²éƒ½é›†æˆåˆ° github çš„å·¥ä½œæµç¨‹ä¸­ã€‚ä½†æ˜¯ç”±äº github action æœ¬èº«å¹¶ä¸æ”¯æŒç›´æ¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°ç§äººçš„è™šæ‹Ÿæœºä¸Šï¼Œéœ€è¦å’Œå…¶ä»–å·¥å…·ç›¸ç»“åˆã€‚æœ€ç»ˆé‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼š</p>
<blockquote>
<p>åœ¨ yml æ–‡ä»¶ä¸­ç¼–å†™ä¸€ä¸ªéƒ¨ç½²è„šæœ¬ï¼Œé€šè¿‡ ssh è¿æ¥åˆ°è™šæ‹Ÿæœºå¹¶æ‰§è¡Œå¯¹åº”çš„éƒ¨ç½²å‘½ä»¤</p>
</blockquote>
<h3 id="ä¸€äº›é…ç½®é¡¹-1"><a href="#ä¸€äº›é…ç½®é¡¹-1" class="headerlink" title="ä¸€äº›é…ç½®é¡¹"></a>ä¸€äº›é…ç½®é¡¹</h3><ul>
<li>workflows: ä¾èµ–çš„workflow</li>
<li>types:æŒ‡å®šåªæœ‰åœ¨ä¾èµ–å·¥ä½œæµç¨‹å®Œæˆåæ‰è§¦å‘è¯¥å·¥ä½œæµç¨‹</li>
</ul>
<h3 id="push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤"><a href="#push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤" class="headerlink" title="push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤"></a>push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤</h3><ol>
<li>é€šè¿‡<code>actions/checkout@v3</code>æ‹‰å–ä»£ç ä»“åº“</li>
<li>å°†è™šæ‹Ÿæœºå¯†é’¥æ·»åŠ åˆ° GitHub Runner çš„ â€œknown_hostsâ€ æ–‡ä»¶ä¸­</li>
<li>ç§»é™¤æ—§å®¹å™¨</li>
<li>æ‹‰å–æœ€æ–°é•œåƒ</li>
<li>åˆ›å»ºæ–°å®¹å™¨</li>
</ol>
<h3 id="ä¸€äº›å‘½ä»¤"><a href="#ä¸€äº›å‘½ä»¤" class="headerlink" title="ä¸€äº›å‘½ä»¤"></a>ä¸€äº›å‘½ä»¤</h3><ul>
<li><code>docker ps -a | grep yanyue1215/vue_app | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f</code><ul>
<li>docker ps -aï¼šåˆ—å‡ºæ‰€æœ‰çš„Dokcerå®¹å™¨</li>
<li>grep yanyue1215&#x2F;vue_appï¼šåœ¨å®¹å™¨åˆ—è¡¨ä¸­è¿‡æ»¤å‡ºåç§°ä¸º â€œyanyue1215&#x2F;vue_appâ€ çš„å®¹å™¨</li>
<li>awk â€˜{print $1}â€™:ä»è¿‡æ»¤ç»“æœä¸­æå–ç¬¬ä¸€åˆ—ï¼ˆå³å®¹å™¨ IDï¼‰</li>
<li>xargs -r docker rm -fï¼šå°†å®¹å™¨ ID ä½œä¸ºå‚æ•°ä¼ é€’ç»™ docker rm -f å‘½ä»¤ï¼Œä»¥å¼ºåˆ¶åˆ é™¤å®¹å™¨</li>
</ul>
</li>
<li>ssh-keyscan 116.204.108.126 &gt;&gt; ~&#x2F;.ssh&#x2F;known_hosts<ul>
<li>ä½¿ç”¨ <code>ssh-keyscan</code> å‘½ä»¤æ‰«æä¸»æœº 116.204.108.126 çš„å…¬é’¥ï¼Œå¹¶å°†ç»“æœè¿½åŠ åˆ° <code>~/.ssh/known_hosts</code> æ–‡ä»¶ä¸­ã€‚<code>&gt;&gt; </code>æ“ä½œç¬¦è¡¨ç¤ºå°†è¾“å‡ºé‡å®šå‘å¹¶è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾</li>
</ul>
</li>
</ul>
<p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p>
<pre><code class="yml">name: push-to-private-machine
run-name: $&#123;&#123; github.actor &#125;&#125; is deploying
on:
  workflow_run:
    workflows: [&quot;build-image&quot;] #ä¾èµ–çš„å·¥ä½œæµç¨‹æ–‡ä»¶çš„åç§°
    types:
      - completed
jobs:
  deploy:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v3
      - name: Add known hosts
        run: | # å°†è™šæ‹Ÿæœºå¯†é’¥æ·»åŠ åˆ° GitHub Runner çš„ &quot;known_hosts&quot; æ–‡ä»¶ä¸­
          mkdir -p ~/.ssh
          ssh-keyscan 116.204.108.126 &gt;&gt; ~/.ssh/known_hosts
      - name: remove old container
        run: |
          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker ps -a | grep yanyue1215/vue_app | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f&quot;
          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker ps -a | grep yanyue1215/resume_service | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f&quot;
          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker system prune -a&quot;
      - name: pull latest front_image
        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker pull yanyue1215/vue_app:latest&quot;
      - name: pull latest backend_image
        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker pull yanyue1215/resume_service:latest&quot;
      - name: Deploy to Virtual Machine
        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;cd /root/resume_generator_front &amp;&amp; /usr/local/git/bin/git pull origin master &amp;&amp; docker-compose up -d&quot;
</code></pre>
<h3 id="å®¹æ˜“è¸©å‘çš„ç‚¹"><a href="#å®¹æ˜“è¸©å‘çš„ç‚¹" class="headerlink" title="å®¹æ˜“è¸©å‘çš„ç‚¹"></a>å®¹æ˜“è¸©å‘çš„ç‚¹</h3><h4 id="è™šæ‹Ÿæœºä¸Šå®‰è£…äº†-gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git-pull-xxå´æŠ¥é”™"><a href="#è™šæ‹Ÿæœºä¸Šå®‰è£…äº†-gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git-pull-xxå´æŠ¥é”™" class="headerlink" title="è™šæ‹Ÿæœºä¸Šå®‰è£…äº† gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git pull xxå´æŠ¥é”™:"></a>è™šæ‹Ÿæœºä¸Šå®‰è£…äº† gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°<code>git pull xx</code>å´æŠ¥é”™:</h4><blockquote>
<p>git: command not found<br>error:Process completed with exit code 127</p>
</blockquote>
<p>çŒœæµ‹åŸå› æ˜¯ Github Actions çš„å·¥ä½œæµç¨‹ä¸­æ— æ³•æ‰¾åˆ° git å‘½ä»¤ã€‚è§£å†³æ–¹æ¡ˆæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šæ‰§è¡Œ<code>which git</code>å‘½ä»¤è·å–åˆ° git çš„å®é™…ä½ç½®ï¼Œç„¶åå°†å…¶æ›¿æ¢åˆ°å‘½ä»¤ä¸­ã€‚</p>
<pre><code class="bash"># åŸæ¥çš„å‘½ä»¤ï¼š
git pull origin master
# ä¿®æ”¹åçš„å‘½ä»¤ï¼š
/usr/local/git/bin/git pull origin master
</code></pre>
<h4 id="ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²"></a>ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²</h4><p>åŸå› ï¼šéœ€è¦ä¸¤ä¸ªå·¥ä½œæµç¨‹æ–‡ä»¶çš„åç§°æ­£ç¡®ä¸”åŒ¹é…<br>è§£å†³æ–¹æ¡ˆï¼šæ˜¯å°†æ‰€æœ‰ yml æ–‡ä»¶å’Œä»–ä»¬é‡Œé¢çš„<code>name</code>å€¼ä¿æŒä¸€è‡´</p>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-09-18</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Moon</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/Docker/'>
                            Docker
                        </a>
                    
                        <a href='/tags/SSH/'>
                            SSH
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/Docker/'>
                            Docker
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        ä»¥ä¸Šã€‚ 
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://comment-hexo-waline.vercel.app/',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ­£ç¡®çš„é‚®ç®±åœ°å€ï¼Œå›å¤å°†èƒ½å¾—åˆ°é‚®ä»¶é€šçŸ¥ã€‚', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â©2021-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
    
</div>


    
<link rel="stylesheet" href="/css/a11y-dark.min.css">

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>