<!DOCTYPE html>
<html lang="zh-CN">
    <head>
    <meta charset="utf-8">
    <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0,  viewport-fit=cover" name="viewport" />
    <meta name="description" content="ä¿„ç½—æ–¯æ–¹å—" />
    <meta name="hexo-theme-A4" content="v1.7.1" />
    <link rel="alternate icon" type="image/webp" href="/img/favicon.webp">
    <title>Diary</title>

    
        
<link rel="stylesheet" href="/css/reset.css">

        
<link rel="stylesheet" href="/css/markdown.css">

        
<link rel="stylesheet" href="/css/fonts.css">
 
         <!--æ³¨æ„ï¼šé¦–é¡µæ—¢ä¸æ˜¯postä¹Ÿä¸æ˜¯page-->
        
            
<link rel="stylesheet" href="/css/waline.css">

        
    
    
<link rel="stylesheet" href="/css/ui.css">
 
    
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 6.3.0"></head>
    
    <body>
        <div class="paper">
            
            
            
            
                <div class="shadow-drop-2-bottom paper-main">
                    
<div class="header">
    <div class="header-container">
        <img style="
        width: 56px;
        height: auto;" alt="^-^" cache-control="max-age=86400" class="header-img" src="/img/favicon.webp" width="10%"></img>
        <div class="header-content">
            <a class="logo" href="/">Diary</a> 
            <span class="description">å¤‡å¿˜å½•/ç¬”è®°æœ¬</span> 
        </div>
        
    </div>
    
   
    <ul class="nav">
        
            
                <li><a href="/">é¦–é¡µ</a></li>
            
        
            
                <li><a href="/list/">æ–‡ç« </a></li>
            
        
            
                <li><a href="/categories/">åˆ†ç±»</a></li>
            
        
    </ul>
</div> 
        
                    
                    

                    
                    
                    
                    <!--è¯´æ˜æ˜¯æ–‡ç« posté¡µé¢-->
                    
                        <div class="post-main">

    
        <div class="post-main-title">
            ä¿„ç½—æ–¯æ–¹å—
        </div>
      
    

    <div class="post-md">
        
            <ol class="post-toc"><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%9D%E5%A7%8B%E5%8C%96-pygame"><span class="post-toc-text">åˆå§‹åŒ– pygame</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%BB%E5%BE%AA%E7%8E%AF"><span class="post-toc-text">ä¸»å¾ªç¯</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#pygame-event-get-%E6%96%B9%E6%B3%95"><span class="post-toc-text">pygame.event.get()æ–¹æ³•</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%88%9B%E5%BB%BA%E7%94%BB%E9%9D%A2"><span class="post-toc-text">åˆ›å»ºç”»é¢</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%98%BE%E7%A4%BA%E5%9B%BE%E7%89%87"><span class="post-toc-text">æ˜¾ç¤ºå›¾ç‰‡</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#get-rect-%E6%96%B9%E6%B3%95"><span class="post-toc-text">get_rect()æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#blit-image-position-%E6%96%B9%E6%B3%95"><span class="post-toc-text">blit(image,position)æ–¹æ³•</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%AE%A9%E5%9B%BE%E7%89%87%E5%8A%A8%E8%B5%B7%E6%9D%A5"><span class="post-toc-text">è®©å›¾ç‰‡åŠ¨èµ·æ¥</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%8E%BB%E6%8E%89%E6%AE%8B%E5%BD%B1"><span class="post-toc-text">å»æ‰æ®‹å½±</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8E%A7%E5%88%B6%E7%A7%BB%E5%8A%A8"><span class="post-toc-text">æ§åˆ¶ç§»åŠ¨</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#get-pressed-%E6%96%B9%E6%B3%95"><span class="post-toc-text">get_pressed()æ–¹æ³•</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#Rect-move-ip-x-y-%E6%96%B9%E6%B3%95"><span class="post-toc-text">Rect.move_ip(x,y)æ–¹æ³•</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A2%9E%E5%8A%A0%E4%B8%8A%E4%B8%8B%E6%96%B9%E5%90%91%E7%A7%BB%E5%8A%A8"><span class="post-toc-text">å¢åŠ ä¸Šä¸‹æ–¹å‘ç§»åŠ¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%9D%97%E7%B1%BB"><span class="post-toc-text">å®ç°æ–¹å—ç±»</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8%E4%B8%BB%E5%87%BD%E6%95%B0%E4%B8%AD%E8%BF%9B%E8%A1%8C%E8%B0%83%E7%94%A8"><span class="post-toc-text">åœ¨ä¸»å‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A4%9A%E5%AE%9E%E4%BE%8B"><span class="post-toc-text">å¤šå®ä¾‹</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8B%86%E5%88%86%E6%96%87%E4%BB%B6"><span class="post-toc-text">æ‹†åˆ†æ–‡ä»¶</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E9%80%BB%E8%BE%91%E5%92%8C%E8%A1%A8%E7%8E%B0%E5%88%86%E7%A6%BB"><span class="post-toc-text">é€»è¾‘å’Œè¡¨ç°åˆ†ç¦»</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#transform-scale"><span class="post-toc-text">transform.scale()</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%94%9F%E6%88%90%E5%A4%9A%E4%B8%AA%E6%96%B9%E5%9D%97"><span class="post-toc-text">ç”Ÿæˆå¤šä¸ªæ–¹å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%B8%BB%E6%B5%81%E7%A8%8B%E6%B8%B2%E6%9F%93%E6%96%B9%E5%9D%97"><span class="post-toc-text">ä¸»æµç¨‹æ¸²æŸ“æ–¹å—</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#relPos"><span class="post-toc-text">relPos</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BB%84%E5%90%88%E6%96%B9%E5%9D%97"><span class="post-toc-text">ç»„åˆæ–¹å—</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#BlockGroup-%E7%B1%BB"><span class="post-toc-text">BlockGroup ç±»</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A8%A1%E6%8B%9F%E4%B8%8B%E8%90%BD"><span class="post-toc-text">æ¨¡æ‹Ÿä¸‹è½</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8-Block-%E7%9A%84%E7%B1%BB%E4%B8%AD%E5%AE%9E%E7%8E%B0%E5%8D%95%E4%B8%AA%E5%9D%97%E7%9A%84-drop-%E5%87%BD%E6%95%B0"><span class="post-toc-text">åœ¨ Block çš„ç±»ä¸­å®ç°å•ä¸ªå—çš„ drop å‡½æ•°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8-BlockGroup-%E7%9A%84%E7%B1%BB%E4%B8%AD%E5%AE%9E%E7%8E%B0%E5%8D%95%E4%B8%AA%E7%BB%84%E5%90%88%E5%9D%97%E7%9A%84%E4%B8%8B%E8%90%BD"><span class="post-toc-text">åœ¨ BlockGroup çš„ç±»ä¸­å®ç°å•ä¸ªç»„åˆå—çš„ä¸‹è½</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8-main-%E5%87%BD%E6%95%B0%E4%B8%AD%E8%B0%83%E7%94%A8"><span class="post-toc-text">åœ¨ main å‡½æ•°ä¸­è°ƒç”¨</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A1%86%E6%9E%B6%E4%BB%A3%E7%A0%81"><span class="post-toc-text">æ¡†æ¶ä»£ç </span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%A1%AE%E5%AE%9A%E6%B8%B8%E6%88%8F%E4%B8%BB%E9%80%BB%E8%BE%91"><span class="post-toc-text">ç¡®å®šæ¸¸æˆä¸»é€»è¾‘</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E5%9D%97%E7%BB%84%E7%9A%84%E5%A4%9A%E6%80%81"><span class="post-toc-text">æ–¹å—ç»„çš„å¤šæ€</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%9A%E4%B9%89%E6%96%B9%E5%9D%97%E7%BB%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E4%B8%80%E4%BA%9B%E5%85%B6%E4%BB%96%E5%B8%B8%E9%87%8F"><span class="post-toc-text">å®šä¹‰æ–¹å—ç»„ç±»å‹å’Œä¸€äº›å…¶ä»–å¸¸é‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%9C%A8-BlockGroup-%E7%B1%BB%E4%B8%AD%E5%A2%9E%E5%8A%A0%E8%AF%A5-blockGroupType-%E5%8F%82%E6%95%B0"><span class="post-toc-text">åœ¨ BlockGroup ç±»ä¸­å¢åŠ è¯¥ blockGroupType å‚æ•°</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%B8%B8%E6%88%8F%E9%80%BB%E8%BE%91%E8%B0%83%E6%95%B4"><span class="post-toc-text">æ¸¸æˆé€»è¾‘è°ƒæ•´</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%A8%A1%E6%8B%9F%E7%A2%B0%E6%92%9E"><span class="post-toc-text">æ¨¡æ‹Ÿç¢°æ’</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%B0%81%E8%A3%85-blockGroup-%E4%B8%AD%E6%89%80%E6%9C%89-block-%E7%9A%84%E5%9D%90%E6%A0%87"><span class="post-toc-text">å°è£… blockGroup ä¸­æ‰€æœ‰ block çš„åæ ‡</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E5%AE%9A%E4%B9%89-blockGroup-%E7%9A%84%E5%A2%9E%E5%88%A0%E6%94%B9%E6%9F%A5"><span class="post-toc-text">å®šä¹‰ blockGroup çš„å¢åˆ æ”¹æŸ¥</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E7%A2%B0%E6%92%9E%E6%A3%80%E6%B5%8B"><span class="post-toc-text">ç¢°æ’æ£€æµ‹</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E6%A3%80%E6%B5%8B%E5%88%B0%E7%A2%B0%E6%92%9E%E4%BB%A5%E5%90%8E%E7%9A%84%E5%A4%84%E7%90%86"><span class="post-toc-text">æ£€æµ‹åˆ°ç¢°æ’ä»¥åçš„å¤„ç†</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B7%A6%E5%8F%B3%E7%A7%BB%E5%8A%A8"><span class="post-toc-text">æ§åˆ¶å·¦å³ç§»åŠ¨</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8E%A7%E5%88%B6%E5%B7%A6%E5%8F%B3%E7%A7%BB%E5%8A%A8%E9%80%9F%E5%BA%A6"><span class="post-toc-text">æ§åˆ¶å·¦å³ç§»åŠ¨é€Ÿåº¦</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#blockGroup-%E7%B1%BB%E6%96%B0%E5%A2%9E%E4%B8%80%E4%B8%AA%E6%97%B6%E9%97%B4%E6%A3%80%E6%B5%8B%E5%87%BD%E6%95%B0-%E4%BB%A5%E6%AF%AB%E7%A7%92%E4%B8%BA%E5%8D%95%E4%BD%8D"><span class="post-toc-text">blockGroup ç±»æ–°å¢ä¸€ä¸ªæ—¶é—´æ£€æµ‹å‡½æ•°(ä»¥æ¯«ç§’ä¸ºå•ä½)</span></a></li><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E8%B0%83%E7%94%A8"><span class="post-toc-text">è°ƒç”¨</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%8E%A7%E5%88%B6%E4%B8%8B%E8%90%BD%E9%80%9F%E5%BA%A6"><span class="post-toc-text">æ§åˆ¶ä¸‹è½é€Ÿåº¦</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E5%9D%97%E6%97%8B%E8%BD%AC"><span class="post-toc-text">æ–¹å—æ—‹è½¬</span></a><ol class="post-toc-child"><li class="post-toc-item post-toc-level-3"><a class="post-toc-link" href="#%E4%BF%AE%E6%94%B9-block-%E7%B1%BB%E7%9A%84%E5%88%9D%E5%A7%8B%E5%8C%96%E5%87%BD%E6%95%B0"><span class="post-toc-text">ä¿®æ”¹ block ç±»çš„åˆå§‹åŒ–å‡½æ•°</span></a></li></ol></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E6%96%B9%E5%9D%97%E6%B6%88%E9%99%A4"><span class="post-toc-text">æ–¹å—æ¶ˆé™¤</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E7%BB%93%E6%9D%9F%E6%B6%88%E9%99%A4"><span class="post-toc-text">ç»“æŸæ¶ˆé™¤</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E5%A4%B1%E8%B4%A5%E5%88%A4%E5%AE%9A"><span class="post-toc-text">å¤±è´¥åˆ¤å®š</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E8%AE%A1%E5%88%86%E8%A7%84%E5%88%99"><span class="post-toc-text">è®¡åˆ†è§„åˆ™</span></a></li><li class="post-toc-item post-toc-level-2"><a class="post-toc-link" href="#%E4%B8%8B%E4%B8%AA%E6%96%B9%E5%9D%97"><span class="post-toc-text">ä¸‹ä¸ªæ–¹å—</span></a></li></ol>
        
        <h2 id="åˆå§‹åŒ–-pygame"><a href="#åˆå§‹åŒ–-pygame" class="headerlink" title="åˆå§‹åŒ– pygame"></a>åˆå§‹åŒ– pygame</h2><ol>
<li>å¼•å…¥ pygame åŒ…</li>
<li>è°ƒç”¨ pygame çš„ init æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–</li>
</ol>
<pre><code class="py">import pygame
from pygame.locals import *

pygame.init()
</code></pre>
<p>2 ä¸ª import çš„åŒºåˆ«æ˜¯ï¼šç¬¬äºŒä¸ª import å¯¼å‡ºçš„å˜é‡å¯ä»¥ç›´æ¥ä½¿ç”¨ï¼Œä¸éœ€è¦åŠ åŒ…åå‰ç¼€</p>
<h2 id="ä¸»å¾ªç¯"><a href="#ä¸»å¾ªç¯" class="headerlink" title="ä¸»å¾ªç¯"></a>ä¸»å¾ªç¯</h2><ol>
<li>ä½¿ç”¨ set_mode æ–¹æ³•å®šä¹‰ä¸€ä¸ªæ¸¸æˆçª—å£</li>
<li>ä½¿ç”¨ while åšä¸€ä¸ªæ­»å¾ªç¯ï¼Œä½¿ç”¨ udpate æ–¹æ³•ä¸æ–­æ›´æ–°æ¸¸æˆçª—å£</li>
<li>æ·»åŠ é€€å‡ºæœºåˆ¶</li>
</ol>
<pre><code class="py">pygame.init()
while True:
    for event in pygame.event.get():
        if event.type== QUIT:
            pygame.quit()
            sys.exit()
    pygame.display.update()
</code></pre>
<h3 id="pygame-event-get-æ–¹æ³•"><a href="#pygame-event-get-æ–¹æ³•" class="headerlink" title="pygame.event.get()æ–¹æ³•"></a>pygame.event.get()æ–¹æ³•</h3><p>ä½œç”¨ï¼šä»äº‹ä»¶é˜Ÿåˆ—ä¸­è·å–å½“å‰æ‰€æœ‰<em>æŒ‚èµ·çš„äº‹ä»¶</em>(äº‹ä»¶é˜Ÿåˆ—ä¸­ç­‰å¾…å¤„ç†çš„äº‹ä»¶)ï¼Œå¹¶å°†å…¶ä»äº‹ä»¶é˜Ÿåˆ—ä¸­ç§»é™¤<br>åœ¨è°ƒç”¨ pygame.event.get() æ–¹æ³•åï¼Œäº‹ä»¶é˜Ÿåˆ—ä¸­ä¸å†ä¿ç•™è¿™äº›äº‹ä»¶ï¼Œä¼šè¢«ç›´æ¥æ¸…ç©º</p>
<h2 id="åˆ›å»ºç”»é¢"><a href="#åˆ›å»ºç”»é¢" class="headerlink" title="åˆ›å»ºç”»é¢"></a>åˆ›å»ºç”»é¢</h2><p>ä½¿ç”¨ set_mode æ–¹æ³•åˆ›å»ºä¸€ä¸ªæ¸¸æˆçª—å£</p>
<pre><code class="py">pygame.init()
DISPLAYSURF=pygame.display.set_mode((800,600))
while True:
    for event in pygame.event.get():
        if event.type== QUIT:
            pygame.quit()
            sys.exit()
    pygame.display.update()
</code></pre>
<h2 id="æ˜¾ç¤ºå›¾ç‰‡"><a href="#æ˜¾ç¤ºå›¾ç‰‡" class="headerlink" title="æ˜¾ç¤ºå›¾ç‰‡"></a>æ˜¾ç¤ºå›¾ç‰‡</h2><ol>
<li>image.load æ–¹æ³•åŠ è½½å›¾ç‰‡</li>
<li>get_rect è·å–çŸ©å½¢</li>
<li>é€šè¿‡ä¸¾è¡Œå¯¹è±¡çš„ center å±æ€§è®¾ç½®çŸ©å½¢ä¸­å¿ƒç‚¹</li>
<li>ä½¿ç”¨ blit æ–¹æ³•ç»˜åˆ¶å›¾ç‰‡</li>
</ol>
<pre><code class="py">Image=pygame.image.load(&#39;../pic/red.png&#39;)
Rect=Image.get_rect()
Rect.center=(400,300)
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    DISPLAYSURF.blit(Image,Rect)
    pygame.display.update()
</code></pre>
<h3 id="get-rect-æ–¹æ³•"><a href="#get-rect-æ–¹æ³•" class="headerlink" title="get_rect()æ–¹æ³•"></a>get_rect()æ–¹æ³•</h3><p>ä½œç”¨ï¼šè¿”å›ä¸€ä¸ªä¸å›¾åƒå¤§å°ç›¸åŒ¹é…çš„çŸ©å½¢å¯¹è±¡ï¼Œè¿™ä¸ªçŸ©å½¢å¯ä»¥ç”¨æ¥å®šä½ã€å¤„ç†ç¢°æ’æ£€æµ‹ç­‰æ“ä½œ<br>React å¯¹è±¡ï¼šåŒ…å«äº†å›¾ç‰‡çš„ä½ç½®å’Œå¤§å°ä¿¡æ¯</p>
<h3 id="blit-image-position-æ–¹æ³•"><a href="#blit-image-position-æ–¹æ³•" class="headerlink" title="blit(image,position)æ–¹æ³•"></a>blit(image,position)æ–¹æ³•</h3><p>ä½œç”¨ï¼šå°†å›¾åƒç»˜åˆ¶åˆ°å±å¹•ä¸Š<br>ä½¿ç”¨ï¼šè°ƒç”¨ Surface å¯¹è±¡ï¼ˆæ¯”å¦‚æ¸¸æˆçª—å£æˆ–è€…å…¶ä»–ç”»å¸ƒï¼‰çš„ blit æ–¹æ³•</p>
<h2 id="è®©å›¾ç‰‡åŠ¨èµ·æ¥"><a href="#è®©å›¾ç‰‡åŠ¨èµ·æ¥" class="headerlink" title="è®©å›¾ç‰‡åŠ¨èµ·æ¥"></a>è®©å›¾ç‰‡åŠ¨èµ·æ¥</h2><p>æœ¬è´¨ä¸Šå°±æ˜¯ä¿®æ”¹çŸ©å½¢å¯¹è±¡çš„ä¸­å¿ƒç‚¹</p>
<pre><code class="py">while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    DISPLAYSURF.blit(Image,Rect)
    Rect.centerx +=random.randint(-1,1)
    pygame.display.update()
</code></pre>
<h2 id="å»æ‰æ®‹å½±"><a href="#å»æ‰æ®‹å½±" class="headerlink" title="å»æ‰æ®‹å½±"></a>å»æ‰æ®‹å½±</h2><p>åŸå› ï¼šæ¯æ¬¡æ¸²æŸ“å¹¶ä¸ä¼šæ¸…é™¤ä¸Šä¸€å¸§çš„æ¸²æŸ“ç»“æœ<br>è§£å†³æ–¹æ³•ï¼šæ¯æ¬¡æ¸²æŸ“ä¹‹å‰éœ€è¦å¡«å……ä¸€æ¬¡å±å¹•,å¯ä»¥ä½¿ç”¨ fill æ–¹æ³•</p>
<pre><code class="py">while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    DISPLAYSURF.fill((0,0,0))
    DISPLAYSURF.blit(Image,Rect)
    Rect.centerx +=random.randint(-1,1)
    pygame.display.update()
</code></pre>
<h2 id="æ§åˆ¶ç§»åŠ¨"><a href="#æ§åˆ¶ç§»åŠ¨" class="headerlink" title="æ§åˆ¶ç§»åŠ¨"></a>æ§åˆ¶ç§»åŠ¨</h2><p>é€šè¿‡è·å–ç”¨æˆ·çš„è¾“å…¥æ¥æ§åˆ¶çŸ©å½¢å¯¹è±¡çš„ç§»åŠ¨</p>
<pre><code class="py">pressed=pygame.key.get_pressed()
if pressed[K_LEFT]:
    Rect.move_ip(-1,0)
elif pressed[K_RIGHT]:
    Rect.move_ip(1,0)
DISPLAYSURF.fill((0,0,0))
DISPLAYSURF.blit(Image,Rect)
pygame.display.update()
</code></pre>
<h3 id="get-pressed-æ–¹æ³•"><a href="#get-pressed-æ–¹æ³•" class="headerlink" title="get_pressed()æ–¹æ³•"></a>get_pressed()æ–¹æ³•</h3><p>ä½œç”¨ï¼šè·å–å½“å‰é”®ç›˜æŒ‰é”®çŠ¶æ€<br>è¿”å›ï¼šä¸€ä¸ªåŒ…å«æ‰€æœ‰æŒ‰é”®å½“å‰çŠ¶æ€çš„å…ƒç»„ï¼Œå¯¹åº”çš„å…ƒç´ å€¼æ˜¯å¸ƒå°”ç±»å‹ã€‚<br>åŸç†ï¼šå…ƒç»„ä¸­çš„é¡ºåºä¸ pygame ä¸­å®šä¹‰çš„é”®ç›˜æŒ‰é”®å¸¸é‡ä¸€ä¸€å¯¹åº”ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡ press[key]æ¥åˆ¤æ–­</p>
<h3 id="Rect-move-ip-x-y-æ–¹æ³•"><a href="#Rect-move-ip-x-y-æ–¹æ³•" class="headerlink" title="Rect.move_ip(x,y)æ–¹æ³•"></a>Rect.move_ip(x,y)æ–¹æ³•</h3><p>ä½œç”¨ï¼šæ ¹æ®çŸ©å½¢å¯¹è±¡å½“å‰çš„ä½ç½®è¿›è¡Œç›¸å¯¹ç§»åŠ¨<br>ç§»åŠ¨æ–¹å‘ï¼š<br>çŸ©å½¢å¯¹è±¡ rectï¼Œå…¶åˆå§‹ä½ç½®ä¸º (x1, y1)ï¼Œè°ƒç”¨ rect.move_ip(5, 10) ä¹‹åï¼ŒçŸ©å½¢çš„ä½ç½®å°†å˜ä¸º (x1+5, y1+10)ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒçŸ©å½¢ä¼šåœ¨æ°´å¹³æ–¹å‘ä¸Šå‘å³ç§»åŠ¨ 5 ä¸ªå•ä½ï¼Œåœ¨å‚ç›´æ–¹å‘ä¸Šå‘ä¸‹ç§»åŠ¨ 10 ä¸ªå•ä½</p>
<h2 id="å¢åŠ ä¸Šä¸‹æ–¹å‘ç§»åŠ¨"><a href="#å¢åŠ ä¸Šä¸‹æ–¹å‘ç§»åŠ¨" class="headerlink" title="å¢åŠ ä¸Šä¸‹æ–¹å‘ç§»åŠ¨"></a>å¢åŠ ä¸Šä¸‹æ–¹å‘ç§»åŠ¨</h2><p>å…¶å®å°±æ˜¯å¢åŠ <code>K_UP</code>å’Œ<code>K_DOWN</code>çš„åˆ¤æ–­</p>
<pre><code class="py">pressed=pygame.key.get_pressed()
if pressed[K_LEFT]:
    Rect.move_ip(-1,0)
elif pressed[K_RIGHT]:
    Rect.move_ip(1,0)
elif pressed[K_UP]:
    Rect.move_ip(0,-1)
elif pressed[K_DOWN]:
    Rect.move_ip(0,1)
</code></pre>
<h2 id="å®ç°æ–¹å—ç±»"><a href="#å®ç°æ–¹å—ç±»" class="headerlink" title="å®ç°æ–¹å—ç±»"></a>å®ç°æ–¹å—ç±»</h2><p>æˆ‘ä»¬åœ¨ä¸Šä¸€æ­¥ä¸­ç»˜åˆ¶äº†ä¸€ä¸ªæ–¹å—å¹¶ä¸æ–­æ›´æ–°å±å¹•ï¼Œè€Œæ¸¸æˆæ˜¯ç”±å¾ˆå¤šä¸ªè¿™æ ·çš„æ–¹å—ç»„æˆçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥å°†å…¶å°è£…æˆä¸€ä¸ª Classã€‚å®ç°æ–¹å—ç±»ä¸»è¦æœ‰ 2 ä¸ªæ­¥éª¤</p>
<ol>
<li>å®šä¹‰åˆå§‹åŒ–æ–¹æ³•__init__,åœ¨åˆå§‹åŒ–æ–¹æ³•ä¸­å®šä¹‰éœ€è¦çš„å±æ€§</li>
<li>å®šä¹‰æ–¹æ³•</li>
</ol>
<p>é¦–å…ˆï¼Œä¸€ä¸ªæ–¹å—ï¼Œåº”è¯¥æœ‰ä¸€ä¸ªå›¾åƒ image ç”¨äºç»˜åˆ¶ï¼Œç„¶åè¿˜éœ€è¦è®¾ç½®å®ƒçš„ä½ç½®,å³ rectã€‚<br>å…¶æ¬¡ï¼Œä»–éœ€è¦ä¸€ä¸ª update çš„æ›´æ–°æ–¹æ³•ï¼Œç”¨äºè®°å½•æ–¹å—çš„è¿åŠ¨ï¼Œæœ€åéœ€è¦ä¸€ä¸ª draw æ–¹æ³•è¿›è¡Œæ–¹å—çš„ç»˜åˆ¶</p>
<pre><code class="py">class Block(pygame.sprite.Sprite):
    def __init__(self):
        super().__init__()
        self.image=pygame.image.load(&#39;../pic/red.png&#39;)
        self.rect=self.image.get_rect()
        self.rect.center=(400,300)
    def update(self):
        pressed=pygame.key.get_pressed()
        if pressed[K_LEFT]:
            self.rect.move_ip(-1,0)
        elif pressed[K_RIGHT]:
            self.rect.move_ip(1,0)
        elif pressed[K_UP]:
            self.rect.move_ip(0,-1)
        elif pressed[K_DOWN]:
            self.rect.move_ip(0,1)
    def draw(self,surface):
        surface.blit(self.image,self.rect)
</code></pre>
<h3 id="åœ¨ä¸»å‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨"><a href="#åœ¨ä¸»å‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨" class="headerlink" title="åœ¨ä¸»å‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨"></a>åœ¨ä¸»å‡½æ•°ä¸­è¿›è¡Œè°ƒç”¨</h3><ol>
<li>æ–°å»ºä¸€ä¸ª Block å®ä¾‹ b</li>
<li>è°ƒç”¨ udpate æ–¹æ³•è®°å½•è¿åŠ¨</li>
<li>è°ƒç”¨ draw æ–¹æ³•ç»˜åˆ¶é˜²çª¥å•Š</li>
</ol>
<pre><code class="py">b=Block()
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    b.update()
    DISPLAYSURF.fill((0,0,0))
    b.draw(DISPLAYSURF)
    pygame.display.update()
</code></pre>
<h2 id="å¤šå®ä¾‹"><a href="#å¤šå®ä¾‹" class="headerlink" title="å¤šå®ä¾‹"></a>å¤šå®ä¾‹</h2><p>å¤šå®ä¾‹å³éœ€è¦ä½¿ç”¨ä¸ä¸€æ ·çš„å›¾ç‰‡å’Œä½ç½®åˆå§‹åŒ– block å®ä¾‹ã€‚æ‰€ä»¥å¯ä»¥å°†æ–¹å—å›¾ç‰‡å’Œä½ç½®ä½œä¸º init å‡½æ•°çš„å‚æ•°</p>
<pre><code class="py">class BlockType:
    RED=0
    ORANGE=1
    YELLOW=2
    GREEN=3
    CYAN=4
    BLUE=5
    PURPLE=6
    BLOCKMAX=7

BLOCK_RES=&#123;
    BlockType.RED:&#39;../pic/red.png&#39;,
    BlockType.ORANGE:&#39;../pic/orange.png&#39;,
    BlockType.YELLOW:&#39;../pic/yellow.png&#39;,
    BlockType.GREEN:&#39;../pic/green.png&#39;,
    BlockType.CYAN:&#39;../pic/cyan.png&#39;,
    BlockType.BLUE:&#39;../pic/blue.png&#39;,
    BlockType.PURPLE:&#39;../pic/purple.png&#39;,
&#125;
class Block(pygame.sprite.Sprite):
    def __init__(self,blockType,pos):
        super().__init__()
        self.image=pygame.image.load(BLOCK_RES[blockType])
        self.rect=self.image.get_rect()
        self.rect.center=pos
</code></pre>
<h2 id="æ‹†åˆ†æ–‡ä»¶"><a href="#æ‹†åˆ†æ–‡ä»¶" class="headerlink" title="æ‹†åˆ†æ–‡ä»¶"></a>æ‹†åˆ†æ–‡ä»¶</h2><p>åˆ°ä¸Šä¸€æ­¥ä¹‹åï¼Œç›®å‰çš„ main.py ä»£ç è¡Œæ•°å·²ç»è¾ƒå¤šï¼Œä¸” Block ç±»ä½œä¸ºä¸€ä¸ªç‹¬ç«‹çš„ç±»å¯ä»¥æ‹†åˆ†åˆ° block.pyï¼Œé¡¹ç›®ä¸­çš„å¸¸é‡å¯ä»¥æ‹†åˆ†åˆ° const.py</p>
<h2 id="é€»è¾‘å’Œè¡¨ç°åˆ†ç¦»"><a href="#é€»è¾‘å’Œè¡¨ç°åˆ†ç¦»" class="headerlink" title="é€»è¾‘å’Œè¡¨ç°åˆ†ç¦»"></a>é€»è¾‘å’Œè¡¨ç°åˆ†ç¦»</h2><p>å¸Œæœ›å¯ä»¥æ ¹æ®æ–¹å—ç±»ä¸‹ã€è¡Œ&#x2F;åˆ—åæ ‡ã€å®½&#x2F;é«˜ä»¥åŠç›¸å¯¹ä½ç½®æ¥å®ç°å¤šæ€ã€‚æ ¹æ®ä¼ å‚æ¥ç¡®å®šä½¿ç”¨å“ªå¼ å›¾ç‰‡ã€å®é™…å°ºå¯¸ä»¥åŠç¡®å®šä½ç½®</p>
<pre><code class="py"># block.py
def __init__(self,blockType,rowIdx,colIdx,width,height,relPos):
    super().__init__()
    self.blockType=blockType
    self.rowIdx=rowIdx
    self.colIdx=colIdx
    self.width=width
    self.height=height
    self.relPos=relPos
    self.loadImage()
    self.updateImagePos()
def loadImage(self):
    self.image=pygame.image.load(BLOCK_RES[self.blockType])
    self.image=pygame.transform.scale(self.image,(self.width,self.height))
def updateImagePos(self):
    self.rect=self.image.get_rect()
    self.rect.left=self.relPos[0]+self.width*self.colIdx
    self.rect.top=self.relPos[1]+self.height*self.rowIdx
</code></pre>
<h3 id="transform-scale"><a href="#transform-scale" class="headerlink" title="transform.scale()"></a>transform.scale()</h3><p>ä½œç”¨ï¼šç¼©æ”¾å›¾åƒ<br>è¯­æ³•ï¼š<code>pygame.transform.scale(Surface, (width, height))</code></p>
<h3 id="ç”Ÿæˆå¤šä¸ªæ–¹å—"><a href="#ç”Ÿæˆå¤šä¸ªæ–¹å—" class="headerlink" title="ç”Ÿæˆå¤šä¸ªæ–¹å—"></a>ç”Ÿæˆå¤šä¸ªæ–¹å—</h3><pre><code class="py">blcoks=[]
for i in range(GAME_ROW):
    b=[]
    for j in range(GAME_COL):
        currentBlock=Block(random.randint(0,BLEND_MAX),i,j,32,32,(240,50))
        b.append(currentBlock)
    blcoks.append(b)
</code></pre>
<p>æœ€ç»ˆç”Ÿæˆæ˜¯æ•°æ®å¦‚ä¸‹(å‡è®¾ GAME_ROW ä¸º 3ï¼ŒGAME_COL ä¸º 2)ï¼š</p>
<pre><code class="JS">[
    [Block(0, 0), Block(1, 0)],
    [Block(0, 1), Block(1, 1)],
    [Block(0, 2), Block(1, 2)]
]
</code></pre>
<h3 id="ä¸»æµç¨‹æ¸²æŸ“æ–¹å—"><a href="#ä¸»æµç¨‹æ¸²æŸ“æ–¹å—" class="headerlink" title="ä¸»æµç¨‹æ¸²æŸ“æ–¹å—"></a>ä¸»æµç¨‹æ¸²æŸ“æ–¹å—</h3><pre><code class="py">while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    for i in range(GAME_ROW):
        for j in range(GAME_COL):
            blcoks[i][j].update()
    DISPLAYSURF.fill((0,0,0))
    for i in range(GAME_ROW):
        for j in range(GAME_COL):
            blcoks[i][j].draw(DISPLAYSURF)
    pygame.display.update()
</code></pre>
<h3 id="relPos"><a href="#relPos" class="headerlink" title="relPos"></a>relPos</h3><p>relPos æŒ‡çš„æ˜¯å·¦ä¸Šæ–¹æ–¹å—çš„çŸ©å½¢å¯¹è±¡ä½ç½®</p>
<h2 id="ç»„åˆæ–¹å—"><a href="#ç»„åˆæ–¹å—" class="headerlink" title="ç»„åˆæ–¹å—"></a>ç»„åˆæ–¹å—</h2><p>å¸¸è§æ–¹å—å½¢çŠ¶ï¼š</p>
<img src="/2023/11/10/e-luo-si-fang-kuai/block.png" class="">
<p>åæ ‡å«ä¹‰ï¼š<br>æ¯ä¸ªå…ƒç»„ (x, y) è¡¨ç¤ºä¸€ä¸ªæ–¹å—ç›¸å¯¹äºå‚è€ƒç‚¹ï¼ˆé€šå¸¸æ˜¯æ—‹è½¬ä¸­å¿ƒï¼‰çš„åç§»é‡ã€‚ä¾‹å¦‚ï¼Œ(0, 0) è¡¨ç¤ºæ–¹å—å½“å‰ä½ç½®ï¼Œ(0, 1) è¡¨ç¤ºå‘ä¸Šç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œ(1, 0) è¡¨ç¤ºå‘å³ç§»åŠ¨ä¸€ä¸ªå•ä½ï¼Œä»¥æ­¤ç±»æ¨ã€‚</p>
<pre><code class="py">BLOCK_SHAPE=[
    [(0,0),(0,1),(1,0),(1,1)], #æ–¹å½¢
    [(0,0),(0,1),(0,2),(0,3)], #é•¿æ¡
    [(0,0),(0,1),(1,1),(1,2)], #zå­—å½¢
    [(0,1),(1,0),(1,1),(1,2)]  #é£æœºå½¢
]
</code></pre>
<h3 id="BlockGroup-ç±»"><a href="#BlockGroup-ç±»" class="headerlink" title="BlockGroup ç±»"></a>BlockGroup ç±»</h3><p>BlockGroup éœ€è¦ä¸€ä¸ª blockShape å’Œæ–¹å—ç»„åˆçš„é…ç½®</p>
<pre><code class="py">class BlockGroup(object):
    def GenerateBlockConfig(rowIdx,colIdx):
        idx=random.randint(0,len(BLOCK_SHAPE)-1)
        bType=random.randint(0,BlockType.BLOCKMAX-1)
        configList=[]
        for x in range(len(BLOCK_SHAPE[idx])):
            config=&#123;
                &#39;blockType&#39;:bType,
                &#39;rowIdx&#39;:rowIdx+BLOCK_SHAPE[idx][x][0],
                &#39;colIdx&#39;:colIdx+BLOCK_SHAPE[idx][x][1]
            &#125;
            configList.append(config)
        return configList

    def __init__(self,width,height,blockConfigList,relPos):
        super().__init__()
        self.blocks=[]
        for config in blockConfigList:
            blk=Block(config[&#39;blockType&#39;],config[&#39;rowIdx&#39;],config[&#39;colIdx&#39;],width,height,relPos)
            self.blocks.append(blk)

    def draw(self,surface):
        for b in self.blocks:
            b.draw(surface)
</code></pre>
<p>è°ƒç”¨ï¼š</p>
<pre><code class="py">blockGroups=[]
for x in range(5):
    conf=BlockGroup.GenerateBlockConfig(x*4,x)
    blockGroups.append(BlockGroup(32,32,conf,(240,50)))


while True:
    for i in blockGroups:
       i.draw(DISPLAYSURF)
</code></pre>
<h2 id="æ¨¡æ‹Ÿä¸‹è½"><a href="#æ¨¡æ‹Ÿä¸‹è½" class="headerlink" title="æ¨¡æ‹Ÿä¸‹è½"></a>æ¨¡æ‹Ÿä¸‹è½</h2><h3 id="åœ¨-Block-çš„ç±»ä¸­å®ç°å•ä¸ªå—çš„-drop-å‡½æ•°"><a href="#åœ¨-Block-çš„ç±»ä¸­å®ç°å•ä¸ªå—çš„-drop-å‡½æ•°" class="headerlink" title="åœ¨ Block çš„ç±»ä¸­å®ç°å•ä¸ªå—çš„ drop å‡½æ•°"></a>åœ¨ Block çš„ç±»ä¸­å®ç°å•ä¸ªå—çš„ drop å‡½æ•°</h3><pre><code class="py">def drop(self):
    self.rowIdx+=1
    self.updateImagePos()
</code></pre>
<h3 id="åœ¨-BlockGroup-çš„ç±»ä¸­å®ç°å•ä¸ªç»„åˆå—çš„ä¸‹è½"><a href="#åœ¨-BlockGroup-çš„ç±»ä¸­å®ç°å•ä¸ªç»„åˆå—çš„ä¸‹è½" class="headerlink" title="åœ¨ BlockGroup çš„ç±»ä¸­å®ç°å•ä¸ªç»„åˆå—çš„ä¸‹è½"></a>åœ¨ BlockGroup çš„ç±»ä¸­å®ç°å•ä¸ªç»„åˆå—çš„ä¸‹è½</h3><pre><code class="py">def update(self):
    self.time+=1
    if self.time&gt;=1000:
        self.time=0
        for b in self.blocks:
            b.drop()
</code></pre>
<h3 id="åœ¨-main-å‡½æ•°ä¸­è°ƒç”¨"><a href="#åœ¨-main-å‡½æ•°ä¸­è°ƒç”¨" class="headerlink" title="åœ¨ main å‡½æ•°ä¸­è°ƒç”¨"></a>åœ¨ main å‡½æ•°ä¸­è°ƒç”¨</h3><pre><code class="py">blockGroups=[]
for x in range(5):
    conf=BlockGroup.GenerateBlockConfig(x*4,x)
    blockGroups.append(BlockGroup(32,32,conf,(240,50)))

while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    for i in blockGroups:
       i.update()
    DISPLAYSURF.fill((0,0,0))
    for i in blockGroups:
       i.draw(DISPLAYSURF)
    pygame.display.update()
</code></pre>
<h2 id="æ¡†æ¶ä»£ç "><a href="#æ¡†æ¶ä»£ç " class="headerlink" title="æ¡†æ¶ä»£ç "></a>æ¡†æ¶ä»£ç </h2><p>æ­¤æ—¶æˆ‘å¸Œæœ›ä¸»å‡½æ•°æŠ½è±¡æˆä¸€ä¸ªæ¡†æ¶ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå®é™…æ¸¸æˆé€»è¾‘ï¼ŒæœŸæœ›å®ƒå¯ä»¥åœ¨åšå…¶ä»–æ¸¸æˆçš„æ—¶å€™å¯ä»¥æ‹¿è¿‡æ¥å¤ç”¨ã€‚<br>game çš„ update æŒ‡çš„æ˜¯é€»è¾‘å¸§ï¼Œgame.draw æ˜¯æ¸²æŸ“å¸§</p>
<pre><code class="py">import pygame
from pygame.locals import *
import sys
from const import *
from block import *
from blockGroup import *
from game import *

pygame.init()
DISPLAYSURF=pygame.display.set_mode((800,600))
game=Game(DISPLAYSURF)
while True:
    for event in pygame.event.get():
        if event.type == QUIT:
            pygame.quit()
            sys.exit()
    game.update() #é€»è¾‘å¸§
    DISPLAYSURF.fill((0,0,0))
    game.draw() #æ¸²æŸ“å¸§
    pygame.display.update()
</code></pre>
<pre><code class="py">class Game(pygame.sprite.Sprite):
    def __init__(self,surface):
        super().__init__()
        self.surface=surface

    def update(self):
        pass

    def draw(self):
        pass
</code></pre>
<h2 id="ç¡®å®šæ¸¸æˆä¸»é€»è¾‘"><a href="#ç¡®å®šæ¸¸æˆä¸»é€»è¾‘" class="headerlink" title="ç¡®å®šæ¸¸æˆä¸»é€»è¾‘"></a>ç¡®å®šæ¸¸æˆä¸»é€»è¾‘</h2><p>ä¿„ç½—æ–¯æ–¹å—æ¸¸æˆçš„å®è´¨ï¼š</p>
<p>ä¸€ä¸ªé™æ€çš„ BlockGroup å’Œä¸€ä¸ªä¸‹è½çš„ BlockGroup å®Œæˆç¢°æ’çš„è¿‡ç¨‹ã€‚</p>
<ol>
<li>ä¸‹è½çš„ BlockGroup åœ¨å’Œé™æ€çš„ BlockGroup äº§ç”Ÿç¢°æ’ä»¥åï¼Œå°±ä¼šè¢«åˆå¹¶åˆ°é™æ€çš„ BlockGroup</li>
<li>é™æ€çš„ BlockGroup ä»ä¸‹å¾€ä¸Šåˆ¤æ–­ï¼Œæ˜¯å¦æœ‰ä¸€æ•´è¡Œå¡«å……çš„æ–¹å—ï¼Œæœ‰åˆ™æ’­æ”¾ä¸€ä¸ªæ¶ˆå»çš„åŠ¨ç”»ï¼Œç›´åˆ°æ‰¾ä¸åˆ°æ•´è¡Œçš„ä¸ºæ­¢</li>
<li>ç»§ç»­ç”Ÿæˆä¸‹è½çš„æ–¹å—,é‡å¤ä¸Šè¿°æ­¥éª¤</li>
<li>å½“é™æ€ blockGroup è¾¾åˆ°ä¸€å®šé«˜åº¦åˆ™æ¸¸æˆå¤±è´¥ã€‚</li>
</ol>
<h2 id="æ–¹å—ç»„çš„å¤šæ€"><a href="#æ–¹å—ç»„çš„å¤šæ€" class="headerlink" title="æ–¹å—ç»„çš„å¤šæ€"></a>æ–¹å—ç»„çš„å¤šæ€</h2><h3 id="å®šä¹‰æ–¹å—ç»„ç±»å‹å’Œä¸€äº›å…¶ä»–å¸¸é‡"><a href="#å®šä¹‰æ–¹å—ç»„ç±»å‹å’Œä¸€äº›å…¶ä»–å¸¸é‡" class="headerlink" title="å®šä¹‰æ–¹å—ç»„ç±»å‹å’Œä¸€äº›å…¶ä»–å¸¸é‡"></a>å®šä¹‰æ–¹å—ç»„ç±»å‹å’Œä¸€äº›å…¶ä»–å¸¸é‡</h3><pre><code class="py">class BlockGroupType:
    FIXED:0
    DROP:1

BLOCK_SIZE_W=32
BLOCK_SIZE_H=32
</code></pre>
<h3 id="åœ¨-BlockGroup-ç±»ä¸­å¢åŠ è¯¥-blockGroupType-å‚æ•°"><a href="#åœ¨-BlockGroup-ç±»ä¸­å¢åŠ è¯¥-blockGroupType-å‚æ•°" class="headerlink" title="åœ¨ BlockGroup ç±»ä¸­å¢åŠ è¯¥ blockGroupType å‚æ•°"></a>åœ¨ BlockGroup ç±»ä¸­å¢åŠ è¯¥ blockGroupType å‚æ•°</h3><pre><code class="py">
    def __init__(self,blockGroupType,width,height,blockConfigList,relPos):
        super().__init__()
        self.blocks=[]
        self.time=0
        self.blockGroupTyp=blockGroupType
        for config in blockConfigList:
            blk=Block(config[&#39;blockType&#39;],config[&#39;rowIdx&#39;],config[&#39;colIdx&#39;],width,height,relPos)
            self.blocks.append(blk)
</code></pre>
<p>å¹¶ä¸”åªæœ‰ä¸‹è½çš„æ–¹å—ç»„æ‰æ‰§è¡Œæ—¶é—´åˆ¤å®š</p>
<pre><code class="py">def update(self):
    self.time+=1
    if self.blockGroupType==BlockGroupType.DROP:
        if self.time&gt;=1000:
            self.time=0
            for b in self.blocks:
                b.drop()
</code></pre>
<h3 id="æ¸¸æˆé€»è¾‘è°ƒæ•´"><a href="#æ¸¸æˆé€»è¾‘è°ƒæ•´" class="headerlink" title="æ¸¸æˆé€»è¾‘è°ƒæ•´"></a>æ¸¸æˆé€»è¾‘è°ƒæ•´</h3><p>åœ¨ game æ–‡ä»¶ä¸­ï¼Œå°† fixedBlockGroup ä»¥åŠ dropBlockGroup éƒ½å®ä¾‹åŒ–å‡ºæ¥ï¼Œupdate å‡½æ•°å°±æ˜¯æ‰§è¡Œä¸¤è€…çš„ updateï¼Œå¹¶ä¸”å¦‚æœæ²¡æœ‰ä¸‹è½ç±»å‹ï¼Œåˆ™éšæœºç”Ÿæˆä¸€ä¸ª,æ¸²æŸ“å‡½æ•°åŒä¸Š</p>
<pre><code class="py">class Game(pygame.sprite.Sprite):
    def **init**(self,surface):
        super().__init__()
        self.surface=surface
        self.fixedBlockGroup=BlockGroup(BlockGroupType.FIXED,BLOCK_SIZE_W,BLOCK_SIZE_H,[],self.getRelPos())
        self.dropBlockGroup=None

    def generateDropBlockGroup(self):
        conf=BlockGroup.GenerateBlockGroupConfig(0,GAME_COL/2-1)
        self.dropBlockGroup=BlockGroup(BlockGroupType.DROP,BLOCK_SIZE_W,BLOCK_SIZE_H,conf,self.getRelPos())

    def update(self):
        # æ‰§è¡Œä¸¤è€…çš„update
        self.fixedBlockGroup.update()
        if self.dropBlockGroup:
            self.dropBlockGroup.update()
        else :
            self.generateDropBlockGroup()

    def draw(self):
        self.fixedBlockGroup.draw(self.surface)
        if self.dropBlockGroup:
            self.dropBlockGroup.draw(self.surface)

    def getRelPos(self):
        return (240,50)
</code></pre>
<h2 id="æ¨¡æ‹Ÿç¢°æ’"><a href="#æ¨¡æ‹Ÿç¢°æ’" class="headerlink" title="æ¨¡æ‹Ÿç¢°æ’"></a>æ¨¡æ‹Ÿç¢°æ’</h2><p>åŸç†ï¼š<br>è®¡ç®— fixedBlockGroup å’Œ dropBlockGroup çš„äº¤é›†ï¼Œå¦‚æœ 2 ä¸ª BlockGroup é›†åˆäº§ç”Ÿäº¤é›†ï¼Œåˆ™è®¤ä¸ºå‘ç”Ÿäº†ç¢°æ’</p>
<h3 id="å°è£…-blockGroup-ä¸­æ‰€æœ‰-block-çš„åæ ‡"><a href="#å°è£…-blockGroup-ä¸­æ‰€æœ‰-block-çš„åæ ‡" class="headerlink" title="å°è£… blockGroup ä¸­æ‰€æœ‰ block çš„åæ ‡"></a>å°è£… blockGroup ä¸­æ‰€æœ‰ block çš„åæ ‡</h3><pre><code class="py">def getBlockIndexes(self):
    return [block.getIndex() for block in self.blocks]
def getNextBlockIndexes(self):
    return [block.getNextIndex() for block in self.blocks]
</code></pre>
<h3 id="å®šä¹‰-blockGroup-çš„å¢åˆ æ”¹æŸ¥"><a href="#å®šä¹‰-blockGroup-çš„å¢åˆ æ”¹æŸ¥" class="headerlink" title="å®šä¹‰ blockGroup çš„å¢åˆ æ”¹æŸ¥"></a>å®šä¹‰ blockGroup çš„å¢åˆ æ”¹æŸ¥</h3><pre><code class="py">def getBlocks(self):
    return self.blocks
def clearBlocks(self):
    self.blocks=[]
def addBlocks(self,blk):
    self.blocks.append(blk)
</code></pre>
<h3 id="ç¢°æ’æ£€æµ‹"><a href="#ç¢°æ’æ£€æµ‹" class="headerlink" title="ç¢°æ’æ£€æµ‹"></a>ç¢°æ’æ£€æµ‹</h3><ol>
<li>å°†å›ºå®šçš„ blockGroup ä¸­æ‰€æœ‰çš„æ–¹å—æ˜ å°„åˆ° å“ˆå¸Œè¡¨ä¸­</li>
<li>å–ä¸‹è½çš„ blockGroup ä¸­æ‰€æœ‰æ–¹å—ä¸‹è½åçš„ä½ç½®</li>
<li>å»å“ˆå¸Œè¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œä¸€æ—¦æ‰¾åˆ°ï¼Œè¿™ä¸ªå‡½æ•°è¿”å› True</li>
<li>å¦‚æœè¶…è¿‡æ¸¸æˆç»™å®šçš„è¡Œæ•°ï¼Œä¹Ÿè¿”å› Trueï¼Œéƒ½ä»£è¡¨äº§ç”Ÿäº†ç¢°æ’</li>
</ol>
<pre><code class="py">def willCollide(self):
    # ç¢°æ’æ£€æµ‹å‡½æ•°
    hash=&#123;&#125;
    allIndexes=self.fixedBlockGroup.getBlockIndexes()
    for idx in allIndexes:
        hash[idx]=1
    dropIndexes=self.dropBlockGroup.getNextBlockIndexes()
    for dropIdx in dropIndexes:
        if hash.get(dropIdx):
            return True
        if dropIdx[0]&gt;=GAME_ROW:
            return True
    return False
</code></pre>
<h3 id="æ£€æµ‹åˆ°ç¢°æ’ä»¥åçš„å¤„ç†"><a href="#æ£€æµ‹åˆ°ç¢°æ’ä»¥åçš„å¤„ç†" class="headerlink" title="æ£€æµ‹åˆ°ç¢°æ’ä»¥åçš„å¤„ç†"></a>æ£€æµ‹åˆ°ç¢°æ’ä»¥åçš„å¤„ç†</h3><ol>
<li>è·å–åˆ°æ‰€æœ‰çš„ä¸‹è½æ–¹å—</li>
<li>å°†ä»–ä»¬åŠ å…¥åˆ°å›ºå®šæ–¹å—ä¸­</li>
<li>æ¸…é™¤æ‰€æœ‰çš„ä¸‹è½æ–¹å—</li>
<li>å°†ä¸‹è½æ–¹å—ç»„å¯¹è±¡è®¾ç½®ä¸ºç©ºå³ None</li>
</ol>
<pre><code class="py">if self.willCollide():
    blocks=self.dropBlockGroup.getBlocks()
    for blk in blocks:
        self.fixedBlockGroup.addBlocks(blk)
    self.dropBlockGroup.clearBlocks()
    self.dropBlockGroup=None
</code></pre>
<h2 id="æ§åˆ¶å·¦å³ç§»åŠ¨"><a href="#æ§åˆ¶å·¦å³ç§»åŠ¨" class="headerlink" title="æ§åˆ¶å·¦å³ç§»åŠ¨"></a>æ§åˆ¶å·¦å³ç§»åŠ¨</h2><ol>
<li>åˆ é™¤ block ç±»ä¸­ç”¨äºæ§åˆ¶å·¦å³ç§»åŠ¨ä½ç§»çš„ update å‡½æ•°</li>
<li>åœ¨ blockGroup ç±»ä¸­å¢åŠ ä¸€ä¸ªé”®ç›˜äº‹ä»¶å¤„ç†å‡½æ•°</li>
</ol>
<pre><code class="py">def keyDownHandler(self):
    pressed=pygame.key.get_pressed()
    if pressed[K_LEFT]:
        b=True
        for blk in self.blocks:
            if blk.isLeftBound():
                b=False
                break
        if b:
            for blk in self.blocks:
                blk.doLeft()
    elif pressed[K_RIGHT]:
        # é€»è¾‘åŒä¸Š
</code></pre>
<ol start="3">
<li>åœ¨ blockGroup çš„ update å‡½æ•°ä¸­å¢åŠ å¯¹ä¸Šè¿°å‡½æ•°çš„è°ƒç”¨</li>
</ol>
<pre><code class="py">def update(self):
    self.time+=1
    if self.blockGroupType==BlockGroupType.DROP:
        if self.time&gt;=1000:
            self.time=0
            for b in self.blocks:
                b.drop()
        self.keyDownHandler()
</code></pre>
<h2 id="æ§åˆ¶å·¦å³ç§»åŠ¨é€Ÿåº¦"><a href="#æ§åˆ¶å·¦å³ç§»åŠ¨é€Ÿåº¦" class="headerlink" title="æ§åˆ¶å·¦å³ç§»åŠ¨é€Ÿåº¦"></a>æ§åˆ¶å·¦å³ç§»åŠ¨é€Ÿåº¦</h2><h3 id="blockGroup-ç±»æ–°å¢ä¸€ä¸ªæ—¶é—´æ£€æµ‹å‡½æ•°-ä»¥æ¯«ç§’ä¸ºå•ä½"><a href="#blockGroup-ç±»æ–°å¢ä¸€ä¸ªæ—¶é—´æ£€æµ‹å‡½æ•°-ä»¥æ¯«ç§’ä¸ºå•ä½" class="headerlink" title="blockGroup ç±»æ–°å¢ä¸€ä¸ªæ—¶é—´æ£€æµ‹å‡½æ•°(ä»¥æ¯«ç§’ä¸ºå•ä½)"></a>blockGroup ç±»æ–°å¢ä¸€ä¸ªæ—¶é—´æ£€æµ‹å‡½æ•°(ä»¥æ¯«ç§’ä¸ºå•ä½)</h3><p>è¶…è¿‡ 30 æ¯«ç§’åˆ™ä¸º True</p>
<pre><code class="py"># æ£€æµ‹ä¸Šæ¬¡æŒ‰ä¸‹æ—¶é—´
def checkAndSetPressTime(self,key):
    ret=False
    if getCurrentTime()-self.pressTime.get(key,0)&gt;30:
        ret=True
    self.pressTime[key]=getCurrentTime()
    return ret
</code></pre>
<h3 id="è°ƒç”¨"><a href="#è°ƒç”¨" class="headerlink" title="è°ƒç”¨"></a>è°ƒç”¨</h3><pre><code class="py">def keyDownHandler(self):
    pressed=pygame.key.get_pressed()
    if pressed[K_LEFT] and self.checkAndSetPressTime(K_LEFT):
        b=True
        for blk in self.blocks:
            if blk.isLeftBound():
                b=False
                break
        if b:
            for blk in self.blocks:
                blk.doLeft()
</code></pre>
<h2 id="æ§åˆ¶ä¸‹è½é€Ÿåº¦"><a href="#æ§åˆ¶ä¸‹è½é€Ÿåº¦" class="headerlink" title="æ§åˆ¶ä¸‹è½é€Ÿåº¦"></a>æ§åˆ¶ä¸‹è½é€Ÿåº¦</h2><p>ä¹‹å‰çš„ä¸‹è½é€Ÿåº¦æ˜¯ç”¨è‡ªå¢è®¡æ•°å™¨å®ç°çš„</p>
<pre><code class="py">def update(self):
    self.time+=1
    if self.blockGroupType==BlockGroupType.DROP:
        if self.time&gt;=1000:
            self.time=0
            for b in self.blocks:
                b.drop()
</code></pre>
<p>è¿™ç§å®ç°æ–¹å¼å–å†³äºç®—æ³•çš„æ‰§è¡Œæ•ˆç‡ï¼Œä¼šå¯¼è‡´ç»“æœä¸ä¸€æ ·ã€‚æ‰€ä»¥éœ€è¦ç”¨çœŸå®æ—¶é—´æ¥åšåˆ¤å®šã€‚è®°å½•å½“å‰æ—¶é—´å’Œä¸Šä¸€æ¬¡æ‰è½çš„æ—¶é—´å·®ï¼Œå¦‚æœå¤§äºç­‰äºè¿™ä¸ªæ—¶é—´é—´éš”ï¼Œåˆ™æ‰§è¡Œä¸€æ¬¡ drop å¹¶æŠŠæ—¶é—´å½’é›¶</p>
<pre><code class="py">    def update(self):
        oldTime=self.time
        curTime=getCurrentTime()
        diffTime=curTime-oldTime
        if self.blockGroupType==BlockGroupType.DROP:
            if diffTime&gt;=self.dropInterval:
                self.time=getCurrentTime()
                for b in self.blocks:
                    b.drop()
            self.keyDownHandler()
</code></pre>
<p>å½“ç”¨æˆ·ç‚¹å‡»ä¸‹è½è§çš„æ—¶å€™ï¼Œå°±æŠŠè¿™ä¸ªæ—¶é—´é—´éš”è°ƒæ•´ä¸º 100ï¼Œå¦åˆ™è°ƒæ•´ 700</p>
<h2 id="æ–¹å—æ—‹è½¬"><a href="#æ–¹å—æ—‹è½¬" class="headerlink" title="æ–¹å—æ—‹è½¬"></a>æ–¹å—æ—‹è½¬</h2><p>ä¼ ç»™ block çš„æ˜¯å®é™…ä¸‹æ ‡ï¼ˆåœ¨æ¸¸æˆçš„ä¸–ç•Œåæ ‡ç³»åšæ“ä½œï¼‰ï¼Œè€Œ block è‡ªèº«çš„æ—‹è½¬åº”è¯¥ç”¨å±€éƒ¨åæ ‡ç³»ã€‚æ‰€ä»¥éœ€è¦å¯¹ç°æœ‰çš„ Block_SHAPE è¿›è¡Œè°ƒæ•´ï¼š</p>
<ul>
<li>ç¬¬ä¸€ç»´ä»£è¡¨å½¢çŠ¶</li>
<li>ç¬¬äºŒç»´ä»£è¡¨å„ç§æ—‹è½¬çš„æƒ…å†µ</li>
<li>ç¬¬ä¸‰ç»´ä»£è¡¨å±€éƒ¨åæ ‡</li>
</ul>
<pre><code class="py"># æ–¹å—å½¢æ€
BLOCK_SHAPE=[
    [((0,0),(0,1),(1,0),(1,1)),], #æ–¹å½¢
    [((0,0),(0,1),(0,2),(0,3)),((0,0),(1,0),(2,0),(3,0))], #é•¿æ¡
    [((0,0),(0,1),(1,1),(1,2)),((0,1),(1,0),(1,1),(2,0))], #zå­—å½¢
    [((0,1),(1,0),(1,1),(1,2)),((0,1),(1,1),(1,2),(2,1)),((1,0),(1,1),(1,2),(2,1)),((0,1),(1,0),(1,1),(2,1))]  #é£æœºå½¢
]
</code></pre>
<h3 id="ä¿®æ”¹-block-ç±»çš„åˆå§‹åŒ–å‡½æ•°"><a href="#ä¿®æ”¹-block-ç±»çš„åˆå§‹åŒ–å‡½æ•°" class="headerlink" title="ä¿®æ”¹ block ç±»çš„åˆå§‹åŒ–å‡½æ•°"></a>ä¿®æ”¹ block ç±»çš„åˆå§‹åŒ–å‡½æ•°</h3><pre><code class="py">    def __init__(self,blockType,baseRowIdx,baseColIdx,blockShape,blockRot,blockGroupIdx,width,height,relPos):
        super().__init__()
        self.blockType=blockType #é¢œè‰²
        self.blockShape=blockShape #å½¢çŠ¶
        self.blockRot=blockRot # æ—‹è½¬çš„ä¸‹æ ‡
        self.baseRowIdx=baseRowIdx
        self.baseColIdx=baseColIdx
        self.blockGroupIdx=blockGroupIdx
        self.width=width
        self.height=height
        self.relPos=relPos
        self.loadImage()
        self.updateImagePos()
</code></pre>
<p>å°†å‚æ•°ä¸­çš„å…¨å±€åæ ‡ä¿®æ”¹ä¸ºå±€éƒ¨åæ ‡ï¼Œé€šè¿‡ å½¢çŠ¶ã€æ—‹è½¬ ä»¥åŠç›¸å¯¹ä¸‹æ ‡å°±å¯ä»¥ç¡®å®šæ¯ä¸ªæ–¹å—çš„ç»å¯¹ä¸‹æ ‡ï¼Œå·¦å³ç§»åŠ¨ï¼Œä¸‹è½éƒ½åº”è¯¥æ˜¯æ“ä½œ ç›¸å¯¹ä¸‹æ ‡ã€‚</p>
<pre><code class="py">def getBlockConfigIndex(self):
    return BLOCK_SHAPE[self.blockShape][self.blockRot][self.blockGroupIdx]
@property
def rowIdx(self):
    return self.baseRowIdx+self.getBlockConfigIndex()[0]
@property
def colIdx(self):
    return self.baseColIdx+self.getBlockConfigIndex()[1]
</code></pre>
<p>æ¥ä¸‹æ¥è¿˜éœ€è¦ä¿®æ”¹ç”Ÿæˆæ–¹å—ç»„é…ç½®çš„å‡½æ•°</p>
<pre><code class="py">def GenerateBlockGroupConfig(rowIdx,colIdx):
    shapeIdx=random.randint(0,len(BLOCK_SHAPE)-1)
    bType=random.randint(0,BlockType.BLOCKMAX-1)
    configList=[]
    rotIdx=0
    for x in range(len(BLOCK_SHAPE[shapeIdx][rotIdx])):
        config=&#123;
            &#39;blockType&#39;:bType,
            &#39;blockShape&#39;:shapeIdx,
            &#39;blockRot&#39;:rotIdx,
            &#39;blockGroupIdx&#39;:x,
            &#39;rowIdx&#39;:rowIdx,
            &#39;colIdx&#39;:colIdx,
        &#125;
        configList.append(config)
    return configList
</code></pre>
<p>æœ‰äº†è¿™äº›ä¹‹åå†å»ä¿®æ”¹æ–¹å—çš„æ—‹è½¬å‡½æ•°</p>
<pre><code class="py"># è°ƒç”¨
if pressed[K_UP] and self.checkAndSetPressTime(K_UP):
    for blk in self.blocks:
        blk.doRotate()


def doRotate(self):
    self.blockRot+=1
    if self.blockRot&gt;=len(BLOCK_SHAPE[self.blockShape]):
        self.blockRot=0
</code></pre>
<h2 id="æ–¹å—æ¶ˆé™¤"><a href="#æ–¹å—æ¶ˆé™¤" class="headerlink" title="æ–¹å—æ¶ˆé™¤"></a>æ–¹å—æ¶ˆé™¤</h2><ol>
<li>æ¶ˆé™¤çš„æ—¶å€™éœ€è¦ç»™æ–¹å—ä¸€ä¸ªé—ªçƒæ•ˆæœï¼Œæ‰€ä»¥ block åˆå§‹åŒ–å‡½æ•°ä¸­å¢åŠ  2 ä¸ªå±æ€§<code>blink</code>å’Œ&#96;&#96;blinkCount<code>,è®°å½•æ¯ä¸ª block æ˜¯å¦é—ªçƒå’Œé—ªçƒæ¬¡æ•°,ä»¥åŠä¸€ä¸ª</code>blinkTime&#96;è®°å½•é—ªçƒæ—¶é—´ã€‚</li>
<li>å®ç°ä¸€ä¸ª startBlink æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ update çš„æ—¶å€™æ›´æ–°é—ªçƒæ¬¡æ•°</li>
</ol>
<pre><code class="py">def startBlink(self):
    self.blink=True
    self.blinkTime=getCurrentTime()
def update(self):
    # æ›´æ–°é—ªçƒæ¬¡æ•°
    if self.blink:
        diffTime=getCurrentTime()-self.blinkTime
        self.blinkCount=int(diffTime/30)
</code></pre>
<ol start="3">
<li>åœ¨ BlockGroup çš„ update æ–¹æ³•ä¸­è°ƒç”¨</li>
</ol>
<pre><code class="py">def update(self):
    oldTime=self.time
    curTime=getCurrentTime()
    diffTime=curTime-oldTime
    if self.blockGroupType==BlockGroupType.DROP:
        if diffTime&gt;=self.dropInterval:
            self.time=getCurrentTime()
            for b in self.blocks:
                b.drop()
        self.keyDownHandler()
    for blk in self.blocks:
        blk.update()
</code></pre>
<ol start="4">
<li>æ‰§è¡Œæ¸²æŸ“å‡½æ•°</li>
</ol>
<p>åœ¨ block çš„æ¸²æŸ“å‡½æ•°ä¸­ï¼Œå¦‚æœæ˜¯é—ªçƒçŠ¶æ€ä¸”é—ªçƒæ¬¡æ•°ä¸ºå¥‡æ•°ï¼Œåˆ™ä¸è¿›è¡Œç»˜åˆ¶ï¼Œè¿™æ ·å°±å¯ä»¥çœ‹åˆ°é—ªçƒæ•ˆæœ</p>
<pre><code class="py">def draw(self,surface):
    self.updateImagePos()
    if self.blink and self.blinkCount%2==1:
        return
    surface.blit(self.image,self.rect)
</code></pre>
<ol start="5">
<li>å®ç° blockGRoup æ¶ˆé™¤çš„é€»è¾‘</li>
</ol>
<p>å•è¡Œ block çš„æ¶ˆé™¤</p>
<pre><code class="py">def doEliminate(self,row):
    eliminateRow=&#123;&#125;
    for col in range(0,GAME_COL):
        idx=(row,col)
        eliminateRow[idx]=1
    self.setEliminate(True)
    self.eliminateRow=row
    for blk in self.blocks:
        if eliminateRow.get(blk.getIndex()):
            blk.startBlink()
</code></pre>
<p>å¤šè¡Œ block çš„æ¶ˆé™¤ï¼š</p>
<pre><code class="py">def processEliminate(self):
    hash=&#123;&#125;
    allIndexes=self.getBlockIndexes()
    for idx in allIndexes:
        hash[idx]=1
    for row in range(GAME_ROW-1,-1,-1):
        full=True
        for col in range(0,GAME_COL):
            idx=(row,col)
            if not(hash.get(idx)):
                full=False
                break
        if full:
            self.doEliminate(row)
            return
</code></pre>
<p>å®šä¹‰ä¸¤ä¸ªå‡½æ•°ä½œä¸º isEliminating çš„ getter å’Œ setter</p>
<pre><code class="py">def setEliminate(self,el):
    self.isEliminating=el
def IsEliminating(self):
    return self.isEliminating
</code></pre>
<p>åœ¨ game.py ä¸­è°ƒç”¨æ˜¯å¦æ¶ˆé™¤,å¦‚æœæ­£åœ¨æ¶ˆé™¤çŠ¶æ€å°±ä¸æ‰§è¡Œæ¥ä¸‹æ¥çš„é€»è¾‘</p>
<pre><code class="py">def update(self):
    # æ‰§è¡Œä¸¤è€…çš„update
    self.fixedBlockGroup.update()
    if self.fixedBlockGroup.IsEliminating():
        return
    if self.dropBlockGroup:
        self.dropBlockGroup.update()
    else :
        self.generateDropBlockGroup()
    if self.willCollide():
        blocks=self.dropBlockGroup.getBlocks()
        for blk in blocks:
            self.fixedBlockGroup.addBlocks(blk)
        self.dropBlockGroup.clearBlocks()
        self.dropBlockGroup=None
        self.fixedBlockGroup.processEliminate()
</code></pre>
<h2 id="ç»“æŸæ¶ˆé™¤"><a href="#ç»“æŸæ¶ˆé™¤" class="headerlink" title="ç»“æŸæ¶ˆé™¤"></a>ç»“æŸæ¶ˆé™¤</h2><p>ä¸Šä¸€æ­¥éª¤ä¸­å·²ç»å¼€å§‹æ¶ˆé™¤ï¼Œä½†æ˜¯å®é™…ä¸Šæ–¹å—å¹¶æ²¡æœ‰æ¶ˆå¤±ï¼Œéœ€è¦åœ¨ blockGroup çš„ update å‡½æ•°ä¸­æ‰§è¡Œ</p>
<pre><code class="py">if self.IsEliminating():
    if getCurrentTime()-self.eliminateTime&gt;500:
        tmpBlocks=[]
        for blk in self.blocks:
            if blk.getIndex()[0]!=self.eliminateRow:
                if blk.getIndex()[0]&lt;self.eliminateRow:
                    blk.drop()
                tmpBlocks.append(blk)
        self.blocks=tmpBlocks
        self.setEliminate(False)
</code></pre>
<h2 id="å¤±è´¥åˆ¤å®š"><a href="#å¤±è´¥åˆ¤å®š" class="headerlink" title="å¤±è´¥åˆ¤å®š"></a>å¤±è´¥åˆ¤å®š</h2><p>åœ¨ Game ç±»çš„ init å‡½æ•°ä¸­åŠ è½½å¯¹åº”å›¾ç‰‡ï¼Œå®šä¹‰ä¸€ä¸ª isGameOver å±æ€§<br>åœ¨ update å‡½æ•°ä¸­åˆ¤æ–­æ˜¯å¦å¤±è´¥,åœ¨ draw å‡½æ•°ä¸­é€šè¿‡åˆ¤æ–­çŠ¶æ€å±•ç¤ºå¤±è´¥å›¾ç‰‡</p>
<pre><code class="py">def update(self):
    if self.isGameOver:
        return
    self.checkGameOver()
def checkGameOver(self):
    allIndexes=self.fixedBlockGroup.getBlockIndexes()
    for idx in allIndexes:
        if idx[0]&lt;2:
            self.isGameOver=True

def draw():
    if self.isGameOver:
        self.surface.fill((0,0,0))
        rect=self.gameOverImage.get_rect()
        rect.centerx=GAME_WIDTH_SIZE/2
        rect.centery=GAME_HEIGHT_SIZE/2
        self.surface.blit(self.gameOverImage,rect)
</code></pre>
<h2 id="è®¡åˆ†è§„åˆ™"><a href="#è®¡åˆ†è§„åˆ™" class="headerlink" title="è®¡åˆ†è§„åˆ™"></a>è®¡åˆ†è§„åˆ™</h2><p>å¸Œæœ›æ¯æ¬¡åœ¨æ¶ˆé™¤ä¸€è¡Œçš„æ—¶å€™ç§¯åˆ†+1</p>
<pre><code class="py">self.scoreFont=pygame.font.Font(None,60)
self.score=0
# æ›´æ–°
if self.fixedBlockGroup.processEliminate():
    self.score+=1
# ç»˜åˆ¶
scoreTextImage=self.scoreFont.render(&#39;Score:&#39;+str(self.score),True,(255,255,255))
self.surface.blit(scoreTextImage,(10,20))
</code></pre>
<h2 id="ä¸‹ä¸ªæ–¹å—"><a href="#ä¸‹ä¸ªæ–¹å—" class="headerlink" title="ä¸‹ä¸ªæ–¹å—"></a>ä¸‹ä¸ªæ–¹å—</h2><pre><code class="py"> self.nextBlockGroup = None
</code></pre>
<p>å®ç°ä¸€ä¸ªç”Ÿæˆä¸‹ä¸€ä¸ªæ–¹å—ç»„çš„å‡½æ•°</p>
<pre><code class="py">def generateNextDropBlockGroup(self):
    conf=BlockGroup.GenerateBlockGroupConfig(0,GAME_COL+3)
    self.nextBlockGroup=BlockGroup(BlockGroupType.DROP,BLOCK_SIZE_W,BLOCK_SIZE_H,conf,self.getRelPos())
</code></pre>
<p>è°ƒæ•´ä¸‹è½å—å’Œä¸‹ä¸€ä¸ªæ–¹å—ç»„çš„ä½ç½®</p>
<pre><code class="py">def setBaseIndexes(self,baseRow,baseCol):
    for blk in self.blocks:
        blk.setBaseIndex(baseRow,baseCol)
</code></pre>

    </div>

    <div class="post-meta">
        <i>
        
            <span>2023-11-10</span>
            
                <span>è¯¥ç¯‡æ–‡ç« è¢« Moon</span>
            
            
                <span>æ‰“ä¸Šæ ‡ç­¾:
                    
                    
                        <a href='/tags/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/'>
                            æ¸¸æˆå¼€å‘
                        </a>
                    
                        <a href='/tags/python/'>
                            python
                        </a>
                    
                </span>
             
             
                <span>å½’ä¸ºåˆ†ç±»:
                    
                    
                        <a href='/categories/python/'>
                            python
                        </a>
                    
                </span>
            
        
        </i>
    </div>
    
        
    <div class="comments-container">
    <div id="comment-anchor"></div>
    <div class="comment-area-title">
        ä»¥ä¸Šã€‚ 
    </div>
    
        

    <div id="waline"></div>
    <script type="module"  >
        import { init } from 'https://npm.elemecdn.com/hexo-theme-a4@latest/source/js/waline.mjs'; 
        function loadWaline() {
            init({
                el: '#waline',
                serverURL: 'https://comment-hexo-waline.vercel.app/',
                lang: 'zh-CN',
                dark: 'body[class~="dark-mode"]',
                requiredMeta: ['nick','mail'], // cannot customize by theme config, change it yourself
                search: false, // ç¦æ­¢è¡¨æƒ…åŒ…æœç´¢
                reaction: false, // å¯¹æ–‡ç« æ‰“åˆ†
                pageview: false, // æµè§ˆé‡ç»Ÿè®¡
                comment: false, // è¯„è®ºæ•°ç»Ÿè®¡

                locale: {
                    placeholder: 'æ­£ç¡®çš„é‚®ç®±åœ°å€ï¼Œå›å¤å°†èƒ½å¾—åˆ°é‚®ä»¶é€šçŸ¥ã€‚', 
                    sofa: ''
                },
            });
            
        }
        window.addEventListener('DOMContentLoaded', loadWaline);
    </script>



    
    
    
    </div>


     
</div>



                    
                    
                    <div class="footer">
    
        <span> 
            Â©2021-2023 China 

            
                

            
        </span>
    
</div>
<!--è¿™æ˜¯æŒ‡ä¸€æ¡çº¿å¾€ä¸‹çš„å†…å®¹-->
<div class="footer-last">
    
            <span>ğŸŒŠçœ‹è¿‡å¤§æµ·çš„äººä¸ä¼šå¿˜è®°æµ·çš„å¹¿é˜”ğŸŒŠ</span>
            
    
</div>


    
<link rel="stylesheet" href="/css/a11y-dark.min.css">

    
<script src="/js/highlight.min.js"></script>

    
<script src="/js/highlightjs-line-numbers.js"></script>



<script>
    hljs.initHighlightingOnLoad();
    hljs.initLineNumbersOnLoad();
</script>
                </div>
            
    </body>
</html>