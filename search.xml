<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>pythonåŸºç¡€è¯­æ³•</title>
      <link href="/2023/10/16/python-ji-chu-yu-fa/"/>
      <url>/2023/10/16/python-ji-chu-yu-fa/</url>
      
        <content type="html"><![CDATA[<h2 id="c2-è§£é‡Šå™¨"><a href="#c2-è§£é‡Šå™¨" class="headerlink" title="c2. è§£é‡Šå™¨"></a>c2. è§£é‡Šå™¨</h2><p>å‰æï¼šå®‰è£… python å¹¶å°†å®‰è£…è·¯å¾„æ·»åŠ åˆ°ç¯å¢ƒå˜é‡ä¸­</p><h3 id="è°ƒç”¨è§£é‡Šå™¨"><a href="#è°ƒç”¨è§£é‡Šå™¨" class="headerlink" title="è°ƒç”¨è§£é‡Šå™¨"></a>è°ƒç”¨è§£é‡Šå™¨</h3><h4 id="å¯åŠ¨è§£é‡Šå™¨æ–¹å¼ï¼š"><a href="#å¯åŠ¨è§£é‡Šå™¨æ–¹å¼ï¼š" class="headerlink" title="å¯åŠ¨è§£é‡Šå™¨æ–¹å¼ï¼š"></a>å¯åŠ¨è§£é‡Šå™¨æ–¹å¼ï¼š</h4><ol><li><code>py xx.py</code> æˆ–è€… <code>python xx.py</code></li><li><code>python -c command [arg] ...</code>,å‘½ä»¤æœ€å¥½ç”¨å¼•å·åŒ…è£¹</li><li><code>python -m module [arg] ...</code>,åœ¨å‘½ä»¤è¡Œä¸‹ç›´æ¥è¿è¡Œ Python æ¨¡å—</li></ol><blockquote><p>åŒºåˆ«ï¼šæ–¹æ³• 2 æ˜¯æ‰§è¡Œ command ä¸­çš„è¯­å¥,ç±»ä¼¼äº shell -c,æ–¹æ³• 3 ä¼šå°†æ¨¡å—ä½œä¸ºä¸»ç¨‹åºè¿è¡Œï¼Œæ¨¡å—é€šè¿‡åç§°åŒºåˆ†</p></blockquote><pre><code class="py"># my_module.pydef greet(name):    print(f&quot;Hello, &#123;name&#125;!&quot;)# å¤–éƒ¨è°ƒç”¨python -m my_module</code></pre><h4 id="é€€å‡ºè§£é‡Šå™¨æ–¹æ³•ï¼š"><a href="#é€€å‡ºè§£é‡Šå™¨æ–¹æ³•ï¼š" class="headerlink" title="é€€å‡ºè§£é‡Šå™¨æ–¹æ³•ï¼š"></a>é€€å‡ºè§£é‡Šå™¨æ–¹æ³•ï¼š</h4><ol><li><code>CTRL+Z</code>+<code>Enter</code></li><li><code>exit()</code></li></ol><h4 id="äº¤äº’æ¨¡å¼"><a href="#äº¤äº’æ¨¡å¼" class="headerlink" title="äº¤äº’æ¨¡å¼"></a>äº¤äº’æ¨¡å¼</h4><ol><li>ä¸»æç¤ºç¬¦<code>&gt;&gt;&gt;</code>:æç¤ºè¾“å…¥ä¸‹ä¸€æ¡æŒ‡ä»¤</li><li>æ¬¡è¦æç¤ºç¬¦<code>...</code>:æç¤ºè¾“å…¥è¿ç»­è¡Œ</li></ol><blockquote><p>è¾“å…¥å¤šè¡Œæ¶æ„çš„è¯­å¥æ—¶ï¼Œè¦ç”¨è¿ç»­è¡Œ</p></blockquote><h3 id="è§£é‡Šå™¨å’Œç¯å¢ƒ"><a href="#è§£é‡Šå™¨å’Œç¯å¢ƒ" class="headerlink" title="è§£é‡Šå™¨å’Œç¯å¢ƒ"></a>è§£é‡Šå™¨å’Œç¯å¢ƒ</h3><p>é»˜è®¤ç¼–ç ï¼šUTF-8<br>æŒ‡å®šç¼–ç æ–¹å¼ï¼šé€šè¿‡æ³¨é‡Šå®ç°ï¼š<code># -*- coding: encoding -*-</code></p><blockquote><p>æŒ‡å®šç¼–ç éœ€è¦å’Œ vscode åº•éƒ¨çš„ç¼–ç æ–¹å¼ä¿æŒä¸€è‡´ï¼Œå¦åˆ™ä¼šæŠ¥é”™ SyntaxError: encoding problem: GB2312 æˆ–è€…ä¹±ç </p></blockquote><pre><code class="py">#!/usr/bin/env python3# -*- coding: gb2312 -*-</code></pre><h2 id="c3-Python-éæ­£å¼ä»‹ç»"><a href="#c3-Python-éæ­£å¼ä»‹ç»" class="headerlink" title="c3. Python éæ­£å¼ä»‹ç»"></a>c3. Python éæ­£å¼ä»‹ç»</h2><h3 id="è®¡ç®—å™¨"><a href="#è®¡ç®—å™¨" class="headerlink" title="è®¡ç®—å™¨"></a>è®¡ç®—å™¨</h3><p>æ³¨é‡Šï¼špython æ³¨é‡Šä»¥<code>#</code>å¼€å¤´ï¼Œç›´åˆ°è¯¥è¡Œç»“æŸ</p><h4 id="ç®—æœ¯è¿ç®—ç¬¦ï¼š"><a href="#ç®—æœ¯è¿ç®—ç¬¦ï¼š" class="headerlink" title="ç®—æœ¯è¿ç®—ç¬¦ï¼š+,-,*,/"></a>ç®—æœ¯è¿ç®—ç¬¦ï¼š<code>+</code>,<code>-</code>,<code>*</code>,<code>/</code></h4><p>ç‰¹æ®Šç®—æœ¯è¿ç®—ç¬¦ï¼š</p><ul><li><code>//</code>ï¼šå–æ•´ 5&#x2F;&#x2F;2&#x3D;2</li><li><code>%</code>ï¼šå–ä½™ 5%2&#x3D;1</li><li><code>**</code>ï¼šä¹˜æ–¹ 5**2&#x3D;25</li><li><code>=</code>ï¼šèµ‹å€¼ a&#x3D;3</li></ul><blockquote><ol><li>æ™®é€šé™¤æ³•çš„è¿”å›å€¼ä¸€ç›´æ˜¯æµ®ç‚¹æ•°ã€‚</li><li>äº¤äº’æ¨¡å¼ä¸‹ï¼Œå‰ä¸€æ¬¡è¾“å‡ºçš„è¡¨è¾¾å¼ä¼šèµ‹å€¼ç»™å˜é‡<code>_</code>,å¹¶ä¸”é¿å…ç»™è¿™ä¸ªå˜é‡æ˜¾å¼èµ‹å€¼</li></ol></blockquote><h4 id="æ–‡æœ¬ç±»å‹-str"><a href="#æ–‡æœ¬ç±»å‹-str" class="headerlink" title="æ–‡æœ¬ç±»å‹ str"></a>æ–‡æœ¬ç±»å‹ str</h4><p>å•è¡Œå­—ç¬¦ä¸²ï¼šä½¿ç”¨å•å¼•å·æˆ–è€…åŒå¼•å·åŒ…è£¹<br>å¤šè¡Œå­—ç¬¦ä¸²ï¼šä½¿ç”¨ä¸‰é‡å¼•å·åŒ…è£¹<code>&quot;&quot;&quot;...&quot;&quot;&quot;</code>æˆ–è€…<code>&#39;&#39;&#39;...&#39;&#39;&#39;</code><br>è½¬ä¹‰ï¼š<code>\</code>+å­—ç¬¦<br>ä¸è½¬ä¹‰ï¼š<code>print(r&#39;a\b&#39;)</code><br>åˆå¹¶é‡å¤: +å’Œ*<br>å­—ç¬¦ä¸²é•¿åº¦ï¼š<code>len(str1)</code></p><blockquote><p>è‡ªåŠ¨åˆå¹¶ï¼šç›¸é‚»çš„ä¸¤ä¸ªæˆ–å¤šä¸ª å­—ç¬¦ä¸²<strong>å­—é¢å€¼</strong> ï¼ˆå¼•å·æ ‡æ³¨çš„å­—ç¬¦ï¼‰ä¼šè‡ªåŠ¨åˆå¹¶ã€‚</p></blockquote><blockquote><p>æ”¯æŒä¸‹æ ‡(æ­£è´Ÿæ•°)è®¿é—®å’Œåˆ‡ç‰‡<code>word[0:3]</code>:åŒ…å« 0-2 çš„å­—ç¬¦çš„å­ä¸²<br>word[0:],word[-2:]åŒ…å«äº†<code>stop</code>ä¸‹æ ‡,å­—ç¬¦ä¸²ä¸­å•ä¸ªå­—ç¬¦ä¸å¯ä¿®æ”¹</p></blockquote><pre><code class="py"># 3 times &#39;un&#39;, followed by &#39;ium&#39;3 * &#39;un&#39; + &#39;ium&#39;# è¾“å‡ºç»“æœï¼š&#39;unununium&#39;s=&#39;Py&#39; &#39;thon&#39;# è¾“å‡ºç»“æœï¼šPython</code></pre><h4 id="åˆ—è¡¨ç±»å‹-list"><a href="#åˆ—è¡¨ç±»å‹-list" class="headerlink" title="åˆ—è¡¨ç±»å‹ list"></a>åˆ—è¡¨ç±»å‹ list</h4><p>ä½¿ç”¨<code>[]</code>è¿›è¡ŒåŒ…è£¹ï¼Œæ”¯æŒä¸åŒç±»å‹æ•°æ®ç»„åˆ,å¯ä»¥åµŒå¥—<br>å•ä¸ªå…ƒç´ å¯ä»¥é€šè¿‡ä¸‹æ ‡æˆ–è€…åˆ‡ç‰‡ä¿®æ”¹<br>è·å–åˆ—è¡¨é•¿åº¦ï¼š<code>len(list1)</code><br>åˆ—è¡¨æœ«å°¾æ·»åŠ æ–°å…ƒç´ ï¼š<code>cubes.append(216) </code><br>åˆå¹¶åˆ—è¡¨:<code>squares + [36, 49, 64, 81, 100]</code></p><h3 id="python-ç¼–ç¨‹ç¬¬ä¸€æ­¥"><a href="#python-ç¼–ç¨‹ç¬¬ä¸€æ­¥" class="headerlink" title="python ç¼–ç¨‹ç¬¬ä¸€æ­¥"></a>python ç¼–ç¨‹ç¬¬ä¸€æ­¥</h3><p>ç¼©è¿›æ˜¯ python ç»„ç»‡è¯­å¥ç»“æ„çš„æ–¹å¼<br>print()å¯ä»¥ä¼ å¤šä¸ªå‚æ•°ï¼Œé€šè¿‡<code>,</code>åˆ†éš”ï¼Œæ¯”å¦‚ <code>print(&#39;a&#39;,&#39;b&#39;)</code>æ‰“å°å‡ºæ¥çš„ç»“æœæ˜¯ï¼š<code>a b</code></p><h2 id="c4-æ§åˆ¶æµ"><a href="#c4-æ§åˆ¶æµ" class="headerlink" title="c4. æ§åˆ¶æµ"></a>c4. æ§åˆ¶æµ</h2><h3 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h3><pre><code class="py">x=input(&#39;è¯·è¾“å…¥ï¼š&#39;)x=int(x)if x &lt; 0:    x = 0    print(&#39;Negative changed to zero&#39;)elif x == 0:    print(&#39;Zero&#39;)else:    print(&#39;More&#39;)</code></pre><h3 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h3><p>å½¢å¼ï¼š<code>for item in åˆ—è¡¨/å­—ç¬¦ä¸²</code><br>æ³¨æ„ç‚¹ï¼š</p><ul><li>python æœ¬èº«ä¸æ”¯æŒé€šè¿‡ä¸‹æ ‡è¿›è¡Œè¿­ä»£ï¼Œå³<code>for (int i = 0; i &lt; 10; i++)</code>è¿™æ ·çš„å½¢å¼ï¼Œè€Œæ˜¯æŒ‰é¡ºåºéå†å¯è¿­ä»£å¯¹è±¡ï¼ˆå¦‚åˆ—è¡¨ã€å­—ç¬¦ä¸²ç­‰ï¼‰ä¸­çš„å…ƒç´ ã€‚</li></ul><pre><code class="py">words = [&#39;cat&#39;, &#39;window&#39;, &#39;defenestrate&#39;]for w in words:    print(w, len(w))</code></pre><ul><li>å¦‚æœéœ€è¦ä¸‹æ ‡è¿›è¡Œè¿­ä»£çš„è¯ï¼Œå¯ä½¿ç”¨<code>enumerate</code>å°†åˆ—è¡¨æˆ–å­—ç¬¦ä¸²ä½œä¸ºå‚æ•°</li></ul><pre><code class="py">words = [&#39;cat&#39;, &#39;window&#39;, &#39;defenestrate&#39;]for index,value in enumerate(words):    print(&#39;index&#39;,index,&#39;value&#39;,value)</code></pre><h4 id="ä¿®æ”¹è¿­ä»£å¯¹è±¡ä¸­çš„å†…å®¹"><a href="#ä¿®æ”¹è¿­ä»£å¯¹è±¡ä¸­çš„å†…å®¹" class="headerlink" title="ä¿®æ”¹è¿­ä»£å¯¹è±¡ä¸­çš„å†…å®¹"></a>ä¿®æ”¹è¿­ä»£å¯¹è±¡ä¸­çš„å†…å®¹</h4><p>æ¨èæ–¹æ³•ï¼šè¿­ä»£å¤šé¡¹é›†çš„å‰¯æœ¬æˆ–è€…åˆ›å»ºæ–°çš„å¤šé¡¹é›†<br>ä¸æ¨èï¼šé€šè¿‡ä¸‹æ ‡ä¿®æ”¹<br>åŸå› ï¼šå¦‚æœåœ¨å¾ªç¯ä½“ä¸­ä¿®æ”¹äº†è¯¥é›†åˆçš„å†…å®¹ï¼ˆå¢åˆ æ”¹ï¼‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´è¿­ä»£è¿‡ç¨‹å‡ºç°æ„å¤–çš„è¡Œä¸ºã€‚å› ä¸ºä¿®æ”¹é›†åˆåï¼ŒåŸå§‹é›†åˆçš„é•¿åº¦å’Œç»“æ„å‘ç”Ÿäº†å˜åŒ–ï¼Œè€Œè¿­ä»£å™¨æ— æ³•æ­£ç¡®åœ°å¤„ç†è¿™ç§å˜åŒ–ã€‚</p><pre><code class="py"># æ­£ç¡®åšæ³•users = &#123;&#39;Hans&#39;: &#39;active&#39;, &#39;Ã‰lÃ©onore&#39;: &#39;inactive&#39;, &#39;æ™¯å¤ªéƒ&#39;: &#39;active&#39;&#125;# Strategy:  è¿­ä»£å‰¯æœ¬for user, status in users.copy().items():    if status == &#39;inactive&#39;:        del users[user]# Strategy:  åˆ›å»ºä¸€ä¸ªæ–°çš„é›†åˆactive_users = &#123;&#125;for user, status in users.items():    if status == &#39;active&#39;:        active_users[user] = statusprint(users,active_users)</code></pre><h3 id="range-å‡½æ•°"><a href="#range-å‡½æ•°" class="headerlink" title="range()å‡½æ•°"></a>range()å‡½æ•°</h3><h3 id="break-x2F-continue-è¯­å¥å’Œå¾ªç¯ä¸Šçš„-else-å­å¥"><a href="#break-x2F-continue-è¯­å¥å’Œå¾ªç¯ä¸Šçš„-else-å­å¥" class="headerlink" title="break&#x2F;continue è¯­å¥å’Œå¾ªç¯ä¸Šçš„ else å­å¥"></a>break&#x2F;continue è¯­å¥å’Œå¾ªç¯ä¸Šçš„ else å­å¥</h3><h3 id="pass-è¯­å¥"><a href="#pass-è¯­å¥" class="headerlink" title="pass è¯­å¥"></a>pass è¯­å¥</h3><h3 id="match-è¯­å¥"><a href="#match-è¯­å¥" class="headerlink" title="match è¯­å¥"></a>match è¯­å¥</h3><h3 id="å®šä¹‰å‡½æ•°"><a href="#å®šä¹‰å‡½æ•°" class="headerlink" title="å®šä¹‰å‡½æ•°"></a>å®šä¹‰å‡½æ•°</h3><h3 id="å®šä¹‰å‡½æ•°-2"><a href="#å®šä¹‰å‡½æ•°-2" class="headerlink" title="å®šä¹‰å‡½æ•° 2"></a>å®šä¹‰å‡½æ•° 2</h3><h4 id="é»˜è®¤å‚æ•°å€¼"><a href="#é»˜è®¤å‚æ•°å€¼" class="headerlink" title="é»˜è®¤å‚æ•°å€¼"></a>é»˜è®¤å‚æ•°å€¼</h4><h4 id="å…³é”®å­—å‚æ•°"><a href="#å…³é”®å­—å‚æ•°" class="headerlink" title="å…³é”®å­—å‚æ•°"></a>å…³é”®å­—å‚æ•°</h4><h4 id="ç‰¹æ®Šå‚æ•°"><a href="#ç‰¹æ®Šå‚æ•°" class="headerlink" title="ç‰¹æ®Šå‚æ•°"></a>ç‰¹æ®Šå‚æ•°</h4><h4 id="ä»»æ„å®å‚åˆ—è¡¨"><a href="#ä»»æ„å®å‚åˆ—è¡¨" class="headerlink" title="ä»»æ„å®å‚åˆ—è¡¨"></a>ä»»æ„å®å‚åˆ—è¡¨</h4><h4 id="è§£åŒ…å®å‚åˆ—è¡¨"><a href="#è§£åŒ…å®å‚åˆ—è¡¨" class="headerlink" title="è§£åŒ…å®å‚åˆ—è¡¨"></a>è§£åŒ…å®å‚åˆ—è¡¨</h4><h4 id="lambda-è¡¨è¾¾å¼"><a href="#lambda-è¡¨è¾¾å¼" class="headerlink" title="lambda è¡¨è¾¾å¼"></a>lambda è¡¨è¾¾å¼</h4><h4 id="æ–‡æ¡£å­—ç¬¦ä¸²"><a href="#æ–‡æ¡£å­—ç¬¦ä¸²" class="headerlink" title="æ–‡æ¡£å­—ç¬¦ä¸²"></a>æ–‡æ¡£å­—ç¬¦ä¸²</h4><h4 id="å‡½æ•°æ³¨è§£"><a href="#å‡½æ•°æ³¨è§£" class="headerlink" title="å‡½æ•°æ³¨è§£"></a>å‡½æ•°æ³¨è§£</h4><h3 id="ä»£ç é£æ ¼"><a href="#ä»£ç é£æ ¼" class="headerlink" title="ä»£ç é£æ ¼"></a>ä»£ç é£æ ¼</h3><h2 id="c5-æ•°æ®ç»“æ„"><a href="#c5-æ•°æ®ç»“æ„" class="headerlink" title="c5. æ•°æ®ç»“æ„"></a>c5. æ•°æ®ç»“æ„</h2><h2 id="c6-æ¨¡å—"><a href="#c6-æ¨¡å—" class="headerlink" title="c6. æ¨¡å—"></a>c6. æ¨¡å—</h2><h2 id="c7-è¾“å…¥å’Œè¾“å‡º"><a href="#c7-è¾“å…¥å’Œè¾“å‡º" class="headerlink" title="c7. è¾“å…¥å’Œè¾“å‡º"></a>c7. è¾“å…¥å’Œè¾“å‡º</h2><h2 id="c8-é”™è¯¯å’Œå¼‚å¸¸"><a href="#c8-é”™è¯¯å’Œå¼‚å¸¸" class="headerlink" title="c8. é”™è¯¯å’Œå¼‚å¸¸"></a>c8. é”™è¯¯å’Œå¼‚å¸¸</h2><h2 id="c9-ç±»"><a href="#c9-ç±»" class="headerlink" title="c9. ç±»"></a>c9. ç±»</h2><h2 id="c10-æ ‡å‡†åº“-part1"><a href="#c10-æ ‡å‡†åº“-part1" class="headerlink" title="c10. æ ‡å‡†åº“-part1"></a>c10. æ ‡å‡†åº“-part1</h2><h2 id="c11-æ ‡å‡†åº“-part2"><a href="#c11-æ ‡å‡†åº“-part2" class="headerlink" title="c11. æ ‡å‡†åº“-part2"></a>c11. æ ‡å‡†åº“-part2</h2><h2 id="c12-è™šæ‹Ÿç¯å¢ƒå’ŒåŒ…"><a href="#c12-è™šæ‹Ÿç¯å¢ƒå’ŒåŒ…" class="headerlink" title="c12. è™šæ‹Ÿç¯å¢ƒå’ŒåŒ…"></a>c12. è™šæ‹Ÿç¯å¢ƒå’ŒåŒ…</h2>]]></content>
      
      
      <categories>
          
          <category> Python </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åº”ç”¨ç¨‹åºè‡ªåŠ¨åŒ–éƒ¨ç½²</title>
      <link href="/2023/09/18/ying-yong-cheng-xu-zi-dong-hua-bu-shu/"/>
      <url>/2023/09/18/ying-yong-cheng-xu-zi-dong-hua-bu-shu/</url>
      
        <content type="html"><![CDATA[<p>åœ¨ç°ä»£è½¯ä»¶å¼€å‘ä¸­ä½¿ç”¨ Dokcer è¿›è¡Œå‰åç«¯ç¨‹åºçš„éƒ¨ç½²å·²ç»æˆä¸ºä¸€ç§å¸¸è§çš„åšæ³•ã€‚ä½†æ˜¯æ¯æ¬¡ push ä»£ç åéƒ½éœ€è¦æ‰‹åŠ¨æ›´æ–°é•œåƒå¹¶é‡æ–°åˆ›å»ºå®¹å™¨ï¼Œè¿™ä¸ä»…éº»çƒ¦ä¸”æµªè´¹æ—¶é—´ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨ github actions å®ç°è‡ªåŠ¨åŒ–éƒ¨ç½²æµç¨‹ã€‚</p><h1 id="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶"><a href="#ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶" class="headerlink" title="ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶"></a>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå·¥ä½œæµç›¸å…³æ–‡ä»¶</h1><p>åœ¨é¡¹ç›®çš„æ ¹ç›®å½•ä¸‹æ–°å»º <code>.github/workflows/xxx.yaml</code>æ–‡ä»¶<br>æˆ‘ä»¬çš„é¢„æœŸæœ‰ä¸¤ä¸ªï¼š</p><ol><li>æ ¹æ®æœ€æ–°çš„ä»£ç æ„å»ºæœ€æ–°çš„å‰åç«¯é•œåƒ</li><li>å°†å®¹å™¨éƒ¨ç½²åˆ°è™šæ‹Ÿæœºä¸Š<br>æ‰€ä»¥æ–°å»ºä¸¤ä¸ªæ–‡ä»¶<code>build-image.yaml</code>å’Œ<code>deploy.yml</code></li></ol><h3 id="è¸©å‘ï¼š"><a href="#è¸©å‘ï¼š" class="headerlink" title="è¸©å‘ï¼š"></a>è¸©å‘ï¼š</h3><p>æ–‡ä»¶å¤¹åç§°å¿…é¡»æ˜¯<code>.github/workflows</code>ï¼Œä¸”å¿…é¡»æ”¾åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹,å¦åˆ™ github ä¸ä¼šå°†å…¶è¯†åˆ«ä¸º github actions çš„é…ç½®æ–‡ä»¶ã€‚</p><h2 id="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶-build-image-yml"><a href="#ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶-build-image-yml" class="headerlink" title="ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶ build-image.yml"></a>ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé•œåƒæ„å»ºé…ç½®æ–‡ä»¶ build-image.yml</h2><h3 id="ä¸€äº›é…ç½®é¡¹"><a href="#ä¸€äº›é…ç½®é¡¹" class="headerlink" title="ä¸€äº›é…ç½®é¡¹"></a>ä¸€äº›é…ç½®é¡¹</h3><ul><li>on:æŒ‡å®šè§¦å‘å·¥ä½œæµç¨‹çš„äº‹ä»¶,å¤§éƒ¨åˆ†æƒ…å†µä¸‹è®¾ç½®ä¸º pushï¼Œå½“ç„¶è¿˜æœ‰å…¶ä»–å¯é€‰å€¼ï¼špull_request,issue_comment ç­‰</li><li>jobs:å®šä¹‰ä¸€ä¸ªæˆ–å¤šä¸ª job</li><li>runs-on:æŒ‡å®š job è¿è¡Œçš„æ“ä½œç³»ç»Ÿç¯å¢ƒ</li><li>steps:å®šä¹‰å®Œæˆå½“å‰ job æ‰€éœ€è¦çš„æ­¥éª¤<ul><li>name: æ­¥éª¤åç§°</li><li>usesï¼šæŒ‡å®šé¢„å®šä¹‰çš„åŠ¨ä½œæˆ–è‡ªå®šä¹‰çš„æ“ä½œæ‰€åœ¨çš„ä»“åº“å’Œç‰ˆæœ¬ï¼Œä¸€èˆ¬å½¢å¼ä¸º<code>ä»“åº“æ‰€æœ‰è€…/ä»“åº“åœ°å€@ç‰ˆæœ¬</code></li><li>run:æŒ‡å®šå…·ä½“çš„å‘½ä»¤æˆ–è„šæœ¬æ¥æ‰§è¡Œ</li><li>envï¼šå®šä¹‰ç¯å¢ƒå˜é‡</li></ul></li></ul><h3 id="build-vue-app-image-æ€»å…±æœ‰-3-ä¸ªæ­¥éª¤ï¼š"><a href="#build-vue-app-image-æ€»å…±æœ‰-3-ä¸ªæ­¥éª¤ï¼š" class="headerlink" title="build_vue_app_image,æ€»å…±æœ‰ 3 ä¸ªæ­¥éª¤ï¼š"></a>build_vue_app_image,æ€»å…±æœ‰ 3 ä¸ªæ­¥éª¤ï¼š</h3><ol><li>é€šè¿‡<code>actions/checkout@v3</code>æ‹‰å–ä»£ç ä»“åº“</li><li>æ„å»ºå‰ç«¯é•œåƒ</li><li>æ„å»ºåç«¯é•œåƒ</li></ol><p>æ­¤å¤„æœ‰ä¸¤ä¸ªç¯å¢ƒå˜é‡<code>DOCKER_USERNAME</code>,<code>DOCKER_PASSWORD</code>,è¿™ä¸¤ä¸ªå˜é‡éƒ½æ˜¯é€šè¿‡é…ç½® github è¯¥é¡¹ç›®ä»“åº“çš„<code>secrets</code>è·å–åˆ°çš„ï¼Œè®¾ç½®è·¯å¾„ä¸ºï¼š<a href="https://github.com/earthaYan/resume_generator_front/settings/secrets/actions">é¡¹ç›®-settings-Security-Actions secrets and variables-Repository secrets</a></p><h3 id="æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š"><a href="#æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š" class="headerlink" title="æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š"></a>æ­¤å¤„æœ‰ä¸¤ä¸ªåœ°æ–¹éœ€è¦æ³¨æ„ã€å®¹æ˜“è¸©å‘ã€‘ï¼š</h3><ol><li>è¿™é‡Œä¸¤ä¸ªç¯å¢ƒå˜é‡åº”è¯¥è®¾ç½®çš„æ˜¯ä¸¤ä¸ª<code>secret</code>ï¼Œè€Œä¸æ˜¯Name ä¸ºä½ çš„ Docker Hub è´¦å·ï¼ŒValue ä¸º Docker Hub çš„ access token<table><thead><tr><th>Name</th><th>Value</th></tr></thead><tbody><tr><td>DOCKER_USERNAME</td><td>Docker Hub è´¦å·å</td></tr><tr><td>DOCKER_PASSWORD</td><td>Docker Hub Access Token</td></tr></tbody></table></li><li>ç¬¬ä¸€æ¬¡æ‰§è¡Œçš„æ—¶å€™æŠ¥é”™ï¼š<code>invalid workflow file,you have error in your yaml syntax on line11</code>ï¼ŒæŠ¥é”™éƒ¨åˆ†ä»£ç å¦‚ä¸‹ï¼š</li></ol><pre><code class="yaml">env:  DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;      DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;</code></pre><p>é”™è¯¯çš„åŸå› æ˜¯ yaml æ–‡ä»¶ä¸­ä½¿ç”¨ç¼©è¿›è¡¨ç¤ºå±‚çº§å…³ç³»ï¼Œç›¸åŒå±‚çº§çš„å…ƒç´ å¿…é¡»å·¦å¯¹é½ï¼Œè€Œè¿™é‡Œ envä¸‹é¢çš„ç¯å¢ƒå˜é‡æ˜¯ env çš„ä¸‹ä¸€çº§ï¼Œä½†æ˜¯å´å’Œå®ƒæ”¾åœ¨äº†åŒä¸€è¡Œï¼Œæ‰€ä»¥æŠ¥é”™äº†ï¼Œä¿®æ”¹ä¸ºï¼š</p><pre><code class="yml">name: Build vue_app imageenv:    DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;    DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;</code></pre><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="yml">name: build-imagerun-name: $&#123;&#123; github.actor &#125;&#125; is building latest imageon: [push]jobs:  build_vue_app_image:    runs-on: ubuntu-latest    steps:      - name: Checkout repository        uses: actions/checkout@v3      - name: Build vue_app image        env:          DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;          DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;        run: |          docker build -t yanyue1215/vue_app .          docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD          docker push yanyue1215/vue_app      - name: build_resume_service        env:          DOCKER_USERNAME: $&#123;&#123; secrets.DOCKER_USERNAME &#125;&#125;          DOCKER_PASSWORD: $&#123;&#123; secrets.DOCKER_PASSWORD &#125;&#125;        run: |          cd Backend/    # åç«¯ä»£ç æ‰€åœ¨ç›®å½•          docker build -t yanyue1215/resume_service .          docker login -u $DOCKER_USERNAME -p $DOCKER_PASSWORD          docker push yanyue1215/resume_service</code></pre><h2 id="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º-deploy-é…ç½®æ–‡ä»¶-deploy-yml"><a href="#ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º-deploy-é…ç½®æ–‡ä»¶-deploy-yml" class="headerlink" title="ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º deploy é…ç½®æ–‡ä»¶ deploy.yml"></a>ç¬¬ä¸‰æ­¥ï¼šåˆ›å»º deploy é…ç½®æ–‡ä»¶ deploy.yml</h2><p>å¦‚æ­¤ä¹‹åï¼Œæ¯å½“ push ä»£ç åˆ°å¯¹åº”åˆ†æ”¯åï¼Œgithub å°±ä¼šè‡ªåŠ¨æ„å»ºæœ€æ–°é•œåƒå¹¶æ¨é€åˆ° Docker Hubã€‚ä½†æ˜¯è¿™ä¸ªæ—¶å€™ä½ è¿˜æ˜¯éœ€è¦è‡ªå·±å»è™šæ‹Ÿæœºä¸Šæ‹‰å–æœ€æ–°é•œåƒå¹¶é‡å»ºå®¹å™¨ï¼Œä¾æ—§å¾ˆéº»çƒ¦ï¼Œå¦‚æœè¿™ä¸ªè¿‡ç¨‹ä¹Ÿèƒ½èƒ½è‡ªåŠ¨åŒ–å°±æœ€å¥½äº†ã€‚<br>ä¸€å¼€å§‹è€ƒè™‘æ˜¯å¦å’Œ umc-ui é¡¹ç›®ä¸€æ ·ä½¿ç”¨MakeFile,ä½†æ˜¯æœ€åè¿˜æ˜¯å¸Œæœ›èƒ½æŠŠæ›´æ–°å’Œéƒ¨ç½²éƒ½é›†æˆåˆ° github çš„å·¥ä½œæµç¨‹ä¸­ã€‚ä½†æ˜¯ç”±äº github action æœ¬èº«å¹¶ä¸æ”¯æŒç›´æ¥å°†åº”ç”¨ç¨‹åºéƒ¨ç½²åˆ°ç§äººçš„è™šæ‹Ÿæœºä¸Šï¼Œéœ€è¦å’Œå…¶ä»–å·¥å…·ç›¸ç»“åˆã€‚æœ€ç»ˆé‡‡ç”¨çš„æ–¹æ³•æ˜¯ï¼š</p><blockquote><p>åœ¨ yml æ–‡ä»¶ä¸­ç¼–å†™ä¸€ä¸ªéƒ¨ç½²è„šæœ¬ï¼Œé€šè¿‡ ssh è¿æ¥åˆ°è™šæ‹Ÿæœºå¹¶æ‰§è¡Œå¯¹åº”çš„éƒ¨ç½²å‘½ä»¤</p></blockquote><h3 id="ä¸€äº›é…ç½®é¡¹-1"><a href="#ä¸€äº›é…ç½®é¡¹-1" class="headerlink" title="ä¸€äº›é…ç½®é¡¹"></a>ä¸€äº›é…ç½®é¡¹</h3><ul><li>workflows: ä¾èµ–çš„workflow</li><li>types:æŒ‡å®šåªæœ‰åœ¨ä¾èµ–å·¥ä½œæµç¨‹å®Œæˆåæ‰è§¦å‘è¯¥å·¥ä½œæµç¨‹</li></ul><h3 id="push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤"><a href="#push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤" class="headerlink" title="push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤"></a>push-to-private-machineæ€»å…±æœ‰ä¸ªæ­¥éª¤</h3><ol><li>é€šè¿‡<code>actions/checkout@v3</code>æ‹‰å–ä»£ç ä»“åº“</li><li>å°†è™šæ‹Ÿæœºå¯†é’¥æ·»åŠ åˆ° GitHub Runner çš„ â€œknown_hostsâ€ æ–‡ä»¶ä¸­</li><li>ç§»é™¤æ—§å®¹å™¨</li><li>æ‹‰å–æœ€æ–°é•œåƒ</li><li>åˆ›å»ºæ–°å®¹å™¨</li></ol><h3 id="ä¸€äº›å‘½ä»¤"><a href="#ä¸€äº›å‘½ä»¤" class="headerlink" title="ä¸€äº›å‘½ä»¤"></a>ä¸€äº›å‘½ä»¤</h3><ul><li><code>docker ps -a | grep yanyue1215/vue_app | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f</code><ul><li>docker ps -aï¼šåˆ—å‡ºæ‰€æœ‰çš„Dokcerå®¹å™¨</li><li>grep yanyue1215&#x2F;vue_appï¼šåœ¨å®¹å™¨åˆ—è¡¨ä¸­è¿‡æ»¤å‡ºåç§°ä¸º â€œyanyue1215&#x2F;vue_appâ€ çš„å®¹å™¨</li><li>awk â€˜{print $1}â€™:ä»è¿‡æ»¤ç»“æœä¸­æå–ç¬¬ä¸€åˆ—ï¼ˆå³å®¹å™¨ IDï¼‰</li><li>xargs -r docker rm -fï¼šå°†å®¹å™¨ ID ä½œä¸ºå‚æ•°ä¼ é€’ç»™ docker rm -f å‘½ä»¤ï¼Œä»¥å¼ºåˆ¶åˆ é™¤å®¹å™¨</li></ul></li><li>ssh-keyscan 116.204.108.126 &gt;&gt; ~&#x2F;.ssh&#x2F;known_hosts<ul><li>ä½¿ç”¨ <code>ssh-keyscan</code> å‘½ä»¤æ‰«æä¸»æœº 116.204.108.126 çš„å…¬é’¥ï¼Œå¹¶å°†ç»“æœè¿½åŠ åˆ° <code>~/.ssh/known_hosts</code> æ–‡ä»¶ä¸­ã€‚<code>&gt;&gt; </code>æ“ä½œç¬¦è¡¨ç¤ºå°†è¾“å‡ºé‡å®šå‘å¹¶è¿½åŠ åˆ°æ–‡ä»¶æœ«å°¾</li></ul></li></ul><p>å®Œæ•´ä»£ç å¦‚ä¸‹ï¼š</p><pre><code class="yml">name: push-to-private-machinerun-name: $&#123;&#123; github.actor &#125;&#125; is deployingon:  workflow_run:    workflows: [&quot;build-image&quot;] #ä¾èµ–çš„å·¥ä½œæµç¨‹æ–‡ä»¶çš„åç§°    types:      - completedjobs:  deploy:    runs-on: ubuntu-latest    steps:      - name: Checkout repository        uses: actions/checkout@v3      - name: Add known hosts        run: | # å°†è™šæ‹Ÿæœºå¯†é’¥æ·»åŠ åˆ° GitHub Runner çš„ &quot;known_hosts&quot; æ–‡ä»¶ä¸­          mkdir -p ~/.ssh          ssh-keyscan 116.204.108.126 &gt;&gt; ~/.ssh/known_hosts      - name: remove old container        run: |          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker ps -a | grep yanyue1215/vue_app | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f&quot;          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker ps -a | grep yanyue1215/resume_service | awk &#39;&#123;print $1&#125;&#39; | xargs -r docker rm -f&quot;          sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker system prune -a&quot;      - name: pull latest front_image        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker pull yanyue1215/vue_app:latest&quot;      - name: pull latest backend_image        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;docker pull yanyue1215/resume_service:latest&quot;      - name: Deploy to Virtual Machine        run: sshpass -p $&#123;&#123; secrets.SSH_PASSWORD &#125;&#125; ssh root@116.204.108.126 &quot;cd /root/resume_generator_front &amp;&amp; /usr/local/git/bin/git pull origin master &amp;&amp; docker-compose up -d&quot;</code></pre><h3 id="å®¹æ˜“è¸©å‘çš„ç‚¹"><a href="#å®¹æ˜“è¸©å‘çš„ç‚¹" class="headerlink" title="å®¹æ˜“è¸©å‘çš„ç‚¹"></a>å®¹æ˜“è¸©å‘çš„ç‚¹</h3><h4 id="è™šæ‹Ÿæœºä¸Šå®‰è£…äº†-gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git-pull-xxå´æŠ¥é”™"><a href="#è™šæ‹Ÿæœºä¸Šå®‰è£…äº†-gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git-pull-xxå´æŠ¥é”™" class="headerlink" title="è™šæ‹Ÿæœºä¸Šå®‰è£…äº† gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°git pull xxå´æŠ¥é”™:"></a>è™šæ‹Ÿæœºä¸Šå®‰è£…äº† gitï¼Œä½†æ˜¯æ‰§è¡Œåˆ°<code>git pull xx</code>å´æŠ¥é”™:</h4><blockquote><p>git: command not found<br>error:Process completed with exit code 127</p></blockquote><p>çŒœæµ‹åŸå› æ˜¯ Github Actions çš„å·¥ä½œæµç¨‹ä¸­æ— æ³•æ‰¾åˆ° git å‘½ä»¤ã€‚è§£å†³æ–¹æ¡ˆæ˜¯åœ¨è™šæ‹Ÿæœºä¸Šæ‰§è¡Œ<code>which git</code>å‘½ä»¤è·å–åˆ° git çš„å®é™…ä½ç½®ï¼Œç„¶åå°†å…¶æ›¿æ¢åˆ°å‘½ä»¤ä¸­ã€‚</p><pre><code class="bash"># åŸæ¥çš„å‘½ä»¤ï¼šgit pull origin master# ä¿®æ”¹åçš„å‘½ä»¤ï¼š/usr/local/git/bin/git pull origin master</code></pre><h4 id="ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²"><a href="#ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²" class="headerlink" title="ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²"></a>ç¬¬ä¸€ä¸ªæµç¨‹æ‰§è¡Œå®Œä¹‹åå¹¶æ²¡æœ‰æ‰§è¡Œè‡ªåŠ¨åŒ–éƒ¨ç½²</h4><p>åŸå› ï¼šéœ€è¦ä¸¤ä¸ªå·¥ä½œæµç¨‹æ–‡ä»¶çš„åç§°æ­£ç¡®ä¸”åŒ¹é…<br>è§£å†³æ–¹æ¡ˆï¼šæ˜¯å°†æ‰€æœ‰ yml æ–‡ä»¶å’Œä»–ä»¬é‡Œé¢çš„<code>name</code>å€¼ä¿æŒä¸€è‡´</p>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Docker </tag>
            
            <tag> SSH </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexoèœå•æ å¢åŠ yuqueä¸“æ </title>
      <link href="/2023/09/05/hexo-cai-dan-lan-zeng-jia-yuque-zhuan-lan/"/>
      <url>/2023/09/05/hexo-cai-dan-lan-zeng-jia-yuque-zhuan-lan/</url>
      
        <content type="html"><![CDATA[]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è·å–ä¸€ä¸ªå‡½æ•°çš„è¿”å›å€¼ç±»å‹</title>
      <link href="/2023/08/03/ru-he-huo-qu-yi-ge-han-shu-de-fan-hui-zhi-lei-xing/"/>
      <url>/2023/08/03/ru-he-huo-qu-yi-ge-han-shu-de-fan-hui-zhi-lei-xing/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨ Modal.confirm()æ–¹æ³•åˆ›å»ºäº†ä¸€ä¸ªå¼¹çª—ï¼Œä½†æ˜¯ç”±äºä¸€äº›åŸå› å¯¼è‡´éœ€è¦æ‰‹åŠ¨å…³é—­å¼¹çª—</p><pre><code class="JavaScript"> const modal = Modal.confirm(&#123;  onCancel:()=&gt;handleCancel(modal) &#125;)  const handleCancel = (modal?: any) =&gt; &#123;    if (!!modal) &#123;      modal.destroy();    &#125;  &#125;;</code></pre><p>ä»£ç å¤å®¡æ—¶ï¼Œå¤å®¡äººæå‡ºè¿™é‡Œå¯ä»¥ä½¿ç”¨<code>(typeof Modal)[&#39;confirm&#39;]</code>,è€Œä¸ä½¿ç”¨ä¸ä¸¥è°¨çš„<code>any</code>ã€‚ç¿»é˜…æ–‡æ¡£åå‘ç° antd æä¾›äº†ç°æˆçš„ç±»å‹å®šä¹‰<code>ModalFunc</code></p><pre><code class="javascript">export declare type ModalFunc = (props: ModalFuncProps) =&gt; &#123;  destroy: () =&gt; void;  update: (configUpdate: ConfigUpdate) =&gt; void;&#125;;</code></pre><p>æ¢ä¸Šå»ä»¥åå‘ç°<code>modal.destroy()</code>æŠ¥é”™ï¼ŒæŠ¥é”™ä¿¡æ¯ä¸ºï¼š</p><blockquote><p>ç±»å‹â€œModalFuncâ€ä¸Šä¸å­˜åœ¨å±æ€§â€œdestroyâ€ã€‚</p></blockquote><p>é€šè¿‡ä¸Šè¿°çš„ç±»å‹å®šä¹‰å¯çœ‹å‡º modal çš„ç±»å‹ä¸åº”è¯¥æ˜¯<code>ModalFunc</code>ï¼Œè€Œåº”è¯¥æ˜¯è¿™ä¸ªå‡½æ•°çš„è¿”å›ç±»å‹ã€‚é€šè¿‡æŸ¥é˜… TS æ–‡æ¡£å¯çŸ¥ï¼šæˆ‘ä»¬å¯ä»¥é€šè¿‡<code>ReturnType</code>å»è§£å†³é—®é¢˜ã€‚<br>æ‰€ä»¥æºç ä¿®æ”¹ä¸ºï¼š</p><pre><code class="javascript">const handleCancel = (modal?: ReturnType&lt;ModalFunc&gt;) =&gt; &#123;  if (!!modal) &#123;    modal.destroy();  &#125;&#125;;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>antdè‡ªå®šä¹‰é¡µè„šModal</title>
      <link href="/2023/08/02/antd-zi-ding-yi-ye-jiao-modal/"/>
      <url>/2023/08/02/antd-zi-ding-yi-ye-jiao-modal/</url>
      
        <content type="html"><![CDATA[<p>éœ€æ±‚ï¼š</p><img src="/2023/08/02/antd-zi-ding-yi-ye-jiao-modal/need.jpg" class="" title="éœ€æ±‚"><h2 id="å‰ç½®èƒŒæ™¯ï¼š"><a href="#å‰ç½®èƒŒæ™¯ï¼š" class="headerlink" title="å‰ç½®èƒŒæ™¯ï¼š"></a>å‰ç½®èƒŒæ™¯ï¼š</h2><p>ç”¨æˆ·ç™»å½•æˆåŠŸåï¼Œå¦‚æœå½“å‰çŠ¶æ€ä¸ºåˆå§‹å¯†ç çŠ¶æ€ï¼Œåˆ™è·³è½¬åˆ°ç›®æ ‡é¡µé¢ä¸”å±•ç¤ºå¼¹çª—æç¤ºç”¨æˆ·ä¿®æ”¹å¯†ç ã€‚ç”±äºä¹‹å‰äº§å“å¸Œæœ› modal å¯ä»¥è·¨é¡µé¢å±•ç¤ºï¼Œæ‰€ä»¥æ²¡æœ‰ä½¿ç”¨ Modal ç»„ä»¶ï¼Œè€Œæ˜¯ä½¿ç”¨äº† Modal.confirm:</p><pre><code class="javascript">Modal.confirm(&#123;  content:    res.is_user_password_expired === IsUserPasswordExpiredEnum.EXPIRE_SOON      ? i18n.t(&#39;Login.Login.index.LOCALE_DEFAULT_SUFFIX3836&#39;)      : i18n.t(&#39;Login.Login.index.firstLoginModifyPwd&#39;),  okText: i18n.t(&#39;commonGenerator.confirm_3&#39;),  cancelText: i18n.t(&#39;commonGenerator.cancel&#39;),  onOk: () =&gt; &#123;    // é˜²æ­¢ç”¨æˆ·åœ¨ä¿®æ”¹å¯†ç ç•Œé¢ç‚¹å‡»æµè§ˆå™¨è¿”å›é”®æˆ–è€…å–æ¶ˆï¼Œç¨‹åºå¡æ­»    dispatch(setIsLogin(&#123; isLogin: true, token: res.token ?? &#39;&#39; &#125;));    history.push(&#39;/password_modify&#39;);  &#125;,  onCancel: () =&gt; &#123;    dispatch(setIsLogin(&#123; isLogin: true, token: res.token ?? &#39;&#39; &#125;));    if (target) &#123;      window.location.href = target;    &#125;  &#125;,&#125;);</code></pre><h2 id="æœ¬æ¬¡éœ€æ±‚"><a href="#æœ¬æ¬¡éœ€æ±‚" class="headerlink" title="æœ¬æ¬¡éœ€æ±‚"></a>æœ¬æ¬¡éœ€æ±‚</h2><p>äº§å“å¸Œæœ›åœ¨åº•éƒ¨å¢åŠ ä¸€ä¸ªå–æ¶ˆå’Œç¡®è®¤ä¹‹å¤–çš„å¿½ç•¥æŒ‰é’®ï¼Œç‚¹å‡»å¿½ç•¥æŒ‰é’®æ—¶ï¼Œè°ƒç”¨æ–°å¢çš„å¿½ç•¥å¯†ç æç¤ºæ¥å£ï¼Œç„¶åè‡ªåŠ¨å…³é—­å¼¹çª—ã€‚</p><h3 id="é¦–é€‰æ–¹æ¡ˆï¼šä½¿ç”¨è‡ªå®šä¹‰é¡µè„š-footer-å±æ€§"><a href="#é¦–é€‰æ–¹æ¡ˆï¼šä½¿ç”¨è‡ªå®šä¹‰é¡µè„š-footer-å±æ€§" class="headerlink" title="é¦–é€‰æ–¹æ¡ˆï¼šä½¿ç”¨è‡ªå®šä¹‰é¡µè„š footer å±æ€§"></a>é¦–é€‰æ–¹æ¡ˆï¼šä½¿ç”¨è‡ªå®šä¹‰é¡µè„š footer å±æ€§</h3><pre><code class="javascript">Modal.confirm(&#123;  // ...  footer:[&#123;    &lt;Button key=&#39;1&#39;&gt;å¿½ç•¥&lt;/Button&gt;,    &lt;Button key=&#39;2&#39;&gt;å–æ¶ˆ&lt;/Button&gt;,    &lt;Button key=&#39;3&#39;&gt;ç¡®è®¤&lt;/Button&gt;  &#125;]&#125;)</code></pre><p>é—®é¢˜ï¼šç›®å‰é¡¹ç›®ä½¿ç”¨çš„ antd ç‰ˆæœ¬ä¸º 4.x,è€Œ antd5.x æ‰æ”¯æŒ footer å±æ€§ï¼Œæ‰€ä»¥æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼š</p><ol><li>å‡çº§é¡¹ç›®ä¾èµ–åº“ç‰ˆæœ¬ã€æš‚æ—¶æ²¡æœ‰å‡çº§è®¡åˆ’ï¼Œç›´æ¥å¿½ç•¥ã€‘</li><li>é€šè¿‡éæ­£å¸¸æ–¹å¼å®ç°æ”¯æŒè‡ªå®šä¹‰é¡µè„šçš„ Modal</li></ol><h3 id="å®ç°æ€è·¯"><a href="#å®ç°æ€è·¯" class="headerlink" title="å®ç°æ€è·¯"></a>å®ç°æ€è·¯</h3><h4 id="ä½¿ç”¨-Modal-ç»„ä»¶å°è£…ä¸€ä¸ªæ”¯æŒè‡ªå®šä¹‰é¡µè„šçš„å¼¹çª—"><a href="#ä½¿ç”¨-Modal-ç»„ä»¶å°è£…ä¸€ä¸ªæ”¯æŒè‡ªå®šä¹‰é¡µè„šçš„å¼¹çª—" class="headerlink" title="ä½¿ç”¨ Modal ç»„ä»¶å°è£…ä¸€ä¸ªæ”¯æŒè‡ªå®šä¹‰é¡µè„šçš„å¼¹çª—"></a>ä½¿ç”¨ Modal ç»„ä»¶å°è£…ä¸€ä¸ªæ”¯æŒè‡ªå®šä¹‰é¡µè„šçš„å¼¹çª—</h4><pre><code class="javascript">const [visible, setVisible] = useState(false);const showModal = () =&gt; &#123;  setVisible(true);&#125;;const handleOk = () =&gt; &#123;  // ...handling&#125;;const handleCancel = () =&gt; &#123;  // ...handling&#125;;const handleIgnore = () =&gt; &#123;  // ...handling&#125;;return (  &lt;&gt;    &lt;Button onClick=&#123;showModal&#125;&gt;Open Modal&lt;/Button&gt;    &lt;Modal      visible=&#123;visible&#125;      onOk=&#123;handleOk&#125;      onCancel=&#123;handleCancel&#125;      footer=&#123;[        &lt;Button key=&quot;cancel&quot; onClick=&#123;handleCancel&#125;&gt;          å–æ¶ˆ        &lt;/Button&gt;,        &lt;Button key=&quot;ignore&quot; onClick=&#123;handleIgnore&#125;&gt;          å¿½ç•¥        &lt;/Button&gt;,        &lt;Button key=&quot;submit&quot; type=&quot;primary&quot; onClick=&#123;handleOk&#125;&gt;          ç¡®è®¤        &lt;/Button&gt;,      ]&#125;    &gt;      &lt;p&gt;Modal Content&lt;/p&gt;    &lt;/Modal&gt;  &lt;/&gt;);</code></pre><p>ç”±äº antd4.x çš„ Modal ç»„ä»¶æ”¯æŒ footer å±æ€§ï¼Œæ‰€ä»¥å¯ä»¥é€šè¿‡è¯¥ç»„ä»¶å°è£…ã€‚ä½†æ˜¯é—®é¢˜æ˜¯æˆ‘ä»¬éœ€è¦å¼¹çª—èƒ½è·¨é¡µé¢å±•ç¤ºã€‚éœ€è¦åšåˆ°è¿™ä¸€ç‚¹ï¼Œå¯ä»¥é‡‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨ redux å°† modal çš„æ˜¾ç¤ºçŠ¶æ€æå‡åˆ°å…¨å±€</p><pre><code class="jsx">// store.jsexport const store = createStore( reducer: (state, action) =&gt; &#123;  // ... handles modal visibility state&#125;)// App.js&lt;Provider store=&#123;store&#125;&gt;  &lt;Router&gt;    &#123;/* æ ¹æ® redux state æ¥æ¸²æŸ“ Modal */&#125;    &lt;Modal /&gt;    &lt;Route path=&quot;/a&quot; component=&#123;PageA&#125; /&gt;    &lt;Route path=&quot;/b&quot; component=&#123;PageB&#125; /&gt;  &lt;/Router&gt;&lt;/Provider&gt;// PageA.jsimport &#123; showModal &#125; from &#39;./actions&#39;const openModal = () =&gt; &#123;  dispatch(showModal()) // å¼€å¯ modal&#125;// PageB.js// è¿™é‡Œä¸éœ€è¦åšä»»ä½•å¤„ç†,modal ä¼šç»§ç»­æ˜¾ç¤º</code></pre><p>ä½†æ˜¯è¿™ä¸ªå¼¹çª—å¹¶ä¸æ˜¯å…¨å±€çš„åŠŸèƒ½ï¼Œæ‰€ä»¥å¹¶ä¸å¸Œæœ›å°†å…¶æ”¾ç½®åœ¨å…¨å±€çš„è·¯ç”±ä¸­ï¼Œä¸”è¿™æ ·åšçš„è¯ä¿®æ”¹æˆæœ¬è¾ƒé«˜ï¼Œæ‰€ä»¥æ”¾å¼ƒæ­¤æ–¹æ¡ˆã€‚</p><h3 id="æœ€ç»ˆæ–¹æ¡ˆ"><a href="#æœ€ç»ˆæ–¹æ¡ˆ" class="headerlink" title="æœ€ç»ˆæ–¹æ¡ˆ"></a>æœ€ç»ˆæ–¹æ¡ˆ</h3><p>æ€è·¯ï¼šcancelText å±æ€§ç±»å‹æ”¯æŒ ReactNodeï¼Œæ‰€ä»¥å¯ä»¥è€ƒè™‘å°†å¿½ç•¥æŒ‰é’®å’Œå–æ¶ˆæŒ‰é’®åŒä¸€çœ‹åšæ˜¯ cancelText,é€šè¿‡ CSS å’Œç‚¹å‡»äº‹ä»¶è®¾ç½®è¾¾åˆ°ç›¸åŒæ•ˆæœ</p><pre><code class="javascript">const handleIgnore = async (modal: any) =&gt; &#123;  const token = localStorage.getItem(&#39;token&#39;);  dispatch(setIsLogin(&#123; isLogin: true, token: token ?? &#39;&#39; &#125;));  const ignore = UserService.ignorePasswdChangeAlarm();  modal.destroy();  ignore.catch((err) =&gt; message.error(getErrorMessage(err)));  if (target) &#123;    window.location.href = target;  &#125;&#125;;const handleCancel = (modal?: any) =&gt; &#123;  const token = localStorage.getItem(&#39;token&#39;);  dispatch(setIsLogin(&#123; isLogin: true, token: token ?? &#39;&#39; &#125;));  if (target) &#123;    window.location.href = target;  &#125;  if (!!modal) &#123;    modal.destroy();  &#125;&#125;;const modal = Modal.confirm(&#123;  // ....  className: &#39;need-modify-modal&#39;,  cancelText: (    &lt;&gt;      &lt;Button onClick=&#123;() =&gt; handleIgnore(modal)&#125;&gt;å¿½ç•¥&lt;/Button&gt;      &lt;Button onClick=&#123;() =&gt; handleCancel(modal)&#125;&gt;å–æ¶ˆ&lt;/Button&gt;    &lt;/&gt;  ),  cancelButtonProps: &#123;    className: &#39;cancel-ignore-btns&#39;,    onClick: () =&gt; &#123;&#125;,    type: &#39;text&#39;,  &#125;,&#125;);</code></pre><p>æ­¤æ—¶å†è®¾ç½®æ ·å¼å³å¯</p><pre><code class="less">.need-modify-modal &#123;  .ant-modal-confirm-btns &#123;    display: flex;    justify-content: end;    align-items: center;    border: none;    .cancel-ignore-btns &#123;      border: none;      display: flex;      align-items: end;      padding: 0;      justify-content: end;      width: 80%;      cursor: default;      &gt; span &#123;        width: 100%;        display: flex;        justify-content: space-between;        background-color: #fff;      &#125;    &#125;  &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> antd </tag>
            
            <tag> Modal </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>umc-uiè¡¨æ ¼ç­›é€‰ä¸ç”Ÿæ•ˆ</title>
      <link href="/2023/07/31/axios-qing-qiu-bu-sheng-xiao/"/>
      <url>/2023/07/31/axios-qing-qiu-bu-sheng-xiao/</url>
      
        <content type="html"><![CDATA[<h2 id="èƒŒæ™¯ï¼š"><a href="#èƒŒæ™¯ï¼š" class="headerlink" title="èƒŒæ™¯ï¼š"></a>èƒŒæ™¯ï¼š</h2><p>å¶ç„¶å‘ç°é¡¹ç›®ä¸­ä¸€ä¸ªè¡¨æ ¼ç­›é€‰æ²¡æœ‰ç”Ÿæ•ˆ,ä¼ å‚å­—æ®µå€¼ä¸º<code> filter_redis_sentinel_instance_ids: tableFilterInfo.redis_sentinel_instance_id ?? undefined</code></p><img src="/2023/07/31/axios-qing-qiu-bu-sheng-xiao/fail.jpg" class="" title="è¡¨æ ¼ç­›é€‰ä¸ç”Ÿæ•ˆ"><p>ä¸ŠæŠ¥ç¼ºé™·ä»¥åï¼Œè‡ªå·±ç”¨ postman è¯•äº†ä¸€ä¸‹ï¼Œå‘ç°æ¥å£<code>v4/redis/sentinel_instance/list?page_index=1&amp;page_size=20&amp;filter_redis_sentinel_instance_ids[]=redis-sentinel-u97bvd</code>,å½“<code>filter_redis_sentinel_instance_ids</code>å­—æ®µä¼ å…¥å•ä¸ªå€¼çš„æ—¶å€™ï¼Œæ˜¯å¯ä»¥æœ‰æ•ˆç­›é€‰å‡ºå¯¹åº”çš„èŠ‚ç‚¹ ID æ•°æ®çš„ã€‚</p><h2 id="è§£å†³æ–¹æ¡ˆï¼š"><a href="#è§£å†³æ–¹æ¡ˆï¼š" class="headerlink" title="è§£å†³æ–¹æ¡ˆï¼š"></a>è§£å†³æ–¹æ¡ˆï¼š</h2><p>å¯»æ±‚åç«¯å¸®åŠ©ï¼Œåç«¯å‘ç°å¦‚æœå°†<code>filter_redis_sentinel_instance_ids</code>å‚æ•°å€¼ç”¨é€—å·åˆ†éš”å¼€ï¼Œè€Œä¸æ˜¯ç›´æ¥ä¼ æ•°ç»„ï¼Œæ­¤æ—¶ç­›é€‰æ˜¯æœ‰æ•ˆçš„ã€‚ä½†æ˜¯å®è·µåå‘ç°ç”±äºåç«¯å°†å…¶å®šä¹‰ä¸ºå­—ç¬¦ä¸²æ•°ç»„ç±»å‹ï¼Œæ‰€ä»¥å‰ç«¯å°†å®ƒä½¿ç”¨<code>join()</code>æ–¹æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸²åï¼ŒTS è¯­æ³•æ£€æŸ¥è¿‡ä¸å»ã€‚æ­¤æ—¶è§£å†³æ–¹æ¡ˆæ˜¯åç«¯é‡æ–°å®šä¹‰æ¥å£å­—æ®µç±»å‹ï¼Œå°†å…¶ä»<code>string[]</code>è½¬æ¢ä¸º<code>string</code>,å°†å‚æ•°ä¿®æ”¹ä¸º<code>filter_redis_sentinel_instance_ids:tableFilterInfo.redis_sentinel_instance_id?.[0]</code>ã€‚æ­¤æ—¶å¯ä»¥ä¿®å¤é—®é¢˜ã€‚</p><h2 id="ç±»ä¼¼é—®é¢˜"><a href="#ç±»ä¼¼é—®é¢˜" class="headerlink" title="ç±»ä¼¼é—®é¢˜"></a>ç±»ä¼¼é—®é¢˜</h2><p>å‘ç°é¡¹ç›®ä¸­æœ‰å¾ˆå¤šç±»ä¼¼çš„é—®é¢˜ï¼Œæ¯”å¦‚ uProxy é¡µé¢å®ä¾‹åˆ—è¡¨æœ‰ä¸€ä¸ªå®ä¾‹ id ç­›é€‰:</p><pre><code class="javascript">  React.useEffect(() =&gt; &#123;    if (!!selectData) &#123;      const groupId = selectData?.uproxy_group_id ?? &#39;&#39;;      UproxyService.listUproxyInstancesV6(&#123;        // è¯¥å‚æ•°ç±»å‹å®šä¹‰ä¸ºArray&lt;string&gt;ï¼Œä½†ä¼ é€’æ•°ç»„æ˜¯æ— æ•ˆçš„ï¼Œåªèƒ½ä¼ é€’å­—ç¬¦ä¸²ã€‚        filter_uproxy_group_ids: groupId as any,      &#125;).then((res) =&gt; &#123;        if (res.data &amp;&amp; res.data.length === 1) &#123;          setIsLast(true);        &#125; else &#123;          setIsLast(false);        &#125;      &#125;);    &#125;  &#125;, [selectData]);</code></pre><p>è¿™é‡Œæ ¹æ®åç«¯ swagger æ–‡æ¡£ç”Ÿæˆçš„ api æ¥å£å®šä¹‰é‡Œ,<code>filter_uproxy_group_ids</code>å­—æ®µæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²æ•°ç»„ï¼Œä½†æ˜¯æ­¤æ—¶å‰ç«¯ä¼ é€’æ•°ç»„æ˜¯æ— æ•ˆçš„ï¼Œåªèƒ½ä¼ é€’å­—ç¬¦ä¸²ï¼Œä½†æ˜¯ TS æ£€æŸ¥è¿‡ä¸å»ï¼Œæ‰€ä»¥è¿™é‡Œä½¿ç”¨äº†<code>as any</code>ï¼Œè¿™ä¹Ÿæ˜¯å¤§éƒ¨åˆ†åŒç±»é—®é¢˜æ²¡æœ‰å‡ºç°é—®é¢˜çš„åŸå› ï¼Œæ¯”å¦‚ï¼š</p><pre><code class="javascript">const params: IListUproxyInstancesV6Params = &#123;  filter_uproxy_group_ids: info.uproxy_group_id?.[0],&#125;;</code></pre><p>ç”±äº<code>info</code>æ˜¯<code>FilteredInfo</code>ç±»å‹,æ‰€ä»¥æ­¤æ—¶ä¼ ç»™<code>filter_uproxy_group_ids</code>çš„å®é™…ä¸Šæ˜¯<code>any</code>ç±»å‹,èº²è¿‡äº† TS æ£€æŸ¥ã€‚ä½†å¦‚æœåç»­éœ€æ±‚æœ‰å¤šå€¼ç­›é€‰çš„æ—¶å€™ï¼Œå°±æ— æ³•èº²è¿‡ TS æ£€æŸ¥ï¼š</p><pre><code class="javascript">export type FilteredInfo = &#123;  [key: string]: any[] | null,&#125;;</code></pre><h2 id="åç»­"><a href="#åç»­" class="headerlink" title="åç»­"></a>åç»­</h2><p>æœ‰åç«¯åŒäº‹åé¦ˆï¼Œè¿™ç§é‡æ–°å®šä¹‰æ¥å£çš„è§£å†³æ–¹æ¡ˆä¿®å¤æˆæœ¬è¾ƒé«˜ï¼Œå› ä¸ºæ¯æ¬¡ä¿®æ”¹æ¥å£å®šä¹‰éƒ½éœ€è¦æ–°å¢ä¸€ä¸ª v1-&gt;v2 è¿™ç§ç±»ä¼¼çš„æ¥å£ï¼Œä½†æ˜¯å†…éƒ¨é€»è¾‘æ˜¯ä¸å˜çš„ã€‚æ‰€ä»¥éœ€è¦ä»å‰ç«¯è§’åº¦å†æ‰¾ä¸€æ‰¾å…¶ä»–çš„è§£å†³æ–¹æ¡ˆï¼Œé™ä½ä»¥åä¿®æ”¹é¡¹ç›®é‡Œå…¶ä»–ç±»ä¼¼ç¼ºé™·çš„ä¿®å¤æˆæœ¬ã€‚è¯¢é—®å…¶ä»–å‰ç«¯åŒäº‹å¾—åˆ°ä»¥ä¸‹ä¿¡æ¯ï¼š</p><blockquote><p>é—®é¢˜æœ¬è´¨åŸå› æ˜¯ axios å¯¹ query ç±»å‹çš„å‚æ•°çš„ format æ ¼å¼ä¸åç«¯ä½¿ç”¨çš„ parse params æ–¹å¼ä¸åŒ¹é…ã€‚axios é»˜è®¤ä¼šå°† query ä¸­çš„ array æ ¼å¼åŒ–åŸ?a[]&#x3D;1&amp;a[]&#x3D;2 çš„æ ¼å¼ï¼Œä½†æ˜¯åç«¯ä½¿ç”¨çš„ parse åªæ”¯æŒ ?a&#x3D;1,2 çš„æ ¼å¼ã€‚</p></blockquote><p>æŸ¥é˜…äº†<a href="https://axios-http.com/zh/docs/req_config">axios çš„å®˜æ–¹æ–‡æ¡£</a> ,å‘ç°äº†é…ç½®é¡¹ï¼š</p><pre><code class="javascript">import qs from &#39;query-string&#39;paramsSerializer: function (params) &#123;  return qs.stringify(params, &#123;arrayFormat: &#39;brackets&#39;&#125;)&#125;</code></pre><p><code>arrayFormat</code>çš„é»˜è®¤å€¼æ˜¯<code>brackets</code>,æ‰€ä»¥å‡ºç°äº† url ä¸­ a[]&#x3D;1 è¿™ç§ç°è±¡ï¼Œå¯¼è‡´ç­›é€‰å¤±è´¥ï¼Œå°†å…¶ä¿®æ”¹ä¸º<code>comma</code>å³å¯ã€‚</p><pre><code class="javascript">qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;indices&#39; &#125;);// &#39;a[0]=b&amp;a[1]=c&#39;qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;brackets&#39; &#125;);// &#39;a[]=b&amp;a[]=c&#39;qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;repeat&#39; &#125;);// &#39;a=b&amp;a=c&#39;qs.stringify(&#123; a: [&#39;b&#39;, &#39;c&#39;] &#125;, &#123; arrayFormat: &#39;comma&#39; &#125;);// &#39;a=b,c&#39;</code></pre><p>æ‰€ä»¥æœ€ç»ˆä¿®æ”¹æ–¹å¼æ˜¯ä¿®æ”¹ request å±æ€§å€¼</p><pre><code class="javascript">return handleTableRequestError(  RedisService.ListRedisSentinelInstancesV5(cleanEmptyParams(params)));// ----å˜æ›´ä¸º--------return handleTableRequestError(  RedisService.ListRedisSentinelInstancesV5(cleanEmptyParams(params), &#123;    paramsSerializer(paramsAll) &#123;      return qs.stringify(paramsAll, &#123;        arrayFormat: &#39;comma&#39;,      &#125;);    &#125;,  &#125;));</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> httpè¯·æ±‚ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>SQLå¿…çŸ¥å¿…ä¼šç¬”è®°</title>
      <link href="/2023/07/17/sql-bi-zhi-bi-hui-bi-ji/"/>
      <url>/2023/07/17/sql-bi-zhi-bi-hui-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="åœ¨è¿è¡Œæ•°æ®åº“å¢åˆ æ”¹æŸ¥è„šæœ¬å‰é¢„æœŸåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ŒæŠ¥é”™ï¼š"><a href="#åœ¨è¿è¡Œæ•°æ®åº“å¢åˆ æ”¹æŸ¥è„šæœ¬å‰é¢„æœŸåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ŒæŠ¥é”™ï¼š" class="headerlink" title="åœ¨è¿è¡Œæ•°æ®åº“å¢åˆ æ”¹æŸ¥è„šæœ¬å‰é¢„æœŸåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ŒæŠ¥é”™ï¼š"></a>åœ¨è¿è¡Œæ•°æ®åº“å¢åˆ æ”¹æŸ¥è„šæœ¬å‰é¢„æœŸåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°æ®åº“ï¼ŒæŠ¥é”™ï¼š</h2><blockquote><p>Error Codeï¼š1044ï¼ŒAccess denied for user â€˜rootâ€˜@â€™%â€™ to database â€˜dbNameâ€™(Mysql::Error)</p></blockquote><p>è§£å†³æ–¹æ³•ï¼šä¿®æ”¹ mysql æ•°æ®åº“ä¸‹çš„ user è¡¨çš„ root ç”¨æˆ·æƒé™</p><pre><code class="bash">UPDATE mysql.user SET Grant_priv=&#39;Y&#39;, Super_priv=&#39;Y&#39; WHERE User=&#39;root&#39;;FLUSH PRIVILEGES;</code></pre><h2 id="åˆ é™¤è¡Œæ•°æ®çš„æ—¶å€™æŠ¥é”™ï¼š"><a href="#åˆ é™¤è¡Œæ•°æ®çš„æ—¶å€™æŠ¥é”™ï¼š" class="headerlink" title="åˆ é™¤è¡Œæ•°æ®çš„æ—¶å€™æŠ¥é”™ï¼š"></a>åˆ é™¤è¡Œæ•°æ®çš„æ—¶å€™æŠ¥é”™ï¼š</h2><p><code>DELETE FROM Customers WHERE cust_id = 1000000006</code></p><blockquote><p>Error Codeï¼š1142 - DELETE command denied to user â€˜rootâ€˜@â€™222.71.242.202â€™ for table â€˜Customersâ€™</p></blockquote><p>è§£å†³åŠæ³•ï¼š</p><ol><li>æŸ¥çœ‹å½“å‰ç™»å½•ç”¨æˆ·ä¿¡æ¯</li></ol><pre><code class="SQL">SELECT user, host, db, commandFROM information_schema.processlist</code></pre><p>ç»“æœï¼š<br>user:root<br>host:222.71.242.202:54120<br>db:10Minute</p><ol start="2"><li>å¢åŠ æƒé™ <code>Delete_priv=&#39;Y&#39;</code></li></ol><h2 id="è·å–ç³»ç»Ÿæ—¶é—´"><a href="#è·å–ç³»ç»Ÿæ—¶é—´" class="headerlink" title="è·å–ç³»ç»Ÿæ—¶é—´"></a>è·å–ç³»ç»Ÿæ—¶é—´</h2><p>MySQL çš„æ—¥æœŸç±»å‹æœ‰ 5 ä¸ªï¼Œåˆ†åˆ«æ˜¯ï¼š dateã€timeã€yearã€datetimeã€timestampã€‚<br>Now(),CURRENT_TIMESTAMP(),CURRENT_DATE()</p><h3 id="MySQL-çš„æ—¥æœŸç±»å‹å¦‚ä½•è®¾ç½®å½“å‰æ—¶é—´ä¸ºå…¶é»˜è®¤å€¼"><a href="#MySQL-çš„æ—¥æœŸç±»å‹å¦‚ä½•è®¾ç½®å½“å‰æ—¶é—´ä¸ºå…¶é»˜è®¤å€¼" class="headerlink" title="MySQL çš„æ—¥æœŸç±»å‹å¦‚ä½•è®¾ç½®å½“å‰æ—¶é—´ä¸ºå…¶é»˜è®¤å€¼"></a>MySQL çš„æ—¥æœŸç±»å‹å¦‚ä½•è®¾ç½®å½“å‰æ—¶é—´ä¸ºå…¶é»˜è®¤å€¼</h3><p>ä½¿ç”¨ timestamp ç±»å‹ï¼Œä¸” é»˜è®¤å€¼è®¾ä¸º now() æˆ– current_timestamp()</p><h2 id="å­˜å‚¨-url"><a href="#å­˜å‚¨-url" class="headerlink" title="å­˜å‚¨ url"></a>å­˜å‚¨ url</h2><p>mysql ç‰ˆæœ¬<br>ä½äº 5.0.3ï¼šTEXT<br>5.0.3 åŠå…¶ä»¥ä¸Šï¼švarChar(2083)</p><h2 id="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"><a href="#åˆ›å»ºå­˜å‚¨è¿‡ç¨‹" class="headerlink" title="åˆ›å»ºå­˜å‚¨è¿‡ç¨‹"></a>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹</h2><pre><code class="sql">CREATE PROCEDURE MailingListCount (OUT listCount INT)# å­˜å‚¨è¿‡ç¨‹ä½“å¼€å§‹BEGINDECLARE v_rows INT;SELECT COUNT(*) INTO v_rowsFROM CustomersWHERE NOT cust_email IS NULL;SET listCount=v_rows;END;# å­˜å‚¨è¿‡ç¨‹ä½“ç»“æŸ</code></pre><p>æŠ¥é”™ï¼šError code:1193,Unknown system variable â€˜listCountâ€™<br>è§£å†³ï¼š</p><pre><code class="sql">delimiter $$CREATE PROCEDURE MailingListCount (OUT `listCount` INT)BEGINDECLARE v_rows INT; SELECT COUNT(*) INTO v_rowsFROM CustomersWHERE NOT cust_email IS NULL;SET listCount=v_rows;END $$delimiter ;CALL MailingListCount(@result);SELECT @result;</code></pre><p>[æ³¨æ„]ï¼šoutå‚æ•°å¿…é¡»ä»¥<code>@</code>å¼€å¤´</p><h3 id="åˆ›å»ºä¸€ä¸ªæ–°è®¢å•"><a href="#åˆ›å»ºä¸€ä¸ªæ–°è®¢å•" class="headerlink" title="åˆ›å»ºä¸€ä¸ªæ–°è®¢å•"></a>åˆ›å»ºä¸€ä¸ªæ–°è®¢å•</h3><pre><code class="sql">delimiter $$CREATE PROCEDURE NewOrder(IN `cust_id` VARCHAR(10))BEGIN#ä¸ºè®¢å•å·å£°æ˜ä¸€ä¸ªå˜é‡DECLARE new_order_num INT; # è·å–å½“å‰æœ€å¤§è®¢å•å·,å†³å®šä¸‹ä¸€ä¸ªè®¢å•å·SET  new_order_num= MAX(order_num)+1;# æ’å…¥æ–°è®¢å•INSERT INTO Orders(order_num, order_date, cust_id) VALUES(new_order_num, CURRENT_TIMESTAMP(),@cust_id); END $$delimiter ;</code></pre>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®åº“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> SQL </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>äº‹ä»¶å¾ªç¯æœºåˆ¶</title>
      <link href="/2023/07/13/shi-jian-xun-huan-ji-zhi/"/>
      <url>/2023/07/13/shi-jian-xun-huan-ji-zhi/</url>
      
        <content type="html"><![CDATA[<p>JavaScript åœ¨ chrome çš„è¿è¡Œç¯å¢ƒæ˜¯ Google çš„ V8 å¼•æ“ï¼Œå®ƒçš„ç»“æ„å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š</p><img src="/2023/07/13/shi-jian-xun-huan-ji-zhi/js.png" class="" title="è¿è¡Œç¯å¢ƒç¤ºæ„å›¾"><p>ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼ŒV8 å¼•æ“ä¸»è¦åŒ…å« 2 éƒ¨åˆ†ï¼š</p><ul><li>å†…å­˜å †ï¼šè¿›è¡Œå†…å­˜åˆ†é…</li><li>è°ƒç”¨æ ˆï¼šå­˜å‚¨æ‰§è¡Œä¸Šä¸‹æ–‡<br>åŒæ—¶ä¹Ÿå¯ä»¥å‘ç°æˆ‘ä»¬å¹³æ—¶ç”¨çš„ setTimeout æˆ–è€… DOMï¼Œå¹¶ä¸å­˜åœ¨äº V8 å¼•æ“å†…éƒ¨ï¼Œè€Œæ˜¯æµè§ˆå™¨æä¾›çš„ï¼Œå®ƒä»¬ç»Ÿç§°ä¸º webAPIã€‚</li></ul><h2 id="è°ƒç”¨æ ˆ"><a href="#è°ƒç”¨æ ˆ" class="headerlink" title="è°ƒç”¨æ ˆ"></a>è°ƒç”¨æ ˆ</h2><p>JS æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œè¿™å°±æ„å‘³ç€å®ƒåªæœ‰ä¸€ä¸ªè°ƒç”¨æ ˆï¼Œå³åŒä¸€æ—¶é—´åªèƒ½æ‰§è¡Œä¸€ä¸ªä»»åŠ¡ã€‚å½“ç¨‹åºè¿›å…¥ä¸€ä¸ªå‡½æ•°æ—¶å€™ï¼Œå°†å…¶æ”¾åœ¨è°ƒç”¨æ ˆé¡¶å±‚ï¼Œå¦‚æœæ‰§è¡Œå®Œè¿™ä¸ªå‡½æ•°ï¼Œå°±å°†å®ƒä»è°ƒç”¨æ ˆé¡¶å±‚å¼¹å‡ºã€‚</p><pre><code class="javascript">function multiply(a, b) &#123;  return a * b;&#125;function square(n) &#123;  return multiply(n, n);&#125;function printSquare(n) &#123;  var squared = square(n);  console.log(squared);&#125;printSquare(4);</code></pre><p>å¯¹åº”çš„è°ƒç”¨æ ˆï¼š</p><img src="/2023/07/13/shi-jian-xun-huan-ji-zhi/stack.png" class="" title="æ ˆè¿‡ç¨‹ç¤ºæ„å›¾"><p>å †æ ˆæº¢å‡ºå°±æ˜¯å› ä¸ºè°ƒç”¨ä¸­çš„å‡½æ•°æ•°é‡è¶…å‡ºäº†è°ƒç”¨æ ˆçš„å®é™…å¤§å°</p><img src="/2023/07/13/shi-jian-xun-huan-ji-zhi/error.png" class=""><img src="/2023/07/13/shi-jian-xun-huan-ji-zhi/overflow.jpg" class="" title="æ ˆæº¢å‡º"><h2 id="å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜"><a href="#å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜" class="headerlink" title="å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜"></a>å•çº¿ç¨‹å¸¦æ¥çš„é—®é¢˜</h2><p>ç”±äº JS åªæœ‰ä¸€ä¸ªè°ƒç”¨æ ˆï¼Œå¦‚æœæœ‰å‡½æ•°éœ€è¦èŠ±è´¹å¤§é‡æ—¶é—´å¤„ç†ï¼Œæ¯”å¦‚ http è¯·æ±‚,è¯·æ±‚æœŸé—´ä¸èƒ½åšå…¶ä»–ä»»ä½•æ“ä½œï¼Œå¯¼è‡´é¡µé¢å¡ä½è¿è¡Œä¸æµç•…ã€‚å¯èƒ½æµè§ˆå™¨è¿˜ä¼šå¼¹å‡ºé”™è¯¯ï¼Œè¯¢é—®æ˜¯å¦åº”è¯¥ç»ˆæ­¢é¡µé¢ã€‚</p><h2 id="è§£å†³æ–¹æ³•ï¼šå¼‚æ­¥å›è°ƒå‡½æ•°"><a href="#è§£å†³æ–¹æ³•ï¼šå¼‚æ­¥å›è°ƒå‡½æ•°" class="headerlink" title="è§£å†³æ–¹æ³•ï¼šå¼‚æ­¥å›è°ƒå‡½æ•°"></a>è§£å†³æ–¹æ³•ï¼šå¼‚æ­¥å›è°ƒå‡½æ•°</h2><p>äº§ç”Ÿäº†äº‹ä»¶å¾ªç¯å’Œä»»åŠ¡é˜Ÿåˆ—çš„æ¦‚å¿µ<br>äº‹ä»¶å¾ªç¯çš„æœ¬è´¨æ˜¯ï¼šç›‘è§†è°ƒç”¨æ ˆå’Œä»»åŠ¡é˜Ÿåˆ—ã€‚å¦‚æœè°ƒç”¨æ ˆä¸ºç©ºï¼Œå®ƒå°†ä»é˜Ÿåˆ—ä¸­è·å–ç¬¬ä¸€ä¸ªäº‹ä»¶ï¼Œå¹¶å°†å…¶æ¨é€åˆ°è°ƒç”¨å †æ ˆï¼Œç„¶åè¿è¡Œå®ƒã€‚</p><p>å¼‚æ­¥ä»»åŠ¡ä¸»è¦åŒ…æ‹¬å®ä»»åŠ¡å’Œå¾®ä»»åŠ¡ï¼š<br>å®ä»»åŠ¡ï¼šsetTimeout&#x2F;setInterval,å›è°ƒå‡½æ•°å°†åœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ<br>å¾®ä»»åŠ¡ï¼šPromise,process.nextTick,å›è°ƒå‡½æ•°å°†ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¹‹å‰æ‰§è¡Œ,ä½œä¸ºæœ¬æ¬¡äº‹ä»¶å¾ªç¯çš„ task queue çš„é™„åŠ </p><h2 id="æ‰§è¡Œé¡ºåº"><a href="#æ‰§è¡Œé¡ºåº" class="headerlink" title="æ‰§è¡Œé¡ºåº"></a>æ‰§è¡Œé¡ºåº</h2><ol><li>ä¸»çº¿ç¨‹æ‰§è¡Œæ‰€æœ‰çš„åŒæ­¥ä»»åŠ¡ï¼Œç¢°åˆ°å¼‚æ­¥ä»»åŠ¡æ”¾åˆ°ä»»åŠ¡é˜Ÿåˆ—ä¸­</li><li>è°ƒç”¨æ ˆæ¸…ç©ºåï¼ŒæŸ¥çœ‹å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—</li><li>æŸ¥çœ‹æœ¬æ¬¡äº‹ä»¶å¾ªç¯ä¸­æ˜¯å¦æœ‰å¾®ä»»åŠ¡ï¼Œå¦‚æœæœ‰ï¼Œå°±ç«‹åˆ»æ‰§è¡Œå¾®ä»»åŠ¡</li><li>å¾®ä»»åŠ¡æ‰§è¡Œå®Œæˆåï¼Œå†å»å®ä»»åŠ¡é˜Ÿåˆ—ä¸­å–æ–°çš„å®ä»»åŠ¡æ”¾å…¥æ ˆä¸­</li></ol><pre><code class="javascript">console.log(&quot;1&quot;);setTimeout(function () &#123;  console.log(&quot;2&quot;);  process.nextTick(function () &#123;    console.log(&quot;3&quot;);  &#125;);  new Promise(function (resolve) &#123;    console.log(&quot;4&quot;);    resolve();  &#125;).then(function () &#123;    console.log(&quot;5&quot;);  &#125;);&#125;);process.nextTick(function () &#123;  console.log(&quot;6&quot;);&#125;);new Promise(function (resolve) &#123;  console.log(&quot;7&quot;);  resolve();&#125;).then(function () &#123;  console.log(&quot;8&quot;);&#125;);setTimeout(function () &#123;  console.log(&quot;9&quot;);  process.nextTick(function () &#123;    console.log(&quot;10&quot;);  &#125;);  new Promise(function (resolve) &#123;    console.log(&quot;11&quot;);    resolve();  &#125;).then(function () &#123;    console.log(&quot;12&quot;);  &#125;);&#125;);// 1,7,6,8,2,4,3,5,9,11,10,12</code></pre><h2 id="å…³äº-asnycâ€¦await-çš„ä¸€äº›ç»†èŠ‚"><a href="#å…³äº-asnycâ€¦await-çš„ä¸€äº›ç»†èŠ‚" class="headerlink" title="å…³äº asnycâ€¦await çš„ä¸€äº›ç»†èŠ‚"></a>å…³äº asnycâ€¦await çš„ä¸€äº›ç»†èŠ‚</h2><p>asyncâ€¦await çš„å‡ºç°æ˜¯ä¸ºäº†ç®€åŒ–ä½¿ç”¨å’Œç¼–å†™é“¾å¼ promise çš„è¿‡ç¨‹,ä½†æ˜¯ async å‡½æ•°ä¼šæ ¹æ®è¿”å›å€¼çš„ç±»å‹ï¼ŒV8 å¼•æ“çš„å¤„ç†æ–¹å¼ä¹Ÿä¸ä¸€æ ·ã€‚async å‡½æ•°åœ¨æŠ›å‡ºè¿”å›å€¼æ—¶ï¼Œä¼šæ ¹æ®<strong>è¿”å›å€¼ç±»å‹</strong>å¼€å¯<strong>ä¸åŒæ•°ç›®çš„å¾®ä»»åŠ¡</strong>ã€‚</p><h3 id="asyncå‡½æ•°è¿”å›å€¼ï¼š"><a href="#asyncå‡½æ•°è¿”å›å€¼ï¼š" class="headerlink" title="asyncå‡½æ•°è¿”å›å€¼ï¼š"></a>asyncå‡½æ•°è¿”å›å€¼ï¼š</h3><ol><li>è¿”å›å€¼é thenableï¼ˆé promiseï¼‰ï¼šä¸ç­‰å¾…</li></ol><pre><code class="javascript">async function testA() &#123;  return 1;&#125;testA().then(() =&gt; console.log(1));Promise.resolve()  .then(() =&gt; console.log(2))  .then(() =&gt; console.log(3));// (ä¸ç­‰å¾…)æœ€ç»ˆç»“æœğŸ‘‰: 1 2 3</code></pre><ol start="2"><li>è¿”å›å€¼ä¸º thenableï¼šç­‰å¾… 1 ä¸ª then çš„æ—¶é—´</li></ol><pre><code class="javascript">async function testB () &#123; Â  Â return &#123; Â  Â  Â  Â then (cb) &#123; Â  Â  Â  Â  Â  Â cb(); Â  Â  Â   &#125; Â   &#125;;&#125;testB().then(() =&gt; console.log(1));Promise.resolve() Â   .then(() =&gt; console.log(2)) Â   .then(() =&gt; console.log(3));â€‹// (ç­‰å¾…ä¸€ä¸ªthen)æœ€ç»ˆç»“æœğŸ‘‰: 2 1 3</code></pre><ol start="3"><li>è¿”å›å€¼ä¸º promise:ç­‰å¾… 2 ä¸ª then æ—¶é—´</li></ol><pre><code class="javascript">async function testC() &#123;  return new Promise((resolve, reject) =&gt; &#123;    resolve();  &#125;);&#125;testC().then(() =&gt; console.log(1));Promise.resolve()  .then(() =&gt; console.log(2))  .then(() =&gt; console.log(3))  .then(() =&gt; console.log(4));// (ç­‰å¾…ä¸¤ä¸ªthen)æœ€ç»ˆç»“æœğŸ‘‰: 2 3 1 4</code></pre><h3 id="await-å³å€¼ç±»å‹çš„åŒºåˆ«"><a href="#await-å³å€¼ç±»å‹çš„åŒºåˆ«" class="headerlink" title="await å³å€¼ç±»å‹çš„åŒºåˆ«"></a>await å³å€¼ç±»å‹çš„åŒºåˆ«</h3><ol><li>æ¥éthenableç±»å‹ï¼šä¼šç«‹å³å‘å¾®ä»»åŠ¡é˜Ÿåˆ—ä¸­æ·»åŠ ä¸€ä¸ªå¾®ä»»åŠ¡then,ä½†æ˜¯ä¸éœ€è¦ç­‰å¾…</li></ol><pre><code class="javascript">async function test () &#123; Â  Â console.log(1); Â  Â await 1; Â  Â console.log(2);&#125;test();console.log(3);// æœ€ç»ˆç»“æœğŸ‘‰: 1 3 2</code></pre><ol start="2"><li>æ¥thenableç±»å‹ï¼šéœ€è¦ç­‰å¾…ä¸€ä¸ª then çš„æ—¶é—´ä¹‹åæ‰§è¡Œ</li></ol><pre><code class="javascript">async function test () &#123; Â  Â console.log(1); Â  Â await &#123; Â  Â  Â  Â then (cb) &#123; Â  Â  Â  Â  Â  Â cb(); Â  Â  Â   &#125;, Â   &#125;; Â  Â console.log(2);&#125;â€‹test();console.log(3);â€‹Promise.resolve() Â   .then(() =&gt; console.log(4)) Â   .then(() =&gt; console.log(5)) Â   .then(() =&gt; console.log(6)) Â   .then(() =&gt; console.log(7));â€‹// æœ€ç»ˆç»“æœğŸ‘‰: 1 3 4 2 5 6 7</code></pre><ol start="3"><li>æ¥promiseç±»å‹ï¼ˆæœ‰ç¡®å®šçš„è¿”å›å€¼ï¼‰ï¼šç«‹å³å‘å¾®ä»»åŠ¡é˜Ÿåˆ—æ·»åŠ ä¸€ä¸ªå¾®ä»»åŠ¡thenï¼Œä½†ä¸éœ€ç­‰å¾…</li></ol><pre><code class="javascript">async function test () &#123; Â  Â console.log(1); Â  Â await new Promise((resolve, reject) =&gt; &#123; Â  Â  Â  Â resolve() Â   &#125;) Â  Â console.log(2);&#125;â€‹test();console.log(3);â€‹Promise.resolve() Â   .then(() =&gt; console.log(4)) Â   .then(() =&gt; console.log(5)) Â   .then(() =&gt; console.log(6)) Â   .then(() =&gt; console.log(7));â€‹// æœ€ç»ˆç»“æœğŸ‘‰: 1 3 2 4 5 6 7</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>event-loop</title>
      <link href="/2023/07/11/event-loop/"/>
      <url>/2023/07/11/event-loop/</url>
      
        <content type="html"><![CDATA[<p>ç”»å›¾å·¥å…·ï¼š<a href="https://www.liuchengtu.com/charts/">https://www.liuchengtu.com/charts/</a></p><h3 id="æœ¯è¯­è§£é‡Š"><a href="#æœ¯è¯­è§£é‡Š" class="headerlink" title="æœ¯è¯­è§£é‡Š"></a>æœ¯è¯­è§£é‡Š</h3><h4 id="å•çº¿ç¨‹ï¼š"><a href="#å•çº¿ç¨‹ï¼š" class="headerlink" title="å•çº¿ç¨‹ï¼š"></a>å•çº¿ç¨‹ï¼š</h4><p>å•çº¿ç¨‹&#x3D;&#x3D;æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªè°ƒç”¨æ ˆ&#x3D;&#x3D;ä¸€æ¬¡åšä¸€ä»¶äº‹æƒ…&#x3D;&#x3D;ç¨‹åºæ¯æ¬¡åªå¯ä»¥è¿è¡Œä¸€æ®µä»£ç </p><h4 id="è°ƒç”¨æ ˆï¼š"><a href="#è°ƒç”¨æ ˆï¼š" class="headerlink" title="è°ƒç”¨æ ˆï¼š"></a>è°ƒç”¨æ ˆï¼š</h4><p>è®°å½•å½“å‰ç¨‹åºæ‰€åœ¨ä½ç½®çš„æ•°æ®ç»“æ„ã€‚å¦‚æœå½“å‰è¿›å…¥äº†æŸä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¢«æ”¾å…¥æ ˆä¸­ï¼Œå¦‚æœå½“å‰ç¦»å¼€äº†æŸä¸ªå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°å°±ä¼šè¢«å¼¹å‡ºæ ˆå¤–</p><pre><code class="javascript">function multiply(a, b) &#123;  return a * b;&#125;function square(n) &#123;  return multiply(n, n);&#125;function printSquare(n) &#123;  var squared = square(n);  console.log(squared);&#125;printSquare(4);</code></pre><ol><li>main():æŒ‡ä»£æ–‡ä»¶è‡ªèº«ï¼Œæ”¾å…¥æ ˆä¸­</li><li>ä»ä¸Šåˆ°ä¸‹æŸ¥çœ‹å£°æ˜çš„å‡½æ•°ï¼Œæœ€åæ˜¯<code>printSquare</code>ï¼Œæœ€ç»ˆæ˜¯å…¶è¢«è°ƒç”¨</li><li>å°†<code>printSquare</code>æ¨å…¥æ ˆä¸­ï¼Œ<code>printSquare</code>è°ƒç”¨äº†<code>square</code></li><li>å°†<code>square</code>æ¨å…¥æ ˆä¸­ï¼Œ<code>square</code>è°ƒç”¨äº†<code>multiply</code></li><li>å°†<code>multiply</code>æ¨å…¥æ ˆä¸­</li><li>å¾—åˆ°<code>multiply</code>è¿”å›å€¼ï¼Œå°†<code>multiply</code>æ¨å‡ºæ ˆ</li><li>ä¾æ¬¡æ‰§è¡Œå¹¶å°†å‡½æ•°æ¨å‡ºæ ˆ</li></ol><img src="/2023/07/11/event-loop/stack.png" class="" title="æ ˆè¿‡ç¨‹ç¤ºæ„å›¾"><p>å¦‚æœæˆ‘ä»¬åœ¨ <code>multiply</code>ä¸­ä½¿ç”¨ throw æŠ›å‡ºé”™è¯¯ï¼Œåˆ™æ§åˆ¶å°ä¼šå‡ºç°ï¼š</p><pre><code class="javascript">preview-9c596f222c88a.js:2 Error: æŠ¥é”™ä¿¡æ¯    at multiply (script.js:2:11)    at square (script.js:5:12)    at printSquare (script.js:8:19)    at script.js:11:1</code></pre><p>å…¸å‹åœºæ™¯ï¼šå†…å­˜æº¢å‡º</p><img src="/2023/07/11/event-loop/overflow.jpg" class="" title="æ ˆæº¢å‡º"><p>æŠ¥é”™ä¿¡æ¯ï¼š</p><pre><code class="javascript">RangeError: Maximum call stack size exceeded    at foo (script.js:12:5)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)    at foo (script.js:12:12)</code></pre><h4 id="é˜»å¡"><a href="#é˜»å¡" class="headerlink" title="é˜»å¡:"></a>é˜»å¡:</h4><p>å®šä¹‰ï¼šæ²¡æœ‰ä¸¥æ ¼å®šä¹‰ï¼Œä»…ä»…æŒ‡çš„æ˜¯ä»£ç è¿è¡Œçš„å¾ˆæ…¢ï¼Œå³åœ¨æ ˆé‡Œè¡¨ç°å¾ˆæ…¢çš„ä¸œè¥¿éƒ½å«é˜»å¡</p><pre><code class="javascript">var foo = fetch(&quot;//foo.com&quot;);var boo = fetch(&quot;//boo.com&quot;);var coo = fetch(&quot;//coo.com&quot;);console.log(foo);console.log(boo);console.log(coo);</code></pre><img src="/2023/07/11/event-loop/fetch.png" class="" title="ç½‘ç»œè¯·æ±‚å¯¼è‡´çš„é˜»å¡"><p>å¦‚ä¸Šæ‰€ç¤ºï¼šå½“ä¸Šé¢æ‰€æœ‰çš„ä»£ç éƒ½è·‘ä¸€éï¼Œæ ˆæ‰ä¼šè¢«æ¸…ç©ºã€‚è€Œ JS æ˜¯å•çº¿ç¨‹è¯­è¨€ï¼Œæ‰€ä»¥æˆ‘ä»¬å¦‚æœè¯·æ±‚ä¸€ä¸ªèµ„æºï¼Œå°±åªèƒ½ç­‰ç€è¯·æ±‚å®Œæˆã€‚<br>å¯¼è‡´çš„é—®é¢˜ï¼šä»£ç éœ€è¦åœ¨æµè§ˆå™¨ä¸Šè¿è¡Œï¼Œè¯·æ±‚æœŸé—´ä¸èƒ½åšå…¶ä»–ä»»ä½•æ“ä½œï¼Œå¯¼è‡´é¡µé¢å¡ä½è¿è¡Œä¸æµç•…</p><h3 id="V8-è¿è¡Œç¯å¢ƒ"><a href="#V8-è¿è¡Œç¯å¢ƒ" class="headerlink" title="V8 è¿è¡Œç¯å¢ƒ"></a>V8 è¿è¡Œç¯å¢ƒ</h3><img src="/2023/07/11/event-loop/js.png" class="" title="è¿è¡Œç¯å¢ƒç¤ºæ„å›¾"><h4 id="V8-å¼•æ“ã€V8-chrome-ä¸­çš„è¿è¡Œç¯å¢ƒã€‘"><a href="#V8-å¼•æ“ã€V8-chrome-ä¸­çš„è¿è¡Œç¯å¢ƒã€‘" class="headerlink" title="V8 å¼•æ“ã€V8 chrome ä¸­çš„è¿è¡Œç¯å¢ƒã€‘"></a>V8 å¼•æ“ã€V8 chrome ä¸­çš„è¿è¡Œç¯å¢ƒã€‘</h4><ul><li>å † heap:è®°å½•å†…å­˜åˆ†é…</li><li>æ ˆ stack: å­˜å‚¨æ‰§è¡Œä¸Šä¸‹æ–‡</li></ul><h4 id="V8-å¤–éƒ¨ã€æµè§ˆå™¨æä¾›ã€‘"><a href="#V8-å¤–éƒ¨ã€æµè§ˆå™¨æä¾›ã€‘" class="headerlink" title="V8 å¤–éƒ¨ã€æµè§ˆå™¨æä¾›ã€‘"></a>V8 å¤–éƒ¨ã€æµè§ˆå™¨æä¾›ã€‘</h4><ul><li>webAPI<ul><li>DOM</li><li>Ajax</li><li>SetTimeout</li></ul></li><li>Callback queue</li><li>event loop</li></ul><h2 id="é˜»å¡çš„è§£å†³æ–¹æ³•"><a href="#é˜»å¡çš„è§£å†³æ–¹æ³•" class="headerlink" title="é˜»å¡çš„è§£å†³æ–¹æ³•"></a>é˜»å¡çš„è§£å†³æ–¹æ³•</h2><h3 id="æä¾›å›è°ƒå‡½æ•°"><a href="#æä¾›å›è°ƒå‡½æ•°" class="headerlink" title="æä¾›å›è°ƒå‡½æ•°"></a>æä¾›å›è°ƒå‡½æ•°</h3><p>å‰æï¼šæµè§ˆå™¨å’Œ node ä¸­å‡ ä¹æ²¡æœ‰é˜»å¡çš„å‡½æ•°,éƒ½æ˜¯éåŒæ­¥ï¼ˆå¼‚æ­¥ï¼‰çš„</p><pre><code class="javascript">console.log(&quot;hi&quot;);setTimeout(() =&gt; &#123;  console.log(&quot;there&quot;);&#125;, 5000);console.log(&quot;end&quot;);</code></pre><img src="/2023/07/11/event-loop/timout.png" class="" title="setTimeoutçš„æ ˆ"><p>ä¸ºä»€ä¹ˆå‘¢ï¼ŸåŸå› æ˜¯ä¸€æ¬¡åšä¸€ä»¶äº‹æƒ…æŒ‡çš„æ˜¯ js Runtime åªèƒ½åŒæ—¶åšä¸€ä»¶äº‹ï¼Œä½†æµè§ˆå™¨ä¸æ­¢æœ‰ RuntTimeï¼Œè¿˜æä¾›äº†å…¶ä»–çš„ä¸œè¥¿ã€‚æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åŒæ—¶åšå¤šä»¶äº‹,ajax è¯·æ±‚ç­‰å…¶ä»– webAPI åŒç†</p><img src="/2023/07/11/event-loop/loop.png" class=""><p>æ³¨æ„ï¼šä»»åŠ¡é˜Ÿåˆ—ä¸­çš„å›è°ƒå‡½æ•°å¿…é¡»ç­‰ stack ä¸­æ¸…ç©ºäº†æ‰èƒ½å…¥æ ˆæ‰§è¡Œã€‚</p><h3 id="Promise"><a href="#Promise" class="headerlink" title="Promise"></a>Promise</h3><p>å®ä»»åŠ¡ï¼šsetTimeout&#x2F;setInterval,å›è°ƒå‡½æ•°å°†åœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¸­æ‰§è¡Œ<br>å¾®ä»»åŠ¡ï¼šPromise,å›è°ƒå‡½æ•°å°†ä¼šåœ¨ä¸‹ä¸€ä¸ªäº‹ä»¶å¾ªç¯ä¹‹å‰æ‰§è¡Œ,ä½œä¸ºæœ¬æ¬¡äº‹ä»¶å¾ªç¯çš„ task queue çš„é™„åŠ </p><h3 id="asynâ€¦await"><a href="#asynâ€¦await" class="headerlink" title="asynâ€¦await"></a>asynâ€¦await</h3><p>ç®€åŒ–ä½¿ç”¨å’Œç¼–å†™é“¾å¼ promise çš„è¿‡ç¨‹ï¼Œè¿”å›å€¼ä¸º promise<br>å¤šä¸ªè¯·æ±‚å†™æ³•ï¼š</p><pre><code class="javascript">async function getAdd() &#123;  let [street, city, state] = await Promise.all([getStreet, getCity, getState]);&#125;</code></pre><h2 id="async-å‡½æ•°è¿”å›å€¼"><a href="#async-å‡½æ•°è¿”å›å€¼" class="headerlink" title="async å‡½æ•°è¿”å›å€¼"></a>async å‡½æ•°è¿”å›å€¼</h2><p>æ ¹æ®è¿”å›å€¼çš„ç±»å‹ï¼ŒV8 å¼•æ“å¯¹è¿”å›å€¼çš„å¤„ç†æ–¹å¼ä¹Ÿä¸ä¸€æ ·<br>ç»“è®ºï¼šasync å‡½æ•°åœ¨æŠ›å‡ºè¿”å›å€¼æ—¶ï¼Œä¼šæ ¹æ®<strong>è¿”å›å€¼ç±»å‹</strong>å¼€å¯<strong>ä¸åŒæ•°ç›®çš„å¾®ä»»åŠ¡</strong></p><h3 id="thenable"><a href="#thenable" class="headerlink" title="thenable"></a>thenable</h3><p>æ˜¯ä¸€ä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°<br>åˆ¤æ–­æ ‡å‡†ï¼šæŸä¸ªå¯¹è±¡æˆ–è€…å‡½æ•°æ˜¯å¦å…·æœ‰ then(â€¦)æ–¹æ³•æ¥åˆ¤æ–­</p><pre><code class="javascript">if (  p !== null &amp;&amp;  (typeof p === &quot;object&quot; || typeof p === &quot;function&quot;) &amp;&amp;  typeof p.then === &quot;function&quot;) &#123;  //thenable&#125; else &#123;  //éthenable&#125;</code></pre><ul><li>é thenableï¼Œé promiseï¼šä¸ç­‰å¾…</li></ul><pre><code class="js">async function testA() &#123;  return 1;&#125;testA().then(() =&gt; console.log(1));Promise.resolve()  .then(() =&gt; console.log(2))  .then(() =&gt; console.log(3));// (ä¸ç­‰å¾…)æœ€ç»ˆç»“æœğŸ‘‰: 1 2 3</code></pre><ul><li>thenableï¼šç­‰å¾… 1 ä¸ª then çš„æ—¶é—´</li></ul><pre><code class="javascript">async function testB () &#123;  Â  Â return &#123;  Â  Â  Â  Â then (cb) &#123;  Â  Â  Â  Â  Â  Â cb();  Â  Â  Â   &#125;  Â   &#125;; &#125; testB().then(() =&gt; console.log(1)); Promise.resolve()  Â   .then(() =&gt; console.log(2))  Â   .then(() =&gt; console.log(3));// (ç­‰å¾…ä¸€ä¸ªthen)æœ€ç»ˆç»“æœğŸ‘‰: 2 1 3</code></pre><ul><li>promise:ç­‰å¾… 2 ä¸ª then çš„æ—¶é—´</li></ul><pre><code class="javascript">async function testC () &#123;Â  Â  return new Promise((resolve, reject) =&gt; &#123;Â  Â  Â  Â  resolve()Â  Â  &#125;)&#125;testC().then(() =&gt; console.log(1));Promise.resolve()Â  Â  .then(() =&gt; console.log(2))Â  Â  .then(() =&gt; console.log(3));// (ç­‰å¾…ä¸¤ä¸ªthen)æœ€ç»ˆç»“æœğŸ‘‰: 2 3 1</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>useEffectEventçš„å‰ä¸–ä»Šç”Ÿ</title>
      <link href="/2023/07/06/useeffectevent-de-qian-shi-jin-sheng/"/>
      <url>/2023/07/06/useeffectevent-de-qian-shi-jin-sheng/</url>
      
        <content type="html"><![CDATA[<p>å»å¹´ React å›¢é˜Ÿåˆ†äº«äº†ä¸€ä¸ªæ–° Hook <code>useEvent</code> çš„<a href="https://github.com/reactjs/rfcs/pull/220">RFC220</a>,å®Œæ•´ RFC å†…å®¹è§<a href="https://github.com/reactjs/rfcs/blob/useevent/text/0000-useevent.md">useEvent</a>ã€‚è¿™ä¸ª Hook çš„æ¥æºæ˜¯<a href="https://github.com/facebook/react/issues/14099">#14099</a>ã€‚ useEvent çš„<a href="https://github.com/facebook/react/pull/25229">åŸå‹</a>å·²ç»å®ç°ï¼Œä½†æ˜¯ä»Šå¹´ 1 æœˆä»½å…³é—­äº†<code>useEvent</code>ææ¡ˆï¼Œä¸ºä»€ä¹ˆä¼šå…³é—­å‘¢ï¼Œä¸»è¦æœ‰ä»¥ä¸‹å‡ ä¸ªåŸå› ï¼š</p><ol><li>å°†æ¸²æŸ“ä¼˜åŒ–å’Œâ€œä¿®å¤â€Effect è€¦åˆåœ¨ä¸€ä¸ªææ¡ˆä¸‹ï¼Œå¾ˆéš¾å®ç°</li><li>å®¹æ˜“è¯±å¯¼å¼€å‘è€…å°†å½“å‰ä½¿ç”¨ <code>useCallback</code> åŒ…è£¹çš„å‡½æ•°éƒ½æ›¿æ¢æˆ <code>useEvent</code></li></ol><p>ä½†æ˜¯å…³é—­ææ¡ˆå¹¶ä¸æ„å‘³ç€å…¨ç›˜å¦å®šï¼Œäº‹å®ä¸Šï¼Œåªæ˜¯å¯¹å…¶è¿›è¡Œäº†æ‹†åˆ†ã€‚é’ˆå¯¹æ¸²æŸ“ä¼˜åŒ–ï¼ŒReact å›¢é˜Ÿå‡†å¤‡å¼€å‘ä¸€ä¸ª<a href="https://www.youtube.com/watch?v=lGEMwh32soc">è‡ªåŠ¨è®°å¿†ç¼–è¯‘å™¨</a>ï¼Œè€Œé’ˆå¯¹ä¿®å¤ Effectï¼Œåˆ™å‘å¸ƒäº†ä¸€ä¸ª <code>useEffectEvent</code>çš„æ–°çš„ Hookã€‚</p><p>å®˜æ–¹ä¹‹å‰åœ¨ RFC ç»™å‡ºçš„ useEvent çš„å¤§æ¦‚å®ç°å¦‚ä¸‹æ‰€ç¤ºï¼Œå½“ç„¶è¿™ä¸æ˜¯çœŸæ­£çš„å®ç°ï¼ŒçœŸæ­£çš„å®ç°è‚¯å®šæ¯”è¿™ä¸ªå¤æ‚å¾—å¤šï¼š</p><pre><code class="javascript">// (!) Approximate behaviorfunction useEvent(handler) &#123;  const handlerRef = useRef(null);  // æ¸²æŸ“ä¹‹å‰è¿è¡Œ  useLayoutEffect(() =&gt; &#123;    handlerRef.current = handler;  &#125;);  return useCallback((...args) =&gt; &#123;    // æ¸²æŸ“æœŸé—´æ‰§è¡Œçš„è¯ï¼Œä¼šæŠ›å‡ºé”™è¯¯    const fn = handlerRef.current;    return fn(...args);  &#125;, []);&#125;</code></pre><p>ä¸‹é¢å°±å€ŸåŠ©ä»£ç æ¥è®²è¿°ä¸€ä¸‹è¿™ä¸ªæ–°çš„ Hook åº”è¯¥æ€ä¹ˆä½¿ç”¨ã€‚<br>å½“å‰å­˜åœ¨çš„é—®é¢˜ï¼š<br>ä½ åˆ›å»ºäº†ä¸€ä¸ªèŠå¤©è¿æ¥ï¼ŒæŠŠå½“å‰çš„ message å­˜å‚¨åœ¨ state å˜é‡ä¸­ï¼Œæ¯æ¬¡è¾“å…¥çš„æ—¶å€™æ›´æ–° message,å½“ç”¨æˆ·å‡†å¤‡å¥½åå°±å¯ä»¥å‘é€ã€‚</p><pre><code class="javascript">function Chat() &#123;  const [message, setMessage] = React.useState(&quot;&quot;);  const sendMessage = (val) =&gt; &#123;    console.log(val);  &#125;;  const onSend = () =&gt; &#123;    sendMessage(message);  &#125;;  return (    &lt;&gt;      &lt;Input onSend=&#123;onSend&#125; setMessage=&#123;setMessage&#125; /&gt;    &lt;/&gt;  );&#125;</code></pre><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œç”±äº <code>onSend</code> çš„å‡½æ•°å¼•ç”¨æ¯æ¬¡éƒ½ä¼šå˜åŒ–ï¼Œå³æ¯æ¬¡çš„ <code>onSend</code> éƒ½æ˜¯é‡æ–°åˆ›å»ºçš„ä¸åŒçš„å‡½æ•°ï¼Œè¿™ä¼šç›´æ¥ç ´å Input ç»„ä»¶çš„ memo æ•ˆæœï¼ŒåŸå› æ˜¯å½“ä¸€ä¸ªç»„ä»¶è¢« memoize å,ä¼šå¯¹ props è¿›è¡Œæµ…å±‚æ¯”è¾ƒæ¥å†³å®šæ˜¯å¦éœ€è¦é‡æ–°æ¸²æŸ“ã€‚å¦‚æœ props æ˜¯â€œæµ…ç›¸ç­‰â€(åŒä¸€ä¸ªå¼•ç”¨),å°±è·³è¿‡é‡æ–°æ¸²æŸ“ã€‚è€Œ <code>onSend</code> æ¯æ¬¡éƒ½è·Ÿä¸Šä¸€æ¬¡ä¸ä¸€æ ·ã€‚</p><p>é‚£å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿå¾ˆæ˜æ˜¾å¯ä»¥ä½¿ç”¨<code>useCallback</code>åŒ…è£¹<code>onSend</code>å‡½æ•°ï¼Œä¿è¯åªæœ‰ state å˜é‡å˜åŒ–æ—¶ï¼Œ<code>onSend</code>å‡½æ•°æ‰ä¼šè¢«é‡æ–°åˆ›å»ºã€‚</p><pre><code class="javascript">const onSend = React.useCallback(() =&gt; &#123;  sendMessage(message);&#125;, [message]);</code></pre><p>é€šè¿‡è¿™ä¸ªä¿®æ”¹ï¼ŒInput ç»„ä»¶åªæœ‰åœ¨ <code>onSend</code> å‡½æ•°é‡æ–°åˆ›å»ºçš„æ—¶å€™ <code>Input</code> ç»„ä»¶æ‰ä¼šé‡æ–°æ¸²æŸ“ã€‚ä½†æ˜¯è¿™æ ·å¹¶ä¸å®Œå…¨å¥‘åˆæˆ‘ä»¬çš„é¢„æœŸï¼Œå› ä¸ºæ¯å½“ message å˜åŒ–ï¼Œ <code>onSend</code> å‡½æ•°è¿˜æ˜¯ä¼šè¢«é‡æ–°åˆ›å»ºã€‚ä½†æ˜¯å¦‚æœå»æ‰ä¾èµ–é¡¹ï¼Œå°±è·å–ä¸åˆ°æœ€æ–°çš„ message å€¼ã€‚</p><img src="/2023/07/06/useeffectevent-de-qian-shi-jin-sheng/recreate.png" class=""><p>è¿˜å¯ä»¥é€šè¿‡ ref ä¿®å¤è¿™ä¸ªé—®é¢˜:ä½¿ç”¨ sendRef å­˜å‚¨äº‹ä»¶å¤„ç†å‡½æ•°ï¼Œè¿™æ ·ä½ è¾“å…¥çš„æ—¶å€™ onSend å‡½æ•°ä¼šä¸€ç›´ä¿æŒä¸ºåŒä¸€ä¸ªå‡½æ•°æ ‡è¯†ç¬¦</p><pre><code class="javascript">const sendRef = React.useRef(null);React.useLayoutEffect(() =&gt; &#123;  sendRef.current = () =&gt; sendMessage(message);&#125;);const onSend = React.useCallback((...args) =&gt; &#123;  return sendRef.current(...args);&#125;, []);</code></pre><p>å°½ç®¡è¿™ä¸ªæ–¹æ³•èƒ½è§£å†³æˆ‘ä»¬çš„é—®é¢˜ï¼Œä½†æ˜¯å¾ˆæ˜æ˜¾ç‰ºç‰²äº†ä»£ç å¯è¯»æ€§ã€‚åŸºäºä»¥ä¸Šçš„é—®é¢˜ï¼ŒReact å›¢é˜Ÿæ¨å‡ºäº†ä¸€ä¸ªæ–°çš„ Hook <code>useEffectEvent</code>ï¼Œä½¿ç”¨èµ·æ¥éå¸¸æ–¹ä¾¿ã€‚</p><p>ä½†æ˜¯å› ä¸ºè¿™ä¸ª Hook ç›®å‰è¿˜æ²¡æœ‰åœ¨ç¨³å®šç‰ˆ React ä¸­å‘å¸ƒï¼Œæ‰€ä»¥éœ€è¦å…ˆå®‰è£…å®éªŒç‰ˆæœ¬çš„ React</p><pre><code class="bash">npm install react@experimentalnpm install react-dom@experimentalnpm install eslint-plugin-react-hooks@experimental</code></pre><p>ç°åœ¨åªéœ€è¦ç›´æ¥ç”¨ <code>useEffectEvent</code> å°†å›è°ƒå‡½æ•°åŒ…è£¹èµ·æ¥å°±å¯ä»¥</p><pre><code class="javascript">import &#123; experimental_useEffectEvent as useEffectEvent &#125; from &quot;react&quot;;const onSend = React.experimental_useEffectEvent(() =&gt; &#123;  sendMessage(message);&#125;);</code></pre><p>æ–°çš„ Hook useEffectEvent å…è®¸ç”¨æˆ·å®šä¹‰ä¸€ä¸ªå‡½æ•°ï¼Œå¯ä»¥ä¸€ç›´è¯»å–åˆ°æœ€æ–°çš„ props&#x2F;stateï¼Œä½†æ˜¯å’Œè¿™ä¸ªå‡½æ•°ä¼šæœ‰ä¸€ä¸ªç¨³å®šçš„æ ‡è¯†ç¬¦ï¼Œæ‰€ä»¥ä»–ä¸ä¼šç ´åç¼“å­˜ï¼Œä¹Ÿä¸ä¼šé‡æ–°è§¦å‘ Effect,å¯ä»¥å‡å°‘ä¸å¿…è¦çš„æ¸²æŸ“ã€‚å®ƒå’Œ <code>useCallback</code> çš„åŒºåˆ«æ˜¯:</p><ol><li>é‡æ¸²æŸ“æ¬¡æ•°çš„æ˜¾è‘—ä¸åŒï¼š<img src="/2023/07/06/useeffectevent-de-qian-shi-jin-sheng/retrigger.png" class=""></li><li>useEffectEvent ä¸éœ€è¦ä¾èµ–é¡¹åˆ—è¡¨</li></ol><p>useEvent çš„è¿”å›å€¼ï¼Œå®ƒçš„è¡Œä¸ºå°±å’Œæ™®é€šå‡½æ•°ä¸€æ ·ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç»™ä»–ä¼ é€’å‚æ•°ï¼Œæ¯”å¦‚ <code>roomID</code></p><pre><code class="javascript">const onSend = useEffectEvent((roomID) =&gt; &#123;  sendMessage(roomID, message);&#125;);onSend(roomID);</code></pre><p>å›åˆ° Chat ç»„ä»¶ï¼Œæ¯å½“ roomID å˜åŒ–æ—¶å°±å±•ç¤ºä¸€ä¸ªæˆåŠŸçš„ alert å¹¶æ¸…ç©º message,ä½¿ç”¨ useEffect å¯ä»¥è¾¾åˆ°ç›®çš„ã€‚</p><pre><code class="javascript">function Chat() &#123;  const [message, setMessage] = React.useState(&quot;&quot;);  const [roomID, setRoomID] = React.useState(&quot;reavel&quot;);  const sendMessage = (val) =&gt; &#123;    console.log(val);  &#125;;  const onSend = React.experimental_useEffectEvent(() =&gt; &#123;    sendMessage(message);  &#125;);  React.useEffect(() =&gt; &#123;    if (!!roomID) &#123;      showNotification(&quot;Changed room-&gt;&quot; + roomID, &quot;dark&quot;);      setMessage(&quot;&quot;);    &#125;  &#125;, [roomID]);  return (    &lt;&gt;      &lt;div&gt;        &lt;select          onChange=&#123;(e) =&gt; &#123;            setRoomID(e.target.value);          &#125;&#125;        &gt;          &lt;option value=&quot;travel&quot;&gt;travel room&lt;/option&gt;          &lt;option value=&quot;music&quot;&gt;music room&lt;/option&gt;          &lt;option value=&quot;sport&quot;&gt;sport room&lt;/option&gt;        &lt;/select&gt;      &lt;/div&gt;      &lt;Input onSend=&#123;onSend&#125; setMessage=&#123;setMessage&#125; message=&#123;message&#125; /&gt;    &lt;/&gt;  );&#125;</code></pre><p>ä½†æ˜¯å¦‚æœ toast æ˜¯ä»å½“å‰çš„ä¸»é¢˜ä¸Šä¸‹æ–‡ä¸­è¯»å–çš„è¯ï¼Œä»£ç æ£€æŸ¥å·¥å…·ä¼šæç¤ºä½ éœ€è¦å°† theme æ·»åŠ åˆ°ä¾èµ–é¡¹ä¸­</p><pre><code class="javascript">function Chat() &#123;  const theme = useContext(ThemeContext);  const [message, setMessage] = useState(&quot;&quot;);  const onSend = useEffectEvent(() =&gt; &#123;    setMessage(message);  &#125;);  React.useEffect(() =&gt; &#123;    if (!!roomID) &#123;      showNotification(&quot;Changed room-&gt;&quot; + roomID, theme);      setMessage(&quot;&quot;);    &#125;  &#125;, [roomID, theme]);  return &lt;Input onSend=&#123;onSend&#125; /&gt;;&#125;</code></pre><p>å®é™…ä¸Šä¸»é¢˜è‰²å˜åŒ–çš„æ—¶å€™ï¼Œè¿æ¥çš„æˆ¿é—´å¹¶æ²¡å‘ç”Ÿå˜åŒ–ï¼Œæ‰€ä»¥å®é™…ä¸Šæˆ‘ä»¬å¹¶ä¸éœ€è¦é‡æ–°å±•ç¤ºæ¶ˆæ¯ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>useCallback</code> å°†ä»£ç ä» <code>useEffect</code> ä¸­æå–å‡ºæ¥ã€‚</p><pre><code class="javascript">const theme = useContext(ThemeContext);const onChangedRoom = useCallback(() =&gt; &#123;  showNotification(&quot;Changed room-&gt;&quot; + roomID, theme);  setMessage(&quot;&quot;);&#125;, [theme]);useEffect(() =&gt; &#123;  onChangedRoom();&#125;, [roomID]);return &lt;Input onSend=&#123;onSend&#125; /&gt;;</code></pre><p>ä½†æ˜¯å› ä¸º <code>useEffectEvent</code> åœ¨é˜²æ­¢ä¸å¿…è¦çš„é‡æ¸²æŸ“ä¸Šæ›´æœ‰æ„ä¹‰,æ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ <code>useEffectEvent</code> åŒ…è£¹å¯¹åº”çš„ä»£ç ï¼Œä½¿å®ƒå˜æˆéå“åº”å¼ä»£ç ã€‚</p><pre><code class="javascript">const theme = useContext(ThemeContext);const onChangedRoom = useEffectEvent(() =&gt; &#123;  showNotification(&quot;Changed room-&gt;&quot; + roomID, theme);  setMessage(&quot;&quot;);&#125;);useEffect(() =&gt; &#123;  onChangedRoom();&#125;, [roomID]);return &lt;Input onSend=&#123;onSend&#125; /&gt;;</code></pre><p>è¿™æ ·æ—¢å‡å°‘äº†ä¸å¿…è¦çš„é‡æ¸²æŸ“ï¼Œä»£ç å¯è¯»æ€§ä¹Ÿå¾—åˆ°äº†æ”¹å–„ã€‚</p><p>é‚£å“ªäº›æƒ…å†µä¸é€‚åˆç”¨ useEffectEvent å‘¢ï¼Ÿå³éœ€è¦åœ¨æ¸²æŸ“æœŸé—´è°ƒç”¨çš„å‡½æ•°,å› ä¸º useEffectEvent åœ¨æ¸²æŸ“æœŸé—´è¿è¡Œä¼šæŠ›å‡ºé”™è¯¯</p><pre><code class="javascript">function ThemedGrid() &#123;  const theme = useContext(ThemeContext);  const renderItem = useCallback(    (item) =&gt; &#123;      // æ¸²æŸ“æœŸé—´è°ƒç”¨ï¼Œæ‰€ä»¥ä»–ä¸æ˜¯ä¸€ä¸ªäº‹ä»¶      return &lt;Row &#123;...item&#125; theme=&#123;theme&#125; /&gt;;    &#125;,    [theme]  );  return &lt;Grid renderItem=&#123;renderItem&#125; /&gt;;&#125;</code></pre><p>ä»£ç ï¼š<a href="https://stackblitz.com/edit/stackblitz-starters-ida8fu">https://stackblitz.com/edit/stackblitz-starters-ida8fu</a></p>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-useEffectEvent-is-coming-to-React</title>
      <link href="/2023/07/03/fan-yi-useeffectevent-is-coming-to-react/"/>
      <url>/2023/07/03/fan-yi-useeffectevent-is-coming-to-react/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://vived.io/useeffectevent-is-coming-to-react-frontend-weekly-vol-118/">https://vived.io/useeffectevent-is-coming-to-react-frontend-weekly-vol-118/</a></p><h2 id="useEvent-å·²æ­»-useEffectEvent-ä¸‡å²ï¼"><a href="#useEvent-å·²æ­»-useEffectEvent-ä¸‡å²ï¼" class="headerlink" title="useEvent å·²æ­», useEffectEvent ä¸‡å²ï¼"></a>useEvent å·²æ­», useEffectEvent ä¸‡å²ï¼</h2><p>å…­ä¸ªå¤šæœˆå‰ï¼ŒReact å›¢é˜Ÿå‘å…¨ä¸–ç•Œåˆ†äº«äº†ä¸€ä¸ªæœ‰å…³æ–° hook <code>useEvent</code> çš„æ„è§å¾æ±‚ã€‚å®ƒæœ¬è¯¥è¿”å›ä¸€ä¸ªç¨³å®šçš„å‡½æ•°å¼•ç”¨ã€‚åŒæ—¶å‡½æ•°å†…çš„ state ä¹Ÿåº”è¯¥æ€»æ˜¯å¯¹åº”ç»„ä»¶çš„å½“å‰ stateã€‚è¿™ç§è¡Œä¸ºå¯ä»¥éå¸¸æœ‰æ•ˆåœ°ä¼˜åŒ–ä¸å¿…è¦çš„æ¸²æŸ“ã€‚</p><pre><code class="javascript">function Chat() &#123;  const [text, setText] = useState(&#39;&#39;);  // ğŸŸ¡ åªè¦`text` å˜åŒ–ï¼Œå°±è¿”å›ä¸€ä¸ªä¸åŒçš„å‡½æ•°  const onClick = useCallback(() =&gt; &#123;    sendMessage(text);  &#125;, [text]);  return &lt;SendButton onClick=&#123;onClick&#125; /&gt;;&#125;</code></pre><pre><code class="javascript">function Chat() &#123;  const [text, setText] = useState(&#39;&#39;);  // âœ…æ€»æ˜¯è¿”å›ç›¸åŒçš„å‡½æ•° (å³ä½¿ `text` å˜åŒ–)  const onClick = useEvent(() =&gt; &#123;    sendMessage(text);  &#125;);  return &lt;SendButton onClick=&#123;onClick&#125; /&gt;;&#125;</code></pre><p>ä¸å¹¸çš„æ˜¯ï¼ŒRFC å®Œæˆäº†å®ƒçš„å·¥ä½œå¹¶å±•å¼€äº†è®¸å¤šè®¨è®ºã€‚æœ€ç»ˆï¼Œè¿™äº›è®¨è®ºå¼•å‘äº†äº† Hook åˆ›å»ºè€…å¿ƒé‡Œçš„ç–‘è™‘ï¼Œä»–ä»¬å†³å®šæš‚åœå…¶å®ç°ã€‚æ­¤æ—¶ä¸¤ä¸ªåå¯¹çš„è®ºæ®æµ®å‡ºäº†æ°´é¢ã€‚é¦–å…ˆï¼Œç”¨æˆ·å¯èƒ½ä¼šè¿™ä¸ªæ–° Hook å½“åšä¼˜åŒ–ç‰ˆçš„<code>useCallback</code>ï¼Œå°†ä¸¤è€…æ··æ·†ã€‚äº‹å®ä¸Šï¼Œè¿™ä¸¤ä¸ª hook æœ¬åº”è¯¥æœ‰ç¨å¾®ä¸åŒçš„åŠŸèƒ½ã€‚å…¶æ¬¡ï¼Œé™¤äº† <code>useEvent</code> ä¹‹å¤–ï¼Œå¼€å‘è€…è¿˜è‡´åŠ›äºå¼€å‘ä¸€ä¸ªèƒ½å¤Ÿå®ç°å‡½æ•°è°ƒç”¨è‡ªåŠ¨ç¼“å­˜çš„ç¼–è¯‘å™¨ã€‚åŒæ—¶å¤„ç†è¿™ä¸¤ä¸ªåŠŸèƒ½å¤ªéº»çƒ¦äº†ã€‚</p><blockquote><p>å½“ä¸€ä¸ªå‡½æ•°æ¥æ”¶ç›¸åŒçš„å‚æ•°æ—¶,å¹¶ä¸éœ€è¦é‡æ–°è®¡ç®—ç»“æœ,è€Œæ˜¯ç›´æ¥ä½¿ç”¨ç¼“å­˜çš„ç»“æœã€‚è¿™å°±æ˜¯ memoization çš„å·¥ä½œåŸç†ã€‚</p></blockquote><p>æ‰€æœ‰è¿¹è±¡éƒ½è¡¨æ˜ <code>useEvent</code> å°†ä¼šä»¥å¦ä¸€ç§å½¢å¼å›åˆ°æˆ‘ä»¬è§†é‡ã€‚ä¸€ä¸ªç¥ç§˜çš„PRå‡ºç°åœ¨äº†Reactçš„ä»“åº“ä¸­ã€‚å®ƒå°† <code>useEvent</code> é‡å‘½åä¸º  <code>useEffectEvent</code> ,ä¸”ç¨å¾®æ”¹å˜äº†ä¸€ä¸‹å®ƒçš„è¡Œä¸ºã€‚ä»ç°åœ¨èµ·ï¼Œè¿™ä¸ªå‡½æ•°ä¸ä¼šè¿”å›ä¸€ä¸ªç¨³å®šçš„å¼•ç”¨ï¼Œä½†æ˜¯ä½ ä»ç„¶å¯ä»¥åœ¨<code>useEffect</code> ä¸­å¼•ç”¨å®ƒï¼Œè€Œä¸éœ€è¦å°†å…¶æŒ‡å®šä¸ºä¾èµ–é¡¹ã€‚</p><pre><code class="javascript">function Chat() &#123;  const [text, setText] = useState(&#39;&#39;);  const [state, setState] = useState&lt;State&gt;(&#39;INITIAL&#39;);  const onHappened = useEffectEvent(() =&gt; &#123;    logValueToAnalytics(text);  &#125;);  useEffect(() =&gt; &#123;    onHappened();  &#125;, [state]);  return (/*...*/);&#125;</code></pre><p>ç°åœ¨è¿™ä¸ªPRè¿˜æ²¡æœ‰å®Œæ•´çš„RFCæ–‡æ¡£æè¿°ï¼Œæ‰€ä»¥å¾ˆéš¾é¢„æµ‹<code>useEffectEvent</code> çš„æœªæ¥æˆ–è€…å¯¹ä»–çš„åŠŸèƒ½åšå‡ºæ›´æ¸…æ¥šçš„ç»“è®ºã€‚æ¯«æ— ç–‘é—®ï¼Œå½“RFCæœ€ç»ˆå‡ºç°çš„æ—¶å€™ï¼Œä¼šæä¾›æ›´å¤šçš„ä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”ä½ è‚¯å®šä¼šåœ¨æˆ‘ä»¬çš„å‘¨æŠ¥ä¸­è¯»åˆ°å®ƒã€‚</p><p>å‚è€ƒé“¾æ¥ï¼š</p><ol><li><a href="https://github.com/facebook/react/pull/25881">useEvent å‘½åä¸º useEffectEvent</a></li><li><a href="https://github.com/reactjs/rfcs/blob/useevent/text/0000-useevent.md">useEvent å®Œæ•´ææ¡ˆ</a></li><li><a href="https://github.com/reactjs/rfcs/pull/220">useEvent ææ¡ˆæè¿°</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åšè‡ªå·±çš„githubä»‹ç»é¡µé¢</title>
      <link href="/2023/06/27/ru-he-zuo-zi-ji-de-github-jie-shao-ye-mian/"/>
      <url>/2023/06/27/ru-he-zuo-zi-ji-de-github-jie-shao-ye-mian/</url>
      
        <content type="html"><![CDATA[<h2 id="æµç¨‹"><a href="#æµç¨‹" class="headerlink" title="æµç¨‹"></a>æµç¨‹</h2><ol><li>æ–°å»ºåŒåä»“åº“ï¼Œæ¯”å¦‚ GitHub çš„ç”¨æˆ·åæ˜¯<code>earthaYan</code>ï¼Œåˆ™æ–°å»ºä»“åº“<code>earthaYan</code>ï¼Œè€Œä¸æ˜¯<code>earthaYan.github.io</code></li><li>æ–°å»ºæ—¶ä»“åº“é€‰æ‹© public å¹¶ä¸”ç”Ÿæˆ README.md</li><li>ç¼–è¾‘ README æ–‡ä»¶</li></ol><h2 id="æ–‡ç« ç¼–è¾‘"><a href="#æ–‡ç« ç¼–è¾‘" class="headerlink" title="æ–‡ç« ç¼–è¾‘"></a>æ–‡ç« ç¼–è¾‘</h2><h3 id="æ·»åŠ -banner-å›¾ç‰‡"><a href="#æ·»åŠ -banner-å›¾ç‰‡" class="headerlink" title="æ·»åŠ  banner å›¾ç‰‡"></a>æ·»åŠ  banner å›¾ç‰‡</h3><pre><code class="html">&lt;picture&gt;  &lt;source    media=&quot;(prefers-color-scheme: dark)&quot;    srcset=&quot;https://github.com/earthaYan/earthaYan/blob/main/3072.webp&quot;  /&gt;  &lt;source    media=&quot;(prefers-color-scheme: light)&quot;    srcset=&quot;https://github.com/earthaYan/earthaYan/blob/main/3072.webp&quot;  /&gt;  &lt;img    alt=&quot;Shows an illustrated sun in light mode and a moon with stars in dark mode.&quot;    src=&quot;https://github.com/earthaYan/earthaYan/blob/main/3072.webp&quot;  /&gt;&lt;/picture&gt;</code></pre><h3 id="æ·»åŠ -github-stats"><a href="#æ·»åŠ -github-stats" class="headerlink" title="æ·»åŠ  github stats"></a>æ·»åŠ  github stats</h3><pre><code class="md">[![earthaYançš„ GitHub](https://github-readme-stats.vercel.app/api?username=earthaYan&amp;show_icons=true&amp;title_color=fff&amp;icon_color=79ff97&amp;text_color=9f9f9f&amp;bg_color=151515)](https://github.com/earthaYan)</code></pre><h3 id="æ·»åŠ ä½¿ç”¨çš„è¯­è¨€"><a href="#æ·»åŠ ä½¿ç”¨çš„è¯­è¨€" class="headerlink" title="æ·»åŠ ä½¿ç”¨çš„è¯­è¨€"></a>æ·»åŠ ä½¿ç”¨çš„è¯­è¨€</h3><pre><code class="md">&lt;a href=&quot;#&quot;&gt;&lt;img src=&quot;https://github-readme-stats-crlnmfdzg-tifan.vercel.app/api/top-langs/?username=earthaYan&amp;langs_count=8&amp;layout=compact&quot; height=&quot;160&quot; /&gt;&lt;/a&gt;</code></pre><h3 id="æ·»åŠ æŠ€èƒ½"><a href="#æ·»åŠ æŠ€èƒ½" class="headerlink" title="æ·»åŠ æŠ€èƒ½"></a>æ·»åŠ æŠ€èƒ½</h3><pre><code class="md">[![My Skills](https://skillicons.dev/icons?i=go,docker,express)](https://skillicons.dev)</code></pre><h2 id="å‚è€ƒé“¾æ¥"><a href="#å‚è€ƒé“¾æ¥" class="headerlink" title="å‚è€ƒé“¾æ¥"></a>å‚è€ƒé“¾æ¥</h2><p><a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-github-profile/customizing-your-profile/managing-your-profile-readme">manage github profile</a><br><a href="https://github.com/anuraghazra/github-readme-stats">github stats</a><br><a href="https://www.webfx.com/tools/emoji-cheat-sheet/">emoji</a><br><a href="https://github.com/tandpfun/skill-icons">skills icon</a></p>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•åœ¨centosä¸Šè¿è¡Œcobraåˆ›å»ºçš„å‘½ä»¤</title>
      <link href="/2023/05/24/ru-he-zai-centos-shang-yun-xing-cobra-chuang-jian-de-ming-ling/"/>
      <url>/2023/05/24/ru-he-zai-centos-shang-yun-xing-cobra-chuang-jian-de-ming-ling/</url>
      
        <content type="html"><![CDATA[<ol><li>ç¼–å†™æºç </li></ol><pre><code class="go">package mainimport (  &quot;fmt&quot;  &quot;github.com/spf13/cobra&quot;)var rootCmd = &amp;cobra.Command&#123;  Use:   &quot;demo&quot;,  Short: &quot;A brief description of your application&quot;,  Run: func(cmd *cobra.Command, args []string) &#123;    fmt.Println(&quot;Hello CentOS!&quot;)  &#125;,&#125;func main() &#123;  rootCmd.Execute()&#125;</code></pre><ol start="2"><li>æœ¬åœ°ç¼–è¯‘ï¼Œç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶<br><code>go build -o demo main.go</code></li><li>è¿è¡Œdemoå‘½ä»¤<br><code>./demo</code></li><li>éå¿…é€‰ï¼šå°†demoå‘½ä»¤æ·»åŠ åˆ°centosçš„å…¨å±€ç¯å¢ƒä¸­<br><code>mv demo /usr/local/bin </code></li><li>æ¥ä¸‹æ¥å°±å¯ä»¥ç›´æ¥é€šè¿‡demoå‘½ä»¤åœ¨ä»»ä½•ç›®å½•ä¸‹æ‰§è¡Œè¯¥åº”ç”¨</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>React_Routerä¸­çš„Prompt</title>
      <link href="/2023/05/23/react-router-zhong-de-prompt/"/>
      <url>/2023/05/23/react-router-zhong-de-prompt/</url>
      
        <content type="html"><![CDATA[<p>web ä¸­çš„<code>Prompt</code>ç»„ä»¶æ˜¯ä»æ ¸å¿ƒçš„<code>Prompt</code>ä¸­äºŒæ¬¡å¯¼å‡ºçš„ã€‚</p><h2 id="æ¦‚è§ˆ"><a href="#æ¦‚è§ˆ" class="headerlink" title="æ¦‚è§ˆ"></a>æ¦‚è§ˆ</h2><ul><li>ä½œç”¨ï¼šåœ¨ä»ä¸€ä¸ªé¡µé¢å¯¼èˆªç¦»å¼€ä¹‹å‰ç»™ç”¨æˆ·æç¤ºã€‚</li><li>åœºæ™¯ï¼šåº”ç”¨å¤„åœ¨ä¸€ä¸ªåº”è¯¥é˜»æ­¢ç”¨æˆ·ç¦»å¼€å½“å‰é¡µé¢çš„çŠ¶æ€</li><li>å®é™…åœºæ™¯ï¼šè¡¨å•å¡«äº†ä¸€åŠï¼Œç”¨æˆ·æƒ³è¦ç¦»å¼€</li><li>ä½¿ç”¨ï¼š</li></ul><pre><code class="jsx">&lt;Prompt when=&#123;formIsHalfFilledOut&#125; message=&quot;Are you sure you want to leave?&quot; /&gt;</code></pre><h2 id="å‚æ•°è¯¦è§£"><a href="#å‚æ•°è¯¦è§£" class="headerlink" title="å‚æ•°è¯¦è§£"></a>å‚æ•°è¯¦è§£</h2><h3 id="when"><a href="#when" class="headerlink" title="when"></a>when</h3><h4 id="boolean"><a href="#boolean" class="headerlink" title="boolean"></a>boolean</h4><p>å¯ä»¥ç›´æ¥ä¼ å†™æ­»çš„å¸ƒå°”å€¼ï¼Œè€Œä¸æ˜¯æœ‰æ¡ä»¶åœ°åœ¨å®ˆå«åé¢æ¸²æŸ“<code>Prompt</code></p><ol><li>true:é˜»æ­¢å¯¼èˆª</li><li>falseï¼šå…è®¸å¯¼èˆª</li></ol><h3 id="message"><a href="#message" class="headerlink" title="message"></a>message</h3><h4 id="string"><a href="#string" class="headerlink" title="string"></a>string</h4><p>å½“ç”¨æˆ·è¯•å›¾ç¦»å¼€å½“å‰é¡µæ—¶ï¼Œä¼šç»™ç”¨æˆ·è¿™ä¸ªå­—ç¬¦ä¸²ä¿¡æ¯</p><img src="/2023/05/23/react-router-zhong-de-prompt/prompt.jpeg" class=""><h4 id="function"><a href="#function" class="headerlink" title="function"></a>function</h4><pre><code class="jsx">export function Users() &#123;  return (    &lt;React.Fragment&gt;      &lt;Prompt        message=&#123;(nextLocation, action) =&gt; &#123;          if (action === &#39;POP&#39;) &#123;            console.log(&#39;Backing up...&#39;);          &#125;          return nextLocation.pathname.startsWith(&#39;/app&#39;)            ? false            : `Are you sure you want to go to $&#123;location.pathname&#125;?`;        &#125;&#125;      /&gt;      &lt;h2&gt;Users&lt;/h2&gt;    &lt;/React.Fragment&gt;  );&#125;</code></pre><p>ä¼šåœ¨è¿›å…¥ç”¨æˆ·è¯•å›¾å¯¼èˆªè¿›å…¥çš„ä¸‹ä¸€ä¸ª <code>location</code>å’Œ <code>action</code>ä¹‹å‰è¢«è°ƒç”¨ã€‚<br>è¿”å›å€¼ï¼š</p><ol><li>stringï¼šå‘ç”¨æˆ·å±•ç¤ºä¸€ä¸ªæç¤º,ç”¨æˆ·ç‚¹å‡»ç¡®å®šåè·³è½¬ï¼Œç‚¹å‡»å–æ¶ˆåœç•™åœ¨åŸåœ°</li><li>trueï¼šå…è®¸è¿™ä¸ªè¿‡åº¦ï¼Œç›´æ¥è·³è½¬åˆ°nextLocation</li><li>false:ä¸å…è®¸è¿‡åº¦ï¼Œä¸”ç‚¹å‡»linkæ— ååº”</li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>pflagç¬”è®°</title>
      <link href="/2023/05/19/pflag-bi-ji/"/>
      <url>/2023/05/19/pflag-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>å‰æï¼špflag æ˜¯å®Œå…¨å…¼å®¹ flag çš„</p><h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p>å®‰è£…ï¼š<code>go get github.com/spf13/pflag</code><br>æµ‹è¯•ï¼š<code>go test github.com/spf13/pflag</code></p><h2 id="åœ¨åŒ…ä¸­å¼•å…¥å¹¶å®šä¹‰-flag"><a href="#åœ¨åŒ…ä¸­å¼•å…¥å¹¶å®šä¹‰-flag" class="headerlink" title="åœ¨åŒ…ä¸­å¼•å…¥å¹¶å®šä¹‰ flag"></a>åœ¨åŒ…ä¸­å¼•å…¥å¹¶å®šä¹‰ flag</h2><p><code>import flag &quot;github.com/spf13/pflag&quot;</code></p><ul><li>ä½¿ç”¨ lag.String(),Bool(),Int()ç­‰å£°æ˜ flag<br><code>var ip *int = flag.Int(&quot;flagName&quot;, 1234, &quot;help message for flagName&quot;)</code></li><li>ä½¿ç”¨ Var()å‡½æ•°å°† flag ç»‘å®šåˆ°ä¸€ä¸ªå˜é‡</li></ul><pre><code class="go">var ipFlag intflag.IntVar(&amp;ipFlag,&quot;flagName&quot;,1234,&quot;help message from flagName&quot;)</code></pre><ul><li>åˆ›å»ºæ»¡è¶³ Value æ¥å£çš„è‡ªå®šä¹‰ flag</li></ul><pre><code class="go">type Duration time.Durationfunc (d *Duration) Set(s string) error &#123;  // è§£æsä¸º Duration å¹¶ä¿å­˜&#125;func (d *Duration) Type() string &#123;  return &quot;duration&quot;&#125;func (d *Duration) String() string &#123;  return time.Duration(*d).String()&#125;var duration Durationpflag.Var(&amp;duration, &quot;duration&quot;, &quot;Some duration&quot;)</code></pre><p>å½“ä½ åœ¨å‘½ä»¤è¡Œå‚æ•°ä¸­ä¼ å…¥<code>--duration=1m30s</code>å:</p><ol><li>pflag æ‰¾åˆ° Duration ç±»å‹å¹¶è°ƒç”¨ Set(â€œ1m30sâ€)</li><li>Set()æ–¹æ³•ä½¿ç”¨æŒ‡é’ˆæ¥æ”¶å™¨è§£æè¯¥å€¼å¹¶ä¿å­˜åœ¨ Duration çš„å†…éƒ¨å­—æ®µä¸­</li><li>duration ç°åœ¨ä¿å­˜ä¼ é€’çš„å€¼(90 ç§’)</li><li>é€šè¿‡ duration.String()æˆ–ç›´æ¥ä½¿ç”¨ duration çš„å€¼è®¿é—®è§£æåçš„å€¼</li></ol><h2 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h2><p>å‰æï¼šæ‰€æœ‰çš„ flag éƒ½å®šä¹‰å¥½äº†<br>æ–¹æ³•ï¼š<code>flag.Parse()</code></p><pre><code class="go">    var ip *int = flag.Int(&quot;ip&quot;, 123, &quot;help message from ip&quot;)    var ipFlag int    flag.IntVar(&amp;ipFlag, &quot;ipFlag&quot;, 1234, &quot;help message from ipFlag&quot;)    flag.Parse()    fmt.Println(*ip,ipFlag)</code></pre><p>æ‰§è¡Œ<code>go run . --ipFlag=12 --ip=345</code>,è¿è¡Œç»“æœä¸º 345,12</p><h3 id="flagSet"><a href="#flagSet" class="headerlink" title="flagSet"></a>flagSet</h3>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>githubçš„å¸¸ç”¨æ“ä½œ</title>
      <link href="/2023/05/05/github-de-chang-yong-cao-zuo/"/>
      <url>/2023/05/05/github-de-chang-yong-cao-zuo/</url>
      
        <content type="html"><![CDATA[<p><a href="https://github.com/FrontEndGitHub/FrontEndGitHub/issues/4">https://github.com/FrontEndGitHub/FrontEndGitHub/issues/4</a></p><p>issue æ ‡ç­¾é¡µï¼š</p><ul><li>æŸ¥è¯¢æ‰€æœ‰çŠ¶æ€ä¸º open çš„ issue<br><code>is:issue is:open</code></li><li>æŸ¥è¯¢æ‰€æœ‰çŠ¶æ€ä¸º open çš„ PR<br><code>is:pr is:open</code></li><li>æŸ¥è¯¢æŒ‡å®šå‘å¸ƒè€…çš„ issue<br><code>is:issue author:_author_name_</code></li><li>æŸ¥è¯¢è‡ªå·±çš„ issue<br><code>is:issue author:@me</code></li><li>æŸ¥è¯¢æŒ‡å®šæ ‡ç­¾çš„ issue<br><code>is:issue label:&quot;_label_name_&quot;</code></li><li>æŸ¥è¯¢æ²¡æœ‰æŒ‡å®šæ ‡ç­¾çš„issue<br><code>is:issue no:label</code></li></ul>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Reactçš„createPortal</title>
      <link href="/2023/04/25/react-de-createportal/"/>
      <url>/2023/04/25/react-de-createportal/</url>
      
        <content type="html"><![CDATA[<h1 id="React-createPortal"><a href="#React-createPortal" class="headerlink" title="React.createPortal()"></a>React.createPortal()</h1><p>ä½œç”¨ï¼šæŠŠéƒ¨åˆ†å­ç»„ä»¶æ¸²æŸ“åˆ°ä¸åŒäºçˆ¶ç»„ä»¶ DOM èŠ‚ç‚¹çš„æŒ‡å®š DOM èŠ‚ç‚¹</p><p>ä½¿ç”¨ï¼š<br><code>React.createPortal(children,domNode)</code></p><h2 id="åŸºæœ¬ä½¿ç”¨"><a href="#åŸºæœ¬ä½¿ç”¨" class="headerlink" title="åŸºæœ¬ä½¿ç”¨"></a>åŸºæœ¬ä½¿ç”¨</h2><pre><code class="javascript">import &#123; createPortal &#125; from &#39;react-dom&#39;;&lt;div&gt;  &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;  &#123;createPortal(    &lt;p&gt;This child is placed in the document body.&lt;/p&gt;,    document.body  )&#125;&lt;/div&gt;;</code></pre><h2 id="é™åˆ¶"><a href="#é™åˆ¶" class="headerlink" title="é™åˆ¶"></a>é™åˆ¶</h2><p>portal åªä¼šæ”¹å˜ DOM èŠ‚ç‚¹çš„ç‰©ç†ä½ç½®ï¼Œä½†æ˜¯æ¸²æŸ“æˆ portal çš„ JSX ä»ç„¶æ˜¯æ¸²æŸ“ JSX çš„ React ç»„ä»¶çš„å­èŠ‚ç‚¹ã€‚</p><ul><li>å­ç»„ä»¶ä»ç„¶å¯ä»¥è®¿é—®çˆ¶ç»„ä»¶æ ‘æä¾›çš„ä¸Šä¸‹æ–‡</li><li>äº‹ä»¶æ ¹æ® React æ ‘ä»å­çº§å†’æ³¡åˆ°çˆ¶çº§</li></ul><h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="å…¥å‚"><a href="#å…¥å‚" class="headerlink" title="å…¥å‚"></a>å…¥å‚</h3><ol><li>children:å¯ä»¥ä½¿ç”¨ React æ¸²æŸ“çš„ï¼šJSX ç‰‡æ®µï¼Œ&lt;&gt;&lt;&#x2F;&gt;,å­—ç¬¦ä¸²ï¼Œæ•°å­—ï¼Œæˆ–è€…ä¸€ç»„è¿™äº›å…ƒç´ </li><li>domNode:å·²ç»å­˜åœ¨çš„ DOM èŠ‚ç‚¹ï¼Œåœ¨æ›´æ–°æœŸé—´ä¼ ä¸åŒçš„ DOM èŠ‚ç‚¹ä¼šå¯¼è‡´ä¸æ–­é‡å»º portal å†…å®¹</li></ol><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><p>è¿”å›ä¸€ä¸ªå¯ä»¥åŒ…å«åœ¨ JSX ä¸­æˆ–è€…å¯ä»¥ä» React ç»„ä»¶è¿”å›çš„ React èŠ‚ç‚¹</p><h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><ul><li>æ¥è‡ª portal çš„äº‹ä»¶æ˜¯æ ¹æ® React æ ‘ä¼ æ’­è€Œä¸æ˜¯ DOM æ ‘ã€‚</li></ul><pre><code class="html">&lt;div id=&quot;root&quot;&gt;&lt;/div&gt;&lt;div id=&quot;name&quot;&gt;111&lt;/div&gt;&lt;script&gt;  //ç‚¹å‡»Demoç»„ä»¶portalç»„ä»¶ä¸­çš„pæ—¶ï¼Œç‚¹å‡»äº‹ä»¶ä¸ä¼šå†’æ³¡åˆ°domæ ‘çš„èŠ‚ç‚¹ï¼Œè¿™é‡Œä¸ä¼šæ‰§è¡Œ  document.getElementById(&#39;name&#39;).onclick = function () &#123;    console.log(&#39;hello world&#39;);  &#125;;&lt;/script&gt;</code></pre><pre><code class="jsx">import &#123; createPortal &#125; from &#39;react-dom&#39;;const Demo = () =&gt; &#123;  return (    // ç‚¹å‡»Demoç»„ä»¶portalç»„ä»¶ä¸­çš„pæ—¶ï¼Œè¿™é‡Œçš„onClickä¼šæ‰§è¡Œï¼Œå› ä¸ºReactç»„ä»¶æ ‘çš„äº‹ä»¶å†’æ³¡    &lt;div style=&#123;&#123; border: '2px solid black' &#125;&#125; onClick=&#123;()=&gt;console.log(&quot;root div click&quot;)&#125;&gt;      &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;      &#123;createPortal(        &lt;p onClick=&#123;() =&gt; console.log(&#39;portal click&#39;)&#125;&gt;          This child is placed in the name        &lt;/p&gt;,        document.getElementById(&#39;name&#39;) as Element      )&#125;    &lt;/div&gt;  );&#125;;</code></pre><ul><li>æŒ‚è½½èŠ‚ç‚¹å¿…é¡»æ˜¯å·²ç»å­˜åœ¨çš„èŠ‚ç‚¹ï¼Œä¸å¯ä»¥æ˜¯å½“å‰ JSX ç‰‡æ®µä¸­çš„ dom èŠ‚ç‚¹</li></ul><pre><code class="jsx">// æ­£å¸¸å±•ç¤ºconst App1 = () =&gt; &#123;  const [popupContainer, setPopupContainer] = React.useState(null);  React.useEffect(() =&gt; &#123;    const popupDiv = document.getElementById(&#39;sister&#39;);    setPopupContainer(popupDiv);  &#125;, []);  return (    &lt;React.Fragment&gt;      &lt;div id=&quot;sister&quot;&gt;å¤–éƒ¨å…„å¼Ÿ&lt;/div&gt;      &lt;div id=&quot;container&quot;&gt;        &lt;div id=&quot;inner&quot;&gt;å†…éƒ¨å…„å¼Ÿ&lt;/div&gt;        &#123;/* æ­£å¸¸å±•ç¤º1 */&#125;        &#123;!!popupContainer &amp;&amp; createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, popupContainer)&#125;        &#123;/* æ­£å¸¸å±•ç¤º2 */&#125;        &#123;document.getElementById(&#39;sister&#39;) &amp;&amp;          createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, document.getElementById(&#39;sister&#39;))&#125;        &#123;/* æŠ¥é”™:Target container is not a DOM element. */&#125;        &#123;createPortal(&lt;p&gt;portalå†…å®¹&lt;/p&gt;, document.getElementById(&#39;sister&#39;))&#125;      &lt;/div&gt;    &lt;/React.Fragment&gt;  );&#125;;export default App1;</code></pre><h2 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h2><h3 id="åˆ›å»º-portal"><a href="#åˆ›å»º-portal" class="headerlink" title="åˆ›å»º portal"></a>åˆ›å»º portal</h3><pre><code class="jsx">import &#123; createPortal &#125; from &#39;react-dom&#39;;export default function MyComponent() &#123;  return (    &lt;div style=&#123;&#123; border: '2px solid black' &#125;&#125;&gt;      &lt;p&gt;This child is placed in the parent div.&lt;/p&gt;      &#123;createPortal(        &lt;p&gt;This child is placed in the document body.&lt;/p&gt;,        document.body      )&#125;    &lt;/div&gt;  );&#125;</code></pre><img src="/2023/04/25/react-de-createportal/portal1.jpg" class=""><h3 id="ä½¿ç”¨-portal-æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—"><a href="#ä½¿ç”¨-portal-æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—" class="headerlink" title="ä½¿ç”¨ portal æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—"></a>ä½¿ç”¨ portal æ¸²æŸ“å¯¹è¯æ¡†å¼¹çª—</h3><p>å¯ä»¥é¿å…è°ƒç”¨åœ¨å¯¹è¯æ¡†çš„ç»„ä»¶ä½¿ç”¨äº† overflow:hidden æˆ–è€…å…¶ä»–æ ·å¼çš„æƒ…å†µä¸‹ï¼Œä¸èƒ½å±•ç¤ºæ‚¬æµ®å¯¹è¯æ¡†</p><h3 id="åœ¨é-React-æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“-React-ç»„ä»¶"><a href="#åœ¨é-React-æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“-React-ç»„ä»¶" class="headerlink" title="åœ¨é React æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“ React ç»„ä»¶"></a>åœ¨é React æœåŠ¡ç«¯é¡µé¢æ ‡è®°æ¸²æŸ“ React ç»„ä»¶</h3><p>React root å¦‚æœæ˜¯é React æ„å»ºçš„é™æ€é¡µé¢æˆ–è€…æœåŠ¡ç«¯æ¸²æŸ“é¡µé¢çš„ä¸€éƒ¨åˆ†ï¼Œå°±å¯ä»¥åˆ©ç”¨ portals åœ¨é™æ€åŒºåŸŸåˆ›å»ºäº¤äº’åŒºåŸŸï¼Œæ¯”å¦‚ sideBars</p><p>ä¸å¤š React root çš„åŒºåˆ«ï¼š</p><ul><li>å³ä½¿å†…éƒ¨æ¸²æŸ“æˆ DOM çš„ä¸åŒéƒ¨åˆ†ï¼Œportal ä¹Ÿå¯ä»¥å°†è¿™ä¸ªåº”ç”¨ä½œä¸ºä¸€ä¸ª<font color="red">çŠ¶æ€å…±äº«</font>çš„ React æ ‘å»å¯¹å¾…</li></ul><p>å®Œæ•´ä»£ç è§:<a href="https://stackblitz.com/edit/react-ts-cwfhhp?file=index.html,style.css">https://stackblitz.com/edit/react-ts-cwfhhp?file=index.html,style.css</a></p><h3 id="åœ¨é-React-çš„-DOM-èŠ‚ç‚¹æ¸²æŸ“-React-ç»„ä»¶"><a href="#åœ¨é-React-çš„-DOM-èŠ‚ç‚¹æ¸²æŸ“-React-ç»„ä»¶" class="headerlink" title="åœ¨é React çš„ DOM èŠ‚ç‚¹æ¸²æŸ“ React ç»„ä»¶"></a>åœ¨é React çš„ DOM èŠ‚ç‚¹æ¸²æŸ“ React ç»„ä»¶</h3><p>ç”¨ portal ç®¡ç† React å¤–éƒ¨çš„ DOM èŠ‚ç‚¹çš„å†…å®¹ã€‚</p><pre><code class="jsx">const App = () =&gt; &#123;  // 1. å®šä¹‰çŠ¶æ€å˜é‡popupContainerå­˜å‚¨è¦æ¸²æŸ“çš„ç›®æ ‡èŠ‚ç‚¹  const [popupContainer, setPopupContainer] = useState(null);  useEffect(() =&gt; &#123;    if (mapRef.current === null) &#123;      const map = createMapWidget(containerRef.current);      mapRef.current = map;      // 2. å½“åˆ›å»ºç¬¬ä¸‰æ–¹ç»„ä»¶æ—¶ï¼Œå­˜å‚¨ç»„ä»¶è¿”å›çš„DOM èŠ‚ç‚¹ï¼Œè¿™æ ·ä½ å¯ä»¥å°†å†…å®¹æ¸²æŸ“åˆ°è¿™ä¸ªDOMèŠ‚ç‚¹      const popupDiv = addPopupToMapWidget(map);      setPopupContainer(popupDiv);    &#125;  &#125;, []);  return (    &lt;div style=&#123;&#123; width: 250, height: 250 &#125;&#125; ref=&#123;containerRef&#125;&gt;      &#123;/* ä¸€æ—¦popupContainerå˜æˆå¯è®¿é—®çŠ¶æ€ï¼Œ    ä½¿ç”¨createPortalæ¸²æŸ“Reactå†…å®¹åˆ°popupContainerå®¹å™¨ä¸­ */&#125;      &#123;popupContainer !== null &amp;&amp;        createPortal(&lt;p&gt;Hello from React!&lt;/p&gt;, popupContainer)&#125;    &lt;/div&gt;  );&#125;;</code></pre><p>å®Œæ•´ä¾‹å­è§ï¼š<a href="https://stackblitz.com/edit/react-ts-cwfhhp?file=App.tsx">https://stackblitz.com/edit/react-ts-cwfhhp?file=App.tsx</a></p><pre><code class="jsx">// æ ¸å¿ƒä»£ç export default function App() &#123;  const containerRef = React.useRef(null);  const mapRef = React.useRef(null);  const [popupContainer, setPopupContainer] = React.useState(null);  React.useEffect(() =&gt; &#123;    if (mapRef.current === null) &#123;      const map = createMapWidget(containerRef.current);      mapRef.current = map;      const popupDiv = addPopupToMapWidget(map);      setPopupContainer(popupDiv);    &#125;  &#125;, []);  return (    &lt;div style=&#123;&#123; width: 250, height: 250 &#125;&#125; ref=&#123;containerRef&#125;&gt;      &#123;popupContainer !== null &amp;&amp;        createPortal(&lt;p&gt;Hello from React!&lt;/p&gt;, popupContainer)&#125;    &lt;/div&gt;  );&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> react </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>unit-test-with-react</title>
      <link href="/2023/04/18/fan-yi-unit-test-with-react/"/>
      <url>/2023/04/18/fan-yi-unit-test-with-react/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<br><a href="https://blog.openreplay.com/unit-testing-with-the-react-testing-library/">https://blog.openreplay.com/unit-testing-with-the-react-testing-library/</a></p><h1 id="ä½¿ç”¨-React-Testing-Library-è¿›è¡Œå•å…ƒæµ‹è¯•"><a href="#ä½¿ç”¨-React-Testing-Library-è¿›è¡Œå•å…ƒæµ‹è¯•" class="headerlink" title="ä½¿ç”¨ React Testing Library è¿›è¡Œå•å…ƒæµ‹è¯•"></a>ä½¿ç”¨ React Testing Library è¿›è¡Œå•å…ƒæµ‹è¯•</h1><p>å•å…ƒæµ‹è¯•æ˜¯ä¸€ç§ç”¨æ¥æµ‹è¯•å•ç‹¬çš„ä»£ç ç‰‡æ®µçš„æµ‹è¯•æ–¹æ³•ï¼Œæ¯”å¦‚ function æˆ–è€… class,é€šè¿‡è¿™ç§æµ‹è¯•æ–¹æ³•æ¥ç¡®ä¿ä»£ç æ­£å¸¸å·¥ä½œã€‚å½“åœ¨ React ä¸­æ‰§è¡Œå•å…ƒæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬å°†ç»„ä»¶ä¸åº”ç”¨å…¶ä»–éƒ¨åˆ†éš”ç¦»ï¼Œå¯¹è¿™ä¸ªç»„ä»¶è¿›è¡Œå•ç‹¬æµ‹è¯•ã€‚å•å…ƒæµ‹è¯•ç›®çš„æ˜¯åœ¨å¼€å‘è¿›ç¨‹æ—©æœŸå°±å¯ä»¥æ•è· bugï¼Œé¿å…é—®é¢˜å‡ºç°åœ¨æœ€ç»ˆçš„ç”Ÿäº§ç¯å¢ƒä¸­ã€‚å®ƒç»™æˆ‘ä»¬å¸¦æ¥äº†è®¸å¤šå¥½å¤„ï¼Œè¿™è®©å•å…ƒæµ‹è¯•åœ¨ web å¼€å‘è¿›ç¨‹ä¸­å˜æˆäº†å¿…éœ€å“ã€‚ä¸‹é¢æ˜¯æ‰§è¡Œè¿™ä¸ªè¿‡ç¨‹çš„ä¸€äº›åŸå› ï¼š</p><ul><li><strong>æ—©æœŸ bug æ£€æµ‹</strong>: å•å…ƒæµ‹è¯•å¯ä»¥å¸®åŠ©æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹æ—©æœŸè¯†åˆ«å‡º bugï¼Œé¿å…å˜å¾—æ›´å¤æ‚å’Œä¸å®¹æ˜“ä¿®å¤ã€‚</li><li><strong>å¢å¼ºå¯¹ä¿®æ”¹çš„ä¿¡å¿ƒ</strong>:å•å…ƒæµ‹è¯•æä¾›äº†ä¸€ä¸ªç®€å•çš„é€”å¾„è¯æ˜ä»£ç ä¿®æ”¹ä¸ä¼šç ´åå·²å­˜åœ¨çš„åŠŸèƒ½ã€‚</li><li><strong>èƒ½å¤Ÿèµ·åˆ°æ–‡æ¡£çš„ä½œç”¨</strong>: å•å…ƒæµ‹è¯•ä½œä¸ºä»£ç æ–‡æ¡£çš„ä¸€ç§å½¢å¼è€Œå­˜åœ¨ï¼Œä¸ºæˆ‘ä»¬å¯¹äºä»£ç å¦‚ä½•å·¥ä½œæä¾›äº†æ¸…æ™°çš„è®¤è¯†ã€‚</li><li><strong>ä½¿å¼€å‘æ›´å¿«</strong>: å•å…ƒæµ‹è¯•æä¾›äº†åœ¨æŸæ®µæ—¶é—´å†…åªæµ‹è¯•ä¸€å°éƒ¨åˆ†ä»£ç çš„æ–¹æ³•ã€‚è¿™è®©å¼€å‘è€…åœ¨æŸä¸€æ—¶é—´å†…åªéœ€è¦ä¸“æ³¨äºé‚£ä¸€æ®µä»£ç ï¼Œä¹Ÿè®©debugæ›´ç®€å•ã€‚</li><li><strong>æŒç»­é›†æˆ</strong>: å•å…ƒæµ‹è¯•å¯ä»¥åŒ…å«åœ¨å¯æŒç»­é›†æˆç³»ç»Ÿä¸­ï¼Œè¿™ä¸ªç³»ç»Ÿå¯ä»¥è‡ªåŠ¨è¿›è¡Œæµ‹è¯•å¹¶ä¸”å½“ä»£ç å‘ç”Ÿå˜åŒ–æ—¶æä¾›åé¦ˆï¼Œä»¥ç¡®ä¿ä»£ç ä¿®æ”¹åœ¨éƒ¨ç½²ä¹‹å‰æ€»æ˜¯è¢«æµ‹è¯•è¿‡çš„ã€‚</li></ul><p>å¼€å‘äººå‘˜çŸ¥é“å¦‚ä½•åœ¨ä»–ä»¬çš„åº”ç”¨ä¸­æ‰§è¡Œæµ‹è¯•ï¼Œè¿™æ˜¯å†æ€ä¹ˆå¼ºè°ƒä¹Ÿä¸è¿‡åˆ†çš„ï¼Œå› ä¸ºæµ‹è¯•å¯ä»¥è¯†åˆ«ä»»ä½•å’Œå®é™…éœ€æ±‚ç›¸åçš„å·®è·ï¼Œé”™è¯¯æˆ–è€…ç¼ºå¤±çš„éœ€æ±‚ï¼Œä»è€Œç¡®è®¤åº”ç”¨ä¸ºå…¬ä¼—ä½¿ç”¨åšå¥½å‡†å¤‡ã€‚å€ŸåŠ©ä¸‹é¢è¿™äº›ä¾‹å­ï¼Œè¿™ç¯‡æ–‡ç« æ—¨åœ¨æ•™ä¼šä½ å¦‚ä½•åœ¨Reactåº”ç”¨ä¸­ä½¿ç”¨React Testing Libraryæ‰§è¡Œå•å…ƒæµ‹è¯•   </p><h2 id="React-Testing-Library"><a href="#React-Testing-Library" class="headerlink" title="React Testing Library"></a>React Testing Library</h2><p><a href="https://testing-library.com/docs/react-testing-library/intro/">React Testing Library</a> æ˜¯ä¸€ä¸ªReactåº“ï¼Œä¸ºæµ‹è¯•Reactç»„ä»¶æä¾›ç›´è§‚å’Œé«˜æ•ˆçš„APIã€‚å®ƒåŸºäº<a href="https://testing-library.com/docs/ecosystem-jest-dom/">DOM Testing Library</a>æ„å»ºï¼Œå¹¶ä¸”æä¾›äº†æ›´åŠ ä»¥ç”¨æˆ·ä¸ºä¸­å¿ƒçš„æµ‹è¯•Reactç»„ä»¶çš„æ–¹å¼ã€‚è¿™ä¸ªåº“æä¾›äº†ä¸€ç³»åˆ—å·¥å…·å‡½æ•°ï¼Œè¿™äº›è®©å†™æµ‹è¯•æ–­è¨€Reactç»„ä»¶çš„è¡Œä¸ºæ›´åŠ å®¹æ˜“ã€‚RTLå‡½æ•°è¢«è®¾è®¡æˆå’ŒReactæ¸²æŸ“çš„çœŸå®DOMå…ƒç´ ä¸€èµ·ä½¿ç”¨è€Œä¸æ˜¯è™šæ‹ŸDOMï¼Œæ‰€ä»¥æµ‹è¯•ä¼šæ¨¡ä»¿ç”¨æˆ·å¦‚ä½•å’Œåº”ç”¨äº¤äº’ã€‚ä½ å¯ä»¥åœ¨<a href="https://testing-library.com/docs/react-testing-library/intro/">è¿™é‡Œ</a>äº†è§£æ›´å¤šå…³äºReact testing libraryçš„çŸ¥è¯†ã€‚</p><h2 id="ä½¿ç”¨-React-testing-libraryåœ¨Reactä¸­å•å…ƒæµ‹è¯•çš„æ„å»ºå—"><a href="#ä½¿ç”¨-React-testing-libraryåœ¨Reactä¸­å•å…ƒæµ‹è¯•çš„æ„å»ºå—" class="headerlink" title="ä½¿ç”¨ React testing libraryåœ¨Reactä¸­å•å…ƒæµ‹è¯•çš„æ„å»ºå—"></a>ä½¿ç”¨ React testing libraryåœ¨Reactä¸­å•å…ƒæµ‹è¯•çš„æ„å»ºå—</h2><p>Reactä¸­ä½¿ç”¨React testing libraryçš„å•å…ƒæµ‹è¯•å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="javascript">import &#123; render, screen &#125; from &#39;@testing-library/react&#39;;import App from &#39;./App&#39;;test(&#39;renders learn react link&#39;, () =&gt; &#123;  render(&lt;App /&gt;);  const linkElement = screen.getByText(/learn react/i);  expect(linkElement).toBeInTheDocument();&#125;);</code></pre><ul><li>ä»ä¸Šé¢çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼Œé¦–å…ˆçœ‹åˆ°çš„å°±æ˜¯ä¸€äº›å¿…è¦çš„æ¨¡å—å¿…é¡»è¢«å¯¼å…¥ï¼Œæ¯”å¦‚render,screenå’Œè¢«æµ‹è¯•çš„ç»„ä»¶(App)ã€‚renderæ–¹æ³•è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡æä¾›å¯¹æ¸²æŸ“ç»„ä»¶çš„è®¿é—®ï¼Œä»¥åŠå¤šä¸ªå¯ä»¥æŸ¥è¯¢ç»„ä»¶å’Œä¸ç»„ä»¶äº¤äº’çš„å·¥å…·å‡½æ•°</li><li>å…¶æ¬¡ï¼Œæµ‹è¯•å—åŒ…å«ä¸¤éƒ¨åˆ†ï¼›ç¬¬ä¸€éƒ¨åˆ†æ˜¯æè¿°æµ‹è¯•çš„æ–‡æœ¬å†…å®¹ï¼Œç¬¬äºŒéƒ¨åˆ†æ˜¯ä¸€ä¸ªå›è°ƒå‡½æ•°ã€‚</li><li>åœ¨æµ‹è¯•å—ä¸­ï¼Œä½¿ç”¨renderæ–¹æ³•æ¸²æŸ“å°†è¦è¢«æµ‹è¯•çš„ç»„ä»¶ã€‚</li><li>æ¸²æŸ“å®Œç»„ä»¶åï¼Œæˆ‘ä»¬éœ€è¦åœ¨å¾…æµ‹è¯•çš„ç»„ä»¶ä¸­æ‰¾åˆ°ç‰¹å®šçš„å…ƒç´ ã€‚åœ¨ä¸€ä¸ªæ¸²æŸ“çš„ç»„ä»¶ä¸­æŸ¥æ‰¾å…ƒç´ ä¸»è¦æœ‰ä¸‰ç§æ–¹æ³•ï¼šgetBy, findByå’Œ queryByã€‚<ul><li><ul><li>getBy æ–¹æ³•è¢«ç”¨æ¥è·å–ç¬¦åˆæ¡ä»¶çš„å•ä¸ªå…ƒç´ ã€‚å¦‚æœä½¿ç”¨åŒä¸€ä¸ªå±æ€§æ‰¾ä¸åˆ°æˆ–è€…æ‰¾åˆ°å¤šä¸ªå…ƒç´ ï¼Œä¼šæŠ›å‡ºé”™è¯¯ã€‚å½“æµ‹è¯•ä¸€ä¸ªå…ƒç´ æ˜¯å¦åœ¨DOMä¸Šæ—¶è¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œæˆ‘ä»¬å¸Œæœ›åªæœ‰ä¸€ä¸ªå…ƒç´ æ»¡è¶³è¿™ä¸ªæ¡ä»¶ã€‚æ¯”å¦‚ï¼š<br> This method is useful when testing if an element is present in the DOM and we expect only one element to match the condition. For example:</li></ul></li></ul></li></ul><pre><code class="javascript">const &#123; getByText &#125; = render(&lt;MyComponent /&gt;);const element = getByText(&#39;Hello World&#39;);</code></pre><p>åœ¨ä¸Šè¿°ä¾‹å­ä¸­ï¼ŒgetByTextä¼šæŸ¥è¯¢DOMæ‰¾ä¸€ä¸ªåŒ…å« â€˜Hello Worldâ€™æ–‡æœ¬å†…å®¹ çš„å…ƒç´ ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆæ¡ä»¶çš„å…ƒç´ ã€‚å¦‚æœæ²¡æœ‰ä¸€ä¸ªå…ƒç´ åŒ…å«â€˜Hello Worldâ€™æˆ–è€…æœ‰å¤šä¸ªå…ƒç´ åŒ…å«å®ƒï¼Œå°±ä¼šæŠ›å‡ºä¸€ä¸ªé”™è¯¯ã€‚</p><ul><li>findByæ–¹æ³•è¢«ç”¨æ¥è·å–æ»¡è¶³æ¡ä»¶çš„å•ä¸ªå…ƒç´ ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°åˆ™è¿”å›null,å¦‚æœæ‰¾åˆ°å¤šä¸ªå°±æŠ›å‡ºé”™è¯¯ã€‚å½“ä½ ä¸ç¡®å®šè¿™ä¸ªå…ƒç´ æ˜¯å¦åœ¨DOMä¸­æˆ–è€…ä½ å¸Œæœ›åªæœ‰ä¸€ä¸ªå…ƒç´ ç¬¦åˆæ¡ä»¶çš„æ—¶å€™è¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ï¼Œæ¯”å¦‚ï¼š</li></ul><pre><code class="javascript">const &#123; findByText &#125; = render(&lt;MyComponent /&gt;);const element = await findByText(&#39;Hello World&#39;);</code></pre><p>åœ¨ä¸Šé¢è¿™ä¸ªä¾‹å­ä¸­ï¼ŒfindByTextä¼šæŸ¥è¯¢DOMæ‰¾ä¸€ä¸ªåŒ…å« â€˜Hello Worldâ€™æ–‡æœ¬å†…å®¹ çš„å…ƒç´ ï¼Œè¿”å›ç¬¬ä¸€ä¸ªç¬¦åˆçš„å…ƒç´ æˆ–è€…å¦‚æœå…ƒç´ æœªæ‰¾åˆ°çš„è¯è¿”å›nullã€‚å¦‚æœæœ‰å¤šä¸ªåˆ™ä¼šæŠ›å‡ºé”™è¯¯ã€‚</p><ul><li>queryByè¢«ç”¨æ¥è·å–æ»¡è¶³æ¡ä»¶çš„æ‰€æœ‰å…ƒç´ ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°å…ƒç´ åˆ™è¿”å›null,å¦åˆ™ä»¥æ•°ç»„çš„å½¢å¼è¿”å›ã€‚å½“ä½ å¸Œæœ›æ‰¾åˆ°å¤šä¸ªæ»¡è¶³æ¡ä»¶çš„å…ƒç´ æ—¶å€™ï¼Œè¿™ä¸ªæ–¹æ³•éå¸¸æœ‰ç”¨ã€‚ä¾‹å¦‚ï¼š</li></ul><pre><code class="javascript">const &#123; queryByText &#125; = render(&lt;MyComponent /&gt;);const elements = queryByText(&#39;Hello World&#39;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒqueryByTextä¼šæŸ¥è¯¢DOMå¯»æ‰¾åŒ…å«æ–‡æœ¬ â€˜Hello Worldâ€™çš„æ‰€æœ‰å…ƒç´ ï¼Œè¿”å›ä¸€ç»„ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œæˆ–è€…å¦‚æœæ²¡æœ‰æ‰¾åˆ°çš„è¯ä¼šè¿”å›nullã€‚è¿™äº›æ–¹æ³•éƒ½æ¥å—ä¸€ä¸ªæ¡ä»¶ä½œä¸ºå‚æ•°ï¼Œè¿™ä¸ªæ¡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼ˆæŒ‰å…ƒç´ æ–‡æœ¬æœç´¢ï¼‰ï¼Œç»„ä»¶ï¼Œè§’è‰²æˆ–è€…ä½ éœ€è¦æŸ¥è¯¢çš„å…¶ä»–å±æ€§ã€‚ä½ ä¹Ÿå¯ä»¥ä¸²è”å¤šä¸ªæ¡ä»¶æ¥è¿›è¡Œæ›´ç²¾ç¡®çš„æœç´¢ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­ï¼š</p><pre><code class="javascript">const &#123; getByRole, getByLabelText &#125; = render(&lt;MyComponent /&gt;);const element = getByRole(&#39;button&#39;, &#123; name: &#39;Save&#39; &#125;).getByLabelText(&#39;Save&#39;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼ŒgetByRoleå°†ä¼šæŸ¥è¯¢DOMå¯»æ‰¾è§’è‰²ä¸ºbuttonï¼Œnameæ˜¯Saveçš„å…ƒç´ ã€‚ç„¶ågetByLabelTextä¼šéå†getByRoleè¿”å›çš„æ‰€æœ‰å…ƒç´ ï¼›å®ƒå°†è¿”å›labelæ–‡æœ¬ä¸ºâ€˜Saveâ€™çš„ç›¸åŒå…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰æ‰¾åˆ°å…ƒç´ æˆ–æ‰¾åˆ°å¤šä¸ªå…ƒç´ ï¼Œå°±æŠ›å‡ºé”™è¯¯ã€‚</p><ul><li>æ‰¾åˆ°å…ƒç´ åï¼Œæµ‹è¯•æœŸé—´æˆ‘ä»¬å¯ä»¥ä½¿ç”¨æ¥è‡ª @testing-library&#x2F;react åº“çš„fireEvent å‡½æ•°åœ¨Reactç»„ä»¶çš„å…ƒç´ ä¸Šæ¨¡æ‹Ÿç”¨æˆ·äº‹ä»¶ï¼ˆå¦‚ï¼šclick,inputç­‰ï¼‰ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä½¿ç”¨fireEventæ¨¡æ‹Ÿç‚¹å‡»æŒ‰é’®äº‹ä»¶çš„ä¾‹å­ï¼š</li></ul><pre><code class="javascript">import &#123; render, fireEvent &#125; from &#39;@testing-library/react&#39;;import MyComponent from &#39;./MyComponent&#39;;test(&#39;clicking the button calls the onClick prop&#39;, () =&gt; &#123;  const onClick = jest.fn();  const &#123; getByText &#125; = render(&lt;MyComponent onClick=&#123;onClick&#125; /&gt;);  const button = getByText(&#39;Click me&#39;);  fireEvent.click(button);  expect(onClick).toHaveBeenCalled();&#125;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä»@testing-library&#x2F;reactå¯¼å…¥äº†renderå’ŒfireEvent åŠŸèƒ½ï¼Œç„¶åæˆ‘ä»¬å¯¼å…¥æƒ³è¦æµ‹è¯•çš„ç»„ä»¶ã€‚åœ¨æµ‹è¯•å‡½æ•°ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†mockå‡½æ•°æ¥ä½œä¸ºç»„ä»¶çš„onClickå±æ€§ä½¿ç”¨ã€‚ç„¶åä½¿ç”¨renderå‡½æ•°æ¥æ¸²æŸ“ç»„ä»¶ï¼Œä½¿ç”¨getByText æ–¹æ³•æ¥æ‰¾åˆ°åŒ…å«æ–‡æœ¬â€click meâ€çš„æŒ‰é’®å…ƒç´ ã€‚é€šè¿‡ä½¿ç”¨fireEvent.clickå‡½æ•°ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿäº†ç‚¹å‡»æŒ‰é’®ï¼Œæœ€ç»ˆï¼Œé¢„æœŸæ£€æŸ¥mockçš„å‡½æ•°åº”è¯¥è¢«è°ƒç”¨ã€‚ä½ å¯ä»¥ä½¿ç”¨fireEvent.changeæ¨¡æ‹Ÿinputçš„change äº‹ä»¶ï¼Œä½¿ç”¨fireEvent.submitæ¨¡æ‹Ÿè¡¨å•çš„æäº¤äº‹ä»¶ä»¥åŠå…¶ä»–äº‹ä»¶ã€‚</p><ul><li>éšç€æ‰¾åˆ°å…ƒç´ å’Œäº‹ä»¶fire,æˆ‘ä»¬éšåæ£€æŸ¥ä»–ä»¬è¡Œä¸ºæ˜¯å¦ä¸é¢„æœŸä¸€è‡´æˆ–è€…ä»–ä»¬åº”è¯¥åœ¨å“ªé‡Œè¢«æ‰¾åˆ°ã€‚è¿™ä¸ªæ£€æŸ¥è¢«ç§°ä¸ºæ–­è¨€ï¼Œæ–­è¨€è¢«ç”¨æ¥æµ‹è¯•åœ¨æ¸²æŸ“çš„ç»„ä»¶é‡ŒæŸä¸ªæ¡ä»¶æ˜¯å¦æ»¡è¶³ã€‚è¿™äº›æ–­è¨€å…¸å‹çš„ç”¨æ³•æ˜¯æ£€æŸ¥å…ƒç´ çŠ¶æ€ï¼Œæ–‡æœ¬æˆ–è€…å±æ€§ä»¥åŠç»„ä»¶è¡Œä¸ºã€‚RTLæä¾›äº†ä¸€ç³»åˆ—å†…ç½®çš„æ–­è¨€æ¯”å¦‚toHaveBeenCalledï¼ŒtoHaveBeenCalledTimes, å’Œ toHaveBeenCalledWithï¼Œæ–­è¨€å‡½æ•°è¡Œä¸ºæ¯”å¦‚äº‹ä»¶å¤„ç†å™¨ã€‚ä¸¾ä¸ªä¾‹å­ï¼š</li></ul><pre><code class="javascript">test(&#39;simulate and test click event on a button&#39;, () =&gt; &#123;  const handleClick = jest.fn();  const &#123; getByTestId &#125; = render(&lt;MyComponent onClick=&#123;handleClick&#125; /&gt;);  fireEvent.click(getByTestId(&#39;my-button&#39;));  expect(handleClick).toHaveBeenCalled();  expect(handleClick).toHaveBeenCalledTimes(1);  expect(handleClick).toHaveBeenCalledWith(expect.anything());&#125;);</code></pre><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨jest.fn() åˆ›å»ºä¸€ä¸ªæˆ‘ä»¬å¯ä»¥æ–­è¨€çš„mockå‡½æ•°ã€‚ç„¶åæˆ‘ä»¬å°†å®ƒä½œä¸ºpropä¼ é€’ç»™ç»„ä»¶ï¼Œæ¥ç€ä½¿ç”¨fireEvent.click æ¨¡æ‹Ÿç‚¹å‡»æŒ‰é’®ã€‚å†æ–­è¨€ã€‚ä½¿ç”¨ toHaveBeenCalled()æ–¹æ³•ï¼Œæ£€æŸ¥å½“ç‚¹å‡»æŒ‰é’®æ—¶ï¼Œå‡½æ•°handleClickæ˜¯å¦è¢«è°ƒç”¨ã€‚ ä½¿ç”¨toHaveBeenCalledTimes(1)ï¼Œæˆ‘ä»¬æµ‹è¯•å½“æŒ‰é’®ç‚¹å‡»çš„æ—¶å€™ï¼ŒhandleClickæ˜¯å¦åªè¢«è°ƒç”¨è¿‡ä¸€æ¬¡ã€‚æœ€åï¼Œä½¿ç”¨toHaveBeenCalledWith()æµ‹è¯•ä»–æ˜¯å¦åªè¢«è°ƒç”¨ä¸€æ¬¡ä¸”å¸¦æœ‰å‚æ•°çš„è°ƒç”¨ã€‚</p><p>æ³¨æ„RTLç›®çš„æ˜¯æä¾›æœ€å°ä¸”çµæ´»çš„ä¸€ç³»åˆ—æ–­è¨€ï¼Œå¹¶ä¸”ä½ å¯ä»¥ä½¿ç”¨ä»»ä½•æ–­è¨€åº“ï¼Œç±»ä¼¼chaiï¼Œjestç­‰æ–­è¨€ç»„ä»¶çŠ¶æ€ã€‚</p><h2 id="ä½¿ç”¨-React-Testing-Libraryç¼–å†™æœ‰æ•ˆçš„å•å…ƒæµ‹è¯•çš„æ­¥éª¤"><a href="#ä½¿ç”¨-React-Testing-Libraryç¼–å†™æœ‰æ•ˆçš„å•å…ƒæµ‹è¯•çš„æ­¥éª¤" class="headerlink" title="ä½¿ç”¨ React- Testing Libraryç¼–å†™æœ‰æ•ˆçš„å•å…ƒæµ‹è¯•çš„æ­¥éª¤"></a>ä½¿ç”¨ React- Testing Libraryç¼–å†™æœ‰æ•ˆçš„å•å…ƒæµ‹è¯•çš„æ­¥éª¤</h2><p>è¿™é‡Œæ˜¯ä½¿ç”¨React Testing Libraryç¼–å†™ç»¼åˆæœ‰æ•ˆçš„å•å…ƒæµ‹è¯•éœ€è¦éµå¾ªçš„æ­¥éª¤ï¼š</p><ul><li>å¯¼å…¥éœ€è¦çš„æ¨¡å—ï¼šä½ å¿…é¡»å¯¼å…¥Reactå’ŒReact Testing Libraryã€‚ä½ ä¹Ÿéœ€è¦å¯¼å…¥ä½ æƒ³æµ‹è¯•çš„ç»„ä»¶ã€‚</li><li>å†™æµ‹è¯•ï¼šä½¿ç”¨Jestçš„æè¿°å’Œä»–çš„æ–¹æ³•æ¥ä¸ºç»„ä»¶å†™æµ‹è¯•ã€‚ä½ ä¼šä½¿ç”¨React Testing Libraryçš„renderæ–¹æ³•æ¥æ¸²æŸ“æµ‹è¯•ä¸­çš„ç»„ä»¶ã€‚</li><li>ä»ç»„ä»¶è·å–å…ƒç´ ï¼šä½¿ç”¨æ¥è‡ªè¿”å›çš„æ¸²æŸ“å¯¹è±¡getBy å’ŒqueryByæ–¹æ³•ä»å·²ç»æ¸²æŸ“çš„ç»„ä»¶ä¸­è·å–å…ƒç´ ã€‚ä½ å¯ä»¥ä½¿ç”¨è¿™äº›æ–¹æ³•é€šè¿‡æ–‡æœ¬ï¼Œå±•ç¤ºå€¼ï¼Œlabelæ–‡æœ¬æˆ–è€…è”åˆä½“è·å–å…ƒç´ ã€‚</li><li>å’Œç»„ä»¶äº¤äº’ï¼šä½¿ç”¨fireEvent æ–¹æ³•å’Œç»„ä»¶äº¤äº’ã€‚ä½ å¯ä»¥ä½¿ç”¨fireEvenæ¨¡æ‹Ÿç±»ä¼¼ç‚¹å‡»æŒ‰é’®ï¼Œæäº¤è¡¨å•æˆ–è€…ä¿®æ”¹è¾“å…¥å€¼è¿™æ ·çš„ç”¨æˆ·äº‹ä»¶ã€‚</li><li>åšå‡ºæ–­è¨€ï¼šä½¿ç”¨Jestçš„expectæ–¹æ³•å¯¹ç»„ä»¶çš„çŠ¶æ€åšå‡ºæ–­è¨€ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯èƒ½ä¼šæ–­è¨€è¡¨å•å·²ç»æˆåŠŸæäº¤æˆ–è€…å±•ç¤ºé”™è¯¯ä¿¡æ¯ã€‚</li><li>æ¸…ç†ï¼šåœ¨è¿›å…¥ä¸‹ä¸€ä¸ªæµ‹è¯•ä¹‹å‰ï¼Œç¡®ä¿æ¸…ç†å¹²å‡€ä»»æ„çš„spy,mockæˆ–è€…ç»™ç»„ä»¶æ·»åŠ çš„äº‹ä»¶ç›‘å¬å™¨ã€‚</li><li>ä¸ºæ¯ä¸ªç»„ä»¶é‡å¤è¿™ä¸ªè¿‡ç¨‹ï¼šä¸ºæ¯ä¸€ä¸ªä½ æƒ³æµ‹è¯•çš„ç»„ä»¶å†™ä¸€ä¸ªå•ç‹¬çš„æµ‹è¯•ã€‚ä¸ºæ¯ä¸ªæµ‹è¯•é‡å¤ä¸Šè¿°æ­¥éª¤ã€‚ç°åœ¨æˆ‘ä»¬è‡ªå·±æ¥å†™ä¸€äº›æµ‹è¯•ã€‚</li></ul><h2 id="å†™å•å…ƒæµ‹è¯•"><a href="#å†™å•å…ƒæµ‹è¯•" class="headerlink" title="å†™å•å…ƒæµ‹è¯•"></a>å†™å•å…ƒæµ‹è¯•</h2><p>ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘ä»¬è¿˜ä¼šåˆ›å»ºç®€å•çš„è”ç³»è¡¨å•ï¼Œæ ¡éªŒæ¯ä¸€ä¸ªfieldã€‚<br><img src="https://blog.openreplay.com/images/unit-testing-with-the-react-testing-library/images/UHSZlyc.png"><br>ä¸ºäº†æµ‹è¯•ï¼Œæˆ‘ä»¬å°†åˆ›å»ºä¸€ä¸ªç®€å•çš„è¡¨å•ï¼Œæ ¡éªŒæ¯ä¸€ä¸ªfieldã€‚å¦‚æœç©ºç™½è¡¨å•è¢«æäº¤å°±ä¼šå±•ç¤ºé”™è¯¯ä¿¡æ¯ã€‚<br><img src="https://blog.openreplay.com/images/unit-testing-with-the-react-testing-library/images/yHK5HIa.png"></p><p>åšå®Œè¿™äº›ä¹‹åï¼Œæˆ‘ä»¬å°†ä¸ºè¿™ä¸ªè¡¨å•å†™ä¸€äº›å•å…ƒæµ‹è¯•ï¼š</p><ul><li>æµ‹è¯•labelå’Œè¾“å…¥åŸŸæ˜¯å¦æ­£ç¡®æ¸²æŸ“ï¼š</li></ul><pre><code class="javascript">it(&#39;renders the form with correct labels and inputs&#39;, () =&gt; &#123;  const &#123; getByLabelText, getByRole &#125; = render(&lt;App /&gt;);  expect(getByLabelText(&#39;Name:&#39;)).toBeInTheDocument();  expect(getByLabelText(&#39;Email:&#39;)).toBeInTheDocument();  expect(getByLabelText(&#39;Message:&#39;)).toBeInTheDocument();  expect(getByRole(&#39;textbox&#39;, &#123; name: &#39;Name:&#39; &#125;)).toBeInTheDocument();  expect(getByRole(&#39;textbox&#39;, &#123; name: &#39;Email:&#39; &#125;)).toBeInTheDocument();  expect(getByRole(&#39;textbox&#39;, &#123; name: &#39;Message:&#39; &#125;)).toBeInTheDocument();&#125;);</code></pre><p>è¿™ä¸ªæµ‹è¯•ç”¨æ¥æ£€æµ‹è¡¨å•çš„labelå’Œè¾“å…¥å€¼æ˜¯å¦æ­£ç¡®ã€‚æ¥è‡ªreact-testing-libraryçš„renderå‡½æ•°è¢«ç”¨æ¥æ¸²æŸ“Appç»„ä»¶ã€‚ä¹‹åï¼ŒgetByLabelTextå’ŒgetByRoleå‡½æ•°ç”¨æ¥æ‰¾è¡¨å•é‡Œçš„å…ƒç´ ï¼Œå¹¶æ–­è¨€ä»–ä»¬åœ¨æ–‡æ¡£ä¸­ã€‚</p><ul><li>æµ‹è¯•æ˜¯å¦ä¼šå±•ç¤ºç©ºåŸŸçš„é”™è¯¯ä¿¡æ¯ï¼š</li></ul><pre><code class="javascript">it(&#39;displays errors for empty fields&#39;, () =&gt; &#123;  const &#123; getByText, getByRole &#125; = render(&lt;App /&gt;);  const submitButton = getByRole(&#39;button&#39;, &#123; type: &#39;submit&#39; &#125;);  fireEvent.click(submitButton);  expect(getByText(&#39;Name is required&#39;)).toBeInTheDocument();  expect(getByText(&#39;Email is required&#39;)).toBeInTheDocument();  expect(getByText(&#39;Message is required&#39;)).toBeInTheDocument();&#125;);</code></pre><p>è¿™ä¸ªæµ‹è¯•æ£€æŸ¥å½“ç”¨æˆ·å°è¯•æäº¤ç©ºç™½è¡¨å•çš„æ—¶å€™æ˜¯å¦ä¼šå±•ç¤ºæ­£ç¡®çš„é”™è¯¯ä¿¡æ¯ã€‚æˆ‘ä»¬çš„è¡¨å•æ˜¯ä½¿ç”¨renderå‡½æ•°æ¸²æŸ“çš„ï¼Œä½¿ç”¨getByRoleæ–¹æ³•æ‰¾åˆ°æŒ‰é’®å…ƒç´ ã€‚fireEventå‡½æ•°æ¨¡æ‹Ÿç‚¹å‡»æäº¤æŒ‰é’®ã€‚getByTextå‡½æ•°æ‰¾åˆ°é”™è¯¯ä¿¡æ¯å¹¶ä¸”æ–­è¨€ä»–ä»¬åœ¨æ–‡æ¡£é‡Œã€‚</p><ul><li>æµ‹è¯•åœ¨emailåœ°å€ä¸åˆæ³•çš„æƒ…å†µä¸‹æ˜¯å¦ä¼šå±•ç¤ºé”™è¯¯ä¿¡æ¯:</li></ul><pre><code class="javascript">it(&#39;display error for invalid email&#39;, () =&gt; &#123;  const &#123; getByLabelText, getByText, getByRole &#125; = render(&lt;App /&gt;);  const emailInput = getByRole(&#39;textbox&#39;, &#123; name: &#39;Email:&#39; &#125;);  fireEvent.change(emailInput, &#123; target: &#123; value: &#39;wdwkfb.com@&#39; &#125; &#125;);  const submitButton = getByRole(&#39;button&#39;, &#123; type: &#39;submit&#39; &#125;);  fireEvent.click(submitButton);  expect(getByLabelText(&#39;Email:&#39;)).toBeInTheDocument();  expect(getByText(&#39;Email is not valid&#39;)).toBeInTheDocument();&#125;);</code></pre><p>è¿™ä¸ªæµ‹è¯•æ£€æµ‹åŒ…å«ä¸åˆæ³•çš„é‚®ä»¶åœ°å€çš„è¡¨å•æ˜¯å¦ä¼šåœ¨ç”¨æˆ·å°è¯•æäº¤è¡¨å•ä¼šå±•ç¤ºé”™è¯¯ä¿¡æ¯ã€‚è¡¨å•æ¸²æŸ“ä»¥åï¼Œé€šè¿‡getByRoleæ–¹æ³•æ‰¾åˆ°é‚®ç®±è¾“å…¥ã€‚fireEventå‡½æ•°è¢«ç”¨æ¥æ¨¡æ‹Ÿå°†é‚®ä»¶åœ°å€å˜æˆä¸åˆæ³•çš„å€¼ã€‚æäº¤æŒ‰é’®æ‰¾åˆ°ä»¥ååƒä»¥å‰çš„æµ‹è¯•ä¸€æ ·ä½¿ç”¨åŒæ ·çš„æ­¥éª¤ç‚¹å‡»ã€‚ä½¿ç”¨getByTextæ–¹æ³•æ‰¾åˆ°é”™è¯¯ä¿¡æ¯å¹¶æ–­è¨€å­˜åœ¨äºæ–‡æ¡£ä¸­ã€‚</p><ul><li>å½“å³è¾¹çš„è¾“å…¥è¢«ç»™å®šçš„æ—¶å€™ï¼Œæµ‹è¯•æˆ‘ä»¬çš„è¡¨å•æ˜¯å¦è¢«æäº¤ï¼š</li></ul><pre><code class="javascript">it(&#39;submit the form with correct data when the submit button is clicked&#39;, () =&gt; &#123;  const spy = jest.spyOn(console, &#39;log&#39;).mockImplementation(() =&gt; &#123;&#125;);  const &#123; getByLabelText, getByText &#125; = render(&lt;App /&gt;);  const nameInput = getByLabelText(&#39;Name:&#39;);  const emailInput = getByLabelText(&#39;Email:&#39;);  const messageInput = getByLabelText(&#39;Message:&#39;);  const submitButton = getByText(&#39;Submit&#39;);  fireEvent.change(nameInput, &#123; target: &#123; value: &#39;John Doe&#39; &#125; &#125;);  fireEvent.change(emailInput, &#123; target: &#123; value: &#39;johndoe@example.com&#39; &#125; &#125;);  fireEvent.change(messageInput, &#123;    target: &#123; value: &#39;Hello, I would like to get in touch.&#39; &#125;,  &#125;);  fireEvent.click(submitButton);  expect(console.log).toHaveBeenCalledWith(&#123;    name: &#39;John Doe&#39;,    email: &#39;johndoe@example.com&#39;,    message: &#39;Hello, I would like to get in touch.&#39;,  &#125;);  spy.mockRestore();&#125;);</code></pre><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Jestçš„spyOnæ–¹æ³•åˆ›å»ºå¯¹console.logæ–¹æ³•çš„ç›‘å¬ï¼Œç„¶åä½¿ç”¨ mockImplementationæ¥ç”¨mockå‡½æ•°æ›¿ä»£çœŸæ­£çš„æ–¹æ³•ã€‚è¿™å…è®¸æˆ‘ä»¬éªŒè¯ console.log æ–¹æ³•å¯ä»¥åœ¨ä¸å¾€æ§åˆ¶å°è®°å½•ä»»ä½•ä¿¡æ¯çš„æƒ…å†µä¸‹è¢«è°ƒç”¨ã€‚ç„¶åæˆ‘ä»¬ä½¿ç”¨æ¥è‡ª@testing-library&#x2F;reactçš„renderæ–¹æ³•æ¸²æŸ“Appç»„ä»¶ï¼Œä½¿ç”¨getByTextä»å·²ç»æ¸²æŸ“çš„ç»„ä»¶ä¸­è·å–åˆ°æŒ‰é’®å…ƒç´ ã€‚ä½¿ç”¨fireEvent.changeï¼Œæˆ‘ä»¬å¯ä»¥ç»™è¾“å…¥åŸŸæä¾›è¾“å…¥ã€‚æ¥ä¸‹æ¥ä½¿ç”¨fireEvent.clickæ¥æ¨¡æ‹Ÿç‚¹å‡»æŒ‰é’®ï¼Œæ–­è¨€æœ‰é¢„æœŸæ¶ˆæ¯çš„console.logæ–¹æ³•è¢«è°ƒç”¨ã€‚æœ€åä½¿ç”¨mockRestoreæ¥æ¢å¤åŸå§‹çš„console.logæ–¹æ³•ï¼Œæ‰€ä»¥spyä¸ä¼šå½±å“ä»»ä½•æœªæ¥çš„æµ‹è¯•ã€‚</p><h2 id="è¿è¡Œæµ‹è¯•"><a href="#è¿è¡Œæµ‹è¯•" class="headerlink" title="è¿è¡Œæµ‹è¯•"></a>è¿è¡Œæµ‹è¯•</h2><p>åˆ°ç›®å‰ä¸ºæ­¢ï¼Œæˆ‘ä»¬å·²ç»å­¦ä¹ äº†å¦‚ä½•ä¸ºReactåº”ç”¨æ­å»ºå•å…ƒæµ‹è¯•ã€‚ä¸ºäº†è¿è¡Œæˆ‘ä»¬å·²ç»å†™å¥½çš„æµ‹è¯•ï¼Œéœ€è¦åšä»¥ä¸‹è¿™äº›äº‹ï¼š</p><ul><li><p>å°†ä½ çš„æµ‹è¯•æ–‡ä»¶ä¿å­˜åœ¨ç»„ä»¶æ–‡ä»¶çš„åŒçº§ç›®å½•ï¼Œå‘½åä¸º[component-name].test.jsã€‚</p></li><li><p>åœ¨ä½ çš„ç»ˆç«¯ï¼Œå¯¼èˆªåˆ°é¡¹ç›®çš„æ ¹ç›®å½•ï¼Œè¿è¡Œä¸‹é¢çš„å‘½ä»¤ï¼šnpm run testï¼Œå¦‚æœä½ ä½¿ç”¨çš„æ˜¯yarn,å¯ä»¥è¿è¡Œyarn test</p></li><li><p>test runnerä¼šè‡ªåŠ¨æ‰¾åˆ°ä½ é¡¹ç›®é‡Œçš„æ‰€æœ‰æµ‹è¯•æ–‡ä»¶å¹¶è¿è¡Œï¼Œåœ¨ç»ˆç«¯å±•ç¤ºç»“æœã€‚</p></li><li><p>å¦‚æœä½ æƒ³è¦è¿è¡ŒæŒ‡å®šçš„æµ‹è¯•æ–‡ä»¶ï¼Œå¯ä»¥ä½¿ç”¨ npm run test [test-file-path]æˆ–è€…yarn test [test-file-path]å‘½ä»¤ã€‚</p></li><li><p>ç»ˆç«¯ä¸Šå±•ç¤ºäº†æˆ‘ä»¬æµ‹è¯•çš„ç»“æœï¼ŒåŒ…å«äº†æ‰€æœ‰çš„æµ‹è¯•å’Œä»–ä»¬çš„ç»“æœã€‚è¿™æ˜¯å½“æµ‹è¯•å…¨éƒ¨é€šè¿‡çš„æ—¶å€™çš„è¾“å‡ºï¼š</p><p><img src="https://blog.openreplay.com/images/unit-testing-with-the-react-testing-library/images/Z92HEh8.png"></p><p>ç°åœ¨æˆ‘ä»¬è®©å…¶ä¸­ä¸€ä¸ªæµ‹è¯•å¤±è´¥ï¼Œçœ‹çœ‹æ˜¯ä»€ä¹ˆæ ·å­ï¼›</p><p><img src="https://blog.openreplay.com/images/unit-testing-with-the-react-testing-library/images/iYziRAC.png"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°React Testing Library å‘æˆ‘ä»¬ç²¾ç¡®åœ°å±•ç¤ºäº†ä»€ä¹ˆåŸå› å¯¼è‡´äº†é”™è¯¯ï¼Œå› æ­¤æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿçº æ­£é”™è¯¯ã€‚</p></li></ul><h2 id="å†™æœ‰æ•ˆå•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä¸€äº›å»ºè®®"><a href="#å†™æœ‰æ•ˆå•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä¸€äº›å»ºè®®" class="headerlink" title="å†™æœ‰æ•ˆå•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä¸€äº›å»ºè®®"></a>å†™æœ‰æ•ˆå•å…ƒæµ‹è¯•ç”¨ä¾‹çš„ä¸€äº›å»ºè®®</h2><ul><li><strong>ä¿æŒæµ‹è¯•å†…å®¹å°ä¸”é›†ä¸­</strong>: æ¯ä¸ªæµ‹è¯•åº”è¯¥åªæµ‹è¯•ç»„ä»¶ç‰¹å®šçš„è¡Œä¸ºæˆ–è€…æ–¹é¢ï¼Œé¿å…åœ¨å•ä¸ªtestä¸­æµ‹è¯•å¤šä¸ªè¡Œä¸ºã€‚è¿™å¯ä»¥æé«˜ä½ çš„æµ‹è¯•åŒ…çš„å¯é æ€§ï¼Œå¯è¯»æ€§å’Œå¯ç»´æŠ¤æ€§ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªåé¢ä¾‹å­ï¼š</li></ul><pre><code class="javascript">import React from &#39;react&#39;;import MyComponent from &#39;./MyComponent&#39;;import &#123; render, fireEvent &#125; from &#39;@testing-library/react&#39;;describe(&#39;MyComponent&#39;, () =&gt; &#123;  it(&#39;tests multiple behaviors&#39;, () =&gt; &#123;    const &#123; getByText, getByRole &#125; = render(&lt;MyComponent title=&quot;Test title&quot; /&gt;);    expect(getByText(&#39;Test title&#39;)).toBeInTheDocument();    fireEvent.click(getByRole(&#39;button&#39;));    expect(getByText(&#39;Button clicked&#39;)).toBeInTheDocument();  &#125;);&#125;);</code></pre><p>è¿™åŒæ—¶æµ‹è¯•äº†æ ‡é¢˜çš„å±•ç¤ºå’ŒæŒ‰é’®ç‚¹å‡»çš„è¡Œä¸ºï¼Œè¿™ä½¿å¾—å®ƒåœ¨å¤±è´¥çš„æ—¶å€™éš¾ä»¥ç†è§£å’Œdebugã€‚è¿™é‡Œæ˜¯åŒæ ·çš„æµ‹è¯•æ›´å¥½çš„å†™æ³•ï¼š</p><pre><code class="javascript">import React from &#39;react&#39;;import MyComponent from &#39;./MyComponent&#39;;import &#123; render, fireEvent &#125; from &#39;@testing-library/react&#39;;describe(&#39;MyComponent&#39;, () =&gt; &#123;  it(&#39;renders the title&#39;, () =&gt; &#123;    const &#123; getByText &#125; = render(&lt;MyComponent title=&quot;Test title&quot; /&gt;);    expect(getByText(&#39;Test title&#39;)).toBeInTheDocument();  &#125;);  it(&#39;handles button click&#39;, () =&gt; &#123;    const &#123; getByText, getByRole &#125; = render(&lt;MyComponent title=&quot;Test title&quot; /&gt;);    fireEvent.click(getByRole(&#39;button&#39;));    expect(getByText(&#39;Button clicked&#39;)).toBeInTheDocument();  &#125;);&#125;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨æ¥è‡ª@testing-library&#x2F;reactçš„renderæ–¹æ³•æ¸²æŸ“ç»„ä»¶å’Œæ¥è‡ªjestçš„fireEvent.clickæ¨¡æ‹ŸæŒ‰é’®ç‚¹å‡»äº‹ä»¶ã€‚ç„¶ågetByText å’Œ getByRoleå‡½æ•°è¢«ç”¨æ¥åœ¨é¡µé¢ä¸­å®šä½å…ƒç´ ã€‚è¿™äº›æµ‹è¯•è¢«å†™åœ¨å•ç‹¬çš„testå—ä¸­ï¼Œéµå¾ªå»ºè®®çš„åšæ³•ï¼Œè¿™è®©ä»–ä»¬å³ä½¿éšç€æ—¶é—´çš„æµé€ä¹Ÿèƒ½æ˜“äºç†è§£å’Œç»´æŠ¤ã€‚</p><ul><li><strong>æµ‹è¯•ç‰¹å®šç»“æœ</strong>: å½“æˆ‘ä»¬ä¸“æ³¨äºæµ‹è¯•ç»„ä»¶ç‰¹å®šçš„ç»“æœæˆ–è€…æŸäº›æ–¹é¢çš„è¡Œä¸ºï¼Œè€Œä¸æ˜¯ä¸“æ³¨äºæ¸²æŸ“çš„æ•´ä½“æ­£ç¡®æ€§ï¼Œå•å…ƒæµ‹è¯•ä¼šæ›´é«˜æ•ˆã€‚é€šè¿‡æµ‹è¯•ç‰¹å®šçš„ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥ç¡®ä¿ç»„ä»¶åŠŸèƒ½åœ¨ä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ä¸‹èƒ½æŒ‰ç…§é¢„æœŸè¿è¡Œã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ å¯ä»¥æµ‹è¯•å½“ä¼ å…¥æŒ‡å®špropçš„æ—¶å€™è¿™ä¸ªç»„ä»¶æ˜¯å¦ä¼šæ­£ç¡®å±•ç¤ºæŒ‡å®šçš„æ•°æ®ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥æµ‹è¯•å½“ç‚¹å‡»æŒ‡å®šçš„æŒ‰é’®æ—¶è§¦å‘æ“ä½œã€‚è¿™äº›ç±»å‹çš„æµ‹è¯•æä¾›äº†å…³äºç»„ä»¶çš„è¡Œä¸ºæ›´ç‰¹å®šçš„å’Œæ›´æœ‰æ„ä¹‰çš„ä¿¡æ¯ï¼Œè¿™ä½¿å¾—æ•è·å¯èƒ½å‘ç”Ÿçš„é—®é¢˜æˆ–è€…bugæ›´åŠ å®¹æ˜“ã€‚</li><li><strong>åŒæ—¶æµ‹è¯•ç¬¦åˆé¢„æœŸå’Œä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸º</strong>: æµ‹è¯•ç»„ä»¶åœ¨ç»™å®šåˆæ³•è¾“å…¥çš„æ—¶å€™æ˜¯å¦è¡Œä¸ºæ­£å¸¸ï¼ŒåŒæ—¶æµ‹è¯•å®ƒæ˜¯å¦èƒ½å¤„ç†ä¸åˆæ³•çš„è¾“å…¥å’Œè¾¹ç¼˜ç”¨ä¾‹ã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­ï¼›å‡è®¾æœ‰è¿™æ ·ä¸€ä¸ªReactç»„ä»¶ï¼Œæœ‰ä¸€ä¸ªæ•°å­—valueä½œä¸ºprop,è¿”å›åŸºäºå€¼çš„ä¿¡æ¯ï¼š</li></ul><pre><code class="javascript">import React from &quot;react&quot;;const ValueMessage = (&#123; value &#125;) =&gt; &#123;  let message = &quot;&quot;;  if (value &gt; 10) &#123;    message = &quot;Value is greater than 10&quot;;  &#125; else if (value &lt; 0) &#123;    message = &quot;Value is negative&quot;;  &#125; else &#123;    message = &quot;Value is between 0 and 10&quot;;  &#125;  return &lt;div&gt;&#123;message&#125;&lt;/div&gt;;&#125;;export default ValueMessage;</code></pre><p>ä¸ºäº†ç»™è¿™ä¸ªç»„ä»¶å†™æœ‰æ•ˆçš„å•å…ƒæµ‹è¯•ï¼Œæˆ‘ä»¬åº”è¯¥åŒæ—¶æµ‹è¯•ç¬¦åˆé¢„æœŸå’Œä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼šæµ‹è¯•ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼›</p><pre><code class="javascript">import React from &#39;react&#39;;import &#123; render &#125; from &#39;@testing-library/react&#39;;import ValueMessage from &#39;./ValueMessage&#39;;test(&#39;displays &quot;Value is greater than 10&quot; when value is greater than 10&#39;, () =&gt; &#123;  const value = 11;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;value&#125; /&gt;);  expect(getByText(&#39;Value is greater than 10&#39;)).toBeInTheDocument();&#125;);test(&#39;displays &quot;Value is between 0 and 10&quot; when value is between 0 and 10&#39;, () =&gt; &#123;  const value = 5;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;value&#125; /&gt;);  expect(getByText(&#39;Value is between 0 and 10&#39;)).toBeInTheDocument();&#125;);test(&#39;displays &quot;Value is negative&quot; when value is negative&#39;, () =&gt; &#123;  const value = -5;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;value&#125; /&gt;);  expect(getByText(&#39;Value is negative&#39;)).toBeInTheDocument();&#125;);</code></pre><p>ç°åœ¨æ¥æµ‹è¯•ä¸€äº›ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼›</p><pre><code class="javascript">import React from &#39;react&#39;;import &#123; render &#125; from &#39;@testing-library/react&#39;;import ValueMessage from &#39;./ValueMessage&#39;;test(&#39;displays &quot;Value is between 0 and 10&quot; when value is undefined&#39;, () =&gt; &#123;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;undefined&#125; /&gt;);  expect(getByText(&#39;Value is between 0 and 10&#39;)).toBeInTheDocument();&#125;);test(&#39;displays &quot;Value is between 0 and 10&quot; when value is null&#39;, () =&gt; &#123;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;null&#125; /&gt;);  expect(getByText(&#39;Value is between 0 and 10&#39;)).toBeInTheDocument();&#125;);test(&#39;displays &quot;Value is between 0 and 10&quot; when value is NaN&#39;, () =&gt; &#123;  const &#123; getByText &#125; = render(&lt;ValueMessage value=&#123;NaN&#125; /&gt;);  expect(getByText(&#39;Value is between 0 and 10&#39;)).toBeInTheDocument();&#125;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡æä¾›ç»™ç»„ä»¶åˆæ³•çš„è¾“å…¥ï¼ˆå¤§äº10ï¼Œ1-10ï¼Œè´Ÿæ•°çš„æ•°å­—ï¼‰æµ‹è¯•ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºã€‚æˆ‘ä»¬ä¹Ÿæµ‹è¯•äº†ä¸ç¬¦åˆé¢„æœŸçš„è¡Œä¸ºï¼Œæ¯”å¦‚ç»™ç»„ä»¶çš„valueçš„propsæä¾›undefinedï¼Œnullå’ŒNaNã€‚è¾¹ç¼˜ç”¨ä¾‹å¸®åŠ©ç¡®ä¿ç»„ä»¶å¯ä»¥ä¼˜é›…å¤„ç†ä¸åˆæ³•è¾“å…¥ï¼Œé¿å…appå´©æºƒã€‚</p><ul><li><p><strong>ä½¿ç”¨åˆç†çš„æµ‹è¯•æ–¹å¼</strong>: React Testing Library æä¾›äº†ä¸åŒçš„æµ‹è¯•ç»„ä»¶çš„æ–¹æ³•ï¼Œæ¯”å¦‚ï¼šrender,fireEventå’Œwaitã€‚ä¸ºä½ è¦æµ‹è¯•çš„è¡Œä¸ºé€‰æ‹©åˆç†çš„æ–¹æ³•ã€‚</p></li><li><p><strong>é¿å…æµ‹è¯•è¿˜æ²¡æœ‰å®ç°çš„ç»†èŠ‚</strong>: ç»„ä»¶ä¹Ÿè®¸å†…éƒ¨ä¼šå˜åŒ–ï¼Œä½†æ˜¯åªè¦ä»–ä»¬çš„è¡Œä¸ºä¸å˜ï¼Œæˆ‘ä»¬çš„æµ‹è¯•ä»ç„¶å¯ä»¥é€šè¿‡ã€‚é¿å…æµ‹è¯•å†…éƒ¨çš„å®ç°ç»†èŠ‚ï¼Œè€Œæ˜¯ä¸“æ³¨äºæµ‹è¯•ç»„ä»¶çš„å…¬å…±APIã€‚ä¸¾ä¾‹æ¥è¯´,å‡è®¾ä½ æœ‰ä¸€ä¸ª<Counter /> ç»„ä»¶,åœ¨å±å¹•ä¸Šæ˜¾ç¤ºä¸€ä¸ªæ•°å­—,å…è®¸ç”¨æˆ·å¢åŠ æˆ–å‡å°‘è¿™ä¸ªæ•°å­—.è¿™é‡Œæ˜¯ä¸€ä¸ªä¾‹å­å±•ç¤ºäº†ä½ åœ¨<Counter />ç»„ä»¶ä¹Ÿè®¸æƒ³è¦æµ‹è¯•ä»€ä¹ˆ:</p></li></ul><pre><code class="javascript">it(&quot;renders the correct number&quot;, () =&gt; &#123;  const wrapper = shallow(&lt;Counter value=&#123;3&#125; /&gt;);  expect(wrapper.text()).toEqual(&quot;3&quot;);&#125;);it(&quot;increments the value correctly&quot;, () =&gt; &#123;  const wrapper = shallow(&lt;Counter value=&#123;3&#125; /&gt;);  wrapper.find(&quot;[data-test=&#39;increment-button&#39;]&quot;).simulate(&quot;click&quot;);  expect(wrapper.text()).toEqual(&quot;4&quot;);&#125;);it(&quot;decrements the value correctly&quot;, () =&gt; &#123;  const wrapper = shallow(&lt;Counter value=&#123;3&#125; /&gt;);  wrapper.find(&quot;[data-test=&#39;decrement-button&#39;]&quot;).simulate(&quot;click&quot;);  expect(wrapper.text()).toEqual(&quot;2&quot;);&#125;);</code></pre><p>åœ¨è¿™ä¸ªä¾‹å­ä¸­,æµ‹è¯•ä¸“æ³¨äº<Counter />ç»„ä»¶çš„è¡Œä¸ºã€‚ä»–ä»¬æ£€æµ‹ç»„ä»¶æ˜¯å¦æ¸²æŸ“äº†æ­£ç¡®çš„æ•°å­—ï¼ŒåŒæ—¶ä¹Ÿæ£€æµ‹ç”¨æˆ·æ˜¯å¦å¯ä»¥å¢åŠ æˆ–å‡å°‘æ•°å­—ã€‚å³ä½¿ç»„ä»¶çš„æ‰§è¡Œå˜äº†ï¼Œåªè¦è¡Œä¸ºä¸å˜ï¼Œæµ‹è¯•åº”è¯¥ä»ç„¶ä¼šé€šè¿‡ã€‚é¿å…æµ‹è¯•å†…éƒ¨å®ç°ç»†èŠ‚éå¸¸é‡è¦ï¼Œæ¯”å¦‚ç”¨äºå±•ç¤ºä¸€ä¸ªæ•°å­—æˆ–è€…æŒ‰é’®çš„ç‰¹å®šHTMLå…ƒç´ ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œç»„ä»¶ä¹Ÿè®¸ä¼šä»ä½¿ç”¨<p> å…ƒç´ å±•ç¤ºæ•°å­—å˜æˆä½¿ç”¨è‡ªå®šä¹‰çš„<Display>ç»„ä»¶å±•ç¤ºã€‚åªè¦ç»„ä»¶è¡¨ç°ä¸€è‡´ï¼Œæµ‹è¯•åº”è¯¥ä»ç„¶ä¼šé€šè¿‡ï¼›å°±ä¸éœ€è¦æ›´æ–°æµ‹è¯•ã€‚</p><ul><li><strong>ä½¿ç”¨æµ‹è¯•æ›¿èº«</strong>:<br>ä½¿ç”¨æµ‹è¯•æ›¿èº«ï¼Œæ¯”å¦‚mock,spyå’Œstubæ¥éš”ç¦»ä»–ä»¬çš„ä¾èµ–å’Œç»„ä»¶ï¼Œè®©æµ‹è¯•æ›´å¿«å’Œæ›´å¯é ã€‚æµ‹è¯•æ›¿èº«å¯ä»¥éš”ç¦»ç»„ä»¶å’Œä¾èµ–ï¼Œè®©æµ‹è¯•æ›´åŠ å¿«é€Ÿå’Œå¯é ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå‡è®¾ä½ æœ‰<FetchData />ç»„ä»¶ï¼Œå®ƒä»APIè·å–æ•°æ®å¹¶ä¸”åœ¨å±å¹•ä¸Šå±•ç¤ºã€‚å½“æµ‹è¯•<FetchData />ç»„ä»¶çš„æ—¶å€™ï¼Œä½ ä¸æƒ³å‘é€ä¸€ä¸ªAPIçš„ç½‘ç»œè¯·æ±‚ï¼Œå› ä¸ºè¿™ä¼šå‡ç¼“æµ‹è¯•é€Ÿåº¦ï¼Œå¹¶ä¸”æ²¡æœ‰é‚£ä¹ˆå¯é ï¼ˆæ¯”å¦‚ï¼ŒAPIä¼šæŒ‚æ‰ï¼Œå“åº”åœ¨æ¯æ¬¡è¿”å›éƒ½ä¸åŒï¼‰ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ï¼Œä½ å¯ä»¥ä½¿ç”¨æµ‹è¯•æ›¿èº«æ¥æ¨¡æ‹ŸAPIå“åº”ã€‚è¿™é‡Œæ¼”ç¤ºäº†å¦‚ä½•ä½¿ç”¨mockæ¥æµ‹è¯•<FetchData /> ç»„ä»¶ï¼š</li></ul><pre><code class="javascript">it(&quot;renders data correctly&quot;, () =&gt; &#123;  const apiResponse = [    &#123; id: 1, name: &quot;John&quot; &#125;,    &#123; id: 2, name: &quot;Jane&quot; &#125;,  ];  const mockFetchData = jest.fn().mockResolvedValue(apiResponse);  const wrapper = shallow(&lt;FetchData fetchData=&#123;mockFetchData&#125; /&gt;);  // ç­‰å¾…ç»„ä»¶æ¸²æŸ“  setTimeout(() =&gt; &#123;    expect(wrapper.text()).toContain(&quot;John&quot;);    expect(wrapper.text()).toContain(&quot;Jane&quot;);  &#125;, 0);&#125;);</code></pre><p>è¿™ä¸ªä¾‹å­ä¸­ï¼Œ mockFetchDataå‡½æ•°æ¨¡ä»¿APIå“åº”ã€‚mockFetchDataå‡½æ•°ä½œä¸ºpropä¼ é€’ç»™<FetchData />ç»„ä»¶ï¼Œæ‰€ä»¥ä¼šè°ƒç”¨mockFetchDataè€Œä¸æ˜¯çœŸæ­£çš„ç½‘ç»œè¯·æ±‚ã€‚è¿™è®©æµ‹è¯•æ›´åŠ å¿«æ·ä¸”å¯é ï¼Œå› ä¸ºæµ‹è¯•ä¸å†ä¾èµ–APIã€‚<br>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨spieså’Œstubsæ¥éš”ç¦»ç»„ä»¶å’Œä»–ä»¬çš„ä¾èµ–ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œä½ ä¹Ÿè®¸ä¼šä½¿ç”¨spyæ£€æµ‹æŸä¸ªåŠŸèƒ½æ˜¯å¦è¢«è°ƒç”¨æˆ–è€…ä½¿ç”¨stubç”¨ç®€å•ç‰ˆæœ¬çš„å¯¹è±¡ä»£æ›¿çœŸæ­£çš„å¯¹è±¡æ¥æµ‹è¯•ã€‚ä½¿ç”¨æµ‹è¯•æ›¿èº«æ˜¯æŠŠç»„ä»¶å’Œä¾èµ–æœ‰æ•ˆçš„éš”ç¦»å¼€æ¥ï¼Œè®©æµ‹è¯•æ›´åŠ å¿«æ·å’Œå¯é ã€‚è¿™æ˜¯æµ‹è¯•å·¥å…·åŒ…ä¸­çš„ä¸€é¡¹çè´µçš„æŠ€æœ¯ã€‚</p><ul><li>ä¿æŒæµ‹è¯•ç”¨ä¾‹æœ€æ–°:è®©æµ‹è¯•ç”¨ä¾‹è·Ÿéšä»£ç çš„æœ€æ–°ä¿®æ”¹è€Œæ›´æ–°ã€‚è¿™å¯ä»¥ç¡®ä¿æµ‹è¯•ç”¨ä¾‹ä¸€ç›´åˆæ³•å’Œæœ‰ä½œç”¨ã€‚</li><li>éš”ç¦»æµ‹è¯•ï¼š å°½å¯èƒ½éš”ç¦»æµ‹è¯•ç»„ä»¶é¿å…æµ‹è¯•ä¾èµ–é¡¹ã€‚</li></ul><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å•å…ƒæµ‹è¯•å¸®åŠ©æˆ‘ä»¬ç¡®ä¿ç»„ä»¶æ­£å¸¸å·¥ä½œä»¥åŠå¯¹ä»£ç åº“åšçš„ä¿®æ”¹ä¸ä¼šç ´åå·²æœ‰åŠŸèƒ½ã€‚è¿™å¯ä»¥æ˜¾è‘—æé«˜Reactåº”ç”¨çš„æ•´ä½“è´¨é‡å’Œå¯é æ€§ã€‚ é™¤æ­¤ä¹‹å¤–ï¼ŒReact testing library ä¹Ÿå¾ˆå®¹æ˜“ä½¿ç”¨ã€‚å®ƒèƒ½å’Œå…¶ä»–æµ‹è¯•æ¡†æ¶å¾ˆå¥½çš„é›†æˆï¼Œè¿™å¯¹ä»»ä½•ä¸€ä¸ªæœŸæœ›åœ¨ä»–ä»¬é¡¹ç›®é‡Œå®ç°å•å…ƒæµ‹è¯•çš„Reactå¼€å‘è€…éƒ½æ˜¯ä¸€ä¸ªå¥½çš„é€‰æ‹©ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> React </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-whats-new-in-http3</title>
      <link href="/2023/04/16/fan-yi-whats-new-in-http3/"/>
      <url>/2023/04/16/fan-yi-whats-new-in-http3/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://medium.com/better-programming/whats-new-in-http-3-10c2455a4f8c">https://medium.com/better-programming/whats-new-in-http-3-10c2455a4f8c</a></p><h2 id="HTTP-x2F-3-ä¸­çš„æ–°ç‰¹æ€§"><a href="#HTTP-x2F-3-ä¸­çš„æ–°ç‰¹æ€§" class="headerlink" title="HTTP&#x2F;3 ä¸­çš„æ–°ç‰¹æ€§?"></a>HTTP&#x2F;3 ä¸­çš„æ–°ç‰¹æ€§?</h2><h3 id="æ¼«æ¸¸-HTTP-x2F-0-9-HTTP-x2F-1-0-HTTP-x2F-1-1-HTTP-x2F-2-and-HTTP-x2F-3"><a href="#æ¼«æ¸¸-HTTP-x2F-0-9-HTTP-x2F-1-0-HTTP-x2F-1-1-HTTP-x2F-2-and-HTTP-x2F-3" class="headerlink" title="æ¼«æ¸¸ HTTP&#x2F;0.9, HTTP&#x2F;1.0, HTTP&#x2F;1.1, HTTP&#x2F;2, and HTTP&#x2F;3"></a>æ¼«æ¸¸ HTTP&#x2F;0.9, HTTP&#x2F;1.0, HTTP&#x2F;1.1, HTTP&#x2F;2, and HTTP&#x2F;3</h3><blockquote><p>â€œè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰æ˜¯åº”ç”¨å±‚åè®®ï¼Œç”¨äºåˆ†å¸ƒå¼ã€åä½œå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿã€‚å®ƒæ˜¯ä¸€ä¸ªé€šç”¨çš„ã€æ— çŠ¶æ€çš„åè®®ï¼Œå¯ä»¥ç”¨äºè¶…æ–‡æœ¬ä»¥å¤–çš„å¾ˆå¤šä»»åŠ¡ï¼Œæ¯”å¦‚ï¼šname server å’Œåˆ†å¸ƒå¼å¯¹è±¡ç®¡ç†ç³»ç»Ÿã€‚-<a href="https://www.w3.org/Protocols/rfc2616/rfc2616.html">W3</a></p></blockquote><p>HTTP ä½¿æµè§ˆå™¨å’ŒæœåŠ¡å™¨èƒ½å¤Ÿé€šä¿¡ã€‚å®ƒæ„æˆäº† web æœåŠ¡å™¨æ‰§è¡Œæœ€åŸºç¡€çš„æ“ä½œæ‰€å¿…é¡»æœ‰çš„åŸºç¡€ã€‚HTTP ç»å†äº†å¤šä¸ªé˜¶æ®µã€‚æœ€æ–°çš„è‰æ¡ˆ <a href="https://quicwg.org/base-drafts/draft-ietf-quic-http.html">è¶…æ–‡æœ¬ä¼ è¾“åè®®ç‰ˆæœ¬ 3</a> (HTTP&#x2F;3)åœ¨ 2021 å¹´ 5 æœˆ 27 æ—¥å‘å¸ƒã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬äº†è§£ä¸‹ HTTP çš„å†å²ï¼Œå¹¶æ¢ç´¢ HTTP&#x2F;3 ä¸­çš„æ–°ç‰¹æ€§ã€‚</p><h2 id="HTTP-x2F-0-9"><a href="#HTTP-x2F-0-9" class="headerlink" title="HTTP&#x2F;0.9"></a>HTTP&#x2F;0.9</h2><p><a href="https://en.wikipedia.org/wiki/Tim_Berners-Lee">Sir Timothy John Berners-Lee</a> , ä¹Ÿè¢«ç§°ä¸º TimBL,æ˜¯è‹±å›½çš„è®¡ç®—æœºç§‘å­¦å®¶ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ä¸‡ç»´ç½‘çš„å‘æ˜è€…ã€‚ä»–åœ¨ 1989 å¹´åˆ›å»ºäº†ä¸€è¡Œçš„ HTTP åè®® . ç®€å•åœ°è¿”å›äº†ä¸€ä¸ªç½‘é¡µã€‚è¿™ä¸ªåè®®åœ¨ 1991 å¹´è¢«å‘½åä¸º HTTP&#x2F;0.9ã€‚</p><p>å®ƒåªæ˜¯ä¸€ä¸ªç®€å•çš„<a href="https://www.w3.org/Protocols/HTTP/AsImplemented.html">å•é¡µè§„èŒƒ</a>ã€‚åªæœ‰ä¸€ç§æ–¹æ³•ï¼šGET,åé¢è·Ÿç€æ–‡æ¡£åœ°å€å’Œå¯é€‰ç«¯å£åœ°å€ï¼Œä»¥å›è½¦(CR)å’Œæ¢è¡Œ(LF)ä½œä¸ºç»“æŸï¼š</p><pre><code class="bash">    GET /aWebpage.html</code></pre><p>å“åº”å¯èƒ½æ˜¯è¢«è¯·æ±‚çš„ HTML æ–‡ä»¶:</p><pre><code class="html">&lt;html&gt;  The Webpage content&lt;/html&gt;</code></pre><p>æˆ–è€…ä¹Ÿæœ‰å¯èƒ½æ˜¯ä¸€ä¸ªé”™è¯¯é¡µé¢:</p><pre><code class="html">&lt;html&gt;  Cannot get the page&lt;/html&gt;</code></pre><p>HTTP&#x2F;0.9 æœ‰ 4 ä¸ªæœ¯è¯­ï¼šè¿æ¥ï¼Œæ–­å¼€è¿æ¥ï¼Œè¯·æ±‚å’Œå“åº”ã€‚æ²¡æœ‰ HTTP å¤´ï¼ŒçŠ¶æ€ç ã€é”™è¯¯ç ï¼Œä¹Ÿæ²¡æœ‰ cookie ä»¥åŠå…¶ä»–çš„ç°ä»£ç‰¹æ€§ã€‚HTTP&#x2F;0.9 æ˜¯åŸºäº TCPâ€”â€”ä¼ è¾“æ§åˆ¶åè®® æ„å»ºçš„ã€‚connection ä¼šåœ¨å“åº”åç«‹åˆ»ç»ˆæ­¢ã€‚</p><h2 id="HTTP-x2F-1-0"><a href="#HTTP-x2F-1-0" class="headerlink" title="HTTP&#x2F;1.0"></a>HTTP&#x2F;1.0</h2><p>1996 å¹´ HTTP&#x2F;1.0 å‘å¸ƒã€‚<a href="https://datatracker.ietf.org/doc/html/rfc1945">è§„èŒƒ</a>æ˜¾è‘—æ‰©å±•ï¼Œæ”¯æŒä¸‰ç§æ–¹æ³•ï¼šGET, Head å’Œ POSTã€‚å¢åŠ äº†æœ¯è¯­ï¼š æ¶ˆæ¯, èµ„æº, å®ä½“, å®¢æˆ·ç«¯, ç”¨æˆ·ä»£ç†, æœåŠ¡ç«¯, æºæœåŠ¡å™¨, ä»£ç†, ç½‘å…³, éš§é“å’Œ ç¼“å­˜ã€‚</p><p>ä¸‹é¢æ˜¯åœ¨ HTTP&#x2F;0.9 åŸºç¡€ä¸Š HTTP&#x2F;1.0 åšå‡ºçš„æ”¹è¿›ï¼š</p><ul><li>æ¯ä¸ªè¯·æ±‚éƒ½é™„åŠ  HTTP ç‰ˆæœ¬ã€‚</li><li>çŠ¶æ€ç åœ¨å“åº”çš„å¼€å¤´è¢«å‘é€ã€‚</li><li>è¯·æ±‚å’Œå“åº”éƒ½åŒ…æ‹¬ HTTP å¤´ã€‚</li><li>å¤´éƒ¨çš„å…ƒæ•°æ®è®©åè®®æ›´åŠ çµæ´»å’Œæ˜“æ‰©å±•ã€‚</li><li>å¤´éƒ¨çš„ content type ä½¿å¾— http æœ‰èƒ½åŠ›ä¼ è¾“ HTML æ–‡ä»¶ä»¥å¤–çš„æ–‡æ¡£ã€‚</li></ul><p>ä½†æ˜¯ï¼ŒHTTP&#x2F;1.0 ä¸æ˜¯å®˜æ–¹æ ‡å‡†ã€‚</p><h2 id="HTTP-x2F-1-1"><a href="#HTTP-x2F-1-1" class="headerlink" title="HTTP&#x2F;1.1"></a>HTTP&#x2F;1.1</h2><p>HTTP ç¬¬ä¸€ä¸ªæ ‡å‡†åŒ–ç‰ˆæœ¬ HTTP&#x2F;1.1 (<a href="https://datatracker.ietf.org/doc/html/rfc2068">RFC 2068</a>)å‘å¸ƒäº 1997 å¹´åˆï¼Œè·ç¦» HTTP&#x2F;1.0 åªæœ‰å‡ ä¸ªæœˆã€‚ HTTP&#x2F;1.1 æ”¯æŒ 7 ç§æ–¹æ³•ï¼šOPTIONS, GET, HEAD, POST, PUT, DELETE å’Œ TRACEã€‚2010 å¹´<a href="https://datatracker.ietf.org/doc/html/rfc5789">RFC 5789</a>å¢åŠ äº† PATCH,2014 å¹´<a href="https://datatracker.ietf.org/doc/html/rfc7231">RFC 7231</a> å¢åŠ äº† CONNECTã€‚</p><p>HTTP&#x2F;1.1 é™„åŠ çš„æœ¯è¯­ï¼šrepresentation, content negotiation, variant, cachable, first-hand, explicit expiration time, heuristic expiration time, age, freshness lifetime, fresh, stale, semantically transparent å’Œ validator.</p><p>HTTP&#x2F;1.1 æ˜¯ HTTP 1.0 çš„å¢å¼ºç‰ˆï¼š</p><ul><li>è™šæ‹Ÿä¸»æœºå…è®¸å¤šä¸ªä»å•ä¸ª ip æä¾›å¤šä¸ªåŸŸã€‚</li><li>æŒä¹…åŒ–å’Œæµæ°´çº¿è¿æ¥ä½¿å¾— web æµè§ˆå™¨å¯ä»¥é€šè¿‡å•ä¸ªçš„æŒä¹…åŒ–è¿æ¥å‘é€å¤šä¸ªè¯·æ±‚ã€‚</li><li>ç¼“å­˜èƒ½å¤Ÿæ”¯æŒèŠ‚çœå¸¦å®½ï¼Œè®©å“åº”æ›´åŠ å¿«é€Ÿã€‚</li><li>åˆ†å—ä¼ è¾“ç¼–ç å¯ä»¥åœ¨çŸ¥é“æ€»é•¿åº¦ä¹‹å‰å°±å‘é€å“åº”ã€‚è¿™ä½¿å¾—åŠ¨æ€ç”Ÿæˆé¡µé¢æˆä¸ºå¯èƒ½ã€‚</li><li>åŒ…æ‹¬è¯­è¨€ï¼Œç¼–ç æˆ–è€…ç±»å‹åœ¨å†…å¤šç§æ–¹å¼çš„å†…å®¹åå•†ï¼Œä½¿å¾—å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯å°±è¦äº¤æ¢çš„æœ€é€‚åˆçš„å†…å®¹è¾¾æˆä¸€è‡´ã€‚</li></ul><p>HTTP&#x2F;1.1 åœ¨æ¥ä¸‹æ¥çš„ 15 å¹´å·¦å³éå¸¸ç¨³å®šã€‚åœ¨é‚£æœŸé—´ï¼ŒHTTPSï¼ˆå®‰å…¨è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰å‡ºç°äº†ã€‚å®ƒæ˜¯ HTTP çš„å®‰å…¨ç‰ˆæœ¬ï¼Œä½¿ç”¨ SSL&#x2F;TLS è¿›è¡Œå®‰å…¨çš„åŠ å¯†é€šä¿¡ã€‚</p><p>2000 å¹´ä»¥æ¥ï¼Œweb API çš„çœŸå®æ½œåŠ›è¢«è®¤å¯ã€‚Roy Fielding å¸¦é¢†ä¸€ç»„ä¸“å®¶å‘æ˜äº† RESTï¼šREpresentational State Transferã€‚ REST æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œå®šä¹‰äº†åˆ›å»º web æœåŠ¡æ—¶å¿…é¡»éµå®ˆçš„ä¸€ç³»åˆ—çš„çº¦æŸå’Œæ ‡å‡†ã€‚REST API åœ¨ HTTP&#x2F;1.1 åŠä»¥ä¸Šç”Ÿæ•ˆã€‚</p><h2 id="HTTP-x2F-2"><a href="#HTTP-x2F-2" class="headerlink" title="HTTP&#x2F;2"></a>HTTP&#x2F;2</h2><p>HTTP&#x2F;2 æ—¨åœ¨æ›´é«˜æ•ˆçš„ä½¿ç”¨ç½‘ç»œèµ„æºï¼Œå‡å°‘å¯¹å»¶è¿Ÿçš„æ„ŸçŸ¥ã€‚å®ƒå¼•å…¥äº†æ–°çš„äºŒè¿›åˆ¶åˆ†å¸§ï¼Œè¯¥å±‚ä¸èƒ½å‘åå…¼å®¹ HTTP&#x2F;1.x çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯ã€‚</p><p>HTTP&#x2F;2 çš„ç¬¬ä¸€ä¸ªè‰æ¡ˆä½¿ç”¨ SPDY ä½œä¸ºè§„èŒƒè‰æ¡ˆçš„å·¥ä½œåŸºç¡€ã€‚<a href="https://datatracker.ietf.org/doc/html/rfc7540">è¿™ä¸ªè§„èŒƒ</a>äº 2015 å¹´å‘å¸ƒã€‚å¢åŠ äº†æœ¯è¯­ï¼š connection error, endpoint, frame, peer, receiver, sender, stream, stream error, intermediary, å’Œ payload bodyã€‚</p><p>HTTP&#x2F;2 åœ¨æµä¸Šæ„å»ºäº†å¹¶è¡ŒåŒ–ã€ä¼˜å…ˆçº§å’Œæµé‡æ§åˆ¶ï¼š</p><ul><li>stream æ˜¯åœ¨å·²å»ºç«‹çš„ TCP è¿æ¥ä¸­çš„åŒå‘å­—èŠ‚æµï¼Œå¯ä»¥æºå¸¦ä¸€æ¡æˆ–å¤šæ¡æ¶ˆæ¯ã€‚</li><li>é€šä¿¡é€šè¿‡å…·æœ‰ä»»æ„æ•°é‡çš„åŒå‘æµçš„å•ä¸ªTCPè¿æ¥å®Œæˆã€‚</li><li>è¿™æ˜¯ä¸€ä¸ªå¤šè·¯å¤ç”¨åè®®ã€‚å¯ä»¥è®©å¤šä¸ªå¹¶è¡Œè¯·æ±‚åœ¨åŒä¸€ä¸ªè¿æ¥ä¸Šå¤„ç†ã€‚</li><li>å®ƒæ‹¥æœ‰ä¼˜å…ˆæ’åºä¸€ä¸ªèµ„æºè€Œä¸æ˜¯å¦ä¸€ä¸ªèµ„æºçš„èƒ½åŠ›,å› æ­¤å¯ä»¥æŠŠä»–æ”¾åœ¨å“åº”è¡Œå¤´éƒ¨ã€‚</li><li>å…è®¸æœªç»è¯·æ±‚å°±å°†representationä»æœåŠ¡ç«¯æ¨é€åˆ°å®¢æˆ·ç«¯ã€‚</li><li>å®ƒä½¿ç”¨äº†äºŒè¿›åˆ¶åè®®è€Œä¸æ˜¯æ–‡æœ¬ã€‚è¿™è®©å®ƒå¯ä»¥è¢«æœºå™¨è¯»å–,æ€§èƒ½å¾—åˆ°æé«˜ã€‚åŒæ—¶ä¹Ÿæé«˜äº†æ€»ä½“ä¸Šçš„å®‰å…¨æ€§ã€‚</li><li>è¯·æ±‚å¤´å’Œå“åº”å¤´éƒ½æ˜¯è¢«å‹ç¼©çš„ã€‚</li><li>å¸§åœ¨æµä¸Šä¼ è¾“,æ•°æ®å¸§çš„è½½è·å—åˆ°æµæ§åˆ¶ã€‚</li></ul><h2 id="HTTP-x2F-3"><a href="#HTTP-x2F-3" class="headerlink" title="HTTP&#x2F;3"></a>HTTP&#x2F;3</h2><p>ç”±äº TCP ä¿è¯å‘é€å’Œæ¥æ”¶æ•°æ®åŒ…çš„é¡ºåºï¼Œå› æ­¤ä¸¢å¤±çš„æ•°æ®åŒ…å°†åœæ­¢æ‰€æœ‰æµï¼Œå³ä½¿å®ƒå¯èƒ½åªå½±å“å…¶ä¸­ä¸€ä¸ªæµã€‚HTTP&#x2F;2 æ²¡æœ‰å¼ºåˆ¶åŠ å¯†ï¼Œå®ƒå®¹æ˜“å—åˆ°æµé‡ç”¨æ”»å‡»ä»¥åŠå‹ç¼©é¡µé¢æ ‡é¢˜å’Œ cookie æ”»å‡»ã€‚</p><p>HTTP&#x2F;3å¯ä»¥è§£å†³ä¸‹é¢è¿™äº›é—®é¢˜ã€‚</p><p>HTTP&#x2F;3æ˜¯ç»§HTTP&#x2F;1.1 å’ŒHTTP&#x2F;2åçš„ç¬¬ä¸‰å¤§ç‰ˆæœ¬ã€‚ç›®å‰ï¼Œè¿™ä»ç„¶åªæ˜¯ä¸€ä¸ªè‰æ¡ˆã€‚<a href="https://quicwg.org/base-drafts/draft-ietf-quic-http.html">æœ€æ–°è§„èŒƒ</a>åœ¨2021å¹´5æœˆ27æ—¥å‘å¸ƒã€‚å®ƒå¢åŠ äº†æœ¯è¯­ï¼šabort,HTTP&#x2F;3 connectionå’Œcontentã€‚</p><p>HTTP&#x2F;3 æ˜¯ä¸€ç§æ–°çš„ã€å¿«é€Ÿçš„ã€å¯é çš„ã€å®‰å…¨çš„åè®®ï¼Œé€‚ç”¨äºæ‰€æœ‰å½¢å¼çš„è®¾å¤‡ã€‚</p><ul><li>HTTP&#x2F;3é‡‡ç”¨äº†æ–°çš„åè®®â€”â€”QUICè€Œä¸æ˜¯TCPï¼Œè¿™æ¬¾åè®®ç”±è°·æ­Œåœ¨2013å¹´å¼€å‘ã€‚QUICåŸºäºUDPâ€”â€”ç”¨æˆ·æ•°æ®æŠ¥åè®®è¿è¡Œï¼Œ</li><li>QUICæä¾›æœ¬åœ°çš„å¤šè·¯æœç”¨ï¼Œä¸¢çš„åŒ…åªä¼šå½±å“æ•°æ®å·²ç»ä¸¢å¤±çš„æµã€‚è¿™è§£å†³äº†HTTP&#x2F;2ä¸­çš„çº¿ç«¯é˜»å¡é—®é¢˜ã€‚</li><li>QUICä¸ºæµæ•°æ®å’Œåœ¨æµä¸Šå‘é€çš„ HTTP&#x2F;3å¸§ç±»å‹æä¾›æµæ§åˆ¶ã€‚å› æ­¤æ‰€æœ‰å¸§çš„headerå’Œpayloadéƒ½å—æµæ§åˆ¶çš„çº¦æŸã€‚</li><li>è¯·æ±‚å¤´å’Œå“åº”å¤´éƒ½æ˜¯é€šè¿‡QPACKå‹ç¼©è€Œä¸æ˜¯é€šè¿‡HTTP&#x2F;2çš„HPACKã€‚</li><li>å¤šä¸ªHTTP&#x2F;3å¸§ç”¨äºç®¡ç†æœåŠ¡å™¨æ¨é€ã€‚</li><li>HTTP&#x2F;3åŒ…æ‹¬äº† TLS 1.3 åŠ å¯†ã€‚äº‹å®ä¸Šï¼Œå®ƒæ‹…ä»»äº†HTTPSçš„è§’è‰²ã€‚</li></ul><h2 id="HTTP-x2F-3-æ”¯æŒåº¦"><a href="#HTTP-x2F-3-æ”¯æŒåº¦" class="headerlink" title="HTTP&#x2F;3 æ”¯æŒåº¦"></a>HTTP&#x2F;3 æ”¯æŒåº¦</h2><p>HTTP&#x2F;3 brings revolutionary changes to improve web performance and security. Setting up an HTTP&#x2F;3 website requires both server and browser support.<br>HTTP&#x2F;3ä¸ºæå‡webæ€§èƒ½å’Œå®‰å…¨å¸¦æ¥äº†é©å‘½æ€§å˜é©ã€‚å»ºç«‹HTTP&#x2F;3 ç½‘ç«™éœ€è¦æœåŠ¡å™¨å’Œæµè§ˆå™¨åŒæ—¶æ”¯æŒã€‚</p><h3 id="æœåŠ¡å™¨æ”¯æŒ"><a href="#æœåŠ¡å™¨æ”¯æŒ" class="headerlink" title="æœåŠ¡å™¨æ”¯æŒ"></a>æœåŠ¡å™¨æ”¯æŒ</h3><p>ç›®å‰ï¼Œ<a href="https://cloud.google.com/">Google Cloud</a>, <a href="https://www.cloudflare.com/">Cloudflare</a> å’Œ<a href="https://www.fastly.com/">Fastly</a>æ”¯æŒ HTTP&#x2F;3ã€‚</p><h3 id="æµè§ˆå™¨æ”¯æŒ"><a href="#æµè§ˆå™¨æ”¯æŒ" class="headerlink" title="æµè§ˆå™¨æ”¯æŒ"></a>æµè§ˆå™¨æ”¯æŒ</h3><p>Chrome, Firefox, Edge, Operaå’Œéƒ¨åˆ†ç§»åŠ¨ç«¯æµè§ˆå™¨æ”¯æŒHTTP&#x2F;3ã€‚æˆ‘ä»¬å¯ä»¥å»<a href="https://caniuse.com/?search=http3">https://caniuse.com/?search=http3</a> æ£€æŸ¥æ›´æ–°åçš„æµè§ˆå™¨çš„æ”¯æŒåº¦ã€‚ç»¿è‰²å•å…ƒæ ¼åˆ—å‡ºäº†æ”¯æŒçš„æµè§ˆå™¨ç‰ˆæœ¬ã€‚</p><p><img src="https://cdn-images-1.medium.com/max/2896/1*3m1FjB_lXyS2y1kBiZ8sEg.png" alt="HTTP/3 browser support table by [Can I use...](https://caniuse.com/?search=http3)"></p><p>åœ¨Chromeä¸­ï¼ŒHTTP&#x2F;3 å¯ä»¥ä½œä¸ºä¸€ä¸ªè¯•éªŒæ€§åè®®è¢«å¯ç”¨ã€‚å½“æˆ‘ä»¬åœ¨æµè§ˆå™¨urlè¾“å…¥chrome:&#x2F;&#x2F;flagsçš„æ—¶å€™ï¼Œå¯ä»¥çœ‹è§QUIC é»˜è®¤æ˜¯å¯ç”¨çš„ã€‚<br><img src="https://cdn-images-1.medium.com/max/2000/1*KsBjkghHX0kQdeAEtjx-ow.png"></p><h2 id="åè®®æ£€æŸ¥"><a href="#åè®®æ£€æŸ¥" class="headerlink" title="åè®®æ£€æŸ¥"></a>åè®®æ£€æŸ¥</h2><p>è¯·æ±‚&#x2F;å“åº”çš„åè®®å¯ä»¥é€šè¿‡NetWorkæ ‡ç­¾é¡µæ£€æŸ¥ã€‚æ‰“å¼€è°·æ­Œå¼€å‘è€…å·¥å…·ï¼Œé€‰ä¸­Networkæ ‡ç­¾ã€‚å½“å³é”®ç‚¹å‡»è¡¨å¤´çš„æ—¶å€™ï¼Œåè®®åˆ—å¯ä»¥è¢«é€‰ä¸­è€Œå±•ç¤ºè¯¥åˆ—ã€‚</p><p><img src="https://cdn-images-1.medium.com/max/2274/1*Km5elHxixk9Y5jhaFkRQbg.png"></p><p>æ ¹æ®<a href="https://w3techs.com/technologies/overview/site_element%EF%BC%8C%E6%88%AA%E6%AD%A2%E5%88%B02021">https://w3techs.com/technologies/overview/site_elementï¼Œæˆªæ­¢åˆ°2021</a> å¹´ 7 æœˆï¼Œ45.7% çš„ç½‘ç«™ä½¿ç”¨ HTTP&#x2F;2ï¼Œ20% çš„ç½‘ç«™ä½¿ç”¨ HTTP&#x2F;3ã€‚<br><img src="https://cdn-images-1.medium.com/max/2000/1*LvJFI64o1rI44tVyfNoffg.png" alt="An image generated by [W3Techs](https://w3techs.com/technologies/overview/site_element)"></p><h3 id="HTTP-x2F-1-1-æ¡ˆä¾‹"><a href="#HTTP-x2F-1-1-æ¡ˆä¾‹" class="headerlink" title="HTTP&#x2F;1.1 æ¡ˆä¾‹"></a>HTTP&#x2F;1.1 æ¡ˆä¾‹</h3><p>ç›®å‰æ²¡æœ‰å¤ªå¤šçš„å…¬å¼€ç½‘ç«™ä»ç„¶è¿˜åœ¨ä½¿ç”¨HTTP&#x2F;1.1åè®®ã€‚AT&amp;Tçš„ç™»å½•é¡µå±äºå…¶ä¸­ä¹‹ä¸€ã€‚<br><img src="https://cdn-images-1.medium.com/max/2846/1*iJBck-4B0YoEgQigzxy8nQ.png" alt="AT&amp;T ç™»é™†é¡µ"></p><h3 id="HTTP-x2F-2-æ¡ˆä¾‹"><a href="#HTTP-x2F-2-æ¡ˆä¾‹" class="headerlink" title="HTTP&#x2F;2 æ¡ˆä¾‹"></a>HTTP&#x2F;2 æ¡ˆä¾‹</h3><p>å¤§éƒ¨åˆ†å…¬å¼€ç½‘ç«™éƒ½è¿è¡Œåœ¨HTTP&#x2F;2,AT&amp;Tå®˜ç½‘ä¹Ÿæ˜¯å¦‚æ­¤ï¼š<br><img src="https://cdn-images-1.medium.com/max/2846/1*oQ162JFnETIOGmkc3NpghQ.png" alt="AT&amp;Tå®˜ç½‘"></p><h3 id="HTTP-x2F-3-æ¡ˆä¾‹"><a href="#HTTP-x2F-3-æ¡ˆä¾‹" class="headerlink" title="HTTP&#x2F;3 æ¡ˆä¾‹"></a>HTTP&#x2F;3 æ¡ˆä¾‹</h3><p>HTTP&#x2F;3çš„YouTubeé¡µé¢ã€‚</p><p><img src="https://cdn-images-1.medium.com/max/2846/1*QgDSM-J_oDAyKwfKtTXQKw.png" alt="Youtubeå®˜æ–¹é¡µé¢"></p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æˆ‘ä»¬äº†è§£äº†HTTP&#x2F;0.9, HTTP&#x2F;1.0, HTTP&#x2F;1.1, HTTP&#x2F;2, å’Œ HTTP&#x2F;3. HTTP&#x2F;3 ä½¿ç”¨QUICï¼Œå®ƒåŸºäºUDPè¿è¡Œã€‚è¿™æ˜¯ä¸€ç§æ–°çš„ï¼Œå¿«é€Ÿå¯é çš„è·¨è®¾å¤‡å®‰å…¨åè®®ã€‚<br>ä½ æ­£åœ¨è€ƒè™‘æŠŠä½ çš„åº”ç”¨è¿ç§»åˆ°HTTP&#x2F;3æœåŠ¡å™¨ä¸Šï¼Ÿæˆ–è€…å·²ç»æ›´æ–°æµè§ˆå™¨é€šè¿‡HTTP&#x2F;3æ¥æŸ¥çœ‹webåº”ç”¨?</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cobraå­¦ä¹ ç¬”è®°</title>
      <link href="/2023/04/03/cobra-xue-xi-bi-ji/"/>
      <url>/2023/04/03/cobra-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<p>cobraæœ¬è´¨ï¼šGoçš„CLIï¼ˆå‘½ä»¤è¡Œç•Œé¢ï¼‰æ¡†æ¶<br>cobraä½œç”¨ï¼š</p><ul><li>åŒ…å«åˆ›å»ºç°ä»£åŒ–CLIåº”ç”¨çš„åº“</li><li>åŒ…å«ä¸€ä¸ªç”¨äºå¿«é€Ÿç”ŸæˆåŸºäºCobraçš„åº”ç”¨å’Œå‘½ä»¤æ–‡ä»¶çš„å·¥å…·</li></ul><h2 id="å®‰è£…å’Œå¯¼å…¥"><a href="#å®‰è£…å’Œå¯¼å…¥" class="headerlink" title="å®‰è£…å’Œå¯¼å…¥"></a>å®‰è£…å’Œå¯¼å…¥</h2><pre><code class="bash">go get -u github.com/spf13/cobra@latestimport &quot;github.com/spf13/cobra&quot;</code></pre><h2 id="åŸºç¡€æ¦‚å¿µ"><a href="#åŸºç¡€æ¦‚å¿µ" class="headerlink" title="åŸºç¡€æ¦‚å¿µ"></a>åŸºç¡€æ¦‚å¿µ</h2><h3 id="Command"><a href="#Command" class="headerlink" title="Command"></a>Command</h3><ul><li>å‘½ä»¤ï¼Œè¡¨ç¤ºä¸€ä¸ªè¡Œä¸ºæˆ–è€…åŠ¨ä½œï¼Œæ¯”å¦‚<code>serve</code>,<code>add</code>,<code>version</code></li><li>ä¸€ä¸ªå‘½ä»¤å¯ä»¥æœ‰å¤šä¸ªå­å‘½ä»¤</li></ul><h3 id="Arg"><a href="#Arg" class="headerlink" title="Arg"></a>Arg</h3><ul><li>å‚æ•°ï¼Œä»£è¡¨æŸä¸ªå¯¹è±¡æˆ–äº‹ç‰©</li><li>é€šå¸¸ä½äºå‘½ä»¤ä¹‹åï¼Œæ¯”å¦‚<code>serve web</code> ä¸­çš„ <code>web</code></li></ul><h3 id="Flags"><a href="#Flags" class="headerlink" title="Flags"></a>Flags</h3><ul><li>æ ‡è®°ï¼Œç”¨äºä¿®é¥°æˆ–è€…é…ç½®å‘½ä»¤çš„è¡Œä¸ºï¼Œä»¥<code>--</code>æˆ–è€…<code>-</code>å¼€å¤´</li><li>æ¯”å¦‚ <code>--port</code>æˆ–è€…<code>-p</code></li></ul><h2 id="éµå¾ªçš„æ¨¡å¼ï¼š"><a href="#éµå¾ªçš„æ¨¡å¼ï¼š" class="headerlink" title="éµå¾ªçš„æ¨¡å¼ï¼š"></a>éµå¾ªçš„æ¨¡å¼ï¼š</h2><ol><li><code>APPNAME VERB NOUN --ADJECTIVE</code><br>git(APPNAME) add(VERB) file(NOUN)</li><li><code>APPNAME COMMAND ARG --FLAG</code><br>git(APPNAME) commit(COMMAND) docs&#x2F;README.md(ARG) -m(FLAG)</li></ol><h3 id="ä¸¾ä¾‹"><a href="#ä¸¾ä¾‹" class="headerlink" title="ä¸¾ä¾‹"></a>ä¸¾ä¾‹</h3><p><code>hugo serve -p 8080 --baseURL https://example.com </code></p><ul><li>command: serve,è¡¨ç¤ºå¯åŠ¨hugoçš„æœåŠ¡å™¨</li><li>flagï¼š<code>-p</code>,<code>--baseUrl</code>,ç”¨äºè®¾ç½®ç«¯å£å’ŒbaseUrl</li><li>argï¼šæ— </li></ul><p><code>git add . </code></p><ul><li>command: add,è¡¨ç¤ºgitæ·»åŠ æ–‡ä»¶</li><li>flagï¼šæ— </li><li>argï¼š<code>.</code>ï¼Œä»£è¡¨å½“å‰ç›®å½•<br><code>git commit -m &quot;Update README&quot;</code></li><li>command: commit,è¡¨ç¤ºgitæäº¤æ–‡ä»¶</li><li>flagï¼š<code>-m</code>,è®¾ç½®æäº¤ä¿¡æ¯</li><li>argï¼šæ— </li></ul><h3 id="flagå’Œargçš„åŒºåˆ«"><a href="#flagå’Œargçš„åŒºåˆ«" class="headerlink" title="flagå’Œargçš„åŒºåˆ«"></a>flagå’Œargçš„åŒºåˆ«</h3><ol><li>argä»£è¡¨ å¿…é€‰å‚æ•°ï¼Œflagä»£è¡¨å¯é€‰å‚æ•°</li><li>argå¦‚æœç¼ºå°‘åˆ™commandä¼šæŠ¥é”™ï¼Œflagç¼ºå°‘ä¸ä¼šæŠ¥é”™ï¼Œè€Œæ˜¯ä¼šä½¿ç”¨é»˜è®¤å€¼</li></ol><h2 id="Command-1"><a href="#Command-1" class="headerlink" title="Command"></a>Command</h2><p>ç±»å‹å®šä¹‰</p><pre><code class="go">type Command struct&#123;    Use string    Aliases []string    SuggestFor []string    Short string    GroupID string    Example  string    ValidArgs []string    ValidArgsFunction func(cmd *Command, args []string, toComplete string) ([]string, ShellCompDirective)    Args PositionalArgs    ArgAliases []string    BashCompletionFunction string    Deprecated string    Annotations map[string]string    Version string    PersistentPreRun func(cmd *Command, args []string)    PersistentPreRunE func(cmd *Command, args []string) error    PreRun func(cmd *Command, args []string)    PreRunE func(cmd *Command, args []string) error    Run func(cmd *Command, args []string)    RunE func(cmd *Command, args []string) error    PostRun func(cmd *Command, args []string)    PostRunE func(cmd *Command, args []string) error    PersistentPostRun func(cmd *Command, args []string)    PersistentPostRunE func(cmd *Command, args []string) error    FParseErrWhitelist FParseErrWhitelist    CompletionOptions CompletionOptions    TraverseChildren bool    Hidden bool    SilenceErrors bool    SilenceUsage bool    DisableFlagParsing bool    DisableAutoGenTag bool    DisableFlagsInUseLine bool    DisableSuggestions bool    SuggestionsMinimumDistance int&#125;</code></pre><h3 id="Hidden"><a href="#Hidden" class="headerlink" title="Hidden"></a>Hidden</h3><p>å®šä¹‰è¯¥å‘½ä»¤ä¸åº”è¯¥å‡ºç°åœ¨å¯è·å¾—å‘½ä»¤åˆ—è¡¨ä¸­çš„</p><h3 id="TraverseChildren"><a href="#TraverseChildren" class="headerlink" title="TraverseChildren"></a>TraverseChildren</h3><p>å®šä¹‰å½“ç”¨æˆ·è¾“å…¥è¯¥å‘½ä»¤çš„è·¯å¾„æ—¶,æ˜¯å¦éå†å…¶å­å‘½ä»¤ã€‚</p><h3 id="CompletionOptions"><a href="#CompletionOptions" class="headerlink" title="CompletionOptions"></a>CompletionOptions</h3><p>å®šä¹‰è‡ªåŠ¨è¡¥å…¨é€‰é¡¹</p><pre><code class="go">var cmd = &amp;cobra.Command&#123;  CompletionOptions: cobra.CompletionOptions&#123;    Flags: []string&#123;&quot;flag1&quot;, &quot;flag2&quot;&#125;,    Commands: []string&#123;&quot;subcmd1&quot;, &quot;subcmd2&quot;&#125;,    GlobalFlags: true,  &#125;,&#125;</code></pre><h3 id="FParseErrWhitelist"><a href="#FParseErrWhitelist" class="headerlink" title="FParseErrWhitelist"></a>FParseErrWhitelist</h3><p>å®šä¹‰è¯¥å‘½ä»¤åœ¨æ ‡å¿—è§£æé˜¶æ®µå¿½ç•¥çš„é”™è¯¯ã€‚<br>åŸæœ¬ï¼šå½“æˆ‘ä»¬åœ¨å‘½ä»¤è¡Œä¸­è¾“å…¥ä¸å‘½ä»¤æ ‡å¿—ä¸åŒ¹é…çš„å†…å®¹æ—¶,Cobra ä¼šè¿”å›ä¸€ä¸ª flag parse error</p><pre><code class="bash">Error: unknown flag: --ghUsage:  add [action] [options] [target] [flags]Flags:  -h, --help   help for add</code></pre><h3 id="Runç›¸å…³å‡½æ•°"><a href="#Runç›¸å…³å‡½æ•°" class="headerlink" title="Runç›¸å…³å‡½æ•°"></a>Runç›¸å…³å‡½æ•°</h3><blockquote><p>æ‰§è¡Œé¡ºåºï¼š<br>PersistentPreRun()<br>PreRun()<br>Run()<br>PostRun()<br>PersistentPostRun()<br><strong>Runå’ŒRunEçš„åŒºåˆ«æ˜¯åè€…ä¼šè¿”å›error</strong></p></blockquote><h4 id="PersistentPostRun"><a href="#PersistentPostRun" class="headerlink" title="PersistentPostRun"></a>PersistentPostRun</h4><p>ä¼šåœ¨æ¯æ¬¡è¿è¡ŒRunå‘½ä»¤åè¢«è°ƒç”¨ï¼Œä¼šè¢«å­å‘½ä»¤ç»§æ‰¿</p><h4 id="PostRun"><a href="#PostRun" class="headerlink" title="PostRun"></a>PostRun</h4><p>åœ¨Runä¹‹åè°ƒç”¨ï¼Œä¸»è¦ç”¨äºæ”¶å°¾å·¥ä½œ</p><ul><li>æ¸…ç†ä¸´æ—¶æ–‡ä»¶</li><li>æ–­å¼€æ•°æ®åº“è¿æ¥</li><li>åœæ­¢æ—¥å¿—è®°å½•</li></ul><h4 id="Run"><a href="#Run" class="headerlink" title="Run"></a>Run</h4><p>é€šå¸¸æ˜¯å®é™…åŠŸèƒ½å‡½æ•°ï¼Œå‘½ä»¤çš„æ ¸å¿ƒåŠŸèƒ½</p><ul><li>è®¿é—®å‘½ä»¤çš„æ ‡å¿—ã€å‚æ•°ç­‰</li><li>æ‰§è¡Œå‘½ä»¤çš„ä¸»è¦ä¸šåŠ¡é€»è¾‘</li><li>è°ƒç”¨å¤–éƒ¨æœåŠ¡</li><li>ä¿®æ”¹ç³»ç»ŸçŠ¶æ€</li><li>è¿”å›ç»“æœç»™ç”¨æˆ·</li><li>å¦‚æœæ²¡æœ‰å®šä¹‰Run,æœ¬è´¨ä¸Šå°±æ˜¯ä¸€ä¸ªç©ºå‘½ä»¤</li></ul><h4 id="PreRun"><a href="#PreRun" class="headerlink" title="PreRun"></a>PreRun</h4><p>ä¼šåœ¨æ¯æ¬¡è¿è¡Œè¯¥å‘½ä»¤å‰è¢«è°ƒç”¨ï¼Œä¸ä¼šè¢«å­å‘½ä»¤ç»§æ‰¿</p><h4 id="PersistentPreRun"><a href="#PersistentPreRun" class="headerlink" title="PersistentPreRun"></a>PersistentPreRun</h4><p>ä¼šåœ¨æ¯æ¬¡è¿è¡Œè¯¥å‘½ä»¤å‰è¢«è°ƒç”¨ï¼Œä¼šè¢«å­å‘½ä»¤ç»§æ‰¿</p><ol><li>éªŒè¯å…¨å±€æ ‡å¿—æˆ–ç¯å¢ƒå˜é‡</li><li>å¯åŠ¨æ—¥å¿—è®°å½•</li><li>è¿æ¥æ•°æ®åº“ç­‰</li></ol><h4 id="PersistentPreRunE"><a href="#PersistentPreRunE" class="headerlink" title="PersistentPreRunE"></a>PersistentPreRunE</h4><h3 id="Annotations"><a href="#Annotations" class="headerlink" title="Annotations"></a>Annotations</h3><p>ç”¨äºä¸ºè¯¥å‘½ä»¤æ·»åŠ æ³¨è§£ï¼Œå¯ä»¥ç”¨<code>cmd.Annotations</code>è®¿é—®ï¼Œä¸»è¦ç”¨äºåœ¨åº”ç”¨é€»è¾‘ä¸­ä¼ é€’å’Œå…±äº«ä¸Šä¸‹æ–‡ä¿¡æ¯,å¯¹æœ€ç»ˆç”¨æˆ·ä¸å¯è§ã€‚</p><h3 id="Version"><a href="#Version" class="headerlink" title="Version"></a>Version</h3><p>ä¸ºå‘½ä»¤å®šä¹‰ç‰ˆæœ¬ï¼Œå¦‚æœå‘½ä»¤ä¸­å®šä¹‰äº†è¯¥å­—æ®µä¸”å‘½ä»¤è¿˜æ²¡æœ‰å®šä¹‰ <code>version</code>æ ‡å¿—ï¼Œåˆ™cobraä¼šè‡ªåŠ¨ç»™å‘½ä»¤æ·»åŠ  â€“versionå’Œ-v æ ‡å¿—ï¼Œå‰ææ˜¯è¿™ä¸¤è€…éƒ½æ²¡æœ‰å®šä¹‰ã€‚<br>æ‰§è¡Œ<code>cmd --version</code>ä¼šè¾“å‡ºVersionä¸­å®šä¹‰çš„å€¼</p><h3 id="Deprecated"><a href="#Deprecated" class="headerlink" title="Deprecated"></a>Deprecated</h3><p>å¦‚æœè¯¥å‘½ä»¤å·²ç»è¢«åºŸå¼ƒï¼Œå½“ä½¿ç”¨çš„æ—¶å€™åº”è¯¥æ‰“å°è¿™ä¸ªå­—ç¬¦ä¸²</p><h3 id="BashCompletionFunction"><a href="#BashCompletionFunction" class="headerlink" title="BashCompletionFunction"></a>BashCompletionFunction</h3><p>å€¼æ˜¯æˆ‘ä»¬çš„ Bash è‡ªåŠ¨è¡¥å…¨å‡½æ•°çš„å‡½æ•°å,ä¾‹å¦‚:</p><pre><code class="go">govar cmd = &amp;cobra.Command&#123;  BashCompletionFunction: &quot;autocompleteDo&quot;,&#125;// åŒåå‡½æ•°å®ç°func autocompleteDo(cmd *cobra.Command, args []string, toComplete string) ([]string, cobra.ShellCompDirective) &#123;  // ...&#125;</code></pre><h3 id="ArgAliases"><a href="#ArgAliases" class="headerlink" title="ArgAliases"></a>ArgAliases</h3><p>ValidArgsåˆ«ååˆ—è¡¨ï¼Œä¸ä¼šæç¤ºç»™ç”¨æˆ·ï¼Œä½†æ˜¯æ‰‹åŠ¨è¾“å…¥ä¹Ÿä¼šæ¥æ”¶</p><h3 id="Args"><a href="#Args" class="headerlink" title="Args"></a>Args</h3><p>ä½œç”¨ï¼šæŒ‡å®šå®ƒæ¥æ”¶çš„ä½ç½®å‚æ•°æ¨¡å¼,åœ¨å†…éƒ¨å¯ä»¥ï¼š</p><ol><li>å®šä¹‰å½“å‰å‘½ä»¤æ¥æ”¶çš„ä½ç½®å‚æ•°</li><li>æ ¡éªŒç”¨æˆ·è¾“å…¥çš„å‚æ•°æ˜¯å¦æ­£ç¡®</li><li>è¿”å›ä¸€ä¸ª nil çš„ error è¡¨ç¤ºæ ¡éªŒæˆåŠŸ,æˆ–è¿”å›é nil çš„ error è¡¨ç¤ºæ ¡éªŒå¤±è´¥<br>å–å€¼ç±»å‹ï¼š<code>PositionalArgs</code></li></ol><pre><code class="go">type PositionalArgs func(*Command, []string) error</code></pre><h3 id="ValidArgsFunction"><a href="#ValidArgsFunction" class="headerlink" title="ValidArgsFunction"></a>ValidArgsFunction</h3><p>åŠ¨æ€çš„ValidArgsï¼Œä¸€ä¸ªå‘½ä»¤ä¸­ä¸èƒ½åŒæ—¶å­˜åœ¨<code>ValidArgsFunction</code>å’Œ<code>ValidArgs</code>é€‰é¡¹</p><ul><li>ç¬¬ä¸‰ä¸ªå‚æ•°<code>toCoplete</code>ç”¨äºå®ç°å‘½ä»¤è¡¥å…¨<ul><li>cobra.ShellCompDirectiveDefault:ç»§ç»­ä½¿ç”¨é»˜è®¤çš„è¡¥å…¨æ–¹æ¡ˆ</li><li>cobra.ShellCompDirectiveErrorï¼šé˜»æ­¢è¡¥å…¨å¹¶è¿”å›é”™è¯¯</li><li>cobra.ShellCompDirectiveNoFileCompï¼šä»…æä¾›æ–‡ä»¶åè¡¥å…¨è€Œéå‘½ä»¤è¡¥å…¨</li></ul></li></ul><pre><code class="go">ValidArgsFunction: func(cmd *cobra.Command, args []string, toComplete string) ([]string, cobra.ShellCompDirective) &#123;    // æ£€æŸ¥ toComplete æ˜¯å¦ä»¥ &quot;enabl&quot; å¼€å¤´,å¦‚æœæ˜¯åˆ™è¿”å›å¯èƒ½çš„è¡¥å…¨é€‰é¡¹ [&quot;enable&quot;, &quot;enables&quot;, &quot;enabling&quot;]  if toComplete == &quot;enabl&quot; &#123;    return []string&#123;&quot;enable&quot;, &quot;enables&quot;, &quot;enabling&quot;&#125;, cobra.ShellCompDirectiveNoFileComp   &#125;    if args[0] != &quot;enable&quot; &#123;    // é˜»æ­¢è¡¥å…¨å¹¶è¿”å›é”™è¯¯    return nil, cobra.ShellCompDirectiveError  &#125;    return nil, cobra.ShellCompDirectiveDefault&#125; </code></pre><h3 id="ValidArgs"><a href="#ValidArgs" class="headerlink" title="ValidArgs"></a>ValidArgs</h3><p>ä½œç”¨ï¼šå®šä¹‰å‘½ä»¤æ¥æ”¶çš„æ‰€æœ‰åˆæ³•çš„éflagå‚æ•°ï¼Œcobraä¼šæ ¹æ®è¿™ä¸ªéªŒè¯ç”¨æˆ·åœ¨shellå‘½ä»¤ä¸­è¾“å…¥çš„å‚æ•°æ˜¯å¦æœ‰æ•ˆï¼Œå¹¶åœ¨helpè¾“å‡ºä¸­ç”Ÿæˆå‚æ•°åˆ—è¡¨ä¿¡æ¯<br>ç–‘é—®ï¼šä¸ºä»€ä¹ˆå®šä¹‰äº†ValidArgsï¼Œè¿è¡Œ.&#x2F;demo addä¸ä¼šæŠ¥é”™ï¼Ÿ<br>åŸå› ï¼šcobraçš„è§£ææµç¨‹å¯¼è‡´çš„</p><ol><li>è§£æå‘½ä»¤é“¾,è¯†åˆ«å‡ºå„ä¸ªå‘½ä»¤å’Œå‚æ•°</li><li>å¯¹æ¯ä¸ªå‘½ä»¤åŠå…¶å‚æ•°,æ£€æŸ¥æ˜¯å¦ç¬¦åˆ ValidArgs ä¸­çš„è¦æ±‚</li><li>å¦‚æœä¸ç¬¦åˆ,åˆ™è§†ä¸ºæ™®é€šå‚æ•°ä¼ å…¥,å¹¶ç»§ç»­åç»­æ£€æŸ¥</li><li>æ£€æŸ¥æ˜¯å¦å®šä¹‰äº†è¯¥å‚æ•°çš„å­å‘½ä»¤</li><li>å¦‚æœæ²¡æœ‰å­å‘½ä»¤,åˆ™å°†è¯¥å‚æ•°ä¼ å…¥ Run æ–¹æ³•</li><li>åœ¨ Run æ–¹æ³•ä¸­,éœ€è¦æˆ‘ä»¬è‡ªè¡Œåˆ¤æ–­è¯¥å‚æ•°æ˜¯å¦æœ‰æ•ˆ,å¦‚æœæ— æ•ˆéœ€è¦æ‰‹åŠ¨æŠ¥é”™</li></ol><h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>ä½œç”¨ï¼šç¤ºèŒƒå¦‚ä½•ä½¿ç”¨å‘½ä»¤<br>åŒºåˆ«ï¼šUseå®šä¹‰è§„èŒƒï¼ŒExampleå±•ç¤ºç”¨ä¾‹</p><h3 id="GroupID"><a href="#GroupID" class="headerlink" title="GroupID"></a>GroupID</h3><h4 id="ä½œç”¨"><a href="#ä½œç”¨" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><p>ç”¨äºå°†å‘½ä»¤åˆ†ç»„ï¼Œå…·æœ‰ç›¸åŒ GroupID çš„å‘½ä»¤ä¼šè¢«æ”¾å…¥åŒä¸€ä¸ªå‘½ä»¤ç»„ä¸­ã€‚</p><ol><li>å®é™…ä½¿ç”¨ä¸­ä¸ä¼šå½±å“å‘½ä»¤çš„å®é™…è¡Œä¸º</li><li>ä¼˜åŒ–helpè¾“å‡ºå’Œè‡ªåŠ¨è¡¥å…¨åŠŸèƒ½</li></ol><h3 id="Use"><a href="#Use" class="headerlink" title="Use"></a>Use</h3><h4 id="ä½œç”¨-1"><a href="#ä½œç”¨-1" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><ol><li>å®šä¹‰å‘½ä»¤çš„ä½¿ç”¨è¯´æ˜,ä½¿ç”¨æˆ·å¿«é€Ÿç†è§£æ¯ä¸ªå‘½ä»¤åŠå…¶å­å‘½ä»¤çš„ç”¨æ³•</li><li>åœ¨ä½¿ç”¨<code>--help</code>æ—¶æ˜¾ç¤º,æä¾›å‘½ä»¤çš„å¸®åŠ©ä¿¡æ¯</li><li>æä¾›ä¸€ç§æ£€éªŒå‘½ä»¤è®¾è®¡çš„æ‰‹æ®µ</li></ol><h4 id="è¯­æ³•"><a href="#è¯­æ³•" class="headerlink" title="è¯­æ³•"></a>è¯­æ³•</h4><p><code>Use:   &quot;add [-F file | -D dir]... [-f format] profile&quot;</code><br>å‘½ä»¤è¡Œä½¿ç”¨:<code>./cobraDemo add xxx</code></p><ol><li><code>[]</code>è¡¨ç¤ºè¿™ä¸ªæ˜¯å¯é€‰å‚æ•°,å…¶ä»–çš„å‚æ•°æ˜¯å¿…é¡»å‚æ•°</li><li><code>...</code>è¡¨ç¤ºå¯ä»¥ä¸ºå‰é¢çš„å‚æ•°æŒ‡å®šå¤šä¸ªå€¼,æ¯”å¦‚<code>Use: &quot;app STR... NUM...&quot;</code>,ä½¿ç”¨<code>app hello world 2 3</code> ã€‚ä¸€ä¸ªé”®(key)å¯ä»¥æœ‰å¤šä¸ªå€¼(value)</li><li><code>|</code>è¡¨ç¤ºäº’æ–¥,åœ¨ä¸€ä¸ªå‘½ä»¤é‡Œä¸èƒ½åŒæ—¶ä½¿ç”¨ä¸¤è¾¹çš„å‚æ•°</li><li><code>&#123;&#125;</code>è¡¨ç¤ºåˆ†éš”ä¸€ç»„äº’æ–¥å‚æ•°,æ¯”å¦‚<code>add &#123;arg1|arg2|arg3&#125; &#123;arg4|arg5|arg6&#125;</code></li></ol><blockquote><ul><li>å¦‚æœgo buildç”Ÿæˆçš„äºŒè¿›åˆ¶æ–‡ä»¶ådemoå’Œ rootCmd çš„ Use å­—æ®µç¬¬ä¸€ä¸ªå•è¯ç›¸åŒ,é‚£ä¹ˆ .&#x2F;demo ä¼šç›´æ¥è¢« Cobra è¯†åˆ«ä¸º rootCmd å‘½ä»¤,è€Œä¸æ˜¯æ™®é€šå‚æ•°ã€‚</li><li>å¦‚æœä¸åŒï¼Œåˆ™.&#x2F;demoç›¸å½“äºæ™®é€šå‚æ•°ä¼ å…¥ï¼Œéœ€è¦åœ¨Runæ–¹æ³•ä¸­è‡ªè¡Œè§£æ</li></ul></blockquote><h3 id="Aliases"><a href="#Aliases" class="headerlink" title="Aliases"></a>Aliases</h3><h4 id="ä½œç”¨-2"><a href="#ä½œç”¨-2" class="headerlink" title="ä½œç”¨"></a>ä½œç”¨</h4><ol><li>è¡¨ç¤ºå‘½ä»¤æˆ–å‚æ•°çš„åˆ«å</li><li><code> Aliases: []string&#123;&quot;param1&quot;, &quot;p1&quot;,&quot;param2&quot;,&quot;p2&quot;&#125;</code>-param1çš„åˆ«åæ˜¯p1,param2çš„åˆ«åæ˜¯p2</li></ol><h3 id="SuggestFor"><a href="#SuggestFor" class="headerlink" title="SuggestFor"></a>SuggestFor</h3><p>ä½œç”¨ï¼šç”¨äºä¸ºç”¨æˆ·è¾“å…¥çš„é”™è¯¯å‚æ•°æä¾›å»ºè®®<br>æ¡ˆä¾‹ï¼š</p><pre><code class="go">var rootCmd = &amp;cobra.Command&#123;    Use:        &quot;app start|stop&quot;,      Args:       cobra.ExactArgs(1),     ValidArgs:  []string&#123;&quot;start&quot;, &quot;stop&quot;&#125;,    SuggestFor: []string&#123;&quot;run&quot;&#125;, // å¯¹ &quot;run&quot; æä¾›å»ºè®®&#125;</code></pre><p>æ­¤æ—¶ç”¨æˆ·è¾“å…¥<code>app run</code>ï¼Œé”™è¯¯æç¤ºä¼šå˜ä¸ºï¼š</p><ul><li>ä¸è®¾ç½®SuggstFor<blockquote><p>Error: invalid argument â€œrunâ€ for â€œappâ€<br>Usage: app start|stop</p></blockquote></li><li>è®¾ç½®SuggstFor</li></ul><pre><code class="go">SuggestFor: []string&#123;&quot;run&quot;&#125;, // å¯¹ &quot;run&quot; æä¾›å»ºè®®</code></pre><blockquote><p>Error: invalid argument â€œrunâ€ for â€œappâ€<br>Did you mean â€œstartâ€ or â€œstopâ€?<br>Usage: app start|stop</p></blockquote><h3 id="Short"><a href="#Short" class="headerlink" title="Short"></a>Short</h3><p>å®šä¹‰å‘½ä»¤æˆ–å­—æ®µçš„ç®€çŸ­æè¿°ï¼Œåœ¨<code>help</code>é‡Œå±•ç¤ºçš„ç®€çŸ­æè¿°</p><h4 id="æ˜¾ç¤ºæ¡ä»¶"><a href="#æ˜¾ç¤ºæ¡ä»¶" class="headerlink" title="æ˜¾ç¤ºæ¡ä»¶"></a>æ˜¾ç¤ºæ¡ä»¶</h4><ol><li>å®é™…å®šä¹‰äº†è¯¥å­—æ®µ</li><li>æ²¡æœ‰å®šä¹‰Longå­—æ®µ<br>å¦‚æœåŒæ—¶å®šä¹‰äº†ï¼Œåˆ™åªä¼šå±•ç¤ºLongå­—æ®µ</li></ol><h3 id="Long"><a href="#Long" class="headerlink" title="Long"></a>Long</h3><p>ä½œç”¨ï¼šå®šä¹‰å‘½ä»¤æˆ–å­—æ®µçš„ è¯¦ç»†æè¿°</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gin-webç¬”è®°</title>
      <link href="/2023/03/23/gin-web-bi-ji/"/>
      <url>/2023/03/23/gin-web-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><pre><code class="bash">go get -u github.com/gin-gonic/gin</code></pre><p>Gin é»˜è®¤ä½¿ç”¨<code>encoding/json</code>è¿›è¡Œç¼–è¯‘</p><h2 id="å¿«æ·æ–¹å¼ï¼š"><a href="#å¿«æ·æ–¹å¼ï¼š" class="headerlink" title="å¿«æ·æ–¹å¼ï¼š"></a>å¿«æ·æ–¹å¼ï¼š</h2><ul><li>gin.H æ˜¯ map[string]interface{}çš„å¿«æ·æ–¹å¼</li><li>gin.Accounts æ˜¯ map[string]string çš„ä¸€ç§å¿«æ·æ–¹å¼</li></ul><h2 id="AsciiJSON"><a href="#AsciiJSON" class="headerlink" title="AsciiJSON"></a>AsciiJSON</h2><p>ä½¿ç”¨ AsciiJSON ç”Ÿæˆå…·æœ‰è½¬ä¹‰çš„é ASCII å­—ç¬¦çš„ ASCII-only JSONã€‚<br>åŸæ•°æ®ï¼š</p><pre><code class="go">data := map[string]interface&#123;&#125;&#123;  &quot;lang&quot;: &quot;GOè¯­è¨€&quot;,  &quot;tag&quot;:  &quot;&lt;br&gt;&quot;,&#125;// è¾“å‡ºdata:&#123;&quot;lang&quot;:&quot;GO\u8bed\u8a00&quot;,&quot;tag&quot;:&quot;\u003cbr\u003e&quot;&#125;c.AsciiJSON(http.StatusOK, data)</code></pre><h2 id="html-æ¸²æŸ“"><a href="#html-æ¸²æŸ“" class="headerlink" title="html æ¸²æŸ“"></a>html æ¸²æŸ“</h2><p>ä½¿ç”¨<code>LoadHTMLGlob()</code>æˆ–è€…<code>LoadHTMLFiles()</code></p><pre><code class="tmpl">&lt;!-- templates/index.tmpl --&gt;&lt;html&gt;    &lt;h1&gt;        &#123;&#123; .title &#125;&#125;    &lt;/h1&gt;&lt;/html&gt;&lt;!-- templates/posts/index.tmpl --&gt;&#123;&#123; define "posts/index.tmpl" &#125;&#125;&lt;html&gt;&lt;h1&gt;    &#123;&#123; .title &#125;&#125;&lt;/h1&gt;&lt;p&gt;Using posts/index.tmpl&lt;/p&gt;&lt;/html&gt;&#123;&#123; end &#125;&#125;&lt;!-- templates/users/index.tmpl --&gt;&#123;&#123; define "users/index.tmpl" &#125;&#125;&lt;html&gt;&lt;h1&gt;    &#123;&#123; .title &#125;&#125;&lt;/h1&gt;&lt;p&gt;Using users/index.tmpl&lt;/p&gt;&lt;/html&gt;&#123;&#123; end &#125;&#125;</code></pre><p>å¦‚ä½•ä½¿ç”¨æ¨¡æ¿ï¼š</p><pre><code class="go">    router.LoadHTMLGlob(&quot;templates/**/*&quot;)  //router.LoadHTMLFiles(&quot;templates/template1.html&quot;, &quot;templates/template2.html&quot;)  // ä½¿ç”¨ä¸åŒç›®å½•ä¸‹çš„ç›¸åŒåç§°çš„æ¨¡æ¿    router.GET(&quot;/posts/index&quot;, func(c *gin.Context) &#123;        c.HTML(http.StatusOK, &quot;posts/index.tmpl&quot;, gin.H&#123;            &quot;title&quot;: &quot;Posts&quot;,        &#125;)    &#125;)    router.GET(&quot;/users/index&quot;, func(c *gin.Context) &#123;        c.HTML(http.StatusOK, &quot;users/index.tmpl&quot;, gin.H&#123;            &quot;title&quot;: &quot;Users&quot;,        &#125;)    &#125;)</code></pre><h3 id="è‡ªå®šä¹‰-html-æ¨¡æ¿"><a href="#è‡ªå®šä¹‰-html-æ¨¡æ¿" class="headerlink" title="è‡ªå®šä¹‰ html æ¨¡æ¿"></a>è‡ªå®šä¹‰ html æ¨¡æ¿</h3><p>æš‚å¿½ç•¥</p><h2 id="HTTP2-server-æœåŠ¡å™¨-æ¨é€"><a href="#HTTP2-server-æœåŠ¡å™¨-æ¨é€" class="headerlink" title="HTTP2 server æœåŠ¡å™¨ æ¨é€"></a>HTTP2 server æœåŠ¡å™¨ æ¨é€</h2><p>æœåŠ¡å™¨æ¨é€ï¼šè¿˜æ²¡æœ‰æ”¶åˆ°æµè§ˆå™¨çš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±æŠŠå„ç§èµ„æºæ¨é€ç»™æµè§ˆå™¨ã€‚æ¯”å¦‚ï¼Œæµè§ˆå™¨åªè¯·æ±‚äº† index.htmlï¼Œä½†æ˜¯æœåŠ¡å™¨æŠŠ index.htmlã€style.cssã€example.png å…¨éƒ¨å‘é€ç»™æµè§ˆå™¨ã€‚è¿™æ ·çš„è¯ï¼Œåªéœ€è¦ä¸€è½® HTTP é€šä¿¡ï¼Œæµè§ˆå™¨å°±å¾—åˆ°äº†å…¨éƒ¨èµ„æºï¼Œæé«˜äº†æ€§èƒ½</p><pre><code class="go">var html = template.Must(template.New(&quot;https&quot;).Parse(`&lt;html&gt;&lt;head&gt;  &lt;title&gt;Https Test&lt;/title&gt;  &lt;script src=&quot;/assets/app.js&quot;&gt;&lt;/script&gt;&lt;/head&gt;&lt;body&gt;  &lt;h1 style=&quot;color:red;&quot;&gt;Welcome, Ginner!&lt;/h1&gt;&lt;/body&gt;&lt;/html&gt;`))r.GET(&quot;/&quot;, func(c *gin.Context) &#123;  if pusher := c.Writer.Pusher(); pusher != nil &#123;    // ä½¿ç”¨ pusher.Push() åšæœåŠ¡å™¨æ¨é€    if err := pusher.Push(&quot;/assets/app.js&quot;, nil); err != nil &#123;      log.Printf(&quot;Failed to push: %v&quot;, err)    &#125;  &#125;  c.HTML(200, &quot;https&quot;, gin.H&#123;    &quot;status&quot;: &quot;success&quot;,  &#125;)&#125;)</code></pre><h2 id="JSONP"><a href="#JSONP" class="headerlink" title="JSONP"></a>JSONP</h2><p>ç”¨æ¥è§£å†³è·¨åŸŸé—®é¢˜:å¦‚æœæŸ¥è¯¢å‚æ•°å­˜åœ¨å›è°ƒï¼Œåˆ™å°†å›è°ƒæ·»åŠ åˆ°å“åº”ä½“ä¸­</p><pre><code class="go">data := map[string]interface&#123;&#125;&#123;  &quot;foo&quot;: &quot;bar&quot;,&#125;// è¯·æ±‚ï¼š/JSONP?callback=x// è¾“å‡ºdata:x(&#123;\&quot;foo\&quot;:\&quot;bar\&quot;&#125;)c.JSONP(http.StatusOK, data)</code></pre><h2 id="Multipart-x2F-Urlencoded-ç»‘å®š"><a href="#Multipart-x2F-Urlencoded-ç»‘å®š" class="headerlink" title="Multipart&#x2F;Urlencoded ç»‘å®š"></a>Multipart&#x2F;Urlencoded ç»‘å®š</h2><pre><code class="go">type LoginForm struct &#123;    User     string `form:&quot;user&quot; binding:&quot;required&quot;`    Password string `form:&quot;password&quot; binding:&quot;required&quot;`&#125;// æ˜¾å¼ç»‘å®šå£°æ˜ç»‘å®šmultipart formï¼šc.ShouldBindWith(&amp;form, binding.Form)// ä½¿ç”¨ShouldBind æ–¹æ³•è‡ªåŠ¨ç»‘å®švar form LoginFormif c.ShouldBind(&amp;form) == nil &#123;  if form.User == &quot;user&quot; &amp;&amp; form.Password == &quot;password&quot; &#123;    c.JSON(200, gin.H&#123;&quot;status&quot;: &quot;you are logged in&quot;&#125;)  &#125; else &#123;    c.JSON(401, gin.H&#123;&quot;status&quot;: &quot;unauthorized&quot;&#125;)  &#125;&#125;// curlæµ‹è¯•// curl -v --form user=user --form password=password http://localhost:8080/login</code></pre><h2 id="Multipart-x2F-Urlencoded-è¡¨å•"><a href="#Multipart-x2F-Urlencoded-è¡¨å•" class="headerlink" title="Multipart&#x2F;Urlencoded è¡¨å•"></a>Multipart&#x2F;Urlencoded è¡¨å•</h2><pre><code class="go">    router.POST(&quot;/form_post&quot;, func(c *gin.Context) &#123;        message := c.PostForm(&quot;message&quot;)        nick := c.DefaultPostForm(&quot;nick&quot;, &quot;anonymous&quot;)        c.JSON(200, gin.H&#123;            &quot;status&quot;:  &quot;posted&quot;,            &quot;message&quot;: message,            &quot;nick&quot;:    nick,        &#125;)    &#125;)</code></pre><h2 id="å¯¹ç‰¹æ®Š-HTML-å­—ç¬¦è¿›è¡Œç¼–ç â€”â€”PureJSON"><a href="#å¯¹ç‰¹æ®Š-HTML-å­—ç¬¦è¿›è¡Œç¼–ç â€”â€”PureJSON" class="headerlink" title="å¯¹ç‰¹æ®Š HTML å­—ç¬¦è¿›è¡Œç¼–ç â€”â€”PureJSON"></a>å¯¹ç‰¹æ®Š HTML å­—ç¬¦è¿›è¡Œç¼–ç â€”â€”PureJSON</h2><p>JSON ä½¿ç”¨ unicode æ›¿æ¢ç‰¹æ®Š HTML å­—ç¬¦ï¼Œä¾‹å¦‚ &lt; å˜ä¸º \ u003cã€‚å¦‚æœè¦æŒ‰å­—é¢å¯¹è¿™äº›å­—ç¬¦è¿›è¡Œç¼–ç ï¼Œåˆ™å¯ä»¥ä½¿ç”¨ PureJSON</p><pre><code class="go">// æä¾› unicode å®ä½“r.GET(&quot;/json&quot;, func(c *gin.Context) &#123;  c.JSON(200, gin.H&#123;    &quot;html&quot;: &quot;&lt;b&gt;Hello, world!&lt;/b&gt;&quot;,  &#125;)&#125;)// æä¾›å­—é¢å­—ç¬¦r.GET(&quot;/pureJson&quot;, func(c *gin.Context) &#123;  c.PureJSON(200, gin.H&#123;    &quot;html&quot;: &quot;&lt;b&gt;Hello, world!&lt;/b&gt;&quot;,  &#125;)&#125;)</code></pre><h2 id="Query-å’Œ-post-form"><a href="#Query-å’Œ-post-form" class="headerlink" title="Query å’Œ post form"></a>Query å’Œ post form</h2><p>è¯·æ±‚å¦‚ä¸‹ï¼š</p><blockquote><p>POST &#x2F;post?id&#x3D;1234&amp;page&#x3D;1 HTTP&#x2F;1.1<br>Content-Type: application&#x2F;x-www-form-urlencoded<br>name&#x3D;mau&amp;message&#x3D;this_is_great</p></blockquote><pre><code class="go">id := c.Query(&quot;id&quot;)page := c.DefaultQuery(&quot;page&quot;, &quot;0&quot;)name := c.PostForm(&quot;name&quot;)message := c.PostForm(&quot;message&quot;)fmt.Printf(&quot;id: %s; page: %s; name: %s; message: %s&quot;, id, page, name, message)// ç»“æœï¼šid: 1234; page: 1; name: mau; message: this_is_great</code></pre><h2 id="é˜²æ­¢-JSON-åŠ«æŒâ€”â€”SecureJSON"><a href="#é˜²æ­¢-JSON-åŠ«æŒâ€”â€”SecureJSON" class="headerlink" title="é˜²æ­¢ JSON åŠ«æŒâ€”â€”SecureJSON"></a>é˜²æ­¢ JSON åŠ«æŒâ€”â€”SecureJSON</h2><p>å¦‚æœç»™å®šçš„ç»“æ„æ˜¯æ•°ç»„å€¼ï¼Œåˆ™é»˜è®¤é¢„ç½® â€œwhile(1),â€ åˆ°å“åº”ä½“</p><pre><code class="go">names := []string&#123;&quot;lena&quot;, &quot;austin&quot;, &quot;foo&quot;&#125;// è‡ªå®šä¹‰SecureJSON å‰ç¼€r.SecureJsonPrefix(&quot;)]&#125;&#39;,\n&quot;)// ç»“æœï¼šwhile(1);[&quot;lena&quot;,&quot;austin&quot;,&quot;foo&quot;]c.SecureJSON(http.StatusOK, names)</code></pre><h2 id="XML-x2F-JSON-x2F-YAML-x2F-ProtoBuf-æ¸²æŸ“"><a href="#XML-x2F-JSON-x2F-YAML-x2F-ProtoBuf-æ¸²æŸ“" class="headerlink" title="XML&#x2F;JSON&#x2F;YAML&#x2F;ProtoBuf æ¸²æŸ“"></a>XML&#x2F;JSON&#x2F;YAML&#x2F;ProtoBuf æ¸²æŸ“</h2><pre><code class="go">// JSONr.GET(&quot;/someJSON&quot;, func(c *gin.Context) &#123;  c.JSON(http.StatusOK, gin.H&#123;&quot;message&quot;: &quot;hey&quot;, &quot;status&quot;: http.StatusOK&#125;)&#125;)// JSON-ä½¿ç”¨ç»“æ„ä½“r.GET(&quot;/moreJSON&quot;, func(c *gin.Context) &#123;  // ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ªç»“æ„ä½“  var msg struct &#123;    Name    string `json:&quot;user&quot;`    Message string    Number  int  &#125;  msg.Name = &quot;Lena&quot;  msg.Message = &quot;hey&quot;  msg.Number = 123  // è¾“å‡ºï¼š&#123;&quot;user&quot;: &quot;Lena&quot;, &quot;Message&quot;: &quot;hey&quot;, &quot;Number&quot;: 123&#125;  c.JSON(http.StatusOK, msg)&#125;)// XMLr.GET(&quot;/someXML&quot;, func(c *gin.Context) &#123;  c.XML(http.StatusOK, gin.H&#123;&quot;message&quot;: &quot;hey&quot;, &quot;status&quot;: http.StatusOK&#125;)&#125;)// Yamlr.GET(&quot;/someYAML&quot;, func(c *gin.Context) &#123;  c.YAML(http.StatusOK, gin.H&#123;&quot;message&quot;: &quot;hey&quot;, &quot;status&quot;: http.StatusOK&#125;)&#125;)// ProtoBufr.GET(&quot;/someProtoBuf&quot;, func(c *gin.Context) &#123;  reps := []int64&#123;int64(1), int64(2)&#125;  label := &quot;test&quot;  // protobuf çš„å…·ä½“å®šä¹‰å†™åœ¨ testdata/protoexample æ–‡ä»¶ä¸­  data := &amp;protoexample.Test&#123;    Label: &amp;label,    Reps:  reps,  &#125;  // æ•°æ®åœ¨å“åº”ä¸­å˜ä¸ºäºŒè¿›åˆ¶æ•°æ®  // å°†è¾“å‡ºè¢« protoexample.Test protobuf åºåˆ—åŒ–äº†çš„æ•°æ®  c.ProtoBuf(http.StatusOK, data)&#125;)</code></pre><h2 id="ä¸Šä¼ æ–‡ä»¶"><a href="#ä¸Šä¼ æ–‡ä»¶" class="headerlink" title="ä¸Šä¼ æ–‡ä»¶"></a>ä¸Šä¼ æ–‡ä»¶</h2><h3 id="å•æ–‡ä»¶"><a href="#å•æ–‡ä»¶" class="headerlink" title="å•æ–‡ä»¶"></a>å•æ–‡ä»¶</h3><pre><code class="go">// ä¸º multipart forms è®¾ç½®è¾ƒä½çš„å†…å­˜é™åˆ¶ (é»˜è®¤æ˜¯ 32 MiB)router.MaxMultipartMemory = 8 &lt;&lt; 20  // 8 MiB,8å³ç§»20ä½router.POST(&quot;/upload&quot;, func(c *gin.Context) &#123;  // å•æ–‡ä»¶  file, _ := c.FormFile(&quot;file&quot;)  log.Println(file.Filename)  dst := &quot;./&quot; + file.Filename  // ä¸Šä¼ æ–‡ä»¶è‡³æŒ‡å®šçš„å®Œæ•´æ–‡ä»¶è·¯å¾„  c.SaveUploadedFile(file, dst)  c.String(http.StatusOK, fmt.Sprintf(&quot;&#39;%s&#39; uploaded!&quot;, file.Filename))&#125;)//curl -X POST http://localhost:8080/upload \// -F &quot;file=@/Users/appleboy/test.zip&quot; \// -H &quot;Content-Type: multipart/form-data&quot;</code></pre><h3 id="å¤šæ–‡ä»¶"><a href="#å¤šæ–‡ä»¶" class="headerlink" title="å¤šæ–‡ä»¶"></a>å¤šæ–‡ä»¶</h3><pre><code class="go">router.POST(&quot;/upload&quot;, func(c *gin.Context) &#123;  // Multipart form  form, _ := c.MultipartForm()  files := form.File[&quot;upload[]&quot;]  for _, file := range files &#123;    log.Println(file.Filename)    // ä¸Šä¼ æ–‡ä»¶è‡³æŒ‡å®šç›®å½•    c.SaveUploadedFile(file, dst)  &#125;  c.String(http.StatusOK, fmt.Sprintf(&quot;%d files uploaded!&quot;, len(files)))&#125;)// curl -X POST http://localhost:8080/upload \//   -F &quot;upload[]=@/Users/appleboy/test1.zip&quot; \//   -F &quot;upload[]=@/Users/appleboy/test2.zip&quot; \//   -H &quot;Content-Type: multipart/form-data&quot;</code></pre><h2 id="ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶"><a href="#ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶" class="headerlink" title="ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶"></a>ä¸ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶</h2><p>gin.Default()é»˜è®¤ä½¿ç”¨ Logger å’Œ Recovery ä¸­é—´ä»¶<br>gin.New()å¯ä»¥ç”¨äºä¸éœ€è¦ä½¿ç”¨é»˜è®¤çš„ä¸­é—´ä»¶çš„åœºæ™¯ä¸‹</p><h2 id="ä»-reader-è¯»å–æ•°æ®"><a href="#ä»-reader-è¯»å–æ•°æ®" class="headerlink" title="ä» reader è¯»å–æ•°æ®"></a>ä» reader è¯»å–æ•°æ®</h2><pre><code class="go">response, err := http.Get(&quot;https://raw.githubusercontent.com/gin-gonic/logo/master/color.png&quot;)if err != nil || response.StatusCode != http.StatusOK &#123;  c.Status(http.StatusServiceUnavailable)  return&#125;reader := response.BodycontentLength := response.ContentLengthcontentType := response.Header.Get(&quot;Content-Type&quot;)extraHeaders := map[string]string&#123;  &quot;Content-Disposition&quot;: `attachment; filename=&quot;gopher.png&quot;`,&#125;c.DataFromReader(http.StatusOK, contentLength, contentType, reader, extraHeaders)</code></pre><h2 id="é‡å¯æˆ–åœæ­¢-web-æœåŠ¡å™¨"><a href="#é‡å¯æˆ–åœæ­¢-web-æœåŠ¡å™¨" class="headerlink" title="é‡å¯æˆ–åœæ­¢ web æœåŠ¡å™¨"></a>é‡å¯æˆ–åœæ­¢ web æœåŠ¡å™¨</h2><p>ä½¿ç”¨<code>fvbock/endless</code>ä»£æ›¿<code>ListenAndServe</code></p><pre><code class="go">router := gin.Default()router.GET(&quot;/&quot;, handler)// [...]endless.ListenAndServe(&quot;:4242&quot;, router)</code></pre><h2 id="ä½¿ç”¨-BasicAuth-ä¸­é—´ä»¶"><a href="#ä½¿ç”¨-BasicAuth-ä¸­é—´ä»¶" class="headerlink" title="ä½¿ç”¨ BasicAuth ä¸­é—´ä»¶"></a>ä½¿ç”¨ BasicAuth ä¸­é—´ä»¶</h2><p>gin.BasicAuth() ä¸­é—´ä»¶</p><pre><code class="go">var secrets = gin.H&#123;    &quot;foo&quot;:    gin.H&#123;&quot;email&quot;: &quot;foo@bar.com&quot;, &quot;phone&quot;: &quot;123433&quot;&#125;,    &quot;austin&quot;: gin.H&#123;&quot;email&quot;: &quot;austin@example.com&quot;, &quot;phone&quot;: &quot;666&quot;&#125;,    &quot;lena&quot;:   gin.H&#123;&quot;email&quot;: &quot;lena@guapa.com&quot;, &quot;phone&quot;: &quot;523443&quot;&#125;,&#125;authorized := r.Group(&quot;/admin&quot;, gin.BasicAuth(gin.Accounts&#123; &quot;foo&quot;:    &quot;bar&quot;, &quot;austin&quot;: &quot;1234&quot;, &quot;lena&quot;:   &quot;hello2&quot;, &quot;manu&quot;:   &quot;4321&quot;,&#125;))// /admin/secrets ç«¯ç‚¹// è§¦å‘ &quot;localhost:8080/admin/secretsauthorized.GET(&quot;/secrets&quot;, func(c *gin.Context) &#123;  // è·å–ç”¨æˆ·ï¼Œå®ƒæ˜¯ç”± BasicAuth ä¸­é—´ä»¶è®¾ç½®çš„  user := c.MustGet(gin.AuthUserKey).(string)  if secret, ok := secrets[user]; ok &#123;    c.JSON(http.StatusOK, gin.H&#123;&quot;user&quot;: user, &quot;secret&quot;: secret&#125;)  &#125; else &#123;    c.JSON(http.StatusOK, gin.H&#123;&quot;user&quot;: user, &quot;secret&quot;: &quot;NO SECRET :(&quot;&#125;)  &#125;&#125;)</code></pre><h2 id="ä½¿ç”¨-http-æ–¹æ³•"><a href="#ä½¿ç”¨-http-æ–¹æ³•" class="headerlink" title="ä½¿ç”¨ http æ–¹æ³•"></a>ä½¿ç”¨ http æ–¹æ³•</h2><pre><code class="go">    // ä½¿ç”¨é»˜è®¤ä¸­é—´ä»¶ï¼ˆlogger å’Œ recovery ä¸­é—´ä»¶ï¼‰åˆ›å»º gin è·¯ç”±    router := gin.Default()    router.GET(&quot;/someGet&quot;, getting)    router.POST(&quot;/somePost&quot;, posting)    router.PUT(&quot;/somePut&quot;, putting)    router.DELETE(&quot;/someDelete&quot;, deleting)    router.PATCH(&quot;/somePatch&quot;, patching)    router.HEAD(&quot;/someHead&quot;, head)    router.OPTIONS(&quot;/someOptions&quot;, options)    // é»˜è®¤åœ¨ 8080 ç«¯å£å¯åŠ¨æœåŠ¡ï¼Œé™¤éå®šä¹‰äº†ä¸€ä¸ª PORT çš„ç¯å¢ƒå˜é‡ã€‚    router.Run()</code></pre><h2 id="ä½¿ç”¨ä¸­é—´ä»¶"><a href="#ä½¿ç”¨ä¸­é—´ä»¶" class="headerlink" title="ä½¿ç”¨ä¸­é—´ä»¶"></a>ä½¿ç”¨ä¸­é—´ä»¶</h2><pre><code class="go">// Logger ä¸­é—´ä»¶å°†æ—¥å¿—å†™å…¥ gin.DefaultWriterï¼Œr.Use(gin.Logger())// Recovery ä¸­é—´ä»¶ä¼š recover ä»»ä½• panicã€‚å¦‚æœæœ‰ panic çš„è¯ï¼Œä¼šå†™å…¥ 500ã€‚r.Use(gin.Recovery())// å¯ä»¥ä¸ºæ¯ä¸ªè·¯ç”±æ·»åŠ ä»»æ„æ•°é‡çš„ä¸­é—´ä»¶ã€‚r.GET(&quot;/benchmark&quot;, MyBenchLogger(), benchEndpoint)</code></pre><h3 id="è·¯ç”±ç»„"><a href="#è·¯ç”±ç»„" class="headerlink" title="è·¯ç”±ç»„"></a>è·¯ç”±ç»„</h3><pre><code class="go">authorized := r.Group(&quot;/&quot;, AuthRequired())&#123;  authorized.POST(&quot;/login&quot;, loginEndpoint)  authorized.POST(&quot;/submit&quot;, submitEndpoint)  authorized.POST(&quot;/read&quot;, readEndpoint)  // åµŒå¥—è·¯ç”±ç»„  testing := authorized.Group(&quot;testing&quot;)  testing.GET(&quot;/analytics&quot;, analyticsEndpoint)&#125;</code></pre><p>åŒä¸‹é¢çš„å®Œå…¨ä¸€æ ·</p><pre><code class="go">authorized := r.Group(&quot;/&quot;)authorized.Use(AuthRequired())&#123;  authorized.POST(&quot;/login&quot;, loginEndpoint)  authorized.POST(&quot;/submit&quot;, submitEndpoint)  authorized.POST(&quot;/read&quot;, readEndpoint)&#125;</code></pre><h2 id="åªç»‘å®š-url-æŸ¥è¯¢å­—ç¬¦ä¸²"><a href="#åªç»‘å®š-url-æŸ¥è¯¢å­—ç¬¦ä¸²" class="headerlink" title="åªç»‘å®š url æŸ¥è¯¢å­—ç¬¦ä¸²"></a>åªç»‘å®š url æŸ¥è¯¢å­—ç¬¦ä¸²</h2><p>åªç»‘å®š url æŸ¥è¯¢å‚æ•°ï¼Œè€Œå¿½ç•¥ post å‚æ•°ï¼š<code>ShouldBindQuery</code></p><pre><code class="go">type Person struct &#123;    Name    string `form:&quot;name&quot;`    Address string `form:&quot;address&quot;`&#125;route.PUT(&quot;/testing&quot;, startPage)func startPage(c *gin.Context) &#123;    var person Person    if c.ShouldBindQuery(&amp;person) == nil &#123;        log.Println(&quot;====== Only Bind By Query String ======&quot;)        log.Println(person.Name)        log.Println(person.Address)    &#125;    c.String(200, &quot;Success&quot;)&#125;</code></pre><h2 id="åœ¨ä¸­é—´ä»¶ä½¿ç”¨-go-routine"><a href="#åœ¨ä¸­é—´ä»¶ä½¿ç”¨-go-routine" class="headerlink" title="åœ¨ä¸­é—´ä»¶ä½¿ç”¨ go routine"></a>åœ¨ä¸­é—´ä»¶ä½¿ç”¨ go routine</h2><p>å½“åœ¨ä¸­é—´ä»¶æˆ– handler ä¸­å¯åŠ¨æ–°çš„ Goroutine æ—¶ï¼Œä¸èƒ½ä½¿ç”¨åŸå§‹çš„ä¸Šä¸‹æ–‡ï¼Œå¿…é¡»ä½¿ç”¨åªè¯»å‰¯æœ¬ã€‚</p><pre><code class="go">r.GET(&quot;/long_async&quot;, func(c *gin.Context) &#123;  // åˆ›å»ºåœ¨ goroutine ä¸­ä½¿ç”¨çš„å‰¯æœ¬  cCp := c.Copy()  go func() &#123;    // ç”¨ time.Sleep() æ¨¡æ‹Ÿä¸€ä¸ªé•¿ä»»åŠ¡ã€‚    time.Sleep(5 * time.Second)    // ä½¿ç”¨çš„æ˜¯å¤åˆ¶çš„ä¸Šä¸‹æ–‡ &quot;cCp&quot;ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦    log.Println(&quot;Done! in path &quot; + cCp.Request.URL.Path)  &#125;()&#125;)r.GET(&quot;/long_sync&quot;, func(c *gin.Context) &#123;  // ç”¨ time.Sleep() æ¨¡æ‹Ÿä¸€ä¸ªé•¿ä»»åŠ¡ã€‚  time.Sleep(5 * time.Second)  // å› ä¸ºæ²¡æœ‰ä½¿ç”¨ goroutineï¼Œä¸éœ€è¦ä½¿ç”¨ä¸Šä¸‹æ–‡å‰¯æœ¬  log.Println(&quot;Done! in path &quot; + c.Request.URL.Path)&#125;)</code></pre><h2 id="è®°å½•æ—¥å¿—"><a href="#è®°å½•æ—¥å¿—" class="headerlink" title="è®°å½•æ—¥å¿—"></a>è®°å½•æ—¥å¿—</h2><pre><code class="go">// åªå°†æ—¥å¿—å†™å…¥æ–‡ä»¶f, _ := os.Create(&quot;gin.log&quot;)gin.DefaultWriter = io.MultiWriter(f)// éœ€è¦åŒæ—¶å°†æ—¥å¿—å†™å…¥æ–‡ä»¶å’Œæ§åˆ¶å°gin.DefaultWriter = io.MultiWriter(f, os.Stdout)</code></pre><h2 id="å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼"><a href="#å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼" class="headerlink" title="å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼"></a>å®šä¹‰è·¯ç”±æ—¥å¿—çš„æ ¼å¼</h2><p>é»˜è®¤çš„è·¯ç”±æ—¥å¿—æ ¼å¼</p><pre><code class="bash">[GIN-debug] POST   /foo                      --&gt; main.main.func1 (3 handlers)[GIN-debug] GET    /bar                      --&gt; main.main.func2 (3 handlers)[GIN-debug] GET    /status                   --&gt; main.main.func3 (3 handlers)</code></pre><p>è‡ªå®šä¹‰æ—¥å¿—æ ¼å¼ï¼šJSONï¼Œkey-value ç­‰-&gt;<code>gin.DebugPrintRouteFunc</code></p><pre><code class="go">gin.DebugPrintRouteFunc = func(httpMethod, absolutePath, handlerName string, nuHandlers int) &#123;  log.Printf(&quot;endpoint %v %v %v %v\n&quot;, httpMethod, absolutePath, handlerName, nuHandlers)&#125;</code></pre><h2 id="å°†-request-body-ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­"><a href="#å°†-request-body-ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­" class="headerlink" title="å°† request body ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­"></a>å°† request body ç»‘å®šåˆ°ä¸åŒçš„ç»“æ„ä½“ä¸­</h2><p><code>c.ShouldBind</code>é€šè¿‡<code>c.Request.Body</code>ç»‘å®šæ•°æ®ï¼Œä½†æ˜¯åœ¨éƒ¨åˆ†æ ¼å¼ä¸èƒ½å¤šæ¬¡è°ƒç”¨ï¼š</p><ul><li>JSON</li><li>XML</li><li>MsgPack</li><li>ProtoBuf<br>å¦‚æœéœ€è¦å¤šæ¬¡ç»‘å®šåˆ°ä¸åŒç»“æ„ä½“,éœ€è¦ä½¿ç”¨<code>c.ShouldBindBodyWith</code><br>å¯ä»¥å¤šæ¬¡è°ƒç”¨<code>c.ShouldBind</code>çš„æ ¼å¼ï¼š</li><li>Query</li><li>Form</li><li>FormPost</li><li>FormMultipart</li></ul><pre><code class="go">type formA struct &#123;  Foo string `json:&quot;foo&quot; xml:&quot;foo&quot; binding:&quot;required&quot;`&#125;type formB struct &#123;  Bar string `json:&quot;bar&quot; xml:&quot;bar&quot; binding:&quot;required&quot;`&#125;func SomeHandler(c *gin.Context) &#123;  objA := formA&#123;&#125;  objB := formB&#123;&#125;  // c.ShouldBind ä½¿ç”¨äº† c.Request.Bodyï¼Œä¸å¯é‡ç”¨ã€‚  if errA := c.ShouldBind(&amp;objA); errA == nil &#123;    c.String(http.StatusOK, `the body should be formA`)  // å› ä¸ºç°åœ¨ c.Request.Body æ˜¯ EOFï¼Œæ‰€ä»¥è¿™é‡Œä¼šæŠ¥é”™ã€‚  &#125; else if errB := c.ShouldBind(&amp;objB); errB == nil &#123;    c.String(http.StatusOK, `the body should be formB`)  &#125;&#125;// è¯»å– c.Request.Body å¹¶å°†ç»“æœå­˜å…¥ä¸Šä¸‹æ–‡ã€‚if errA := c.ShouldBindBodyWith(&amp;objA, binding.JSON); errA == nil &#123;  c.String(http.StatusOK, `the body should be formA`)// è¿™æ—¶, å¤ç”¨å­˜å‚¨åœ¨ä¸Šä¸‹æ–‡ä¸­çš„ bodyã€‚&#125; else if errB := c.ShouldBindBodyWith(&amp;objB, binding.JSON); errB == nil &#123;  c.String(http.StatusOK, `the body should be formB JSON`)// å¯ä»¥æ¥å—å…¶ä»–æ ¼å¼&#125; else if errB2 := c.ShouldBindBodyWith(&amp;objB, binding.XML); errB2 == nil &#123;  c.String(http.StatusOK, `the body should be formB XML`)&#125;</code></pre><h2 id="æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²"><a href="#æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²" class="headerlink" title="æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²"></a>æ§åˆ¶æ—¥å¿—è¾“å‡ºé¢œè‰²</h2><p>è¾“å‡ºåˆ°æ§åˆ¶å°çš„æ—¥å¿—é»˜è®¤æ˜¯æœ‰é¢œè‰²çš„</p><pre><code class="go">// ç¦æ­¢æ—¥å¿—çš„é¢œè‰²gin.DisableConsoleColor()// å¼ºåˆ¶æ—¥å¿—é¢œè‰²åŒ–gin.ForceConsoleColor()</code></pre><h2 id="æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°"><a href="#æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°" class="headerlink" title="æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°"></a>æ˜ å°„æŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è¡¨å•å‚æ•°</h2><pre><code class="bash">POST /post?ids[a]=1234&amp;ids[b]=hello HTTP/1.1Content-Type: application/x-www-form-urlencodednames[first]=thinkerou&amp;names[second]=tianou</code></pre><pre><code class="go">ids := c.QueryMap(&quot;ids&quot;)names := c.PostFormMap(&quot;names&quot;)fmt.Printf(&quot;ids: %v; names: %v&quot;, ids, names)// queryå‚æ•°â€”â€”ids: map[b:hello a:1234],// è¡¨å•å‚æ•°â€”â€”names: map[second:tianou first:thinkerou]</code></pre><h2 id="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°"><a href="#æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°" class="headerlink" title="æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°"></a>æŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°</h2><p>&#x2F;&#x2F; ä½¿ç”¨ç°æœ‰çš„åŸºç¡€è¯·æ±‚å¯¹è±¡è§£ææŸ¥è¯¢å­—ç¬¦ä¸²å‚æ•°ã€‚<br>ç¤ºä¾‹ URLï¼š &#x2F;welcome?firstname&#x3D;Jane&amp;lastname&#x3D;Doe</p><pre><code class="go">router.GET(&quot;/welcome&quot;, func(c *gin.Context) &#123;  firstname := c.DefaultQuery(&quot;firstname&quot;, &quot;Guest&quot;)  lastname := c.Query(&quot;lastname&quot;) // c.Request.URL.Query().Get(&quot;lastname&quot;) çš„ä¸€ç§å¿«æ·æ–¹å¼  c.String(http.StatusOK, &quot;Hello %s %s&quot;, firstname, lastname)&#125;)</code></pre><h2 id="model-binding-ç»‘å®šå’ŒéªŒè¯"><a href="#model-binding-ç»‘å®šå’ŒéªŒè¯" class="headerlink" title="model binding ç»‘å®šå’ŒéªŒè¯"></a>model binding ç»‘å®šå’ŒéªŒè¯</h2><p>åœ¨ç»‘å®šçš„æ‰€æœ‰å­—æ®µä¸Šï¼Œè®¾ç½®ç›¸åº”çš„ tagï¼Œæ¯”å¦‚ä½¿ç”¨ json ç»‘å®šçš„æ—¶å€™ï¼Œè®¾ç½®å­—æ®µæ ‡ç­¾ä¸º <code>json:&quot;filename&quot;</code><br>æ–¹æ³•ï¼šShouldBind, ShouldBindJSON, ShouldBindXML, ShouldBindQuery, ShouldBindYAML<br>è¡Œä¸ºï¼š å¦‚æœå‘ç”Ÿç»‘å®šé”™è¯¯ï¼ŒGin ä¼šè¿”å›é”™è¯¯å¹¶ç”±å¼€å‘è€…å¤„ç†é”™è¯¯å’Œè¯·æ±‚ã€‚</p><pre><code class="go">type Login struct &#123;    User     string `form:&quot;user&quot; json:&quot;user&quot; xml:&quot;user&quot;  binding:&quot;required&quot;`    Password string `form:&quot;password&quot; json:&quot;password&quot; xml:&quot;password&quot; binding:&quot;required&quot;`&#125;// ç»‘å®š JSON (&#123;&quot;user&quot;: &quot;manu&quot;, &quot;password&quot;: &quot;123&quot;&#125;)router.POST(&quot;/loginJSON&quot;, func(c *gin.Context) &#123;  var json Login  if err := c.ShouldBindJSON(&amp;json); err != nil &#123;    c.JSON(http.StatusBadRequest, gin.H&#123;&quot;error&quot;: err.Error()&#125;)    return  &#125;  if json.User != &quot;manu&quot; || json.Password != &quot;123&quot; &#123;    c.JSON(http.StatusUnauthorized, gin.H&#123;&quot;status&quot;: &quot;unauthorized&quot;&#125;)    return  &#125;  c.JSON(http.StatusOK, gin.H&#123;&quot;status&quot;: &quot;you are logged in&quot;&#125;)&#125;)// ç»‘å®šXML//&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;//&lt;root&gt;//&lt;user&gt;manu&lt;/user&gt;//&lt;password&gt;123&lt;/password&gt;//&lt;/root&gt;)router.POST(&quot;/loginXML&quot;, func(c *gin.Context) &#123;  var xml Login  if err := c.ShouldBindXML(&amp;xml); err != nil &#123;    c.JSON(http.StatusBadRequest, gin.H&#123;&quot;error&quot;: err.Error()&#125;)    return  &#125;  if xml.User != &quot;manu&quot; || xml.Password != &quot;123&quot; &#123;    c.JSON(http.StatusUnauthorized, gin.H&#123;&quot;status&quot;: &quot;unauthorized&quot;&#125;)    return  &#125;  c.JSON(http.StatusOK, gin.H&#123;&quot;status&quot;: &quot;you are logged in&quot;&#125;)&#125;)// ç»‘å®š HTML è¡¨å• (user=manu&amp;password=123)router.POST(&quot;/loginForm&quot;, func(c *gin.Context) &#123;  var form Login  // æ ¹æ® Content-Type Header æ¨æ–­ä½¿ç”¨å“ªä¸ªç»‘å®šå™¨ã€‚  if err := c.ShouldBind(&amp;form); err != nil &#123;    c.JSON(http.StatusBadRequest, gin.H&#123;&quot;error&quot;: err.Error()&#125;)    return  &#125;  if form.User != &quot;manu&quot; || form.Password != &quot;123&quot; &#123;    c.JSON(http.StatusUnauthorized, gin.H&#123;&quot;status&quot;: &quot;unauthorized&quot;&#125;)    return  &#125;  c.JSON(http.StatusOK, gin.H&#123;&quot;status&quot;: &quot;you are logged in&quot;&#125;)&#125;)</code></pre><h2 id="ç»‘å®š-uri"><a href="#ç»‘å®š-uri" class="headerlink" title="ç»‘å®š uri"></a>ç»‘å®š uri</h2><pre><code class="go">type Person struct &#123;    ID   string `uri:&quot;id&quot; binding:&quot;required,uuid&quot;`    Name string `uri:&quot;name&quot; binding:&quot;required&quot;`&#125;route.GET(&quot;/:name/:id&quot;, func(c *gin.Context) &#123;  var person Person  if err := c.ShouldBindUri(&amp;person); err != nil &#123;    c.JSON(400, gin.H&#123;&quot;msg&quot;: err.Error()&#125;)    return  &#125;  c.JSON(200, gin.H&#123;&quot;name&quot;: person.Name, &quot;uuid&quot;: person.ID&#125;)&#125;)</code></pre><h2 id="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è€…è¡¨å•æ•°æ®"><a href="#ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è€…è¡¨å•æ•°æ®" class="headerlink" title="ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è€…è¡¨å•æ•°æ®"></a>ç»‘å®šæŸ¥è¯¢å­—ç¬¦ä¸²æˆ–è€…è¡¨å•æ•°æ®</h2><pre><code class="go">type Person struct &#123;    Name     string    `form:&quot;name&quot;`    Address  string    `form:&quot;address&quot;`    Birthday time.Time `form:&quot;birthday&quot; time_format:&quot;2006-01-02&quot; time_utc:&quot;1&quot;`&#125;route.GET(&quot;/testing&quot;, startPage)func startPage(c *gin.Context) &#123;    var person Person    // å¦‚æœæ˜¯ `GET` è¯·æ±‚ï¼Œåªä½¿ç”¨ `Form` ç»‘å®šå¼•æ“ï¼ˆ`query`ï¼‰ã€‚    // å¦‚æœæ˜¯ `POST` è¯·æ±‚ï¼Œé¦–å…ˆæ£€æŸ¥ `content-type` æ˜¯å¦ä¸º `JSON` æˆ– `XML`ï¼Œç„¶åå†ä½¿ç”¨ `Form`ï¼ˆ`form-data`ï¼‰ã€‚    // æŸ¥çœ‹æ›´å¤šï¼šhttps://github.com/gin-gonic/gin/blob/master/binding/binding.go#L88    if c.ShouldBind(&amp;person) == nil &#123;        log.Println(person.Name)        log.Println(person.Address)        log.Println(person.Birthday)    &#125;    c.String(200, &quot;Success&quot;)&#125;</code></pre><h2 id="ç»‘å®šè¡¨å•æ•°æ®åˆ°è‡ªå®šä¹‰-struct"><a href="#ç»‘å®šè¡¨å•æ•°æ®åˆ°è‡ªå®šä¹‰-struct" class="headerlink" title="ç»‘å®šè¡¨å•æ•°æ®åˆ°è‡ªå®šä¹‰ struct"></a>ç»‘å®šè¡¨å•æ•°æ®åˆ°è‡ªå®šä¹‰ struct</h2><p>ä¸æ”¯æŒåµŒå¥—çš„ struct</p><pre><code class="go">type StructA struct &#123;    FieldA string `form:&quot;field_a&quot;`&#125;type StructB struct &#123;    NestedStruct StructA    FieldB string `form:&quot;field_b&quot;`&#125;func GetDataB(c *gin.Context) &#123;  var b StructB  c.Bind(&amp;b)  c.JSON(200, gin.H&#123;      &quot;a&quot;: b.NestedStruct,      &quot;b&quot;: b.FieldB,  &#125;)&#125;</code></pre><h2 id="è‡ªå®šä¹‰-http-é…ç½®"><a href="#è‡ªå®šä¹‰-http-é…ç½®" class="headerlink" title="è‡ªå®šä¹‰ http é…ç½®"></a>è‡ªå®šä¹‰ http é…ç½®</h2><pre><code class="go">http.ListenAndServe(&quot;:8080&quot;, router)// è‡ªå®šä¹‰s := &amp;http.Server&#123;  Addr:           &quot;:8080&quot;,  Handler:        router,  ReadTimeout:    10 * time.Second,  WriteTimeout:   10 * time.Second,  MaxHeaderBytes: 1 &lt;&lt; 20,&#125;s.ListenAndServe()</code></pre><h2 id="è‡ªå®šä¹‰ä¸­é—´ä»¶"><a href="#è‡ªå®šä¹‰ä¸­é—´ä»¶" class="headerlink" title="è‡ªå®šä¹‰ä¸­é—´ä»¶"></a>è‡ªå®šä¹‰ä¸­é—´ä»¶</h2><pre><code class="go">func Logger() gin.HandlerFunc &#123;    return func(c *gin.Context) &#123;        t := time.Now()        // è®¾ç½® example å˜é‡        c.Set(&quot;example&quot;, &quot;12345&quot;)        // è¯·æ±‚å‰        c.Next()        // è¯·æ±‚å        latency := time.Since(t)        log.Print(latency)        // è·å–å‘é€çš„ status        status := c.Writer.Status()        log.Println(status)    &#125;&#125;//r := gin.New()r.Use(Logger())r.GET(&quot;/test&quot;, func(c *gin.Context) &#123;  example := c.MustGet(&quot;example&quot;).(string)  // æ‰“å°ï¼š&quot;12345&quot;  log.Println(example)&#125;)</code></pre><h2 id="è‡ªå®šä¹‰éªŒè¯"><a href="#è‡ªå®šä¹‰éªŒè¯" class="headerlink" title="è‡ªå®šä¹‰éªŒè¯"></a>è‡ªå®šä¹‰éªŒè¯</h2><pre><code class="go">type Booking struct &#123;    CheckIn  time.Time `form:&quot;check_in&quot; binding:&quot;required,bookabledate&quot; time_format:&quot;2006-01-02&quot;`    CheckOut time.Time `form:&quot;check_out&quot; binding:&quot;required,gtfield=CheckIn,bookabledate&quot; time_format:&quot;2006-01-02&quot;`&#125;var bookableDate validator.Func = func(fl validator.FieldLevel) bool &#123;    date, ok := fl.Field().Interface().(time.Time)    if ok &#123;        today := time.Now()        if today.After(date) &#123;            return false        &#125;    &#125;    return true&#125;    if v, ok := binding.Validator.Engine().(*validator.Validate); ok &#123;        v.RegisterValidation(&quot;bookabledate&quot;, bookableDate)    &#125;</code></pre><h2 id="è®¾ç½®-x2F-è·å–-cookie"><a href="#è®¾ç½®-x2F-è·å–-cookie" class="headerlink" title="è®¾ç½®&#x2F;è·å– cookie"></a>è®¾ç½®&#x2F;è·å– cookie</h2><p>è·å–:<code>cookie, err := c.Cookie(&quot;gin_cookie&quot;)</code><br>è®¾ç½®:<code>c.SetCookie(&quot;gin_cookie&quot;, &quot;test&quot;, 3600, &quot;/&quot;, &quot;localhost&quot;, false, true)</code></p><h2 id="è·¯ç”±å‚æ•°"><a href="#è·¯ç”±å‚æ•°" class="headerlink" title="è·¯ç”±å‚æ•°"></a>è·¯ç”±å‚æ•°</h2><p>åŒ¹é… &#x2F;user&#x2F;john ä½†ä¸ä¼šåŒ¹é… &#x2F;user&#x2F; æˆ–è€… &#x2F;user:</p><pre><code class="go">router.GET(&quot;/user/:name&quot;, func(c *gin.Context) &#123;  name := c.Param(&quot;name&quot;)  c.String(http.StatusOK, &quot;Hello %s&quot;, name)&#125;)</code></pre><p>åŒ¹é… &#x2F;user&#x2F;john&#x2F; å’Œ &#x2F;user&#x2F;john&#x2F;send:</p><pre><code class="go">//  å¦‚æœæ²¡æœ‰å…¶ä»–è·¯ç”±åŒ¹é… /user/johnï¼Œå®ƒå°†é‡å®šå‘åˆ° /user/john/router.GET(&quot;/user/:name/*action&quot;, func(c *gin.Context) &#123;  name := c.Param(&quot;name&quot;)  action := c.Param(&quot;action&quot;)  message := name + &quot; is &quot; + action  c.String(http.StatusOK, message)&#125;)</code></pre><h2 id="è·¯ç”±ç»„-1"><a href="#è·¯ç”±ç»„-1" class="headerlink" title="è·¯ç”±ç»„"></a>è·¯ç”±ç»„</h2><pre><code class="go">v1 := router.Group(&quot;/v1&quot;)&#123;  v1.POST(&quot;/login&quot;, loginEndpoint)  v1.POST(&quot;/submit&quot;, submitEndpoint)  v1.POST(&quot;/read&quot;, readEndpoint)&#125;</code></pre><h2 id="è¿è¡Œå¤šä¸ªæœåŠ¡"><a href="#è¿è¡Œå¤šä¸ªæœåŠ¡" class="headerlink" title="è¿è¡Œå¤šä¸ªæœåŠ¡"></a>è¿è¡Œå¤šä¸ªæœåŠ¡</h2><p>GO </p><pre><code class="go">var (    g errgroup.Group)func router01() http.Handler &#123;    e := gin.New()    e.Use(gin.Recovery())    e.GET(&quot;/&quot;, func(c *gin.Context) &#123;        c.JSON(            http.StatusOK,            gin.H&#123;                &quot;code&quot;:  http.StatusOK,                &quot;error&quot;: &quot;Welcome server 01&quot;,            &#125;,        )    &#125;)    return e&#125;func router02() http.Handler &#123;    e := gin.New()    e.Use(gin.Recovery())    e.GET(&quot;/&quot;, func(c *gin.Context) &#123;        c.JSON(            http.StatusOK,            gin.H&#123;                &quot;code&quot;:  http.StatusOK,                &quot;error&quot;: &quot;Welcome server 02&quot;,            &#125;,        )    &#125;)    return e&#125;server01 := &amp;http.Server&#123;  Addr:         &quot;:8080&quot;,  Handler:      router01(),  ReadTimeout:  5 * time.Second,  WriteTimeout: 10 * time.Second,&#125;server02 := &amp;http.Server&#123;  Addr:         &quot;:8081&quot;,  Handler:      router02(),  ReadTimeout:  5 * time.Second,  WriteTimeout: 10 * time.Second,&#125;g.Go(func() error &#123;  return server01.ListenAndServe()&#125;)g.Go(func() error &#123;  return server02.ListenAndServe()&#125;)if err := g.Wait(); err != nil &#123;  log.Fatal(err)&#125;</code></pre><h2 id="é‡å®šå‘"><a href="#é‡å®šå‘" class="headerlink" title="é‡å®šå‘"></a>é‡å®šå‘</h2><h3 id="geté‡å®šå‘"><a href="#geté‡å®šå‘" class="headerlink" title="geté‡å®šå‘"></a>geté‡å®šå‘</h3><pre><code class="go">r.GET(&quot;/test&quot;, func(c *gin.Context) &#123;    c.Redirect(http.StatusMovedPermanently, &quot;http://www.google.com/&quot;)&#125;)</code></pre><h3 id="post-é‡å®šå‘"><a href="#post-é‡å®šå‘" class="headerlink" title="post é‡å®šå‘"></a>post é‡å®šå‘</h3><pre><code class="go">r.POST(&quot;/test&quot;, func(c *gin.Context) &#123;    c.Redirect(http.StatusFound, &quot;/foo&quot;)&#125;)</code></pre><h3 id="è·¯ç”±é‡å®šå‘"><a href="#è·¯ç”±é‡å®šå‘" class="headerlink" title="è·¯ç”±é‡å®šå‘"></a>è·¯ç”±é‡å®šå‘</h3><p>ä½¿ç”¨<code>HandleContext</code></p><pre><code class="go">r.GET(&quot;/test&quot;, func(c *gin.Context) &#123;    c.Request.URL.Path = &quot;/test2&quot;    r.HandleContext(c)&#125;)r.GET(&quot;/test2&quot;, func(c *gin.Context) &#123;    c.JSON(200, gin.H&#123;&quot;hello&quot;: &quot;world&quot;&#125;)&#125;)</code></pre><h2 id="é™æ€æ–‡ä»¶"><a href="#é™æ€æ–‡ä»¶" class="headerlink" title="é™æ€æ–‡ä»¶"></a>é™æ€æ–‡ä»¶</h2><pre><code class="go">router.Static(&quot;/assets&quot;, &quot;./assets&quot;)router.StaticFS(&quot;/more_static&quot;, http.Dir(&quot;my_file_system&quot;))router.StaticFile(&quot;/favicon.ico&quot;, &quot;./resources/favicon.ico&quot;)</code></pre><h2 id="é™æ€èµ„æºåµŒå…¥"><a href="#é™æ€èµ„æºåµŒå…¥" class="headerlink" title="é™æ€èµ„æºåµŒå…¥"></a>é™æ€èµ„æºåµŒå…¥</h2><pre><code class="go">// loadTemplate åŠ è½½ç”± go-assets-builder åµŒå…¥çš„æ¨¡æ¿func loadTemplate() (*template.Template, error) &#123;    t := template.New(&quot;&quot;)    for name, file := range Assets.Files &#123;        if file.IsDir() || !strings.HasSuffix(name, &quot;.tmpl&quot;) &#123;            continue        &#125;        h, err := ioutil.ReadAll(file)        if err != nil &#123;            return nil, err        &#125;        t, err = t.New(name).Parse(string(h))        if err != nil &#123;            return nil, err        &#125;    &#125;    return t, nil&#125;t, err := loadTemplate()if err != nil &#123;  panic(err)&#125;r.SetHTMLTemplate(t)r.GET(&quot;/&quot;, func(c *gin.Context) &#123;  c.HTML(http.StatusOK, &quot;/html/index.tmpl&quot;, nil)&#125;)</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gormå­¦ä¹ ç¬”è®°</title>
      <link href="/2023/03/21/gorm-xue-xi-bi-ji/"/>
      <url>/2023/03/21/gorm-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><pre><code class="bash">go get -u gorm.io/gorm# å®‰è£…å¯¹åº”æ•°æ®åº“é©±åŠ¨ï¼Œæ¯”å¦‚mysql,sqlitego get -u gorm.io/driver/mysql</code></pre><h2 id="å¸¸è§ç”¨æ³•"><a href="#å¸¸è§ç”¨æ³•" class="headerlink" title="å¸¸è§ç”¨æ³•"></a>å¸¸è§ç”¨æ³•</h2><pre><code class="go">package mainimport (  &quot;gorm.io/gorm&quot;  &quot;gorm.io/driver/sqlite&quot;)type Product struct &#123;  gorm.Model  Code  string  Price uint&#125;func main() &#123;  // è¿æ¥æ•°æ®åº“  db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config&#123;&#125;)  if err != nil &#123;    panic(&quot;failed to connect database&quot;)  &#125;  // è¿ç§» schemaï¼šä¿æŒæ•°æ®åº“å’Œç¨‹åºæ•°æ®ç»“æ„å§‹ç»ˆä¿æŒä¸€è‡´  db.AutoMigrate(&amp;Product&#123;&#125;)  // Create ï¼šåˆ›å»ºä¸€æ¡æ•°æ®åº“è®°å½•  db.Create(&amp;Product&#123;Code: &quot;D42&quot;, Price: 100&#125;)  // Read ï¼šæŸ¥è¯¢æ•°æ®åº“è®°å½•  var product Product  db.First(&amp;product, 1) // æ ¹æ®æ•´å‹ä¸»é”®æŸ¥æ‰¾  db.First(&amp;product, &quot;code = ?&quot;, &quot;D42&quot;) // æŸ¥æ‰¾ code å­—æ®µå€¼ä¸º D42 çš„è®°å½•  // Update ï¼šä¿®æ”¹æ•°æ®åº“å•æ¡è®°å½•ï¼Œå°† product çš„ price æ›´æ–°ä¸º 200  db.Model(&amp;product).Update(&quot;Price&quot;, 200)  // Update - æ›´æ–°å¤šä¸ªå­—æ®µ  db.Model(&amp;product).Updates(Product&#123;Price: 200, Code: &quot;F42&quot;&#125;) // ä»…æ›´æ–°éé›¶å€¼å­—æ®µ  db.Model(&amp;product).Updates(map[string]interface&#123;&#125;&#123;&quot;Price&quot;: 200, &quot;Code&quot;: &quot;F42&quot;&#125;)  // Deleteï¼šè½¯åˆ é™¤æ•°æ®åº“å•æ¡è®°å½•ï¼Œ åˆ é™¤ product  db.Delete(&amp;product, 1)&#125;</code></pre><h2 id="çº¦å®š"><a href="#çº¦å®š" class="headerlink" title="çº¦å®š"></a>çº¦å®š</h2><p>çº¦å®šä¼˜äºé…ç½®</p><ol><li>GORM ä½¿ç”¨ ID åšä¸»é”®</li><li>GORM ä½¿ç”¨ç»“æ„ä½“åç§°<code>UserTable</code>çš„è›‡å½¢å¤æ•°<code>user_tables</code>ä½œä¸ºè¡¨åï¼Œå­—æ®µåçš„è›‡å½¢<code>created_at</code>ä½œä¸ºåˆ—å</li><li>GORM ä½¿ç”¨ CreatedAt,UpdatedAt å­—æ®µè¿½è¸ªåˆ›å»ºæ—¶é—´å’Œæ›´æ–°æ—¶é—´</li><li>å¯ä¿®æ”¹é»˜è®¤é…ç½®,å…·ä½“è§<a href="https://gorm.io/zh_CN/docs/conventions.html">ä¿®æ”¹é»˜è®¤é…ç½®</a></li></ol><h2 id="gorm-Model"><a href="#gorm-Model" class="headerlink" title="gorm.Model"></a>gorm.Model</h2><p>æœ¬è´¨ï¼šä¸€ä¸ª struct ç»“æ„ä½“</p><pre><code class="go">// gorm.Model çš„å®šä¹‰type Model struct &#123;  ID        uint           `gorm:&quot;primaryKey&quot;`  CreatedAt time.Time   //åœ¨åˆ›å»ºã€æ›´æ–°ã€åˆ é™¤æ—¶è‡ªåŠ¨å¡«å……å½“å‰æ—¶é—´  UpdatedAt time.Time  DeletedAt gorm.DeletedAt `gorm:&quot;index&quot;`&#125;</code></pre><h2 id="æ§åˆ¶å­—æ®µçº§çš„è¯»å†™æƒé™"><a href="#æ§åˆ¶å­—æ®µçº§çš„è¯»å†™æƒé™" class="headerlink" title="æ§åˆ¶å­—æ®µçº§çš„è¯»å†™æƒé™"></a>æ§åˆ¶å­—æ®µçº§çš„è¯»å†™æƒé™</h2><p>é»˜è®¤å¯å¯¼å‡ºå­—æ®µåœ¨è¿›è¡Œ CRUD çš„æ—¶å€™æ‹¥æœ‰å…¨éƒ¨æƒé™ã€‚ä½¿ç”¨è‡ªåŠ¨è¿ç§»åˆ›å»ºè¡¨çš„æ—¶å€™ï¼Œä¸ä¼šåˆ›å»ºè¢«å¿½ç•¥çš„å­—æ®µ</p><pre><code class="go">type User struct &#123;  Name string `gorm:&quot;&lt;-:create&quot;` // å…è®¸è¯»å’Œåˆ›å»º  Name string `gorm:&quot;&lt;-:update&quot;` // å…è®¸è¯»å’Œæ›´æ–°  Name string `gorm:&quot;&lt;-&quot;`        // å…è®¸è¯»å’Œå†™ï¼ˆåˆ›å»ºå’Œæ›´æ–°ï¼‰  Name string `gorm:&quot;&lt;-:false&quot;`  // å…è®¸è¯»ï¼Œç¦æ­¢å†™  Name string `gorm:&quot;-&gt;&quot;`        // åªè¯»ï¼ˆé™¤éæœ‰è‡ªå®šä¹‰é…ç½®ï¼Œå¦åˆ™ç¦æ­¢å†™ï¼‰  Name string `gorm:&quot;-&gt;;&lt;-:create&quot;` // å…è®¸è¯»å’Œå†™  Name string `gorm:&quot;-&gt;:false;&lt;-:create&quot;` // ä»…åˆ›å»ºï¼ˆç¦æ­¢ä» db è¯»ï¼‰  Name string `gorm:&quot;-&quot;`  // é€šè¿‡ struct è¯»å†™ä¼šå¿½ç•¥è¯¥å­—æ®µ  Name string `gorm:&quot;-:all&quot;`        // é€šè¿‡ struct è¯»å†™ã€è¿ç§»ä¼šå¿½ç•¥è¯¥å­—æ®µ  Name string `gorm:&quot;-:migration&quot;`  // é€šè¿‡ struct è¿ç§»ä¼šå¿½ç•¥è¯¥å­—æ®µ&#125;</code></pre><h2 id="åµŒå…¥ç»“æ„ä½“"><a href="#åµŒå…¥ç»“æ„ä½“" class="headerlink" title="åµŒå…¥ç»“æ„ä½“"></a>åµŒå…¥ç»“æ„ä½“</h2><h3 id="åŒ¿åå­—æ®µ"><a href="#åŒ¿åå­—æ®µ" class="headerlink" title="åŒ¿åå­—æ®µ"></a>åŒ¿åå­—æ®µ</h3><pre><code class="go">type User struct &#123;  gorm.Model  Name string&#125;// ç­‰æ•ˆäºtype User struct &#123;  ID        uint           `gorm:&quot;primaryKey&quot;`  CreatedAt time.Time  UpdatedAt time.Time  DeletedAt gorm.DeletedAt `gorm:&quot;index&quot;`  Name string&#125;</code></pre><h3 id="æ­£å¸¸ç»“æ„ä½“å­—æ®µ"><a href="#æ­£å¸¸ç»“æ„ä½“å­—æ®µ" class="headerlink" title="æ­£å¸¸ç»“æ„ä½“å­—æ®µ"></a>æ­£å¸¸ç»“æ„ä½“å­—æ®µ</h3><ol><li>é€šè¿‡æ ‡ç­¾ <code>embedded</code> å°†å…¶åµŒå…¥</li></ol><pre><code class="go">type Author struct &#123;    Name  string    Email string&#125;type Blog struct &#123;  ID      int  Author  Author `gorm:&quot;embedded&quot;`  UpVotes int32&#125;// ç­‰æ•ˆäºtype Blog struct &#123;  ID    int64  Name  string  Email string  UpVotes  int32&#125;</code></pre><ol start="2"><li>ä½¿ç”¨æ ‡ç­¾ embeddedPrefix æ¥ä¸º db ä¸­çš„å­—æ®µåæ·»åŠ å‰ç¼€</li></ol><pre><code class="go">type Author struct &#123;    Name  string    Email string&#125;type Blog struct &#123;  ID      int  Author  Author `gorm:&quot;embedded;embeddedPrefix:author_&quot;`  UpVotes  int32&#125;// ç­‰æ•ˆäºtype Blog struct &#123;  ID          int64  AuthorName string  AuthorEmail string  UpVotes  int32&#125;</code></pre><h2 id="å­—æ®µæ ‡ç­¾-tag"><a href="#å­—æ®µæ ‡ç­¾-tag" class="headerlink" title="å­—æ®µæ ‡ç­¾ tag"></a>å­—æ®µæ ‡ç­¾ tag</h2><p>å£°æ˜ model æ—¶ï¼Œtag æ˜¯å¯é€‰çš„,ä½¿ç”¨<code>camelCase</code>é£æ ¼</p><table><thead><tr><th>æ ‡ç­¾å</th><th>è¯´æ˜</th></tr></thead><tbody><tr><td>column</td><td>æŒ‡å®š db åˆ—å</td></tr><tr><td>type</td><td>åˆ—æ•°æ®ç±»å‹ï¼Œæ¨èä½¿ç”¨å…¼å®¹æ€§å¥½çš„é€šç”¨ç±»å‹ï¼Œä¾‹å¦‚ï¼šæ‰€æœ‰æ•°æ®åº“éƒ½æ”¯æŒ boolã€intã€uintã€floatã€stringã€timeã€bytes å¹¶ä¸”å¯ä»¥å’Œå…¶ä»–æ ‡ç­¾ä¸€èµ·ä½¿ç”¨ï¼Œä¾‹å¦‚ï¼šnot nullã€size, autoIncrementâ€¦ åƒ varbinary(8) è¿™æ ·æŒ‡å®šæ•°æ®åº“æ•°æ®ç±»å‹ä¹Ÿæ˜¯æ”¯æŒçš„ã€‚åœ¨ä½¿ç”¨æŒ‡å®šæ•°æ®åº“æ•°æ®ç±»å‹æ—¶ï¼Œå®ƒéœ€è¦æ˜¯å®Œæ•´çš„æ•°æ®åº“æ•°æ®ç±»å‹ï¼Œå¦‚ï¼šMEDIUMINT UNSIGNED not NULL AUTO_INCREMENT</td></tr><tr><td>serializer</td><td>æŒ‡å®šå°†æ•°æ®åºåˆ—åŒ–æˆ–ååºåˆ—åŒ–åˆ°æ•°æ®åº“ä¸­çš„åºåˆ—åŒ–å™¨, ä¾‹å¦‚: serializer:json&#x2F;gob&#x2F;unixtime</td></tr><tr><td>size</td><td>å®šä¹‰åˆ—æ•°æ®ç±»å‹çš„å¤§å°æˆ–é•¿åº¦ï¼Œä¾‹å¦‚ size: 256</td></tr><tr><td>primaryKey</td><td>å°†åˆ—å®šä¹‰ä¸ºä¸»é”®</td></tr><tr><td>unique</td><td>å°†åˆ—å®šä¹‰ä¸ºå”¯ä¸€é”®</td></tr><tr><td>default</td><td>å®šä¹‰åˆ—çš„é»˜è®¤å€¼</td></tr><tr><td>precision</td><td>æŒ‡å®šåˆ—çš„ç²¾åº¦</td></tr><tr><td>scale</td><td>æŒ‡å®šåˆ—å¤§å°</td></tr><tr><td>not null</td><td>æŒ‡å®šåˆ—ä¸º NOT NULL</td></tr><tr><td>autoIncrement</td><td>æŒ‡å®šåˆ—ä¸ºè‡ªåŠ¨å¢é•¿</td></tr><tr><td>autoIncrementIncrement</td><td>è‡ªåŠ¨æ­¥é•¿ï¼Œæ§åˆ¶è¿ç»­è®°å½•ä¹‹é—´çš„é—´éš”</td></tr><tr><td>embedded</td><td>åµŒå¥—å­—æ®µ</td></tr><tr><td>embeddedPrefix</td><td>åµŒå…¥å­—æ®µçš„åˆ—åå‰ç¼€</td></tr><tr><td>autoCreateTime</td><td>åˆ›å»ºæ—¶è¿½è¸ªå½“å‰æ—¶é—´ï¼Œå¯¹äº int å­—æ®µï¼Œå®ƒä¼šè¿½è¸ªæ—¶é—´æˆ³ç§’æ•°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ nano&#x2F;milli æ¥è¿½è¸ªçº³ç§’ã€æ¯«ç§’æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ï¼šautoCreateTime:nano</td></tr><tr><td>autoUpdateTime</td><td>åˆ›å»º&#x2F;æ›´æ–°æ—¶è¿½è¸ªå½“å‰æ—¶é—´ï¼Œå¯¹äº int å­—æ®µï¼Œå®ƒä¼šè¿½è¸ªæ—¶é—´æˆ³ç§’æ•°ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ nano&#x2F;milli æ¥è¿½è¸ªçº³ç§’ã€æ¯«ç§’æ—¶é—´æˆ³ï¼Œä¾‹å¦‚ï¼šautoUpdateTime:milli</td></tr><tr><td>index</td><td>æ ¹æ®å‚æ•°åˆ›å»ºç´¢å¼•ï¼Œå¤šä¸ªå­—æ®µä½¿ç”¨ç›¸åŒçš„åç§°åˆ™åˆ›å»ºå¤åˆç´¢å¼•ï¼ŒæŸ¥çœ‹ ç´¢å¼• è·å–è¯¦æƒ…</td></tr><tr><td>uniqueIndex</td><td>ä¸ index ç›¸åŒï¼Œä½†åˆ›å»ºçš„æ˜¯å”¯ä¸€ç´¢å¼•</td></tr><tr><td>check</td><td>åˆ›å»ºæ£€æŸ¥çº¦æŸï¼Œä¾‹å¦‚ check:age &gt; 13ï¼ŒæŸ¥çœ‹ çº¦æŸ è·å–è¯¦æƒ…</td></tr><tr><td>&lt;-</td><td>è®¾ç½®å­—æ®µå†™å…¥çš„æƒé™ï¼Œ &lt;-:create åªåˆ›å»ºã€&lt;-:update åªæ›´æ–°ã€&lt;-:false æ— å†™å…¥æƒé™ã€&lt;- åˆ›å»ºå’Œæ›´æ–°æƒé™</td></tr><tr><td>-&gt;</td><td>è®¾ç½®å­—æ®µè¯»çš„æƒé™ï¼Œ-&gt;:false æ— è¯»æƒé™</td></tr><tr><td>-</td><td>å¿½ç•¥è¯¥å­—æ®µï¼Œ- è¡¨ç¤ºæ— è¯»å†™ï¼Œ-:migration è¡¨ç¤ºæ— è¿ç§»æƒé™ï¼Œ-:all è¡¨ç¤ºæ— è¯»å†™è¿ç§»æƒé™</td></tr><tr><td>comment</td><td>è¿ç§»æ—¶ä¸ºå­—æ®µæ·»åŠ æ³¨é‡Š</td></tr></tbody></table><h2 id="è¿æ¥åˆ°æ•°æ®åº“"><a href="#è¿æ¥åˆ°æ•°æ®åº“" class="headerlink" title="è¿æ¥åˆ°æ•°æ®åº“"></a>è¿æ¥åˆ°æ•°æ®åº“</h2><p>ç›®å‰æ”¯æŒæ•°æ®åº“ç±»å‹ï¼šMySQL, PostgreSQL, SQLite, SQL Server,clickHouse å’Œ TiDB</p><h3 id="ä»¥-mysql-ä¸ºä¾‹"><a href="#ä»¥-mysql-ä¸ºä¾‹" class="headerlink" title="ä»¥ mysql ä¸ºä¾‹"></a>ä»¥ mysql ä¸ºä¾‹</h3><h4 id="ç®€å•å‹"><a href="#ç®€å•å‹" class="headerlink" title="ç®€å•å‹"></a>ç®€å•å‹</h4><pre><code class="go">  dsn := &quot;user:pass@tcp(127.0.0.1:3306)/dbname?charset=utf8mb4&amp;parseTime=True&amp;loc=Local&quot;  db, err := gorm.Open(mysql.Open(dsn), &amp;gorm.Config&#123;&#125;)</code></pre><h4 id="é«˜çº§é…ç½®å‹"><a href="#é«˜çº§é…ç½®å‹" class="headerlink" title="é«˜çº§é…ç½®å‹"></a>é«˜çº§é…ç½®å‹</h4><p>DNS å‚æ•°é…ç½®å‚è€ƒ<a href="https://github.com/go-sql-driver/mysql#parameters">go-sql-driver</a><br>mysql é…ç½®å¯å‚è€ƒ<a href="https://github.com/go-gorm/mysql">go-gorm&#x2F;mysql</a></p><pre><code class="go">db, err := gorm.Open(mysql.New(mysql.Config&#123;  // æ­¤å¤„  DSN: &quot;gorm:gorm@tcp(127.0.0.1:3306)/gorm?charset=utf8&amp;parseTime=True&amp;loc=Local&quot;, // DSN data source name  DefaultStringSize: 256, // string ç±»å‹å­—æ®µçš„é»˜è®¤é•¿åº¦  DisableDatetimePrecision: true, // ç¦ç”¨ datetime ç²¾åº¦ï¼ŒMySQL 5.6 ä¹‹å‰çš„æ•°æ®åº“ä¸æ”¯æŒ  DontSupportRenameIndex: true, // é‡å‘½åç´¢å¼•æ—¶é‡‡ç”¨åˆ é™¤å¹¶æ–°å»ºçš„æ–¹å¼ï¼ŒMySQL 5.7 ä¹‹å‰çš„æ•°æ®åº“å’Œ MariaDB ä¸æ”¯æŒé‡å‘½åç´¢å¼•  DontSupportRenameColumn: true, // ç”¨ `change` é‡å‘½ååˆ—ï¼ŒMySQL 8 ä¹‹å‰çš„æ•°æ®åº“å’Œ MariaDB ä¸æ”¯æŒé‡å‘½ååˆ—  SkipInitializeWithVersion: false, // æ ¹æ®å½“å‰ MySQL ç‰ˆæœ¬è‡ªåŠ¨é…ç½®  DriverName:&quot;è‡ªå®šä¹‰mysqlé©±åŠ¨åç§°&quot;&#125;), &amp;gorm.Config&#123;&#125;)</code></pre><h4 id="é€šè¿‡ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥æ¥åˆå§‹åŒ–-gorm-DB"><a href="#é€šè¿‡ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥æ¥åˆå§‹åŒ–-gorm-DB" class="headerlink" title="é€šè¿‡ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥æ¥åˆå§‹åŒ– *gorm.DB"></a>é€šè¿‡ä¸€ä¸ªç°æœ‰çš„æ•°æ®åº“è¿æ¥æ¥åˆå§‹åŒ– *gorm.DB</h4><pre><code class="go">import (  &quot;database/sql&quot;  &quot;gorm.io/driver/mysql&quot;  &quot;gorm.io/gorm&quot;)sqlDB, err := sql.Open(&quot;mysql&quot;, &quot;mydb_dsn&quot;)gormDB, err := gorm.Open(mysql.New(mysql.Config&#123;  Conn: sqlDB,&#125;), &amp;gorm.Config&#123;&#125;)</code></pre><h2 id="å¢åŠ "><a href="#å¢åŠ " class="headerlink" title="å¢åŠ "></a>å¢åŠ </h2><h3 id="é€šè¿‡æ•°æ®çš„æŒ‡é’ˆåˆ›å»º"><a href="#é€šè¿‡æ•°æ®çš„æŒ‡é’ˆåˆ›å»º" class="headerlink" title="é€šè¿‡æ•°æ®çš„æŒ‡é’ˆåˆ›å»º"></a>é€šè¿‡æ•°æ®çš„æŒ‡é’ˆåˆ›å»º</h3><pre><code class="go">user:=User&#123;Name:&quot;yueyueyan&quot;,Age:19,Birthday:time.Now()&#125;result:=db.Create(&amp;user)</code></pre><p>è¿”å›ç»“æœ<br>user.IDï¼šè¿”å›æ’å…¥æ•°æ®çš„ä¸»é”®<br>result.Error ï¼šè¿”å› error<br>result.RowsAffected ï¼š è¿”å›æ’å…¥è®°å½•çš„æ¡æ•°</p><h3 id="ç”¨æŒ‡å®šçš„å­—æ®µåˆ›å»ºè®°å½•"><a href="#ç”¨æŒ‡å®šçš„å­—æ®µåˆ›å»ºè®°å½•" class="headerlink" title="ç”¨æŒ‡å®šçš„å­—æ®µåˆ›å»ºè®°å½•"></a>ç”¨æŒ‡å®šçš„å­—æ®µåˆ›å»ºè®°å½•</h3><pre><code class="go">db.Select(&quot;Name&quot;, &quot;Age&quot;, &quot;CreatedAt&quot;).Create(&amp;user)//åˆ›å»ºæŒ‡å®šå­—æ®µçš„è®°å½•// INSERT INTO `users` (`name`,`age`,`created_at`) VALUES (&quot;j&quot;, 18, &quot;2020-07-04 11:05:21.775&quot;)db.Omit(&quot;Name&quot;, &quot;Age&quot;, &quot;CreatedAt&quot;).Create(&amp;user)//åˆ›å»ºå¿½ç•¥æŒ‡å®šå­—æ®µçš„è®°å½•// INSERT INTO `users` (`birthday`,`updated_at`) VALUES (&quot;2020-01-01 00:00:00.000&quot;, &quot;2020-07-04 11:05:21.775&quot;)</code></pre><h3 id="æ‰¹é‡æ·»åŠ "><a href="#æ‰¹é‡æ·»åŠ " class="headerlink" title="æ‰¹é‡æ·»åŠ "></a>æ‰¹é‡æ·»åŠ </h3><p>åŸç†:å°†åˆ‡ç‰‡ä¼ ç»™ Create æ–¹æ³•<br>æ³¨æ„ï¼šä½¿ç”¨ CreateBatchSize é€‰é¡¹åˆå§‹åŒ– GORM æ—¶ï¼Œæ‰€æœ‰çš„åˆ›å»º&amp; å…³è” INSERT éƒ½å°†éµå¾ªè¯¥é€‰é¡¹</p><blockquote><p>æ¯”å¦‚ gorm.Config ä¸­ CreateBatchSize è®¾ç½®ä¸º 1000ï¼Œåˆ™ä¹‹åæ‰€æœ‰æ•°æ®æ’å…¥éƒ½è¦éµå¾ªè¿™ä¸ªå€¼<br><code>users = [5000]User&#123;&#123;Name: "jinzhu", Pets: []Pet&#123;pet1, pet2, pet3&#125;&#125;...&#125;</code><br>åˆ™ users éœ€è¦æ‰¹é‡æ’å…¥ 5 æ¬¡,pets éœ€è¦æ‰¹é‡æ’å…¥ 15 æ¬¡</p></blockquote><pre><code class="go">var users = []User&#123;&#123;Name: "j1"&#125;, &#123;Name: "j2"&#125;, &#123;Name: "j3"&#125;&#125;db.Create(&amp;users)for _, user := range users &#123;  user.ID // 1,2,3&#125;</code></pre><h3 id="åˆ›å»ºé’©å­"><a href="#åˆ›å»ºé’©å­" class="headerlink" title="åˆ›å»ºé’©å­"></a>åˆ›å»ºé’©å­</h3><p>æ”¯æŒçš„é’©å­å‡½æ•°ï¼šBeforeSave, BeforeCreate, AfterSave, AfterCreate<br>è·³è¿‡é’©å­å‡½æ•°ï¼š<code>DB.Session(&amp;gorm.Session&#123;SkipHooks: true&#125;).Create(&amp;user)</code></p><h4 id="æ ¹æ®-Map-åˆ›å»º"><a href="#æ ¹æ®-Map-åˆ›å»º" class="headerlink" title="æ ¹æ® Map åˆ›å»º"></a>æ ¹æ® Map åˆ›å»º</h4><ul><li>æ ¹æ®<code>map[string]interface&#123;&#125;</code>åˆ›å»º</li></ul><pre><code class="go">db.Model(&amp;User&#123;&#125;).Create(map[string]interface&#123;&#125;&#123;  &quot;Name&quot;: &quot;jinzhu&quot;, &quot;Age&quot;: 18,&#125;)</code></pre><ul><li>æ ¹æ®<code>[]map[string]interface&#123;&#125;&#123;&#125;</code>åˆ›å»º</li></ul><pre><code class="go">db.Model(&amp;User&#123;&#125;).Create([]map[string]interface&#123;&#125;&#123;  &#123;&quot;Name&quot;: &quot;jinzhu_1&quot;, &quot;Age&quot;: 18&#125;,  &#123;&quot;Name&quot;: &quot;jinzhu_2&quot;, &quot;Age&quot;: 20&#125;,&#125;)</code></pre><h3 id="ä½¿ç”¨-SQL-è¡¨è¾¾å¼ã€Context-Valuer-åˆ›å»ºè®°å½•"><a href="#ä½¿ç”¨-SQL-è¡¨è¾¾å¼ã€Context-Valuer-åˆ›å»ºè®°å½•" class="headerlink" title="ä½¿ç”¨ SQL è¡¨è¾¾å¼ã€Context Valuer åˆ›å»ºè®°å½•"></a>ä½¿ç”¨ SQL è¡¨è¾¾å¼ã€Context Valuer åˆ›å»ºè®°å½•</h3><p>æš‚æ—¶å¿½ç•¥</p><h2 id="æŸ¥è¯¢"><a href="#æŸ¥è¯¢" class="headerlink" title="æŸ¥è¯¢"></a>æŸ¥è¯¢</h2><h3 id="è·å–å•æ¡è®°å½•ï¼š"><a href="#è·å–å•æ¡è®°å½•ï¼š" class="headerlink" title="è·å–å•æ¡è®°å½•ï¼š"></a>è·å–å•æ¡è®°å½•ï¼š</h3><ul><li>First() è·å–ç¬¬ä¸€æ¡è®°å½•[ä¸»é”®å‡åº]</li><li>Take() è·å–ä¸€æ¡è®°å½•</li><li>Lastï¼ˆï¼‰è·å–æœ€åä¸€æ¡è®°å½•[ä¸»é”®é™åº]</li><li>æ£€æŸ¥ ErrRecordNotFound é”™è¯¯<br><code>errors.Is(result.Error, gorm.ErrRecordNotFound)</code></li><li>é¿å¼€ ErrRecordNotFound é”™è¯¯<br><code>db.Limit(1).Find(&amp;user)</code></li><li>Fist å’Œ Last æ–¹æ³•ç”Ÿæ•ˆæ¡ä»¶<ol><li>æŒ‡å‘ç›®æ ‡ struct çš„æŒ‡é’ˆä½œä¸ºå‚æ•°ä¼ å…¥æ–¹æ³•</li><li>ä½¿ç”¨<code>db.Model()</code>æŒ‡å®š model</li></ol></li><li>å¦‚æœæ²¡æœ‰å®šä¹‰ä¸»é”®,åˆ™æŒ‰ç…§ç¬¬ä¸€ä¸ªå­—æ®µæ’åº</li></ul><pre><code class="go">var user  Uservar users []User// ç”Ÿæ•ˆï¼Œæ»¡è¶³æ¡ä»¶1// æŸ¥è¯¢usersè¡¨ä¸­æŒ‰user struct ä¸»é”®idæ’åˆ—çš„ç¬¬ä¸€æ¡è®°å½•db.First(&amp;user)// ç”Ÿæ•ˆï¼Œæ»¡è¶³æ¡ä»¶2result := map[string]interface&#123;&#125;&#123;&#125;db.Model(&amp;User&#123;&#125;).First(&amp;result)// ä¸ç”Ÿæ•ˆresult := map[string]interface&#123;&#125;&#123;&#125;db.Table(&quot;users&quot;).First(&amp;result)// ä½¿ç”¨Takeç”Ÿæ•ˆresult := map[string]interface&#123;&#125;&#123;&#125;db.Table(&quot;users&quot;).Take(&amp;result)</code></pre><h3 id="æŒ‰ç…§ä¸»é”®è·å–"><a href="#æŒ‰ç…§ä¸»é”®è·å–" class="headerlink" title="æŒ‰ç…§ä¸»é”®è·å–"></a>æŒ‰ç…§ä¸»é”®è·å–</h3><ol><li>ä¸»é”®æ˜¯æ•°å€¼:ä½¿ç”¨å†…è”æ¡ä»¶</li></ol><pre><code class="go">db.First(&amp;user, 10)db.First(&amp;user, &quot;10&quot;)//æŸ¥è¯¢idä¸º10çš„ç¬¬ä¸€æ¡è®°å½•db.Find(&amp;users, []int&#123;1,2,3&#125;) //æŸ¥è¯¢idåœ¨1,2,3ä¸­çš„è®°å½•</code></pre><ol start="2"><li>ä¸»é”®æ˜¯å­—ç¬¦ä¸²:æœ‰ sql æ³¨å…¥é£é™©</li></ol><pre><code class="go">// æœç´¢idä¸º1bxx-xx-xxçš„ç”¨æˆ·è®°å½•db.First(&amp;user, &quot;id = ?&quot;, &quot;1b74413f-f3b8-409f-ac47-e8c062e3472a&quot;)</code></pre><h3 id="æ£€ç´¢å…¨éƒ¨å¯¹è±¡"><a href="#æ£€ç´¢å…¨éƒ¨å¯¹è±¡" class="headerlink" title="æ£€ç´¢å…¨éƒ¨å¯¹è±¡"></a>æ£€ç´¢å…¨éƒ¨å¯¹è±¡</h3><pre><code class="go">// result.RowsAffected :è¿”å›æ‰¾åˆ°çš„è®°å½•æ¡æ•°// result.Error: è¿”å›é”™è¯¯result := db.Find(&amp;users)</code></pre><h3 id="æ¡ä»¶"><a href="#æ¡ä»¶" class="headerlink" title="æ¡ä»¶"></a>æ¡ä»¶</h3><h4 id="string-æ¡ä»¶"><a href="#string-æ¡ä»¶" class="headerlink" title="string æ¡ä»¶"></a>string æ¡ä»¶</h4><pre><code class="go">//æŸ¥è¯¢nameç­‰äºjinzhuçš„ç¬¬ä¸€æ¡è®°å½•db.Where(&quot;name = ?&quot;, &quot;jinzhu&quot;).First(&amp;user)// æŸ¥è¯¢nameä¸ç­‰äºjinzhuçš„æ‰€æœ‰è®°å½•db.Where(&quot;name &lt;&gt; ?&quot;, &quot;jinzhu&quot;).Find(&amp;users)// æŸ¥è¯¢nameä¸ºjinzhuæˆ–è€… jinzhu 2çš„æ‰€æœ‰è®°å½•db.Where(&quot;name IN ?&quot;, []string&#123;&quot;jinzhu&quot;, &quot;jinzhu 2&quot;&#125;).Find(&amp;users)// æ¨¡ç³ŠåŒ¹é…,æŸ¥è¯¢nameåŒ…å«jinçš„æ‰€æœ‰è®°å½•db.Where(&quot;name LIKE ?&quot;, &quot;%jin%&quot;).Find(&amp;users)// æŸ¥è¯¢nameä¸ºjinzhuå¹¶ä¸”age&gt;=22çš„æ‰€æœ‰è®°å½•db.Where(&quot;name = ? AND age &gt;= ?&quot;, &quot;jinzhu&quot;, &quot;22&quot;).Find(&amp;users)// æŸ¥è¯¢æ›´æ–°æ—¶é—´å¤§äºä¸Šå‘¨çš„æ‰€æœ‰è®°å½•db.Where(&quot;updated_at &gt; ?&quot;, week(now())-1).Find(&amp;users)// æŸ¥è¯¢ä¸Šå‘¨å’Œä»Šå¤©ä¹‹é—´åˆ›å»ºçš„æ‰€æœ‰è®°å½•db.Where(&quot;created_at BETWEEN ? AND ?&quot;, lastWeek, today).Find(&amp;users)</code></pre><p>å¦‚æœè®¾ç½®äº†å¯¹è±¡çš„ä¸»é”®,åˆ™ä¸æŸ¥è¯¢æ¡ä»¶æ„æˆ AND å…³ç³»</p><h4 id="struct-amp-Map-æ¡ä»¶"><a href="#struct-amp-Map-æ¡ä»¶" class="headerlink" title="struct&amp;Map æ¡ä»¶"></a>struct&amp;Map æ¡ä»¶</h4><pre><code class="go">// struct:æŸ¥è¯¢Nameä¸ºjinzhu,å¹´é¾„ä¸º20çš„æŒ‰ä¸»é”®idå‡åºçš„ç¬¬ä¸€æ¡è®°å½•db.Where(&amp;User&#123;Name: &quot;jinzhu&quot;, Age: 20&#125;).First(&amp;user)// Mapï¼šæŸ¥è¯¢nameä¸ºjinzhu,å¹´é¾„ä¸º20çš„æ‰€æœ‰è®°å½•db.Where(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;jinzhu&quot;, &quot;age&quot;: 20&#125;).Find(&amp;users)// æŸ¥è¯¢idä¸º20/21/22çš„æ‰€æœ‰è®°å½•db.Where([]int64&#123;20, 21, 22&#125;).Find(&amp;users)// ä¸æ”¯æŒé›¶å€¼,æŸ¥è¯¢nameä¸ºjinzhuçš„æ‰€æœ‰è®°å½•db.Where(&amp;User&#123;Name: &quot;jinzhu&quot;, Age: 0&#125;).Find(&amp;users)// æ”¯æŒé›¶å€¼db.Where(map[string]interface&#123;&#125;&#123;&quot;Name&quot;: &quot;jinzhu&quot;, &quot;Age&quot;: 0&#125;).Find(&amp;users)</code></pre><h4 id="æŒ‡å®šç»“æ„ä½“æŸ¥è¯¢å­—æ®µ"><a href="#æŒ‡å®šç»“æ„ä½“æŸ¥è¯¢å­—æ®µ" class="headerlink" title="æŒ‡å®šç»“æ„ä½“æŸ¥è¯¢å­—æ®µ"></a>æŒ‡å®šç»“æ„ä½“æŸ¥è¯¢å­—æ®µ</h4><pre><code class="go">// æŸ¥è¯¢åç§°ä¸ºjinzhu,Ageä¸º0çš„ç”¨æˆ·db.Where(&amp;User&#123;Name: &quot;jinzhu&quot;&#125;, &quot;name&quot;, &quot;Age&quot;).Find(&amp;users)// æŸ¥è¯¢å¹´é¾„ä¸º0çš„æ‰€æœ‰è®°å½•db.Where(&amp;User&#123;Name: &quot;jinzhu&quot;&#125;, &quot;Age&quot;).Find(&amp;users)// SELECT * FROM users WHERE age = 0;</code></pre><h4 id="å†…è”æ¡ä»¶"><a href="#å†…è”æ¡ä»¶" class="headerlink" title="å†…è”æ¡ä»¶"></a>å†…è”æ¡ä»¶</h4><p>å†…è”æŒ‡çš„æ˜¯å°†æŸ¥è¯¢æ¡ä»¶åµŒå…¥åˆ° First ç­‰æ–¹æ³•ä¸­,è¾¾åˆ°ä¸ where ç›¸ä¼¼çš„æ•ˆæœ</p><pre><code class="go">db.First(&amp;user, &quot;id = ?&quot;, &quot;string_primary_key&quot;)db.Find(&amp;user, &quot;name = ?&quot;, &quot;jinzhu&quot;)db.Find(&amp;users, &quot;name &lt;&gt; ? AND age &gt; ?&quot;, &quot;jinzhu&quot;, 20)// structdb.Find(&amp;users, User&#123;Age: 20&#125;)// mapdb.Find(&amp;users, map[string]interface&#123;&#125;&#123;&quot;age&quot;: 20&#125;)</code></pre><h4 id="Not-æ¡ä»¶-å’Œ-Or-æ¡ä»¶"><a href="#Not-æ¡ä»¶-å’Œ-Or-æ¡ä»¶" class="headerlink" title="Not æ¡ä»¶ å’Œ Or æ¡ä»¶"></a>Not æ¡ä»¶ å’Œ Or æ¡ä»¶</h4><pre><code class="go">// Not// æŸ¥è¯¢nameä¸ä¸ºjinzhuçš„ç¬¬ä¸€æ¡è®°å½•db.Not(&quot;name = ?&quot;, &quot;jinzhu&quot;).First(&amp;user)// æŸ¥è¯¢nameä¸ä¸ºjinzhuæˆ–è€…jinzhu 2çš„æ‰€æœ‰è®°å½•db.Not(map[string]interface&#123;&#125;&#123;&quot;name&quot;: []string&#123;&quot;jinzhu&quot;, &quot;jinzhu 2&quot;&#125;&#125;).Find(&amp;users)// æŸ¥è¯¢nameä¸ä¸ºjinzhuå¹¶ä¸”Ageä¸ä¸º18çš„ç¬¬ä¸€æ¡è®°å½•db.Not(User&#123;Name: &quot;jinzhu&quot;, Age: 18&#125;).First(&amp;user)// æŸ¥è¯¢ä¸»é”®idä¸åœ¨1,2,3çš„ç¬¬ä¸€æ¡è®°å½•db.Not([]int64&#123;1,2,3&#125;).First(&amp;user)// Or// æŸ¥è¯¢roleæ˜¯adminæˆ–è€…roleæ˜¯super_adminçš„ç¬¬ä¸€æ¡è®°å½•db.Where(&quot;role = ?&quot;, &quot;admin&quot;).Or(&quot;role = ?&quot;, &quot;super_admin&quot;).Find(&amp;users)// æŸ¥è¯¢nameä¸ºjinzhu,æˆ–è€…nameä¸ºjinzhu2å¹¶ä¸”Ageä¸º18çš„æ‰€æœ‰è®°å½•// struct:db.Where(&quot;name = &#39;jinzhu&#39;&quot;).Or(User&#123;Name: &quot;jinzhu 2&quot;, Age: 18&#125;).Find(&amp;users)// map:db.Where(&quot;name = &#39;jinzhu&#39;&quot;).Or(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;jinzhu 2&quot;, &quot;age&quot;: 18&#125;).Find(&amp;users)</code></pre><h4 id="é€‰æ‹©ç‰¹å®šå­—æ®µ-Select-æ–¹æ³•"><a href="#é€‰æ‹©ç‰¹å®šå­—æ®µ-Select-æ–¹æ³•" class="headerlink" title="é€‰æ‹©ç‰¹å®šå­—æ®µ Select æ–¹æ³•"></a>é€‰æ‹©ç‰¹å®šå­—æ®µ Select æ–¹æ³•</h4><pre><code class="go">// ä»usersè¡¨ä¸­æŸ¥è¯¢name,ageå­—æ®µdb.Select(&quot;name&quot;, &quot;age&quot;).Find(&amp;users)db.Select([]string&#123;&quot;name&quot;, &quot;age&quot;&#125;).Find(&amp;users)db.Table(&quot;users&quot;).Select(&quot;COALESCE(age,?)&quot;, 42).Rows()</code></pre><h3 id="æ’åº"><a href="#æ’åº" class="headerlink" title="æ’åº"></a>æ’åº</h3><p>é»˜è®¤å‡åº</p><pre><code class="go">// ageé™åº,nameå‡åºè¿”å›æ‰€æœ‰è®°å½•db.Order(&quot;age desc, name&quot;).Find(&amp;users)db.Order(&quot;age desc&quot;).Order(&quot;name&quot;).Find(&amp;users)// SQLè¯­å¥ï¼šä¸å¸¸ç”¨~SELECT * FROM users ORDER BY FIELD(id,1,2,3)db.Clauses(clause.OrderBy&#123;  Expression: clause.Expr&#123;SQL: &quot;FIELD(id,?)&quot;, Vars: []interface&#123;&#125;&#123;[]int&#123;1, 2, 3&#125;&#125;, WithoutParentheses: true&#125;,&#125;).Find(&amp;User&#123;&#125;)</code></pre><h3 id="Limit-amp-Offset"><a href="#Limit-amp-Offset" class="headerlink" title="Limit&amp;Offset"></a>Limit&amp;Offset</h3><h4 id="Limit"><a href="#Limit" class="headerlink" title="Limit"></a>Limit</h4><p>ä½œç”¨:æŒ‡å®šè¿”å›è®°å½•çš„æœ€å¤§å€¼<br>Limit(-1):å–æ¶ˆ limit é™åˆ¶</p><pre><code class="go">// ä»usersè¡¨æŸ¥è¯¢3æ¡è®°å½•db.Limit(3).Find(&amp;users)// ä»users1è¡¨æŸ¥è¯¢10æ¡è®°å½•ï¼Œä»users2è¡¨ä¸­æŸ¥è¯¢æ‰€æœ‰è®°å½•db.Limit(10).Find(&amp;users1).Limit(-1).Find(&amp;users2)</code></pre><h4 id="Offset"><a href="#Offset" class="headerlink" title="Offset"></a>Offset</h4><p>ä½œç”¨:æŒ‡å®šåœ¨å¼€å§‹è¿”å›è®°å½•ä¹‹å‰è¦è·³è¿‡çš„è®°å½•æ•°é‡<br>Offset(-1)ï¼šå–æ¶ˆ Offset é™åˆ¶</p><pre><code class="go">// ä»ç¬¬å››æ¡å¼€å§‹è¿”å›è®°å½•db.Offset(3).Find(&amp;users)db.Limit(10).Offset(5).Find(&amp;users)db.Offset(10).Find(&amp;users1).Offset(-1).Find(&amp;users2)</code></pre><p>offset å…·ä½“æ•ˆæœï¼š</p><img src="/2023/03/21/gorm-xue-xi-bi-ji/no_offset.jpg" class=""><img src="/2023/03/21/gorm-xue-xi-bi-ji/offset.jpg" class=""><h3 id="Group-By-amp-Having"><a href="#Group-By-amp-Having" class="headerlink" title="Group By &amp;Having"></a>Group By &amp;Having</h3><h4 id="Group-Byï¼šGroup"><a href="#Group-Byï¼šGroup" class="headerlink" title="Group Byï¼šGroup()"></a>Group Byï¼šGroup()</h4><p>ä½œç”¨ï¼šå°†å…·æœ‰ç›¸åŒå€¼çš„è¡Œåˆ†ç»„åˆ°æ±‡æ€»è¡Œä¸­ï¼Œä¾‹å¦‚â€œæŸ¥æ‰¾æ¯ä¸ªå›½å®¶çš„å®¢æˆ·æ•°â€ã€‚</p><pre><code class="go">type result struct &#123;  Date  time.Time  Total int&#125;// SELECT name, sum(age) as total FROM `users` WHERE name LIKE &quot;group%&quot; GROUP BY `name` LIMIT 1// aså…³é”®å­—ç”¨äºé‡å‘½ååˆ—æˆ–è¡¨db.Model(&amp;User&#123;&#125;).Select(&quot;name, sum(age) as total&quot;).Where(&quot;name LIKE ?&quot;, &quot;group%&quot;).Group(&quot;name&quot;).First(&amp;result)rows, err := db.Table(&quot;orders&quot;).Select(&quot;date(created_at) as date, sum(amount) as total&quot;).Group(&quot;date(created_at)&quot;).Rows()</code></pre><h4 id="Having"><a href="#Having" class="headerlink" title="Having"></a>Having</h4><p>ä½œç”¨ï¼šwhere çš„æ›¿ä»£å“ï¼Œå› ä¸º where ä¸èƒ½å’Œèšåˆå‡½æ•°ä¸€èµ·ä½¿ç”¨,æ‰€ä»¥ä½¿ç”¨ having å­å¥æ¥è®¾ç½®æ¡ä»¶<br>èšåˆå‡½æ•°ï¼š</p><ul><li>AVG - è®¡ç®—ä¸€ç»„å€¼æˆ–è¡¨è¾¾å¼çš„å¹³å‡å€¼ã€‚</li><li>COUNT - è®¡ç®—è¡¨ä¸­çš„è¡Œæ•°ã€‚</li><li>INSTR - è¿”å›å­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡å‡ºç°çš„å­å­—ç¬¦ä¸²çš„ä½ç½®ã€‚</li><li>SUM - è®¡ç®—ä¸€ç»„å€¼æˆ–è¡¨è¾¾å¼çš„æ€»å’Œã€‚</li><li>MIN - åœ¨ä¸€ç»„å€¼ä¸­æ‰¾åˆ°æœ€å°å€¼</li><li>MAX - åœ¨ä¸€ç»„å€¼ä¸­æ‰¾åˆ°æœ€å¤§å€¼</li></ul><pre><code class="go">db.Model(&amp;User&#123;&#125;).Select(&quot;name, sum(age) as total&quot;).Group(&quot;name&quot;).Having(&quot;name = ?&quot;, &quot;group&quot;).Find(&amp;result)db.Table(&quot;orders&quot;).Select(&quot;date(created_at) as date, sum(amount) as total&quot;).Group(&quot;date(created_at)&quot;).Having(&quot;sum(amount) &gt; ?&quot;, 100).Scan(&amp;results)rows, err := db.Table(&quot;orders&quot;).Select(&quot;date(created_at) as date, sum(amount) as total&quot;).Group(&quot;date(created_at)&quot;).Having(&quot;sum(amount) &gt; ?&quot;, 100).Rows()</code></pre><h3 id="Distinct"><a href="#Distinct" class="headerlink" title="Distinct"></a>Distinct</h3><p>ä½œç”¨ï¼šæŸ¥è¯¢å»é‡,åªä¿ç•™ä¸€ä¸ª<br>åªæ ¹æ®æŸ¥è¯¢å­—æ®µå»é‡:</p><img src="/2023/03/21/gorm-xue-xi-bi-ji/distinct1.jpg" class=""><img src="/2023/03/21/gorm-xue-xi-bi-ji/distinct2.jpg" class=""><img src="/2023/03/21/gorm-xue-xi-bi-ji/distinct3.jpg" class=""><img src="/2023/03/21/gorm-xue-xi-bi-ji/distinct4.jpg" class=""><pre><code class="go">db.Distinct(&quot;name&quot;, &quot;age&quot;).Order(&quot;name, age desc&quot;).Find(&amp;results)</code></pre><h3 id="Join"><a href="#Join" class="headerlink" title="Join"></a>Join</h3><p>å¤–é”®åˆ—ï¼šæ•°æ®åº“ä¸­çš„å…¬å…±åˆ—<br>ä½œç”¨ï¼šæŒ‡å®š joins æ¡ä»¶ï¼ŒåŸºäºè¡¨ä¹‹é—´çš„å…¬å…±åˆ—çš„å€¼åœ¨ä¸€ä¸ªï¼ˆè‡ªè¿æ¥ï¼‰æˆ–æ›´å¤šè¡¨ä¹‹é—´é“¾æ¥æ•°æ®<br>å­˜åœ¨è¡¨ï¼št1,t2</p><ul><li>cross join ç¬›å¡å°”ç§¯ â€”â€” ç»“æœé›†åŒ…æ‹¬ t1 è¡¨ä¸­è¡Œå’Œ t2 è¡¨ä¸­è¡Œçš„ç»„åˆ-&gt;<code>SELECT t1.id, t2.id FROM t1 CROSS JOIN t2; </code></li><li>inner join â€”â€” å¿…é¡»æœ‰ä¸€ä¸ªè¿æ¥å­—æ®µæ¡ä»¶,ç»“æœé›†åŒ…æ‹¬æ»¡è¶³è¯¥æ¡ä»¶çš„ t1 å’Œ t2 è¡Œçš„ç»„åˆ-&gt; <code>SELECT t1.id, t2.id FROM t1 INNER JOIN t2 ON t1.pattern = t2.pattern; </code></li><li>left join â€”â€” å¿…é¡»æœ‰ä¸€ä¸ªæ¡ä»¶,ç»“æœé›†åŒ…å«å·¦è¡¨ t1 çš„æ‰€æœ‰æ•°æ®å’Œæ»¡è¶³æ¡ä»¶çš„ t2 çš„è¡Œçš„ç»„åˆ <code>SELECT t1.id, t2.id FROM t1 LEFT JOIN t2 ON t1.pattern = t2.pattern;</code>,æ­¤å¤„æ¯” inner join å¤šä¸€ä¸ª 1,null</li><li>right join â€”â€” åŒ left join ç›¸åï¼Œç»“æœé›†åŒ…å«å³è¡¨ t2 çš„æ‰€æœ‰æ•°æ®</li></ul><pre><code class="go">type result struct &#123;  Name  string  Email string&#125;db.Model(&amp;User&#123;&#125;).Select(&quot;users.name, emails.email&quot;).Joins(&quot;left join emails on emails.user_id = users.id&quot;).Scan(&amp;result&#123;&#125;) //usersè¡¨ï¼Œå·¦è¿æ¥rows, err := db.Table(&quot;users&quot;).Select(&quot;users.name, emails.email&quot;).Joins(&quot;left join emails on emails.user_id = users.id&quot;).Rows()//usersè¡¨ï¼Œå³è¿æ¥db.Table(&quot;users&quot;).Select(&quot;users.name, emails.email&quot;).Joins(&quot;left join emails on emails.user_id = users.id&quot;).Scan(&amp;results)// å¸¦å‚æ•°çš„å¤šé‡joindb.Joins(&quot;JOIN emails ON emails.user_id = users.id AND emails.email = ?&quot;, &quot;jinzhu@example.org&quot;).Joins(&quot;JOIN credit_cards ON credit_cards.user_id = users.id&quot;).Where(&quot;credit_cards.number = ?&quot;, &quot;411111111111&quot;).Find(&amp;user)</code></pre><h4 id="Join-é¢„åŠ è½½"><a href="#Join-é¢„åŠ è½½" class="headerlink" title="Join é¢„åŠ è½½"></a>Join é¢„åŠ è½½</h4><pre><code class="go">// SELECT users.id,users.name,users.age,Company.id AS Company__id,Company.name AS Company__name FROM users LEFT JOIN companies AS Company ON users.company_id = Company.id;db.Joins(&quot;Company&quot;).Find(&amp;users)// SELECT users.id,users.name,users.age,Company.id AS Company__id,Company.name AS Company__name FROM users INNER JOIN  companies AS Company  ON users.company_id = Company.id;db.InnerJoins(&quot;Company&quot;).Find(&amp;users)// æ¡ä»¶è¿æ¥// SELECT users.id,users.name,users.age,Company.id AS Company__id,Company.name AS Company__name FROM users LEFT JOIN companies AS Company  ON users.company_id = Company.id AND Company.alive = true;db.Joins(&quot;Company&quot;, db.Where(&amp;Company&#123;Alive: true&#125;)).Find(&amp;users)</code></pre><h4 id="Scan"><a href="#Scan" class="headerlink" title="Scan()"></a>Scan()</h4><p>æŠŠç»“æœæ‰«æåˆ°ä¸€ä¸ª struct,å’Œ Find()æ–¹æ³•ç±»ä¼¼</p><pre><code class="go">type Result struct &#123;  Name string  Age  int&#125;var result Resultdb.Table(&quot;users&quot;).Select(&quot;name&quot;, &quot;age&quot;).Where(&quot;name = ?&quot;, &quot;Antonio&quot;).Scan(&amp;result)// Raw SQLdb.Raw(&quot;SELECT name, age FROM users WHERE name = ?&quot;, &quot;Antonio&quot;).Scan(&amp;result)</code></pre><h2 id="é«˜çº§æŸ¥è¯¢"><a href="#é«˜çº§æŸ¥è¯¢" class="headerlink" title="é«˜çº§æŸ¥è¯¢"></a>é«˜çº§æŸ¥è¯¢</h2><h3 id="è‡ªåŠ¨é€‰æ‹©å­—æ®µ"><a href="#è‡ªåŠ¨é€‰æ‹©å­—æ®µ" class="headerlink" title="è‡ªåŠ¨é€‰æ‹©å­—æ®µ"></a>è‡ªåŠ¨é€‰æ‹©å­—æ®µ</h3><p>æ‰‹åŠ¨ï¼šä½¿ç”¨ Select()æ–¹æ³•é€‰æ‹©ç‰¹å®šå­—æ®µ<br>è‡ªåŠ¨ï¼šå°†éœ€è¦é€‰æ‹©çš„å­—æ®µæ”¾åœ¨ä¸€ä¸ª struct ä¸­</p><pre><code class="go">type User struct &#123;  ID     uint  Name   string  Age    int  Gender string  // å‡è®¾åé¢è¿˜æœ‰å‡ ç™¾ä¸ªå­—æ®µ...&#125;type APIUser struct &#123;  ID   uint  Name string&#125;// æŸ¥è¯¢æ—¶ä¼šè‡ªåŠ¨é€‰æ‹© `id`, `name` å­—æ®µdb.Model(&amp;User&#123;&#125;).Limit(10).Find(&amp;APIUser&#123;&#125;)// SELECT id, name FROM users LIMIT 10</code></pre><h3 id="Locking"><a href="#Locking" class="headerlink" title="Locking"></a>Locking</h3><p>Gorm æ”¯æŒå¤šç§ç±»å‹çš„é”<br>é”ï¼šå’Œè¡¨å…³è”çš„æ ‡å¿—ï¼Œ</p><ul><li>é’ˆå¯¹ä¼šè¯</li><li>é˜²æ­¢å…¶ä»–ä¼šè¯åœ¨ç‰¹å®šæ—¶é—´æ®µå†…è®¿é—®åŒä¸€ä¸ªè¡¨ã€‚</li><li>å®¢æˆ·ç«¯ä¼šè¯åªèƒ½ä¸ºè‡ªå·±è·å–æˆ–é‡Šæ”¾è¡¨é”ã€‚å®ƒæ— æ³•è·å–æˆ–é‡Šæ”¾å…¶ä»–ä¼šè¯çš„è¡¨é”</li></ul><h4 id="è¯»é”-å…±äº«é”-è¡¨é”"><a href="#è¯»é”-å…±äº«é”-è¡¨é”" class="headerlink" title="è¯»é”-å…±äº«é” (è¡¨é”)"></a>è¯»é”-å…±äº«é” (è¡¨é”)</h4><p>è¯­æ³•ï¼š</p><ul><li>æ˜¾å¼ä¸Šé”ï¼š<code>LOCK TABLES table_name READ</code></li><li>éšå¼ä¸Šé”ï¼š<code>select </code></li><li>è§£é”ï¼š<code>UNLOCK TABLES; </code></li></ul><p>çº¦æŸï¼š</p><ol><li>å½“åœ¨ A ä¼šè¯ä¸­è®¾ç½®äº† READ é”ï¼Œåˆ™ A ä¼šè¯ä¸­æ’å…¥æ•°æ®ä¼šæŠ¥é”™</li><li>å½“åœ¨ A ä¼šè¯ä¸­è®¾ç½®äº† READ é”ï¼Œä¼šè¯ B ä¾ç„¶å¯ä»¥ä»è¡¨ä¸­è¯»å–æ•°æ®</li><li>å½“åœ¨ A ä¼šè¯ä¸­è®¾ç½®äº† READ é”ï¼Œä¼šè¯ B å¦‚æœè¦æ’å…¥æ•°æ®ï¼Œä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´è‡³ A ä¼šè¯ä¸­çš„é”è¢«é‡Šæ”¾</li><li>å¦‚æœä¼šè¯ç»ˆæ­¢ï¼Œåˆ™éšå¼é‡Šæ”¾æ‰€æœ‰é”</li></ol><h4 id="å†™é”-æ’ä»–é”-è¡¨é”"><a href="#å†™é”-æ’ä»–é”-è¡¨é”" class="headerlink" title="å†™é”-æ’ä»–é” (è¡¨é”)"></a>å†™é”-æ’ä»–é” (è¡¨é”)</h4><p>è¯­æ³•ï¼š</p><ul><li><p>æ˜¾å¼ä¸Šé”ï¼š<code>LOCK TABLE table_name WRITE;</code></p></li><li><p>éšå¼ä¸Šé”ï¼š<code>insertã€updateã€delete</code><br>ç§ç±»ï¼š</p></li><li><p>çº¦æŸï¼š</p></li></ul><ol><li>å½“åœ¨ A ä¼šè¯ä¸­è®¾ç½®äº† WRITE é”,A ä¼šè¯ä»å¯ä»¥æ£€ç´¢æˆ–è€…æ’å…¥æ•°æ®</li><li>å½“åœ¨ A ä¼šè¯ä¸­è®¾ç½®äº† WRITE é”,ä¼šè¯ B çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´è‡³è§£é”</li></ol><h4 id="è¡Œé”"><a href="#è¡Œé”" class="headerlink" title="è¡Œé”"></a>è¡Œé”</h4><p>æ˜¾å¼ä¸Šé”ï¼š</p><ul><li><code>select * from tableName lock in share mode;</code>&#x2F;&#x2F;è¯»é”&#x2F;å…±äº«é” 5.7</li><li>&#96;&#96;select * from tableName lock for share;&#96;&#x2F;&#x2F;è¯»é” 8.0</li><li><code>select * from tableName for update;</code>&#x2F;&#x2F;å†™é”&#x2F;æ’ä»–é”</li></ul><p>è§£é”ï¼š</p><ul><li>æäº¤äº‹åŠ¡ï¼ˆcommitï¼‰</li><li>å›æ»šäº‹åŠ¡ï¼ˆrollbackï¼‰</li><li>kill é˜»å¡è¿›ç¨‹</li></ul><hr><pre><code class="go">// SELECT * FROM users FOR UPDATEdb.Clauses(clause.Locking&#123;Strength: &quot;UPDATE&quot;&#125;).Find(&amp;users)// SELECT * FROM users FOR SHARE OF usersdb.Clauses(clause.Locking&#123;  Strength: &quot;SHARE&quot;,  Table: clause.Table&#123;Name: clause.CurrentTable&#125;,&#125;).Find(&amp;users)// SELECT * FROM users FOR UPDATE NOWAITdb.Clauses(clause.Locking&#123;  Strength: &quot;UPDATE&quot;,  Options: &quot;NOWAIT&quot;,&#125;).Find(&amp;users)</code></pre><h3 id="å­æŸ¥è¯¢"><a href="#å­æŸ¥è¯¢" class="headerlink" title="å­æŸ¥è¯¢"></a>å­æŸ¥è¯¢</h3><pre><code class="go">// ç›¸å½“äºSELECT * FROM &quot;orders&quot; WHERE amount &gt; (SELECT AVG(amount) FROM &quot;orders&quot;);db.Where(&quot;amount &gt; (?)&quot;, db.Table(&quot;orders&quot;).Select(&quot;AVG(amount)&quot;)).Find(&amp;orders)// ç›¸å½“äºSELECT AVG(age) as avgage FROM `users` GROUP BY `name` HAVING AVG(age) &gt; (SELECT AVG(age) FROM `users` WHERE name LIKE &quot;name%&quot;)subQuery := db.Select(&quot;AVG(age)&quot;).Where(&quot;name LIKE ?&quot;, &quot;name%&quot;).Table(&quot;users&quot;)db.Select(&quot;AVG(age) as avgage&quot;).Group(&quot;name&quot;).Having(&quot;AVG(age) &gt; (?)&quot;, subQuery).Find(&amp;results)// FROMå­æŸ¥è¯¢// ç›¸å½“äºSELECT * FROM (SELECT `name`,`age` FROM `users`) as u WHERE `age` = 18db.Table(&quot;(?) as u&quot;, db.Model(&amp;User&#123;&#125;).Select(&quot;name&quot;, &quot;age&quot;)).Where(&quot;age = ?&quot;, 18).Find(&amp;User&#123;&#125;)</code></pre><h3 id="å¤šä¸ªåˆ—çš„INæŸ¥è¯¢"><a href="#å¤šä¸ªåˆ—çš„INæŸ¥è¯¢" class="headerlink" title="å¤šä¸ªåˆ—çš„INæŸ¥è¯¢"></a>å¤šä¸ªåˆ—çš„INæŸ¥è¯¢</h3><pre><code class="go">// SELECT * FROM users WHERE (name, age, role) IN ((&quot;jinzhu&quot;, 18, &quot;admin&quot;), (&quot;jinzhu 2&quot;, 19, &quot;user&quot;));db.Where(&quot;(name, age, role) IN ?&quot;, [][]interface&#123;&#125;&#123;&#123;"jinzhu", 18, "admin"&#125;, &#123;"jinzhu2", 19, "user"&#125;&#125;).Find(&amp;users)</code></pre><!-- å¾…è¡¥å…… --><h2 id="ä¿®æ”¹æ›´æ–°"><a href="#ä¿®æ”¹æ›´æ–°" class="headerlink" title="ä¿®æ”¹æ›´æ–°"></a>ä¿®æ”¹æ›´æ–°</h2><h3 id="ä¿å­˜æ‰€æœ‰å­—æ®µ"><a href="#ä¿å­˜æ‰€æœ‰å­—æ®µ" class="headerlink" title="ä¿å­˜æ‰€æœ‰å­—æ®µ"></a>ä¿å­˜æ‰€æœ‰å­—æ®µ</h3><pre><code class="go">// UPDATE users SET name=&#39;jinzhu 2&#39;, age=100, birthday=&#39;2016-01-01&#39;, updated_at = &#39;2013-11-17 21:34:10&#39; WHERE id=111;db.First(&amp;user)user.Name = &quot;jinzhu 2&quot;user.Age = 100db.Save(&amp;user)</code></pre><h3 id="ä¿®æ”¹å•ä¸ªåˆ—"><a href="#ä¿®æ”¹å•ä¸ªåˆ—" class="headerlink" title="ä¿®æ”¹å•ä¸ªåˆ—"></a>ä¿®æ”¹å•ä¸ªåˆ—</h3><p>éœ€è¦è®¾ç½®ä¸€äº›æ¡ä»¶é¿å…<code>ErrMissingWhereClause</code>é”™è¯¯<br>ä½¿ç”¨ Model æ–¹æ³•ï¼Œå¹¶ä¸”å€¼ä¸­æœ‰ä¸»é”®å€¼æ—¶ï¼Œä¸»é”®å°†ä¼šè¢«ç”¨äºæ„å»ºæ¡ä»¶</p><pre><code class="go">// æ¡ä»¶æ›´æ–°:UPDATE users SET name=&#39;hello&#39;, updated_at=&#39;2013-11-17 21:34:10&#39; WHERE active=true;db.Model(&amp;User&#123;&#125;).Where(&quot;active = ?&quot;, true).Update(&quot;name&quot;, &quot;hello&quot;)// User çš„ ID æ˜¯ `111`: UPDATE users SET name=&#39;hello&#39;, updated_at=&#39;2013-11-17 21:34:10&#39; WHERE id=111;db.Model(&amp;user).Update(&quot;name&quot;, &quot;hello&quot;)// æ ¹æ®æ¡ä»¶å’Œ model çš„å€¼è¿›è¡Œæ›´æ–°:UPDATE users SET name=&#39;hello&#39;, updated_at=&#39;2013-11-17 21:34:10&#39; WHERE id=111 AND active=true;db.Model(&amp;user).Where(&quot;active = ?&quot;, true).Update(&quot;name&quot;, &quot;hello&quot;)</code></pre><h3 id="ä¿®æ”¹å¤šä¸ªåˆ—"><a href="#ä¿®æ”¹å¤šä¸ªåˆ—" class="headerlink" title="ä¿®æ”¹å¤šä¸ªåˆ—"></a>ä¿®æ”¹å¤šä¸ªåˆ—</h3><p>æ ¹æ® <code>struct</code> æ›´æ–°å±æ€§ï¼Œåªä¼šæ›´æ–°éé›¶å€¼çš„å­—æ®µ</p><pre><code class="go">// æ ¹æ® `struct` æ›´æ–°å±æ€§// UPDATE users SET name=&#39;hello&#39;, age=18, updated_at = &#39;2013-11-17 21:34:10&#39; WHERE id = 111;db.Model(&amp;user).Updates(User&#123;Name: &quot;hello&quot;, Age: 18, Active: false&#125;)// æ ¹æ® `map` æ›´æ–°å±æ€§// UPDATE users SET name=&#39;hello&#39;, age=18, active=false, updated_at=&#39;2013-11-17 21:34:10&#39; WHERE id=111;db.Model(&amp;user).Updates(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;hello&quot;, &quot;age&quot;: 18, &quot;active&quot;: false&#125;)</code></pre><h3 id="ä¿®æ”¹æŒ‡å®šå­—æ®µ"><a href="#ä¿®æ”¹æŒ‡å®šå­—æ®µ" class="headerlink" title="ä¿®æ”¹æŒ‡å®šå­—æ®µ"></a>ä¿®æ”¹æŒ‡å®šå­—æ®µ</h3><p>æ–¹æ³•: Selectã€Omit</p><pre><code class="go">// User&#39;s ID is `111`:// struct:UPDATE users SET name=&#39;hello&#39; WHERE id=111;db.Model(&amp;user).Select(&quot;name&quot;).Updates(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;hello&quot;, &quot;age&quot;: 18, &quot;active&quot;: false&#125;)// å¿½ç•¥æŸä¸ªå­—æ®µ// UPDATE users SET age=18, active=false, updated_at=&#39;2013-11-17 21:34:10&#39; WHERE id=111;db.Model(&amp;user).Omit(&quot;name&quot;).Updates(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;hello&quot;, &quot;age&quot;: 18, &quot;active&quot;: false&#125;)//é€‰æ‹©roleä»¥å¤–çš„æ‰€æœ‰å­—æ®µdb.Model(&amp;user).Select(&quot;*&quot;).Omit(&quot;Role&quot;).Updates(User&#123;Name: &quot;jinzhu&quot;, Role: &quot;admin&quot;, Age: 0&#125;)</code></pre><h3 id="æ›´æ–°hook"><a href="#æ›´æ–°hook" class="headerlink" title="æ›´æ–°hook"></a>æ›´æ–°hook</h3><p>æš‚æ—¶å¿½ç•¥</p><h3 id="æ‰¹é‡æ›´æ–°"><a href="#æ‰¹é‡æ›´æ–°" class="headerlink" title="æ‰¹é‡æ›´æ–°"></a>æ‰¹é‡æ›´æ–°</h3><p>æœªé€šè¿‡ Model æŒ‡å®šè®°å½•çš„ä¸»é”®ï¼Œåˆ™ GORM ä¼šæ‰§è¡Œæ‰¹é‡æ›´æ–°<br>æ›´æ–°å¦‚æœæ²¡æœ‰ä»»ä½•æ¡ä»¶åˆ™ä¼šæŠ¥é”™,å¯ä»¥é€šè¿‡æ·»åŠ æ¡ä»¶æˆ–åŸç”ŸSqlæˆ–è€…å¯ç”¨<code>AllowGlobalUpdate</code>æ¨¡å¼</p><pre><code class="go">// æ ¹æ® struct æ›´æ–°// UPDATE users SET name=&#39;hello&#39;, age=18 WHERE role = &#39;admin&#39;;db.Model(User&#123;&#125;).Where(&quot;role = ?&quot;, &quot;admin&quot;).Updates(User&#123;Name: &quot;hello&quot;, Age: 18&#125;)// æ ¹æ® map æ›´æ–°db.Table(&quot;users&quot;).Where(&quot;id IN ?&quot;, []int&#123;10, 11&#125;).Updates(map[string]interface&#123;&#125;&#123;&quot;name&quot;: &quot;hello&quot;, &quot;age&quot;: 18&#125;)// UPDATE users SET name=&#39;hello&#39;, age=18 WHERE id IN (10, 11);// gorm.ErrMissingWhereClausedb.Model(&amp;User&#123;&#125;).Updates(&quot;name&quot;, &quot;jinzhu&quot;).Error </code></pre><p>é€šè¿‡åŸç”Ÿsql,å¯ç”¨<code>AllowGlobalUpdate</code>æ¨¡å¼è§£å†³gorm.ErrMissingWhereClauseæŠ¥é”™</p><pre><code class="go">db.Exec(&quot;UPDATE users SET name = ?&quot;, &quot;jinzhu&quot;)// UPDATE users SET name = &quot;jinzhu&quot;db.Session(&amp;gorm.Session&#123;AllowGlobalUpdate: true&#125;).Model(&amp;User&#123;&#125;).Update(&quot;name&quot;, &quot;jinzhu&quot;)// UPDATE users SET `name` = &quot;jinzhu&quot;</code></pre><h3 id="è·å–å—æ›´æ–°å½±å“çš„è¡Œæ•°"><a href="#è·å–å—æ›´æ–°å½±å“çš„è¡Œæ•°" class="headerlink" title="è·å–å—æ›´æ–°å½±å“çš„è¡Œæ•°"></a>è·å–å—æ›´æ–°å½±å“çš„è¡Œæ•°</h3><p><code>RowsAffected</code>å±æ€§</p><pre><code class="go">// UPDATE users SET name=&#39;hello&#39;, age=18 WHERE role = &#39;admin&#39;;result := db.Model(User&#123;&#125;).Where(&quot;role = ?&quot;, &quot;admin&quot;).Updates(User&#123;Name: &quot;hello&quot;, Age: 18&#125;)result.RowsAffected // æ›´æ–°çš„è®°å½•æ•°result.Error        // æ›´æ–°çš„é”™è¯¯</code></pre><h3 id="é«˜çº§é€‰é¡¹"><a href="#é«˜çº§é€‰é¡¹" class="headerlink" title="é«˜çº§é€‰é¡¹"></a>é«˜çº§é€‰é¡¹</h3><p>æš‚æ—¶å¿½ç•¥</p><h2 id="åˆ é™¤"><a href="#åˆ é™¤" class="headerlink" title="åˆ é™¤"></a>åˆ é™¤</h2><h3 id="åˆ é™¤å•æ¡è®°å½•"><a href="#åˆ é™¤å•æ¡è®°å½•" class="headerlink" title="åˆ é™¤å•æ¡è®°å½•"></a>åˆ é™¤å•æ¡è®°å½•</h3><p>éœ€è¦æŒ‡å®šä¸»é”®,å¦åˆ™ä¼šè§¦å‘æ‰¹é‡åˆ é™¤</p><pre><code class="go">// Email çš„ ID æ˜¯ `10`// DELETE from emails where id = 10;db.Delete(&amp;email)// å¸¦é¢å¤–æ¡ä»¶çš„åˆ é™¤// DELETE from emails where id = 10 AND name = &quot;jinzhu&quot;db.Where(&quot;name = ?&quot;, &quot;jinzhu&quot;).Delete(&amp;email)</code></pre><h3 id="æ ¹æ®ä¸»é”®åˆ é™¤"><a href="#æ ¹æ®ä¸»é”®åˆ é™¤" class="headerlink" title="æ ¹æ®ä¸»é”®åˆ é™¤"></a>æ ¹æ®ä¸»é”®åˆ é™¤</h3><pre><code class="go">// DELETE FROM users WHERE id = 10;db.Delete(&amp;User&#123;&#125;, 10)db.Delete(&amp;User&#123;&#125;, &quot;10&quot;)// DELETE FROM users WHERE id IN (1,2,3);db.Delete(&amp;users, []int&#123;1,2,3&#125;)</code></pre><h3 id="Delete-hook"><a href="#Delete-hook" class="headerlink" title="Delete hook"></a>Delete hook</h3><p>æš‚æ—¶å¿½ç•¥</p><h3 id="æ‰¹é‡åˆ é™¤"><a href="#æ‰¹é‡åˆ é™¤" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h3><p>å¦‚æœæŒ‡å®šçš„å€¼ä¸åŒ…æ‹¬ä¸»å±æ€§ï¼Œé‚£ä¹ˆ GORM ä¼šæ‰§è¡Œæ‰¹é‡åˆ é™¤ï¼Œå°†åˆ é™¤æ‰€æœ‰åŒ¹é…çš„è®°å½•</p><pre><code class="go">// DELETE from emails where email LIKE &quot;%jinzhu%&quot;;db.Where(&quot;email LIKE ?&quot;, &quot;%jinzhu%&quot;).Delete(&amp;Email&#123;&#125;)// DELETE from emails where email LIKE &quot;%jinzhu%&quot;;db.Delete(&amp;Email&#123;&#125;, &quot;email LIKE ?&quot;, &quot;%jinzhu%&quot;)</code></pre><h3 id="è¿”å›è¢«åˆ é™¤çš„æ•°æ®"><a href="#è¿”å›è¢«åˆ é™¤çš„æ•°æ®" class="headerlink" title="è¿”å›è¢«åˆ é™¤çš„æ•°æ®"></a>è¿”å›è¢«åˆ é™¤çš„æ•°æ®</h3><pre><code class="go">// è¿”å›æ‰€æœ‰åˆ—var users []User// è¿”å›æ‰€æœ‰åˆ—var users []User// DELETE FROM `users` WHERE role = &quot;admin&quot; RETURNING *DB.Clauses(clause.Returning&#123;&#125;).Where(&quot;role = ?&quot;, &quot;admin&quot;).Delete(&amp;users)// users =&gt; []User&#123;&#123;ID: 1, Name: "jinzhu", Role: "admin", Salary: 100&#125;, &#123;ID: 2, Name: "jinzhu.2", Role: "admin", Salary: 1000&#125;&#125;// è¿”å›æŒ‡å®šçš„åˆ—// DELETE FROM `users` WHERE role = &quot;admin&quot; RETURNING `name`, `salary`// users =&gt; []User&#123;&#123;ID: 0, Name: "jinzhu", Role: "", Salary: 100&#125;, &#123;ID: 0, Name: "jinzhu.2", Role: "", Salary: 1000&#125;&#125;DB.Clauses(clause.Returning&#123;Columns: []clause.Column&#123;&#123;Name: "name"&#125;, &#123;Name: "salary"&#125;&#125;&#125;).Where(&quot;role = ?&quot;, &quot;admin&quot;).Delete(&amp;users)</code></pre><h3 id="è½¯åˆ é™¤"><a href="#è½¯åˆ é™¤" class="headerlink" title="è½¯åˆ é™¤"></a>è½¯åˆ é™¤</h3><p>æ¦‚å¿µ:</p><ol><li>ä¸ä¼šæŠŠè®°å½•ä»æ•°æ®åº“ä¸­çœŸæ­£åˆ é™¤,åªæ˜¯æŠŠDeletedAtè®¾ç½®ä¸ºå½“å‰æ—¶é—´</li><li>åˆ é™¤åä¸èƒ½å†é€šè¿‡æ™®é€šçš„æŸ¥è¯¢æ–¹æ³•æ‰¾åˆ°è¯¥è®°å½•</li></ol><pre><code class="go">// user çš„ ID æ˜¯ `111`// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE id = 111;db.Delete(&amp;user)// æ‰¹é‡åˆ é™¤// UPDATE users SET deleted_at=&quot;2013-10-29 10:23&quot; WHERE age = 20;db.Where(&quot;age = ?&quot;, 20).Delete(&amp;User&#123;&#125;)// æŸ¥è¯¢æ—¶ä¼šå¿½ç•¥è¢«è½¯åˆ é™¤çš„è®°å½•db.Where(&quot;age = 20&quot;).Find(&amp;user)// SELECT * FROM users WHERE age = 20 AND deleted_at IS NULL</code></pre><h3 id="æ°¸ä¹…åˆ é™¤"><a href="#æ°¸ä¹…åˆ é™¤" class="headerlink" title="æ°¸ä¹…åˆ é™¤"></a>æ°¸ä¹…åˆ é™¤</h3><p>æ‰¾åˆ°è¢«è½¯åˆ é™¤çš„è®°å½•:<code>db.Unscoped().Where(&quot;age = 20&quot;).Find(&amp;users)</code></p><pre><code class="go">// DELETE FROM orders WHERE id=10;db.Unscoped().Delete(&amp;order)</code></pre><hr><h2 id="å…³è”"><a href="#å…³è”" class="headerlink" title="å…³è”"></a>å…³è”</h2><h3 id="belongs-to"><a href="#belongs-to" class="headerlink" title="belongs to"></a>belongs to</h3><p>æ¦‚å¿µ:</p><ol><li>åŒ…å« user å’Œ companyï¼Œå¹¶ä¸”æ¯ä¸ª user èƒ½ä¸”åªèƒ½è¢«åˆ†é…ç»™ä¸€ä¸ª company</li><li>Userå’ŒCompanyæœ‰ä¸€ä¸ªå…±åŒçš„å¤–é”®CompanyID</li></ol><pre><code class="go">type User struct &#123;  gorm.Model  Name      string  CompanyID int  Company   Company `gorm:&quot;constraint:OnUpdate:CASCADE,OnDelete:SET NULL;&quot;`&#125;type Company struct &#123;  ID   int  Name string&#125;</code></pre><h3 id="has-one"><a href="#has-one" class="headerlink" title="has one"></a>has one</h3><p>æ¦‚å¿µ:</p><ol><li>åŒ…å« user å’Œ credit card ï¼Œä¸”æ¯ä¸ª user åªèƒ½æœ‰ä¸€å¼  credit card</li></ol><pre><code class="go">// User æœ‰ä¸€å¼  CreditCardï¼ŒUserID æ˜¯å¤–é”®type User struct &#123;  gorm.Model  CreditCard CreditCard&#125;type CreditCard struct &#123;  gorm.Model  Number string  UserID uint&#125;// æ£€ç´¢ç”¨æˆ·åˆ—è¡¨å¹¶é¢„åŠ è½½ä¿¡ç”¨å¡func GetAll(db *gorm.DB) ([]User, error) &#123;    var users []User    err := db.Model(&amp;User&#123;&#125;).Preload(&quot;CreditCard&quot;).Find(&amp;users).Error    return users, err&#125;</code></pre><h3 id="Has-Many"><a href="#Has-Many" class="headerlink" title="Has Many"></a>Has Many</h3><p>æ¦‚å¿µ:</p><ol><li>åŒ…å« user å’Œ credit card æ¨¡å‹ï¼Œä¸”æ¯ä¸ª user å¯ä»¥æœ‰å¤šå¼  credit card</li></ol><pre><code class="go">// User æœ‰å¤šå¼  CreditCardï¼ŒUserID æ˜¯å¤–é”®type User struct &#123;  gorm.Model  CreditCards []CreditCard&#125;type CreditCard struct &#123;  gorm.Model  Number string  UserID uint&#125;// æ£€ç´¢ç”¨æˆ·åˆ—è¡¨å¹¶é¢„åŠ è½½ä¿¡ç”¨å¡func GetAll(db *gorm.DB) ([]User, error) &#123;    var users []User    err := db.Model(&amp;User&#123;&#125;).Preload(&quot;CreditCards&quot;).Find(&amp;users).Error    return users, err&#125;</code></pre><h3 id="Many-to-Many"><a href="#Many-to-Many" class="headerlink" title="Many to Many"></a>Many to Many</h3><p>æ¦‚å¿µ:</p><ol><li>åŒ…å«äº† user å’Œ languageï¼Œä¸”ä¸€ä¸ª user å¯ä»¥è¯´å¤šç§ languageï¼Œå¤šä¸ª user ä¹Ÿå¯ä»¥è¯´ä¸€ç§ language</li><li>å½“ä½¿ç”¨ GORM çš„ AutoMigrate ä¸º User åˆ›å»ºè¡¨æ—¶ï¼ŒGORM ä¼šè‡ªåŠ¨åˆ›å»ºè¿æ¥è¡¨</li></ol><pre><code class="go">// User æ‹¥æœ‰å¹¶å±äºå¤šç§ languageï¼Œ`user_languages` æ˜¯è¿æ¥è¡¨type User struct &#123;  gorm.Model  Languages []Language `gorm:&quot;many2many:user_languages;&quot;`&#125;type Language struct &#123;  gorm.Model  Name string&#125;// User æ‹¥æœ‰å¹¶å±äºå¤šç§ languageï¼Œ`user_languages` æ˜¯è¿æ¥è¡¨type User struct &#123;  gorm.Model  Languages []*Language `gorm:&quot;many2many:user_languages;&quot;`&#125;type Language struct &#123;  gorm.Model  Name string  Users []*User `gorm:&quot;many2many:user_languages;&quot;`&#125;// æ£€ç´¢ User åˆ—è¡¨å¹¶é¢„åŠ è½½ Languagefunc GetAllUsers(db *gorm.DB) ([]User, error) &#123;    var users []User    err := db.Model(&amp;User&#123;&#125;).Preload(&quot;Languages&quot;).Find(&amp;users).Error    return users, err&#125;// æ£€ç´¢ Language åˆ—è¡¨å¹¶é¢„åŠ è½½ Userfunc GetAllLanguages(db *gorm.DB) ([]Language, error) &#123;    var languages []Language    err := db.Model(&amp;Language&#123;&#125;).Preload(&quot;Users&quot;).Find(&amp;languages).Error    return languages, err&#125;</code></pre><h3 id="å®ä½“å…³è”"><a href="#å®ä½“å…³è”" class="headerlink" title="å®ä½“å…³è”"></a>å®ä½“å…³è”</h3><p>åœ¨åˆ›å»ºã€æ›´æ–°è®°å½•æ—¶ï¼ŒGORM ä¼šé€šè¿‡ Upsert è‡ªåŠ¨ä¿å­˜å…³è”åŠå…¶å¼•ç”¨è®°å½•ã€‚<br>è·³è¿‡è‡ªåŠ¨åˆ›å»ºæ›´æ–°:ä½¿ç”¨select å’Œ omit</p><h3 id="é¢„åŠ è½½"><a href="#é¢„åŠ è½½" class="headerlink" title="é¢„åŠ è½½"></a>é¢„åŠ è½½</h3><h4 id="ä½¿ç”¨-Preloadé€šè¿‡å¤šä¸ªSQLä¸­æ¥ç›´æ¥åŠ è½½å…³ç³»"><a href="#ä½¿ç”¨-Preloadé€šè¿‡å¤šä¸ªSQLä¸­æ¥ç›´æ¥åŠ è½½å…³ç³»" class="headerlink" title="ä½¿ç”¨ Preloadé€šè¿‡å¤šä¸ªSQLä¸­æ¥ç›´æ¥åŠ è½½å…³ç³»"></a>ä½¿ç”¨ <code>Preload</code>é€šè¿‡å¤šä¸ªSQLä¸­æ¥ç›´æ¥åŠ è½½å…³ç³»</h4><pre><code class="go">type User struct &#123;  gorm.Model  Username string  Orders   []Order&#125;type Order struct &#123;  gorm.Model  UserID uint  Price  float64&#125;// æŸ¥æ‰¾ user æ—¶é¢„åŠ è½½ç›¸å…³ Order// SELECT * FROM users;// SELECT * FROM orders WHERE user_id IN (1,2,3,4);db.Preload(&quot;Orders&quot;).Find(&amp;users)// SELECT * FROM users;// SELECT * FROM orders WHERE user_id IN (1,2,3,4); // has many// SELECT * FROM profiles WHERE user_id IN (1,2,3,4); // has one// SELECT * FROM roles WHERE id IN (4,5,6); // belongs todb.Preload(&quot;Orders&quot;).Preload(&quot;Profile&quot;).Preload(&quot;Role&quot;).Find(&amp;users)</code></pre><h4 id="joinsé¢„åŠ è½½"><a href="#joinsé¢„åŠ è½½" class="headerlink" title="joinsé¢„åŠ è½½"></a>joinsé¢„åŠ è½½</h4><pre><code class="go">db.Joins(&quot;Company&quot;).Joins(&quot;Manager&quot;).Joins(&quot;Account&quot;).First(&amp;user, 1)db.Joins(&quot;Company&quot;).Joins(&quot;Manager&quot;).Joins(&quot;Account&quot;).First(&amp;user, &quot;users.name = ?&quot;, &quot;jinzhu&quot;)db.Joins(&quot;Company&quot;).Joins(&quot;Manager&quot;).Joins(&quot;Account&quot;).Find(&amp;users, &quot;users.id IN ?&quot;, []int&#123;1,2,3,4,5&#125;)db.Joins(&quot;Company&quot;, DB.Where(&amp;Company&#123;Alive: true&#125;)).Find(&amp;users)</code></pre><hr><h2 id="å¤„ç†é”™è¯¯"><a href="#å¤„ç†é”™è¯¯" class="headerlink" title="å¤„ç†é”™è¯¯"></a>å¤„ç†é”™è¯¯</h2><p>æ™®é€šé”™è¯¯:</p><pre><code class="go">if err := db.Where(&quot;name = ?&quot;, &quot;jinzhu&quot;).First(&amp;user).Error; err != nil &#123;  // å¤„ç†é”™è¯¯...&#125;</code></pre><p>æœªæ‰¾åˆ°å¯¹åº”è®°å½•é”™è¯¯ErrRecordNotFound</p><pre><code class="go">// æ£€æŸ¥é”™è¯¯æ˜¯å¦ä¸º RecordNotFounderr := db.First(&amp;user, 100).Errorerrors.Is(err, gorm.ErrRecordNotFound)</code></pre><h2 id="é“¾å¼æ–¹æ³•"><a href="#é“¾å¼æ–¹æ³•" class="headerlink" title="é“¾å¼æ–¹æ³•"></a>é“¾å¼æ–¹æ³•</h2><p>é“¾å¼&#x2F;ç»ˆç»“æ–¹æ³•ä¹‹åè¿”å›ä¸€ä¸ªåˆå§‹åŒ–çš„<code>*gorm.DB</code>å®ä¾‹</p><ul><li>é“¾å¼æ–¹æ³•:Where, Select, Omit, Joins, Scopes, Preload, Raw</li><li>ç»ˆç»“æ–¹æ³•:Create, First, Find, Take, Save, Update, Delete, Scan, Row, Rows</li><li>æ–°å»ºä¼šè¯æ–¹æ³•: Sessionã€WithContextã€Debug</li></ul><h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><h2 id="é’©å­"><a href="#é’©å­" class="headerlink" title="é’©å­"></a>é’©å­</h2><h2 id="äº‹åŠ¡"><a href="#äº‹åŠ¡" class="headerlink" title="äº‹åŠ¡"></a>äº‹åŠ¡</h2><p>æš‚æ—¶å¿½ç•¥</p><h2 id="è¿ç§»"><a href="#è¿ç§»" class="headerlink" title="è¿ç§»"></a>è¿ç§»</h2><p>ç”¨äºè‡ªåŠ¨è¿ç§» schemaï¼Œä¿æŒæ‚¨çš„ schema æ˜¯æœ€æ–°çš„<br>schema:æ•°æ®åº“å¯¹è±¡é›†åˆï¼Œå®ƒåŒ…å«äº†å„ç§å¯¹åƒï¼Œæ¯”å¦‚ï¼šè¡¨ï¼Œè§†å›¾ï¼Œå­˜å‚¨è¿‡ç¨‹ï¼Œç´¢å¼•ç­‰ç­‰</p><pre><code class="go">db.AutoMigrate(&amp;User&#123;&#125;)db.AutoMigrate(&amp;User&#123;&#125;, &amp;Product&#123;&#125;, &amp;Order&#123;&#125;)// åˆ›å»ºè¡¨æ—¶æ·»åŠ åç¼€db.Set(&quot;gorm:table_options&quot;, &quot;ENGINE=InnoDB&quot;).AutoMigrate(&amp;User&#123;&#125;)</code></pre><h2 id="æ—¥å¿—Logger"><a href="#æ—¥å¿—Logger" class="headerlink" title="æ—¥å¿—Logger"></a>æ—¥å¿—Logger</h2><p>ä½œç”¨:æ‰“å°æ…¢ SQL å’Œé”™è¯¯<br>çº§åˆ«:Silentã€Errorã€Warnã€Info</p><pre><code class="go">newLogger := logger.New(  log.New(os.Stdout, &quot;\r\n&quot;, log.LstdFlags), // io writerï¼ˆæ—¥å¿—è¾“å‡ºçš„ç›®æ ‡ï¼Œå‰ç¼€å’Œæ—¥å¿—åŒ…å«çš„å†…å®¹ï¼‰  logger.Config&#123;    SlowThreshold: time.Second,   // æ…¢ SQL é˜ˆå€¼    LogLevel:      logger.Silent, // æ—¥å¿—çº§åˆ«    IgnoreRecordNotFoundError: true,   // å¿½ç•¥ErrRecordNotFoundï¼ˆè®°å½•æœªæ‰¾åˆ°ï¼‰é”™è¯¯    Colorful:      false,         // ç¦ç”¨å½©è‰²æ‰“å°  &#125;,)// å…¨å±€æ¨¡å¼db, err := gorm.Open(sqlite.Open(&quot;test.db&quot;), &amp;gorm.Config&#123;  Logger: newLogger,&#125;)// æ–°å»ºä¼šè¯æ¨¡å¼tx := db.Session(&amp;Session&#123;Logger: newLogger&#125;)tx.First(&amp;user)tx.Model(&amp;user).Update(&quot;Age&quot;, 18)</code></pre><h2 id="é€šç”¨æ•°æ®åº“æ¥å£"><a href="#é€šç”¨æ•°æ®åº“æ¥å£" class="headerlink" title="é€šç”¨æ•°æ®åº“æ¥å£"></a>é€šç”¨æ•°æ®åº“æ¥å£</h2><pre><code class="go">// è·å–é€šç”¨æ•°æ®åº“å¯¹è±¡ sql.DBï¼Œç„¶åä½¿ç”¨å…¶æä¾›çš„åŠŸèƒ½sqlDB, err := db.DB()// PingsqlDB.Ping()// ClosesqlDB.Close()// è¿”å›æ•°æ®åº“ç»Ÿè®¡ä¿¡æ¯sqlDB.Stats()</code></pre><h3 id="è¿æ¥æ± "><a href="#è¿æ¥æ± " class="headerlink" title="è¿æ¥æ± "></a>è¿æ¥æ± </h3><pre><code class="go">// è·å–é€šç”¨æ•°æ®åº“å¯¹è±¡ sql.DB ï¼Œç„¶åä½¿ç”¨å…¶æä¾›çš„åŠŸèƒ½sqlDB, err := db.DB()// SetMaxIdleConns ç”¨äºè®¾ç½®è¿æ¥æ± ä¸­ç©ºé—²è¿æ¥çš„æœ€å¤§æ•°é‡ã€‚sqlDB.SetMaxIdleConns(10)// SetMaxOpenConns è®¾ç½®æ‰“å¼€æ•°æ®åº“è¿æ¥çš„æœ€å¤§æ•°é‡ã€‚sqlDB.SetMaxOpenConns(100)// SetConnMaxLifetime è®¾ç½®äº†è¿æ¥å¯å¤ç”¨çš„æœ€å¤§æ—¶é—´ã€‚sqlDB.SetConnMaxLifetime(time.Hour)</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iniæ–‡ä»¶é…ç½®</title>
      <link href="/2023/03/19/ini-wen-jian-pei-zhi/"/>
      <url>/2023/03/19/ini-wen-jian-pei-zhi/</url>
      
        <content type="html"><![CDATA[<p>githubåœ°å€ï¼š<a href="https://github.com/go-ini/ini">https://github.com/go-ini/ini</a><br>æ–‡æ¡£åœ°å€ï¼š<a href="https://ini.unknwon.io/">https://ini.unknwon.io/</a></p><p>åŒ…çš„åŠŸèƒ½ï¼šåœ¨Goè¯­è¨€ä¸­è¯»å†™INIæ–‡ä»¶çš„åŠŸèƒ½<br>Goæœ€ä½ç‰ˆæœ¬ï¼š1.6<br>å®‰è£…ï¼š<code>go get gopkg.in/ini.v1</code><br>æ›´æ–°ï¼š<code>go get -u gopkg.in/ini.v1</code></p><p>my.ini</p><pre><code class="bash"># my.ini#  å¯é€‰å€¼ï¼šproduction, developmentapp_mode = development# grafanaå­˜å‚¨ä¸´æ—¶æ–‡ä»¶ï¼Œsessionå’Œsqlite3æ•°æ®åº“[paths]data=/home/git/grafana[server]# åè®®protocol=http# httpç«¯å£http_port=9999# å¦‚æœä¸»æœºheaderä¸ç¬¦åˆåŸŸåçš„è¯ï¼Œé‡å®šå‘åˆ°æ­£ç¡®çš„åŸŸå# é˜²æ­¢ DNS é‡æ–°ç»‘å®šæ”»å‡»enforce_domain=true</code></pre><p>main.go</p><pre><code class="go">func main() &#123;    cfg, err := ini.Load(&quot;my.ini&quot;)    if err != nil &#123;        fmt.Printf(&quot;Fail to read file: %v&quot;, err)        os.Exit(1)    &#125;    // ç®€å•çš„è¯»å–æ“ä½œ    fmt.Println(&quot;App Mode:&quot;, cfg.Section(&quot;&quot;).Key(&quot;app_mode&quot;).String())    fmt.Println(&quot;Data Path:&quot;, cfg.Section(&quot;paths&quot;).Key(&quot;data&quot;).String())    // åšä¸€äº›å€™é€‰å€¼é™åˆ¶çš„æ“ä½œ    // å¦‚æœè¯»å–çš„å€¼ä¸åœ¨å€™é€‰åˆ—è¡¨å†…ï¼Œåˆ™ä¼šå›é€€ä½¿ç”¨æä¾›çš„é»˜è®¤å€¼    fmt.Println(&quot;Server Protocol:&quot;, cfg.Section(&quot;server&quot;).Key(&quot;protocol&quot;).In(&quot;http&quot;, []string&#123;&quot;http&quot;, &quot;https&quot;&#125;))    fmt.Println(&quot;Email Protocol:&quot;, cfg.Section(&quot;server&quot;).Key(&quot;protocol&quot;).In(&quot;smtp&quot;, []string&#123;&quot;imap&quot;, &quot;smtp&quot;&#125;))    // è‡ªåŠ¨ç±»å‹è½¬æ¢    fmt.Printf(&quot;Port Number:(%[1]T) %[1]d\n&quot;, cfg.Section(&quot;server&quot;).Key(&quot;http_port&quot;).MustInt((9999)))    fmt.Printf(&quot;Enforce Domain: (%[1]T) %[1]v\n&quot;, cfg.Section(&quot;server&quot;).Key(&quot;enforce_domain&quot;).MustBool(false))    // ä¿®æ”¹æŸä¸ªå€¼åä¿å­˜åˆ°æ–°æ–‡ä»¶    cfg.Section(&quot;&quot;).Key(&quot;app_mode&quot;).SetValue(&quot;production&quot;)    cfg.SaveTo(&quot;mysql.ini.local&quot;)&#125;// è¾“å‡ºï¼š// App Mode: development// Data Path: /home/git/grafana// Server Protocol: http// Email Protocol: smtp// Port Number:(int) 9999// Enforce Domain: (bool) true</code></pre><h3 id="ä»æ•°æ®æºåŠ è½½é…ç½®"><a href="#ä»æ•°æ®æºåŠ è½½é…ç½®" class="headerlink" title="ä»æ•°æ®æºåŠ è½½é…ç½®"></a>ä»æ•°æ®æºåŠ è½½é…ç½®</h3><p>æ•°æ®æºç±»å‹ï¼š</p><ul><li>[]byteç±»å‹çš„åŸå§‹æ•°æ®</li><li>string ç±»å‹çš„æ–‡ä»¶è·¯å¾„</li><li>io.ReadCloser</li></ul><p>ç‰¹ç‚¹ï¼š</p><ul><li>å¯ä»¥åŠ è½½å¤šä¸ªæ•°æ®æº  <code>ini.Load(&quot;my.ini&quot;)</code></li><li>å¯ä»¥ä»ä¸€ä¸ªç©ºç™½çš„æ–‡ä»¶å¼€å§‹ <code>cfg:=ini.Empty()</code></li><li>åæœŸå¯ä»¥æŒ‰éœ€åŠ è½½ <code>err := cfg.Append(&quot;other file&quot;, []byte(&quot;other raw data&quot;))</code></li><li>ä¸ç¡®å®šæ˜¯å¦æœ‰æ–‡ä»¶ä¸å­˜åœ¨ï¼Œå¯ä»¥ä½¿ç”¨LooseLoad <code>cfg, err := ini.LooseLoad(&quot;filename&quot;, &quot;filename_404&quot;)</code>,åæœŸé€šè¿‡<code>Reload()</code>å¯ä»¥æ­£å¸¸åŠ è½½</li><li>åŠ è½½å¤šä¸ªæ•°æ®æºï¼Œå¦‚æœå‡ºç°åŒåé”®ï¼Œåˆ™åé¢çš„é…ç½®ä¼šè¦†ç›–å‰é¢çš„é…ç½®</li><li>æ•°æ®è¦†ç›–åªæœ‰åœ¨ä½¿ç”¨ ShadowLoad åŠ è½½æ•°æ®æºä¸ä¼šè¢«è§¦å‘</li></ul><h4 id="è·³è¿‡æ— æ³•è¯†åˆ«çš„æ•°æ®è¡Œ"><a href="#è·³è¿‡æ— æ³•è¯†åˆ«çš„æ•°æ®è¡Œ" class="headerlink" title="è·³è¿‡æ— æ³•è¯†åˆ«çš„æ•°æ®è¡Œ"></a>è·³è¿‡æ— æ³•è¯†åˆ«çš„æ•°æ®è¡Œ</h4><p>å¦‚æœé…ç½®æ–‡ä»¶åŒ…å«éé”®å€¼å¯¹çš„æ•°æ®è¡Œï¼Œè§£æå™¨é»˜è®¤æŠ¥é”™å¹¶ç»ˆæ­¢è§£æ<br>å¿½ç•¥é”™è¯¯ï¼š</p><pre><code class="go">cfg, err := ini.LoadSources(ini.LoadOptions&#123;    SkipUnrecognizableLines: true,&#125;, &quot;other.ini&quot;)</code></pre><h4 id="ä¿å­˜é…ç½®"><a href="#ä¿å­˜é…ç½®" class="headerlink" title="ä¿å­˜é…ç½®"></a>ä¿å­˜é…ç½®</h4><ol><li>è¾“å‡ºé…ç½®åˆ°æŸä¸ªæ–‡ä»¶</li></ol><pre><code class="go">err = cfg.SaveTo(&quot;my.ini&quot;)err = cfg.SaveToIndent(&quot;my.ini&quot;, &quot;\t&quot;)</code></pre><ol start="2"><li>å†™å…¥åˆ°ä»»ä½•å®ç° io.Writer æ¥å£çš„å¯¹è±¡ä¸­</li></ol><pre><code class="go">cfg.WriteTo(writer)cfg.WriteToIndent(writer, &quot;\t&quot;)</code></pre><h3 id="æ“ä½œåˆ†åŒºSection"><a href="#æ“ä½œåˆ†åŒºSection" class="headerlink" title="æ“ä½œåˆ†åŒºSection"></a>æ“ä½œåˆ†åŒºSection</h3><ul><li>è·å–é»˜è®¤åˆ†åŒº1:<code>sec, err := cfg.GetSection(&quot;&quot;)</code></li><li>è·å–é»˜è®¤åˆ†åŒº2:<code>sec, err := cfg.GetSection(ini.DEFAULT_SECTION)</code></li><li>è·å–æŒ‡å®šåˆ†åŒº1ï¼š<code>sec, err := cfg.GetSection(&quot;section name&quot;)</code></li><li>è·å–æŒ‡å®šåˆ†åŒº2ï¼š<code>sec := cfg.Section(&quot;section name&quot;)</code>ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»ºå¹¶è¿”å›ä¸€ä¸ªå¯¹åº”çš„åˆ†åŒº</li><li>åˆ›å»ºåˆ†åŒºï¼š<code>err := cfg.NewSection(&quot;new section&quot;)</code></li><li>è·å–æ‰€æœ‰åˆ†åŒºå¯¹è±¡æˆ–åç§°ï¼š</li></ul><pre><code class="go">secs := cfg.Sections()names := cfg.SectionStrings()</code></pre><h4 id="çˆ¶å­åˆ†åŒº"><a href="#çˆ¶å­åˆ†åŒº" class="headerlink" title="çˆ¶å­åˆ†åŒº"></a>çˆ¶å­åˆ†åŒº</h4><p>æ¦‚å¿µï¼šåœ¨åˆ†åŒºåç§°ä¸­ä½¿ç”¨ . æ¥è¡¨ç¤ºä¸¤ä¸ªæˆ–å¤šä¸ªåˆ†åŒºä¹‹é—´çš„çˆ¶å­å…³ç³»<br>å…³ç³»ï¼šå¦‚æœæŸä¸ªé”®åœ¨å­åˆ†åŒºä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¼šå»å®ƒçš„çˆ¶åˆ†åŒºä¸­å†æ¬¡å¯»æ‰¾ï¼Œç›´åˆ°æ²¡æœ‰çˆ¶åˆ†åŒºä¸ºæ­¢</p><pre><code class="bash">NAME = iniVERSION = v1IMPORT_PATH = gopkg.in/%(NAME)s.%(VERSION)s[package]CLONE_URL = https://%(IMPORT_PATH)s[package.sub]# https://gopkg.in/ini.v1cfg.Section(&quot;package.sub&quot;).Key(&quot;CLONE_URL&quot;).String()   </code></pre><h4 id="éé”®å€¼å¯¹åˆ†åŒº"><a href="#éé”®å€¼å¯¹åˆ†åŒº" class="headerlink" title="éé”®å€¼å¯¹åˆ†åŒº"></a>éé”®å€¼å¯¹åˆ†åŒº</h4><p>ä½¿ç”¨é€‰é¡¹<code>LoadOptions.UnparsableSections</code>é…ç½®è§£æ</p><pre><code class="go">cfg, err := ini.LoadSources(ini.LoadOptions&#123;    UnparseableSections: []string&#123;&quot;COMMENTS&quot;&#125;,&#125;, `[COMMENTS]&lt;1&gt;&lt;L.Slide#2&gt; This slide has the fuel listed in the wrong units &lt;e.1&gt;`)body := cfg.Section(&quot;COMMENTS&quot;).Body()/* --- start ---&lt;1&gt;&lt;L.Slide#2&gt; This slide has the fuel listed in the wrong units &lt;e.1&gt;------  end  --- */</code></pre><h3 id="æ“ä½œé”®Key"><a href="#æ“ä½œé”®Key" class="headerlink" title="æ“ä½œé”®Key"></a>æ“ä½œé”®Key</h3><ul><li>è·å–æŸä¸ªåˆ†åŒºä¸‹çš„é”®1ï¼š<code>key, err := cfg.Section(&quot;&quot;).GetKey(&quot;key name&quot;)</code></li><li>è·å–æŸä¸ªåˆ†åŒºä¸‹çš„é”®2ï¼š<code>key := cfg.Section(&quot;&quot;).Key(&quot;key name&quot;)</code></li><li>åˆ¤æ–­æŸä¸ªé”®æ˜¯å¦å­˜åœ¨ï¼š<code>yes := cfg.Section(&quot;&quot;).HasKey(&quot;key name&quot;)</code></li><li>åˆ›å»ºæ–°çš„Keyï¼š<code>err := cfg.Section(&quot;&quot;).NewKey(&quot;name&quot;, &quot;value&quot;)</code></li><li>è·å–åˆ†åŒºä¸‹çš„æ‰€æœ‰é”®æˆ–é”®åï¼š</li></ul><pre><code class="go">keys := cfg.Section(&quot;&quot;).Keys()names := cfg.Section(&quot;&quot;).KeyStrings()</code></pre><h4 id="å¿½ç•¥åˆ†åŒºæˆ–é”®åå¤§å°å†™"><a href="#å¿½ç•¥åˆ†åŒºæˆ–é”®åå¤§å°å†™" class="headerlink" title="å¿½ç•¥åˆ†åŒºæˆ–é”®åå¤§å°å†™"></a>å¿½ç•¥åˆ†åŒºæˆ–é”®åå¤§å°å†™</h4><p><code>cfg, err := ini.InsensitiveLoad(&quot;filename&quot;)</code></p><h4 id="åŒä¸€ä¸ªé”®ååŒ…å«å¤šä¸ªå€¼"><a href="#åŒä¸€ä¸ªé”®ååŒ…å«å¤šä¸ªå€¼" class="headerlink" title="åŒä¸€ä¸ªé”®ååŒ…å«å¤šä¸ªå€¼"></a>åŒä¸€ä¸ªé”®ååŒ…å«å¤šä¸ªå€¼</h4><p>æ™®é€šæƒ…å†µä¸‹ï¼šåªæœ‰æœ€åä¸€æ¬¡å‡ºç°çš„å€¼ä¼šè¢«ä¿å­˜åˆ°urlä¸­<br>éœ€è¦ä¿ç•™æ‰€æœ‰å€¼ï¼š</p><pre><code class="go">cfg, err := ini.ShadowLoad(&quot;.gitconfig&quot;)f.Section(`remote &quot;origin&quot;`).Key(&quot;url&quot;).String() # Result: https://github.com/Antergone/test2.gitf.Section(`remote &quot;origin&quot;`).Key(&quot;url&quot;).ValueWithShadows()//  Result:  []string&#123;//             &quot;https://github.com/Antergone/test1.git&quot;,//               &quot;https://github.com/Antergone/test2.git&quot;,//           &#125;</code></pre><h4 id="è‡ªå¢é”®å"><a href="#è‡ªå¢é”®å" class="headerlink" title="è‡ªå¢é”®å"></a>è‡ªå¢é”®å</h4><p>å¦‚æœæ•°æ®æºä¸­çš„é”®åä¸º -ï¼Œåˆ™è®¤ä¸ºè¯¥é”®ä½¿ç”¨äº†è‡ªå¢é”®åçš„ç‰¹æ®Šè¯­æ³•ã€‚è®¡æ•°å™¨ä» 1 å¼€å§‹ï¼Œå¹¶ä¸”åˆ†åŒºä¹‹é—´æ˜¯ç›¸äº’ç‹¬ç«‹çš„<br><code>cfg.Section(&quot;features&quot;).KeyStrings()    // []&#123;&quot;#1&quot;, &quot;#2&quot;, &quot;#3&quot;&#125;</code></p><h4 id="è·å–çˆ¶åˆ†åŒºä¸‹çš„æ‰€æœ‰é”®å"><a href="#è·å–çˆ¶åˆ†åŒºä¸‹çš„æ‰€æœ‰é”®å" class="headerlink" title="è·å–çˆ¶åˆ†åŒºä¸‹çš„æ‰€æœ‰é”®å"></a>è·å–çˆ¶åˆ†åŒºä¸‹çš„æ‰€æœ‰é”®å</h4><p><code>cfg.Section(&quot;package.sub&quot;).ParentKeys() // [&quot;CLONE_URL&quot;]</code></p><h3 id="æ“ä½œé”®å€¼Value"><a href="#æ“ä½œé”®å€¼Value" class="headerlink" title="æ“ä½œé”®å€¼Value"></a>æ“ä½œé”®å€¼Value</h3><ul><li>è·å–keyçš„å€¼:<code>al := cfg.Section(&quot;&quot;).Key(&quot;key name&quot;).String()</code></li><li>è·å–åŸå€¼ï¼š<code>val := cfg.Section(&quot;&quot;).Key(&quot;key name&quot;).Value()</code></li><li>åˆ¤æ–­æŸä¸ªåŸå€¼æ˜¯å¦å­˜åœ¨ï¼š<code>yes := cfg.Section(&quot;&quot;).HasValue(&quot;test value&quot;)</code></li></ul><h4 id="Valueå¸ƒå°”å€¼çš„è§„åˆ™ï¼š"><a href="#Valueå¸ƒå°”å€¼çš„è§„åˆ™ï¼š" class="headerlink" title="Valueå¸ƒå°”å€¼çš„è§„åˆ™ï¼š"></a>Valueå¸ƒå°”å€¼çš„è§„åˆ™ï¼š</h4><p>ç»“æœä¸ºtrueï¼šä¸ºï¼š1, t, T, TRUE, true, True, YES, yes, Yes, y, ON, on, On<br>ç»“æœä¸ºfalse ä¸ºï¼š0, f, F, FALSE, false, False, NO, no, No, n, OFF, off, Off</p><h4 id="Mustå¼€å¤´çš„æ–¹æ³•"><a href="#Mustå¼€å¤´çš„æ–¹æ³•" class="headerlink" title="Mustå¼€å¤´çš„æ–¹æ³•"></a>Mustå¼€å¤´çš„æ–¹æ³•</h4><p>ç”± Must å¼€å¤´çš„æ–¹æ³•åå…è®¸æ¥æ”¶ä¸€ä¸ªç›¸åŒç±»å‹çš„å‚æ•°æ¥ä½œä¸ºé»˜è®¤å€¼ï¼Œ<br>å½“é”®ä¸å­˜åœ¨æˆ–è€…è½¬æ¢å¤±è´¥æ—¶ï¼Œåˆ™ä¼šç›´æ¥è¿”å›è¯¥é»˜è®¤å€¼ã€‚ä½†æ˜¯ï¼ŒMustXXXXæ–¹æ³•å¿…é¡»ä¼ é€’ä¸€ä¸ªé»˜è®¤å€¼ã€‚</p><pre><code class="go">v = cfg.Section(&quot;&quot;).Key(&quot;INT&quot;).MustInt(10)</code></pre><h4 id="å¤šè¡Œä¹¦å†™"><a href="#å¤šè¡Œä¹¦å†™" class="headerlink" title="å¤šè¡Œä¹¦å†™"></a>å¤šè¡Œä¹¦å†™</h4><p>å¯ä»¥ä½¿ç”¨\åˆ†éš”<br><code>cfg.Section(&quot;advance&quot;).Key(&quot;two_lines&quot;).String() </code>è·å–åˆ°çš„æ˜¯ä¸€ä¸ªä¸æ¢è¡Œçš„å­—ç¬¦ä¸²</p><h4 id="è‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦"><a href="#è‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦" class="headerlink" title="è‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦"></a>è‡ªåŠ¨å¤„ç†ç‰¹æ®Šå­—ç¬¦</h4><p>å…·ä½“æ¦‚å¿µï¼šå€¼ä½¿ç”¨åŒå¼•å·æ‹¬èµ·æ¥ï¼Œå†…éƒ¨çš„åŒå¼•å·è¢«è½¬ä¹‰<br>æ¡ˆä¾‹ï¼šcreate_repo&#x3D;â€created repository &lt;a href&#x3D;&quot;%s&quot;&gt;%s</a>â€œ</p><pre><code class="go">cfg, err := ini.LoadSources(ini.LoadOptions&#123;UnescapeValueDoubleQuotes: true&#125;, &quot;en-US.ini&quot;)cfg.Section(&quot;&lt;name of your section&gt;&quot;).Key(&quot;create_repo&quot;).String()// ç»“æœï¼šcreated repository &lt;a href=&quot;%s&quot;&gt;%s&lt;/a&gt;</code></pre><h4 id="è¾…åŠ©æ–¹æ³•"><a href="#è¾…åŠ©æ–¹æ³•" class="headerlink" title="è¾…åŠ©æ–¹æ³•"></a>è¾…åŠ©æ–¹æ³•</h4><ul><li>è®¾ç½®é»˜è®¤å€¼,ä¸åœ¨ç»™å®šçš„å€¼å†…å°±è®¾ç½®ä¸ºé»˜è®¤å€¼<br><code>v = cfg.Section(&quot;&quot;).Key(&quot;STRING&quot;).In(&quot;default&quot;, []string&#123;&quot;str&quot;, &quot;arr&quot;, &quot;types&quot;&#125;)</code></li><li>åˆ¤æ–­è·å–çš„å€¼æ˜¯å¦åœ¨æŒ‡å®šèŒƒå›´å†…,ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºé»˜è®¤å€¼ï¼Œç¬¬äºŒä¸ªå‚æ•°å’Œç¬¬ä¸‰ä¸ªå‚æ•°ä¸ºèŒƒå›´<br><code>vals = cfg.Section(&quot;&quot;).Key(&quot;FLOAT64&quot;).RangeFloat64(0.0, 1.1, 2.2)</code></li><li>è‡ªåŠ¨åˆ†å‰²é”®å€¼åˆ°åˆ‡ç‰‡<ul><li>å­˜åœ¨æ— æ•ˆè¾“å…¥çš„çš„æ—¶å€™ï¼Œä½¿ç”¨é›¶å€¼ä»£æ›¿</li></ul></li></ul><pre><code class="go">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]// Input: how, 2.2, are, you -&gt; [0.0 2.2 0.0 0.0]vals = cfg.Section(&quot;&quot;).Key(&quot;STRINGS&quot;).Strings(&quot;,&quot;)vals = cfg.Section(&quot;&quot;).Key(&quot;FLOAT64S&quot;).Float64s(&quot;,&quot;)</code></pre><pre><code>-  å»é™¤æ— æ•ˆè¾“å…¥</code></pre><pre><code class="go">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]// Input: how, 2.2, are, you -&gt; [2.2]vals = cfg.Section(&quot;&quot;).Key(&quot;FLOAT64S&quot;).ValidFloat64s(&quot;,&quot;)</code></pre><pre><code>- å­˜åœ¨æ— æ•ˆè¾“å…¥æ—¶ï¼Œç›´æ¥è¿”å›é”™è¯¯</code></pre><pre><code class="go">// Input: 1.1, 2.2, 3.3, 4.4 -&gt; [1.1 2.2 3.3 4.4]// Input: how, 2.2, are, you -&gt; errorvals = cfg.Section(&quot;&quot;).Key(&quot;FLOAT64S&quot;).StrictFloat64s(&quot;,&quot;)</code></pre><ul><li>é€’å½’è¯»å–é”®å€¼<br>è¯­æ³•ï¼š<code> %(&lt;name&gt;)s</code>ï¼Œ å…¶ä¸­nameåªèƒ½æ˜¯ç›¸åŒåˆ†åŒºæˆ–é»˜è®¤åˆ†åŒºä¸‹çš„é”®åï¼Œå¦‚æœæŒ‡å®šçš„é”®ä¸å­˜åœ¨ï¼Œåˆ™ä¼šç”¨ç©ºå­—ç¬¦ä¸²æ›¿ä»£</li></ul><pre><code class="go">NAME = ini[author]NAME = UnknwonGITHUB = https://github.com/%(NAME)s[package]FULL_NAME = github.com/go-ini/%(NAME)s// cfg.Section(&quot;author&quot;).Key(&quot;GITHUB&quot;).String()ï¼šhttps://github.com/Unknwon// cfg.Section(&quot;package&quot;).Key(&quot;FULL_NAME&quot;).String()ï¼šgithub.com/go-ini/ini</code></pre><h3 id="æ³¨é‡ŠComment"><a href="#æ³¨é‡ŠComment" class="headerlink" title="æ³¨é‡ŠComment"></a>æ³¨é‡ŠComment</h3><h4 id="æ³¨é‡Šåˆ†ç±»"><a href="#æ³¨é‡Šåˆ†ç±»" class="headerlink" title="æ³¨é‡Šåˆ†ç±»"></a>æ³¨é‡Šåˆ†ç±»</h4><ol><li>æ‰€æœ‰ä»¥ # æˆ– ; å¼€å¤´çš„è¡Œ</li><li>æ‰€æœ‰åœ¨ # æˆ– ; ä¹‹åçš„å†…å®¹</li><li>åˆ†åŒºæ ‡ç­¾åçš„æ–‡å­— (å³ [åˆ†åŒºå] ä¹‹åçš„å†…å®¹)</li></ol><h3 id="ç»“æ„ä½“å’Œåˆ†åŒºåŒå‘æ˜ å°„"><a href="#ç»“æ„ä½“å’Œåˆ†åŒºåŒå‘æ˜ å°„" class="headerlink" title="ç»“æ„ä½“å’Œåˆ†åŒºåŒå‘æ˜ å°„"></a>ç»“æ„ä½“å’Œåˆ†åŒºåŒå‘æ˜ å°„</h3><p>æš‚æ—¶å¿½ç•¥</p><h3 id="è‡ªå®šä¹‰é”®åå’Œé”®å€¼æ˜ å°„å™¨"><a href="#è‡ªå®šä¹‰é”®åå’Œé”®å€¼æ˜ å°„å™¨" class="headerlink" title="è‡ªå®šä¹‰é”®åå’Œé”®å€¼æ˜ å°„å™¨"></a>è‡ªå®šä¹‰é”®åå’Œé”®å€¼æ˜ å°„å™¨</h3><p>æš‚æ—¶å¿½ç•¥</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•è·å–uiåº“æœªå¯¼å‡ºçš„ç»„ä»¶ç±»å‹</title>
      <link href="/2023/03/09/ru-he-huo-qu-ui-ku-wei-dao-chu-de-zu-jian-lei-xing/"/>
      <url>/2023/03/09/ru-he-huo-qu-ui-ku-wei-dao-chu-de-zu-jian-lei-xing/</url>
      
        <content type="html"><![CDATA[<p>antdæœ‰ä¸€äº›ç»„ä»¶çš„propså±æ€§å¹¶æ²¡æœ‰å¯¼å‡ºï¼Œä½†æ˜¯é¡¹ç›®é‡Œåˆéœ€è¦ç”¨åˆ°ï¼Œå¯ä»¥ç”¨ä¸‹é¢è¿™ä¸ªæ–¹æ³•æ¥è·å–</p><pre><code class="TypeScript">type SelectProps = React.ComponentProps&lt;typeof Select&gt;;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-CSS vs. CSS-in-JSï¼šHow and why to use each</title>
      <link href="/2023/03/07/fan-yi-css-vs-css-in-js/"/>
      <url>/2023/03/07/fan-yi-css-vs-css-in-js/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://blog.logrocket.com/css-vs-css-in-js/">https://blog.logrocket.com/css-vs-css-in-js/</a><br><a href="https://blog.logrocket.com/how-style-react-router-links-styled-components/">https://blog.logrocket.com/how-style-react-router-links-styled-components/</a><br>å½“ä½¿ç”¨ javascript æ¡†æ¶å†™ä»£ç çš„æ—¶å€™ï¼Œå¼€å‘è€…ç»å¸¸ä¼šé¢ä¸´ä¸€ä¸ªå›°å¢ƒï¼šæ˜¯å¦éœ€è¦ä½¿ç”¨ CSS-in-JSã€‚å¦‚æœä½ ä½¿ç”¨ React è¿›è¡Œå¼€å‘ï¼Œå¯èƒ½ä½ ä¹‹å‰å°±ä½¿ç”¨è¿‡ CSS-in-JSã€‚</p><p>CSS vs CSS-in-JS æ˜¯å½“ä¸‹çš„çƒ­é—¨è¯é¢˜ã€‚è¿™ä¸»è¦æ˜¯å› ä¸º CSS-in-JS æ­£åœ¨å› ä¸ºæ€§èƒ½é—®é¢˜è€Œå¤‡å—å…³æ³¨ã€‚ä½†æ˜¯åœ¨<a href="https://web.dev/state-of-css-2022/">è¿™ä¸ªæ–¹å‘ä¸Š(pipline ç¿»è¯‘ä¸ç¡®å®š)</a>ä¹Ÿæœ‰ä¸€äº›æ–°çš„ CSS ç‰¹æ€§,ä»–ä»¬åº”è¯¥ä¼šåœ¨ä¸ä¹…çš„æœªæ¥è§£å†³ä¸€éƒ¨åˆ†é—®é¢˜ã€‚</p><p>è¿™ç¯‡æ–‡ç« çš„ç›®çš„æ˜¯ç»“åˆç°ä»£ CSS çš„å½“å‰çŠ¶æ€ä»¥åŠå°†æ¥å¯èƒ½å¦‚ä½•å˜åŒ–å¸®åŠ©ä½ åœ¨æ¥ä¸‹æ¥çš„é¡¹ç›®ä¸­å°± CSS å’Œ CSS-in-JS ä¸­åšå‡ºé€‰æ‹©ã€‚</p><p>è¿™ç¯‡æ–‡ç« å±•ç¤ºçš„ä»£ç ç‰‡æ®µå’Œ demo éƒ½æ˜¯ä½¿ç”¨ React å’Œ CSS ç¼–å†™çš„ã€‚æ‰€ä»¥åœ¨è¿›è¡Œä¸‹ä¸€æ­¥ä¹‹å‰éœ€è¦ç¡®ä¿ä½ å¯¹è¿™ä¸¤ç§ web æŠ€æœ¯éƒ½éå¸¸ç†Ÿæ‚‰ã€‚</p><p>æ³¨æ„ä»»æ„çš„ JavaScript å‰ç«¯æ¡†æ¶æˆ–è€…åº“éƒ½å¯ä»¥æ˜¯å®ç° CSS-in-JS çš„ç†å¿µã€‚æœ¬æ–‡ä½¿ç”¨ç›®å‰ä¸ºæ­¢æœ€æµè¡Œçš„å‰ç«¯åº“â€”â€”React æ¥è®¨è®º CSS-in-JS çš„åº”ç”¨ä»¥åŠå®ƒæ˜¾è‘—çš„åˆ©å¼Šã€‚</p><h2 id="Render-blocking-å’Œ-CSS"><a href="#Render-blocking-å’Œ-CSS" class="headerlink" title="Render-blocking å’Œ CSS"></a>Render-blocking å’Œ CSS</h2><p>åœ¨è¿›ä¸€æ­¥è®¨è®ºä»€ä¹ˆæ˜¯æœ€å¥½çš„,ä»€ä¹ˆä¸æ˜¯æœ€å¥½çš„ä¹‹å‰,æˆ‘ä»¬å…ˆè®¨è®ºå› ä¸º CSS å¯¼è‡´çš„ä¸€äº›æ¸²æŸ“é—®é¢˜ã€‚</p><p>ä¼ ç»Ÿ web æŠ€æœ¯ä¸­,æµè§ˆå™¨é¦–å…ˆä¼šåŠ è½½ HTML,ç„¶ååŠ è½½æ¥è‡ªæ‰€æœ‰å¤–éƒ¨èµ„æºçš„ CSSã€‚é‚£ä¹‹å,æµè§ˆå™¨ä½¿ç”¨æ‰€æœ‰çš„å†…å¤–éƒ¨ CSS ä¿¡æ¯åˆ›å»º CSSOMã€‚æ­¤æ—¶æµè§ˆå™¨å·²å‡†å¤‡å¥½é€šè¿‡ CSS çº§è”è§„åˆ™å‘å·²ç»æ¸²æŸ“çš„ HTML æä¾›æ ·å¼ã€‚</p><p>è¿™ä¸ªè¿›ç¨‹ä¼šå¯¼è‡´ CSS <a href="https://blog.logrocket.com/9-tricks-eliminate-render-blocking-resources/">é˜»æ­¢é¡µé¢æ¸²æŸ“</a>ï¼Œå¹¶å»¶è¿Ÿæ‰€è¯·æ±‚é¡µé¢çš„é¦–ç»˜ã€‚é¦–ç»˜æŒ‡çš„æ˜¯æµè§ˆå™¨åœ¨å±å¹•ä¸Šæ‰“å°æ‰€è¯·æ±‚é¡µé¢çš„ç¬¬ä¸€ä¸ªåƒç´ æ—¶çš„äº‹ä»¶ã€‚</p><p>é¦–ç»˜ä¸­è¶…è¿‡åŠç§’çš„å»¶è¿Ÿå°±ä¼šé€ æˆç”¨æˆ·ä¸æ»¡æ„çš„é£é™©ï¼Œå¹¶ä¸”å¯ä»¥å¯¹ app çš„è¯„åˆ†é€ æˆè´Ÿé¢å½±å“ã€‚è¶Šå¿«æŠŠ CSS ä¼ é€’åˆ°å®¢æˆ·ç«¯ï¼Œå°±å¯ä»¥è¶Šå¥½åœ°ä¼˜åŒ–é¡µé¢çš„é¦–ç»˜æ—¶é—´ã€‚</p><h3 id="æˆ˜èƒœ-CSS-render-block"><a href="#æˆ˜èƒœ-CSS-render-block" class="headerlink" title="æˆ˜èƒœ CSS render-block"></a>æˆ˜èƒœ CSS render-block</h3><p>åŸºäº HTTP&#x2F;2 çš„åº”ç”¨ç¨‹åº,å¯ä»¥å¹¶è¡ŒåŠ è½½å¤šä¸ª HTML, CSS å’Œ JS æ–‡ä»¶ã€‚HTTP&#x2F;1.1 ä¸å…·å¤‡è¿™ç§åŠŸèƒ½ã€‚å¤§éƒ¨åˆ†ç°ä»£æµè§ˆå™¨å’Œç½‘ç«™éƒ½å·²ç»æ”¯æŒ HTTP&#x2F;2,è¿™æœ€å¤§ç¨‹åº¦åœ°å‡å°‘äº†ç”±ç­‰å¾…å…¶ä»–æ–‡ä»¶åŠ è½½å¼•èµ·çš„æ¸²æŸ“é˜»å¡ã€‚</p><img src="/2023/03/07/fan-yi-css-vs-css-in-js/img1-Graphic-showing-difference-file-loading-HTTP1-HTTP2.avif" class=""><p>ä½†æ˜¯æ¸²æŸ“é˜»å¡é™¤äº†æ–‡ä»¶åŠ è½½é€Ÿåº¦è¿˜æœ‰å…¶ä»–åŸå› ã€‚</p><p>æˆ‘ä»¬å‡è®¾ app çš„ä¸€ä¸ªé¡µé¢æœ‰è®¸å¤š CSSã€‚è¿™ä¸ªé¡µé¢å¯èƒ½åŒ…å«äº†å¾ˆå¤šå­˜åœ¨ä½†æ˜¯æ²¡æœ‰è¢«ä½¿ç”¨çš„é€‰æ‹©å™¨ï¼Œå› ä¸ºæˆ‘ä»¬åœ¨æ¯ä¸ªé¡µé¢éƒ½å¯¼å…¥äº†ä¸€ä¸ªä¸» CSS æ–‡ä»¶ã€‚</p><p>ä¸Šé¢è¿™ä¸ªåœºæ™¯åŸºæœ¬æè¿°äº†æˆ‘ä»¬æ˜¯å¦‚ä½•ä¹ æƒ¯ç›´æ¥ä½¿ç”¨æˆ‘ä»¬åˆ›å»ºçš„ <a href="https://blog.logrocket.com/comparing-tailwind-css-bootstrap-time-ditch-ui-kits/">CSS UI æ¡†æ¶æˆ–è€… UI å·¥å…·ç®±</a>æ¥å¿«é€Ÿä¿ƒè¿›æˆ‘ä»¬çš„è®¾è®¡ç³»ç»Ÿã€‚å¹¶éæ‰€æœ‰ä»æ¡†æ¶æˆ–è€…å·¥å…·ç®±å¼•ç”¨çš„æ ·å¼éƒ½ä¼šåœ¨æ¯ä¸ªé¡µé¢å†…è¢«ä½¿ç”¨ã€‚ç»“æœå°±æ˜¯æˆ‘ä»¬æœ€ç»ˆä¸ºè¿™ä¸ªé¡µé¢ç”Ÿæˆçš„ CSS æ ·å¼é‡Œå‡ºç°äº†æ›´å¤šçš„åƒåœ¾ã€‚</p><p>CSS è¶Šå¤š,æµè§ˆå™¨æ„å»º CSSOM çš„æ—¶é—´è¶Šé•¿ï¼Œè¿™ä¼šå¯¼è‡´å®Œå…¨æ²¡æœ‰å¿…è¦çš„æ¸²æŸ“é˜»å¡ã€‚</p><p>ä¸ºäº†éåˆ¶è¿™ç§å±€é¢,æŠŠ CSS åˆ†å‰²æˆå°ä»£ç å—éå¸¸æœ‰ç”¨ã€‚æ¢å¥è¯è¯´,æŠŠå…¨å±€æ ·å¼å’Œå¿…è¦çš„ CSS ä¿å­˜åœ¨ä¸€ä¸ªå…¨å±€æ–‡ä»¶ä¸­ï¼Œç„¶åå°†å…¶ä»–å†…å®¹ç»„ä»¶åŒ–ã€‚è¿™ç§ç­–ç•¥æ›´æœ‰æ„ä¹‰ä¸”è§£å†³äº†ä¸å¿…è¦çš„éå¿…è¦ CSS é˜»å¡ï¼š</p><img src="/2023/03/07/fan-yi-css-vs-css-in-js/img2-Project-structure-componentized-CSS.avif" class=""><p>ä¸Šé¢è¿™å¼ å›¾å±•ç¤ºäº†åœ¨ React ä¸­ä¸ºå„ä¸ªç»„ä»¶åˆ›å»ºå’Œç®¡ç†å±€éƒ¨ CSS æ–‡ä»¶çš„ä¼ ç»Ÿæ–¹å¼ã€‚å› ä¸ºæ¯ä¸ª CSS æ–‡ä»¶æ˜¯ç›´æ¥é™„åŠ åœ¨å„è‡ªçš„ç»„ä»¶ä¸Š,æ‰€ä»¥å®ƒåªåœ¨ç›¸å…³ç»„ä»¶è¢«å¯¼å…¥çš„æ—¶å€™è¢«å¯¼å…¥ï¼Œåœ¨ç»„ä»¶è¢«ç§»é™¤çš„çš„æ—¶å€™æ¶ˆå¤±ã€‚</p><p>ç›®å‰ï¼Œè¿™ä¸ªæ–¹æ³•è¿˜æœ‰ä¸è¶³ä¹‹å¤„ã€‚å‡è®¾ app åŒ…å« 100 ä¸ªç»„ä»¶ï¼ŒåŒä¸€ä¸ªé¡¹ç›®ä¸­çš„å…¶ä»–å¼€å‘è€…å¯èƒ½åœ¨è¿™äº› CSS æ–‡ä»¶ä¸­å·²ç»ä¸å°å¿ƒä½¿ç”¨äº†ä¸€æ ·çš„ç±»åã€‚</p><p>åœ¨è¿™é‡Œ,æ¯ä¸ªç»„ä»¶çš„æ¯ä¸ª CSS æ–‡ä»¶çš„èŒƒå›´éƒ½æ˜¯å…¨å±€çš„ï¼Œæ‰€ä»¥è¿™äº›ä¸å°å¿ƒé‡å¤çš„æ ·å¼ä¼šä¸æ–­ç›¸äº’è¦†ç›–å¹¶è¢«å…¨å±€åº”ç”¨ã€‚åƒè¿™æ ·çš„åœºæ™¯ä¼šå¼•èµ·ä¸¥é‡çš„å¸ƒå±€å’Œè®¾è®¡ä¸ä¸€è‡´ã€‚</p><p>æ®è¯´ CSS-in-JS å¯ä»¥è§£å†³è¿™ä¸ªä½œç”¨åŸŸé—®é¢˜ã€‚æ¥ä¸‹æ¥çš„æ–‡ç« åœ¨é«˜å±‚æ¬¡ä¸Šå›é¡¾äº† CSS-in-JSï¼Œå¹¶è®¨è®ºäº†å®ƒæ˜¯å¦ä¸€åŠ³æ°¸é€¸åœ°æœ‰æ•ˆåœ°è§£å†³äº†ä½œç”¨åŸŸé—®é¢˜ã€‚</p><h2 id="CSS-in-JS-æä¾›äº†ä»€ä¹ˆ"><a href="#CSS-in-JS-æä¾›äº†ä»€ä¹ˆ" class="headerlink" title="CSS-in-JS æä¾›äº†ä»€ä¹ˆ"></a>CSS-in-JS æä¾›äº†ä»€ä¹ˆ</h2><p>CSS-in-JS ç®€å•æ¥è¯´å°±æ˜¯å¤–éƒ¨åŠŸèƒ½å±‚ï¼Œå®ƒå¯ä»¥è®©ä½ é€šè¿‡ JavaScript ä¸ºç»„ä»¶ç¼–å†™ CSS å±æ€§ã€‚</p><p>è¿™ä¸€åˆ‡èµ·æºäº 2015 å¹´ä¸€ä¸ªå«åš <a href="https://cssinjs.org/?v=v10.10.0">JSS</a> çš„åº“ï¼Œå½“ç„¶è¿™ä¸ªåº“ç°åœ¨ä»ç„¶å¤„äºæ´»è·ƒçš„ç»´æŠ¤çŠ¶æ€ã€‚ä½ å¿…é¡»ä½¿ç”¨ JavaScript è¯­æ³•ç»™é€‰æ‹©å™¨æä¾› CSS å±æ€§ï¼Œä¸€æ—¦é¡µé¢åŠ è½½åå°±ä¼šè‡ªåŠ¨æŠŠè¿™äº›å±æ€§åº”ç”¨åˆ°ä»–ä»¬å„è‡ªçš„é€‰æ‹©å™¨ã€‚</p><p>å½“ JavaScript ä½¿ç”¨ç±»ä¼¼ React çš„åº“æ¥ç®¡æ¸²æŸ“å’Œç®¡ç†å‰ç«¯çš„æ—¶å€™ï¼Œä¸€ä¸ªå«åš <a href="https://blog.logrocket.com/how-style-react-router-links-styled-components/">styled-components</a> çš„ CSS-in-JS è§£å†³æ–¹æ¡ˆå‡ºç°äº†ã€‚å¦å¤–ä¸€ä¸ªå¿«é€Ÿæµè¡Œçš„è§£å†³æ–¹æ¡ˆæ˜¯ä½¿ç”¨ Emotion åº“åšåŒæ ·çš„äº‹ã€‚</p><p>æˆ‘ä»¬æ‰“ç®—ç”¨ styled-components åº“æ¼”ç¤º CSS-in-JS çš„ç¤ºä¾‹ç”¨ä¾‹ï¼Œå› ä¸ºä»–æ˜¯åœ¨ React ç”Ÿæ€ä¸­ä½¿ç”¨ CSS-in-JS æ–¹æ¡ˆä¸­æœ€æµè¡Œçš„ã€‚</p><h3 id="é€šè¿‡-styled-components-ä½¿ç”¨-CSS-in-JS-çš„ä¾‹å­"><a href="#é€šè¿‡-styled-components-ä½¿ç”¨-CSS-in-JS-çš„ä¾‹å­" class="headerlink" title="é€šè¿‡ styled-components ä½¿ç”¨ CSS-in-JS çš„ä¾‹å­"></a>é€šè¿‡ styled-components ä½¿ç”¨ CSS-in-JS çš„ä¾‹å­</h3><p>åœ¨ React app ä¸­ä½¿ç”¨ä¸‹é¢çš„ Yarn å‘½ä»¤å®‰è£… styled-components åº“ã€‚å¦‚æœä½ ä½¿ç”¨çš„æ˜¯ä¸åŒçš„åŒ…ç®¡ç†å™¨,å¯ä»¥æŸ¥çœ‹ styled-components å®‰è£…æ–‡æ¡£æ‰¾åˆ°åˆé€‚çš„å®‰è£…å‘½ä»¤ï¼š</p><pre><code class="bash">yarn add styled-components</code></pre><p>å®‰è£…å®Œ styled-components åº“ä¹‹å,å¯¼å…¥ styled å‡½æ•°ï¼ŒæŒ‰å¦‚ä¸‹ä»£ç ä½¿ç”¨ï¼š</p><pre><code class="jsx">import styled from &quot;styled-components&quot;;const StyledButton = styled.a`  padding: 0.75em 1em;  background-color: $&#123;(&#123; primary &#125;) =&gt; (primary ? &quot;#07c&quot; : &quot;#333&quot;)&#125;;  color: white;  &amp;:hover &#123;    background-color: #111;  &#125;`;export default StyledButton;</code></pre><p>å¦‚æœä½ æ²¡æœ‰ React ç¯å¢ƒï¼Œ<a href="https://codepen.io/_rahul/pen/oNywWXR">è¿™é‡Œ</a>æœ‰ä¸€ä¸ªè¿è¡Œä¸Šè¿°ä»£ç çš„é“¾æ¥ï¼š</p><p>ä¸Šé¢çš„ä»£ç æ¼”ç¤ºäº†å¦‚ä½•åœ¨ React ä¸­ç»™ä¸€ä¸ª button-link ç»„ä»¶æ·»åŠ æ ·å¼ã€‚æ·»åŠ å®Œæ ·å¼çš„ç»„ä»¶ç°åœ¨å¯ä»¥ä¸ç”¨æ‹…å¿ƒæ ·å¼é—®é¢˜åœ¨ä»»æ„åœ°æ–¹è¢«å¯¼å…¥å¹¶è¢«ç›´æ¥ç”¨æ¥æ„å»ºä¸€ä¸ªåŠŸèƒ½ç»„ä»¶ï¼š</p><pre><code class="bash">import StyledButton from &#39;./components/styles/Button.styled&#39;;function App() &#123;  return (    &lt;div className=&quot;App&quot;&gt;      ...      &lt;StyledButton href=&quot;...&quot;&gt;Default Call-to-action&lt;/StyledButton&gt;      &lt;StyledButton primary href=&quot;...&quot;&gt;Primary Call-to-action&lt;/StyledButton&gt;    &lt;/div&gt;  );&#125;export default App;</code></pre><p>æ³¨æ„ï¼šåº”ç”¨åˆ° styled ç»„ä»¶ä¸Šçš„æ ·å¼æ˜¯å±€éƒ¨èŒƒå›´çš„,è¿™æ¶ˆé™¤äº†éœ€è¦ç•™å¿ƒ CSS ç±»å‘½åå’Œå…¨å±€èŒƒå›´çš„ç¹çéœ€æ±‚ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åŸºäºæä¾›ç»™ç»„ä»¶çš„ props æˆ–è€… app åŠŸèƒ½æ‰€éœ€çš„ä»»ä½•å…¶ä»–é€»è¾‘åŠ¨æ€æ·»åŠ æˆ–ç§»é™¤ CSSã€‚</p><h2 id="CSS-in-JS-çš„å¥½å¤„"><a href="#CSS-in-JS-çš„å¥½å¤„" class="headerlink" title="CSS-in-JS çš„å¥½å¤„"></a>CSS-in-JS çš„å¥½å¤„</h2><p>æ¯”èµ· CSS ç±»,JavaScript å¼€å‘è€…å¯èƒ½æ›´å–œæ¬¢ä½¿ç”¨ CSS-in-JS æ¥å†™æ ·å¼ã€‚CSS-in-JS è§£å†³çš„æœ€å¤§é—®é¢˜æ˜¯å…¨å±€ä½œç”¨åŸŸã€‚å¦‚æœä½ æ˜¯ JavaScript å¼€å‘è€…çš„è¯ï¼Œå®ƒå…¶ä»–çš„ä¸€äº›ä¼˜åŠ¿ä¹Ÿéå¸¸æœ‰æ„ä¹‰ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬å¼€å§‹æ¢ç´¢è¿™äº›ä¼˜åŠ¿ä¸­çš„ä¸€éƒ¨åˆ†ã€‚</p><h3 id="æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜"><a href="#æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜" class="headerlink" title="æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜"></a>æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜</h3><p>ç”±äºæ ·å¼åªèƒ½åœ¨å±€éƒ¨èŒƒå›´å†…ä½¿ç”¨ï¼Œæ‰€ä»¥ä»–ä»¬ä¸å®¹æ˜“å’Œå…¶ä»–ç»„ä»¶çš„æ ·å¼å†²çªã€‚ä½ ç”šè‡³ä¸éœ€è¦æ‹…å¿ƒä½¿ç”¨ä¸¥æ ¼çš„å‘½åæ¥é¿å…æ ·å¼å†²çªã€‚</p><p>ä¸“é—¨ä¸ºä¸€ä¸ªç»„ä»¶å†™çš„æ ·å¼ä¸éœ€è¦é¢„å…ˆè€ƒè™‘å­é€‰æ‹©å™¨ï¼Œæ‰€ä»¥ç‰¹å¼‚æ€§é—®é¢˜å¾ˆå°‘ã€‚</p><h3 id="åŠ¨æ€æ ·å¼"><a href="#åŠ¨æ€æ ·å¼" class="headerlink" title="åŠ¨æ€æ ·å¼"></a>åŠ¨æ€æ ·å¼</h3><p>æ¡ä»¶ CSS æ˜¯ CSS-in-JS çš„å¦å¤–ä¸€ä¸ªé«˜å…‰ç‚¹ã€‚å¦‚åŒä¸Šé¢æ¼”ç¤ºçš„æŒ‰é’®ç¤ºä¾‹ä¸€æ ·ï¼Œæ¯”èµ·ä¸ºæ¯ä¸ªå˜åŠ¨å†™ä¸€ä¸ªå•ç‹¬çš„æ ·å¼ï¼Œæ£€æŸ¥ props å€¼å¹¶ä¸”æ·»åŠ åˆé€‚çš„æ ·å¼æ˜¯æ›´é…·çš„ä¸€ç§æ–¹æ³•ã€‚</p><h3 id="æ›´å°‘çš„-CSS-ç‰¹å¼‚æ€§"><a href="#æ›´å°‘çš„-CSS-ç‰¹å¼‚æ€§" class="headerlink" title="æ›´å°‘çš„ CSS ç‰¹å¼‚æ€§"></a>æ›´å°‘çš„ CSS ç‰¹å¼‚æ€§</h3><p>CSS-in-JS å¸®åŠ©ä½ æŠŠ CSS å£°æ˜çš„ç‰¹å¼‚æ€§ä¿æŒåœ¨æœ€ä½æ°´å¹³ï¼Œå› ä¸ºä½ å”¯ä¸€ä½¿ç”¨å®ƒçš„æ ·å¼çš„é€”å¾„å°±æ˜¯å…ƒç´ æœ¬èº«ã€‚è¿™åŒæ ·é€‚ç”¨äºåˆ›å»ºç»„ä»¶å˜ä½“ï¼Œä½ å¯ä»¥æ£€æŸ¥ prop å¯¹è±¡å€¼å¹¶ä¸”åœ¨éœ€è¦çš„æ—¶å€™æ·»åŠ åŠ¨æ€æ ·å¼ã€‚</p><h3 id="å®¹æ˜“çš„ä¸»é¢˜"><a href="#å®¹æ˜“çš„ä¸»é¢˜" class="headerlink" title="å®¹æ˜“çš„ä¸»é¢˜"></a>å®¹æ˜“çš„ä¸»é¢˜</h3><p>ä½¿ç”¨è‡ªå®šä¹‰ CSS å±æ€§ä¸º app è®¾ç½®ä¸»é¢˜éå¸¸æœ‰æ„ä¹‰ã€‚åœ¨æœ€åï¼Œä½ å¿…é¡»è½¬åˆ° JavaScript ä¾§ï¼ŒåŸºäºç”¨æˆ·è¾“å…¥å†™ä¸€äº›é€»è¾‘ä»£ç æ¥åˆ‡æ¢å’Œè®°ä½ä¸»é¢˜ã€‚</p><p>CSS-in-JS è®©ä½ å¯ä»¥å®Œå…¨ä½¿ç”¨ JavaScript ç¼–å†™ä¸»é¢˜é€»è¾‘ã€‚å€ŸåŠ© styled-components çš„ ThemeProvider wrapperï¼Œä½ å¯ä»¥å¿«é€Ÿä¸ºç»„ä»¶çš„ä¸»é¢˜è¿›è¡Œé¢œè‰²ç¼–ç ã€‚ä¸‹é¢å€Ÿ<a href="https://codepen.io/_rahul/pen/qBKXevo">è¿™ä¸ªæ¡ˆä¾‹</a>æ¥æŸ¥çœ‹ä½¿ç”¨ styled-components å®šåˆ¶ä¸»é¢˜ï¼š</p><h3 id="æ— ç—›ç»´æŠ¤"><a href="#æ— ç—›ç»´æŠ¤" class="headerlink" title="æ— ç—›ç»´æŠ¤"></a>æ— ç—›ç»´æŠ¤</h3><p>è€ƒè™‘åˆ° CSS-in-JS æä¾›çš„ç‰¹æ€§å’Œä¼˜åŠ¿ï¼ŒJavaScript å¯èƒ½ä¼šå‘ç° CSS-in-JS æ¯”ç®¡ç†ä¸Šç™¾ä¸ª CSS æ–‡ä»¶æ›´æ–¹ä¾¿ã€‚</p><p>ä½†æ˜¯æœ‰ä¸€ä¸ªé—ç•™äº‹å®æ˜¯ï¼šåªæœ‰å¯¹ JavaScript å’Œ CSS éƒ½æœ‰å¾ˆæ·±çš„ç†è§£,æ‰èƒ½é«˜æ•ˆç®¡ç†å’Œç»´æŠ¤ç”± CSS-in-JS é©±åŠ¨çš„å¤§å‹é¡¹ã€‚</p><h2 id="CSS-in-JS-çš„åå¤„"><a href="#CSS-in-JS-çš„åå¤„" class="headerlink" title="CSS-in-JS çš„åå¤„"></a>CSS-in-JS çš„åå¤„</h2><p>CSS-in-JS ç¡®å®éå¸¸å®Œç¾çš„è§£å†³äº†ä½œç”¨åŸŸé—®é¢˜ã€‚ä½†æ˜¯å°±åƒæˆ‘ä»¬ä¸€å¼€å§‹è®¨è®ºçš„é‚£æ ·ï¼Œæˆ‘ä»¬ä¼šé¢ä¸´æ›´å¤§çš„æŒ‘æˆ˜â€”â€”æ¯”å¦‚æ¸²æŸ“é˜»å¡â€”â€”è¿™ä¼šç›´æ¥å½±å“ç”¨æˆ·ä½“éªŒã€‚é™¤æ­¤ä¹‹å¤–ï¼ŒCSS-in-JS çš„æ¦‚å¿µè¿˜éœ€è¦å¤„ç†ä¸€äº›å…¶ä»–çš„é—®é¢˜ã€‚</p><h3 id="å»¶è¿Ÿæ¸²æŸ“"><a href="#å»¶è¿Ÿæ¸²æŸ“" class="headerlink" title="å»¶è¿Ÿæ¸²æŸ“"></a>å»¶è¿Ÿæ¸²æŸ“</h3><p>CSS-in-JS ä¼šæ‰§è¡Œ JavaScript æ¥ä» JavaScript ç»„ä»¶ä¸­è§£æ CSS,ç„¶åæŠŠè¿™äº›è½¬æ¢å‡ºæ¥çš„æ ·å¼æ³¨å…¥ DOMã€‚ç»„ä»¶è¶Šå¤šï¼Œæµè§ˆå™¨é¦–ç»˜çš„æ—¶é—´å°±è¶Šé•¿ã€‚</p><h3 id="ç¼“å­˜é—®é¢˜"><a href="#ç¼“å­˜é—®é¢˜" class="headerlink" title="ç¼“å­˜é—®é¢˜"></a>ç¼“å­˜é—®é¢˜</h3><p>CSS ç¼“å­˜ç»å¸¸è¢«ç”¨æ¥æ”¹å–„è¿ç»­é¡µé¢åŠ è½½æ—¶é—´ã€‚å½“ä½¿ç”¨ CSS-in-JS çš„æ—¶å€™ç”±äºæ²¡æœ‰ CSS æ–‡ä»¶,ç¼“å­˜å˜æˆäº†ä¸€ä¸ªå¤§é—®é¢˜ã€‚è€Œä¸”ã€‚åŠ¨æ€ç”Ÿæˆ CSS ç±»åè®©è¿™ä¸ªé—®é¢˜å˜å¾—æ›´å¤æ‚ã€‚</p><h3 id="CSS-é¢„å¤„ç†å™¨æ”¯æŒåº¦"><a href="#CSS-é¢„å¤„ç†å™¨æ”¯æŒåº¦" class="headerlink" title="CSS é¢„å¤„ç†å™¨æ”¯æŒåº¦"></a>CSS é¢„å¤„ç†å™¨æ”¯æŒåº¦</h3><p>å€ŸåŠ©ç»„ä»¶åŒ–çš„ CSS æ–¹æ³•,å¾ˆå®¹æ˜“æ·»åŠ åƒ<a href="https://blog.logrocket.com/how-to-write-reusable-css-with-sass/">SASS</a>, Less, PostCSS å’Œå…¶ä»–çš„é¢„å¤„ç†çš„æ”¯æŒã€‚è€Œåœ¨ CSS-in-JS ä¸­ï¼Œè¿™æ˜¯ä¸å¯èƒ½çš„ã€‚</p><h3 id="å‡Œä¹±çš„-DOM"><a href="#å‡Œä¹±çš„-DOM" class="headerlink" title="å‡Œä¹±çš„ DOM"></a>å‡Œä¹±çš„ DOM</h3><p>CSS-in-JS çš„åŸºç¡€æ˜¯å°†æ‰€æœ‰çš„æ ·å¼å®šä¹‰ä» JavaScript è§£æä¸ºåŸºç¡€ CSSï¼Œç„¶åä½¿ç”¨æ ·å¼å—å°†æ ·å¼æ³¨å…¥ DOM ä¸­ã€‚</p><p>å¯¹äºæ¯ä¸ªä½¿ç”¨ CSS-in-JS è¿›è¡Œæ ·å¼ç¼–å†™çš„ç»„ä»¶æ¥è¯´,å¯èƒ½é¦–å…ˆå°±ä¼šæœ‰ 100 ä¸ªæ ·å¼å—éœ€è¦è§£æç„¶åæ³¨å…¥ã€‚ç®€å•æ¥è¯´å°±æ˜¯ä¼šæœ‰æ›´å¤šçš„é—´æ¥æˆæœ¬ã€‚</p><h3 id="åº“ä¾èµ–"><a href="#åº“ä¾èµ–" class="headerlink" title="åº“ä¾èµ–"></a>åº“ä¾èµ–</h3><p>å¦‚åŒæˆ‘ä»¬æ‰€çŸ¥é“çš„é‚£æ ·ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤–éƒ¨åº“æ·»åŠ  CSS-in-JS åŠŸèƒ½ã€‚è®¸å¤š JavaScript å°†åœ¨å®é™…çš„ CSS è§£æä¹‹å‰è¢«åŒ…å«å¹¶è¿è¡Œï¼Œå› ä¸ºä» JavaScript åˆ° CSS æ ·å¼çš„è§£æå–å†³äºåƒ styled-components è¿™æ ·çš„åº“ã€‚</p><h3 id="å­¦ä¹ æ›²çº¿"><a href="#å­¦ä¹ æ›²çº¿" class="headerlink" title="å­¦ä¹ æ›²çº¿"></a>å­¦ä¹ æ›²çº¿</h3><p>CSS-in-JS ç¼ºå¤±å¾ˆå¤š CSS å’Œ SCSS ä¸ç”Ÿä¿±æ¥çš„ç‰¹æ€§ã€‚å¯¹äºå·²ç»ä¹ æƒ¯äº† CSS å’Œ SCSS çš„å¼€å‘è€…æ¥è¯´é€‚åº” CSS-in-JS å°†ä¼šéå¸¸æœ‰æŒ‘æˆ˜æ€§</p><h3 id="æ²¡æœ‰å¤§è§„æ¨¡çš„æ”¯æŒ"><a href="#æ²¡æœ‰å¤§è§„æ¨¡çš„æ”¯æŒ" class="headerlink" title="æ²¡æœ‰å¤§è§„æ¨¡çš„æ”¯æŒ"></a>æ²¡æœ‰å¤§è§„æ¨¡çš„æ”¯æŒ</h3><p>ç›®å‰å¤§éƒ¨åˆ† UI åº“å’Œç»„ä»¶åº“éƒ½ä¸æ”¯æŒ CSS-in-JS æ–¹å¼ï¼Œå› ä¸ºå®ƒä»ç„¶æœ‰è®¸å¤šé—®é¢˜éœ€è¦è§£å†³</p><p>ä¸Šé¢è®¨è®ºçš„é—®é¢˜å¯èƒ½ä¼šç´¯ç§¯åœ¨ä¸€èµ·ï¼Œå¯¼è‡´äº§å“æ€§èƒ½ä½ã€éš¾ä»¥ç»´æŠ¤ï¼Œå¹¶å­˜åœ¨è‹¥å¹² UI å’Œ ç”¨æˆ·ä½“éªŒä¸ä¸€è‡´çš„é—®é¢˜ã€‚</p><h2 id="ä»€ä¹ˆæƒ…å†µä¸‹æ¨èä½¿ç”¨-CSS-in-JS"><a href="#ä»€ä¹ˆæƒ…å†µä¸‹æ¨èä½¿ç”¨-CSS-in-JS" class="headerlink" title="ä»€ä¹ˆæƒ…å†µä¸‹æ¨èä½¿ç”¨ CSS-in-JS"></a>ä»€ä¹ˆæƒ…å†µä¸‹æ¨èä½¿ç”¨ CSS-in-JS</h2><p>å½“ä½ å¤„ç†ä¸€ä¸ªè¾ƒå°çš„åº”ç”¨å¹¶ä¸”æ€§èƒ½ä¼˜å…ˆçº§è¦æ±‚ä¸é«˜çš„è¯ï¼Œ CSS-in-JS æ˜¯ä¸€ä¸ªç†æƒ³çš„è§£å†³æ–¹æ¡ˆã€‚åœ¨å¤„ç†å…·æœ‰åºå¤§è®¾è®¡ç³»ç»Ÿçš„æ€§èƒ½è¦æ±‚é«˜çš„åº”ç”¨æ—¶ï¼Œå®ƒå¯èƒ½å¹¶ä¸ç†æƒ³ã€‚</p><p>éšç€ app é€æ¸å˜å¤§ï¼Œè€ƒè™‘åˆ°è¿™ä¸ªæ¦‚å¿µçš„æ‰€æœ‰ç¼ºç‚¹ï¼Œä½¿ç”¨ CSS-in-JS ä¼šå¾ˆå®¹æ˜“å˜å¾—å¤æ‚ï¼ŒæŠŠä¸€ä¸ªè®¾è®¡ç³»ç»Ÿè½¬åŒ–ä¸º CSS-in-JS æœ‰è®¸å¤šå·¥ä½œè¦åšï¼Œä»æˆ‘çš„è§’åº¦æ¥çœ‹ï¼Œæ²¡æœ‰ JavaScript å¼€å‘è€…ä¼šæƒ³è¦å¤„ç†è¿™ç§æƒ…å†µã€‚</p><h2 id="CSS-Module-æ¦‚è§ˆ"><a href="#CSS-Module-æ¦‚è§ˆ" class="headerlink" title="CSS Module æ¦‚è§ˆ"></a>CSS Module æ¦‚è§ˆ</h2><p><a href="https://blog.logrocket.com/a-deep-dive-into-css-modules/">CSS Module</a>æ˜¯ä¸€ä¸ª CSS æ–‡ä»¶ï¼Œé‡Œé¢æ‰€æœ‰çš„å±æ€§åœ¨å·²ç»æ¸²æŸ“çš„ CSS ä¸­é»˜è®¤éƒ½è¢«é™åˆ¶åœ¨å±€éƒ¨èŒƒå›´å†…ã€‚JavaScript è¿›ä¸€æ­¥å¤„ç† CSS Module æ–‡ä»¶å¹¶ä¸”å°è£…ä»–ä»¬çš„æ ·å¼å£°æ˜æ¥è§£å†³ä½œç”¨åŸŸé—®é¢˜ã€‚</p><p>ä¸ºäº†ä½¿ç”¨ CSS Moduleï¼Œä½ éœ€è¦æŠŠ CSS æ–‡ä»¶æ‰©å±•åä¿®æ”¹ä¸º<code>.module.css</code>,ç„¶åå°†ä»–ä»¬å¯¼å…¥ JavaScript æ–‡ä»¶ä¸­ã€‚ä¸‹é¢çš„ä»£ç ç‰‡æ®µæä¾›äº†ä¸€ä¸ªå¦‚ä½•ä½¿ç”¨ CSS Module çš„ä¾‹å­ï¼š</p><pre><code class="jsx">import styles from &quot;./Button.module.css&quot;;export default function Button(props) &#123;  return (    &lt;a href=&#123;props.href ? props.href : &quot;#&quot;&#125; className=&#123;styles.btn&#125;&gt;      &#123;props.name&#125;    &lt;/a&gt;  );&#125;</code></pre><p>çœ‹è¿™ä¸ªåœ¨ React ä¸­å®ç° CSS Module çš„<a href="https://stackblitz.com/edit/react-hbivvp?file=src/components/AnotherButton/AnotherButton.jsx">ç¤ºä¾‹</a>ã€‚è¿™ä¸ªä¾‹å­å±•ç¤ºäº†å¦‚ä½•ä½¿ç”¨ CSS Module ä¿®å¤ä½œç”¨åŸŸé—®é¢˜ã€‚</p><p>åœ¨è¿™ä¸ªä¾‹å­é‡Œ,è¯·æ³¨æ„å¦‚ä½•æ™ºèƒ½åœ°å¤„ç†å’Œä¼˜åŒ– Button.module.css å’Œ AnotherButton.module.css çš„ç›¸åŒç±»åæ¥é˜²æ­¢å‘½åå†²çªã€‚</p><h2 id="CSS-Module-çš„å¥½å¤„"><a href="#CSS-Module-çš„å¥½å¤„" class="headerlink" title="CSS Module çš„å¥½å¤„"></a>CSS Module çš„å¥½å¤„</h2><p>CSS Module æä¾›çš„æœ€å¤§çš„å¥½å¤„å°±æ˜¯æ‘†è„±å¯¹ CSS in-JS çš„ä¾èµ–è§£å†³èŒƒå›´å’Œç‰¹å¼‚æ€§é—®é¢˜ã€‚å¦‚æœæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¿æŒå°½å¯èƒ½ä¼ ç»Ÿ CSS æ¥è§£å†³ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜ï¼Œé‚£ä¹ˆ CSS-in-JS çš„å·¥ä½œé‡ä¼šæ¯”å¿…è¦çš„å·¥ä½œé‡å¤§ã€‚</p><h3 id="æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜-1"><a href="#æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜-1" class="headerlink" title="æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜"></a>æ²¡æœ‰ä½œç”¨åŸŸå’Œç‰¹å¼‚æ€§é—®é¢˜</h3><p>å°±åƒä¸Šé¢æ¼”ç¤ºçš„ç¤ºä¾‹ä¸€æ ·ï¼ŒCSS Module æˆåŠŸè§£å†³äº†æˆ‘ä»¬é‡åˆ°çš„ä¼ ç»Ÿæ—§å¼çš„ CSS ä½œç”¨åŸŸé—®é¢˜ã€‚ã€‚ç”±äºè§„åˆ™æ˜¯æ¾æ•£åœ°ç¼–å†™åœ¨ CSS æ¨¡å—æ–‡æ¡£ä¸­çš„ï¼Œå› æ­¤å¾ˆå°‘è§‚å¯Ÿåˆ°ä»»ä½•ç‰¹å¼‚æ€§é—®é¢˜ã€‚</p><h3 id="æœ‰ç»„ç»‡çš„ä»£ç "><a href="#æœ‰ç»„ç»‡çš„ä»£ç " class="headerlink" title="æœ‰ç»„ç»‡çš„ä»£ç "></a>æœ‰ç»„ç»‡çš„ä»£ç </h3><p>ä¿ç•™å„è‡ªå•ç‹¬çš„ CSS æ–‡ä»¶ä¼¼ä¹æ˜¯ä¸€ä¸ªé™åˆ¶ã€‚ä½†æ˜¯è¿™ä¸ªæ–¹æ³•ç¡®å®ä¿ƒè¿›äº†æ›´å¥½çš„ç»„ç»‡ç»„ä»¶ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œè¿™å°±æ˜¯æˆ‘å¦‚ä½•é€šè¿‡æŠŠä»–ä»¬åˆ†åˆ°å„è‡ªçš„æ–‡ä»¶å¤¹ä¸‹æ¥ç»„ç»‡ç»„ä»¶ï¼š</p><pre><code class="bash">- Project  - src    - components      - Button          - Button.jsx          - Button.modules.css      - Carousel          - Carousel.jsx          - Carousel.modules.css</code></pre><h3 id="ç¼“å­˜çš„å¯èƒ½"><a href="#ç¼“å­˜çš„å¯èƒ½" class="headerlink" title="ç¼“å­˜çš„å¯èƒ½"></a>ç¼“å­˜çš„å¯èƒ½</h3><p>æœ€ç»ˆæ„å»ºç”Ÿæˆçš„æç®€åŒ–çš„ CSS æ–‡ä»¶å¯ä»¥è¢«æµè§ˆå™¨ç¼“å­˜ï¼Œä»è€Œæ”¹å–„è¿ç»­é¡µé¢åŠ è½½æ—¶é—´ã€‚</p><h3 id="CSS-é¢„å¤„ç†"><a href="#CSS-é¢„å¤„ç†" class="headerlink" title="CSS é¢„å¤„ç†"></a>CSS é¢„å¤„ç†</h3><p>æ·»åŠ å¯¹ CSS é¢„å¤„ç†å™¨ï¼ˆå¦‚ PostCSSï¼ŒSASSï¼ŒLess ç­‰ï¼‰çš„æ”¯æŒå¾ˆå®¹æ˜“ã€‚ä½†æ˜¯å¿…é¡»ä¾èµ–é¢å¤–çš„åŒ…æ¥åšè¿™ä¸ªäº‹æƒ…ã€‚</p><h3 id="é›¶å­¦ä¹ æ›²çº¿"><a href="#é›¶å­¦ä¹ æ›²çº¿" class="headerlink" title="é›¶å­¦ä¹ æ›²çº¿"></a>é›¶å­¦ä¹ æ›²çº¿</h3><p>If you know how CSS works, you can use CSS Module without learning anything new besides the few points that we discussed above in the intro segment.<br>å¦‚æœä½ çŸ¥é“ CSS æ˜¯æ€ä¹ˆå·¥ä½œçš„å°±èƒ½ä½¿ç”¨ CSS Moduleï¼Œé™¤äº†ä¸Šé¢ä»‹ç»éƒ¨åˆ†è®¨è®ºçš„å‡ ç‚¹å¤–ä½ å‡ ä¹ä¸ç”¨å­¦ä¹ ä»»ä½•æ–°çš„ä¸œè¥¿ã€‚</p><h3 id="å¼ºå¤§çš„æ”¯æŒ"><a href="#å¼ºå¤§çš„æ”¯æŒ" class="headerlink" title="å¼ºå¤§çš„æ”¯æŒ"></a>å¼ºå¤§çš„æ”¯æŒ</h3><p>ä½ ä¸éœ€è¦æ·»åŠ ä»»ä½•é¢å¤–çš„åŒ…å°±èƒ½ä½¿ç”¨ CSS Moduleã€‚æ‰€æœ‰çš„ä¸»æµæ¡†æ¶å’Œåº“éƒ½æä¾›äº†å†…ç½®çš„æ”¯æŒã€‚</p><h2 id="CSS-Module-çš„åå¤„"><a href="#CSS-Module-çš„åå¤„" class="headerlink" title="CSS Module çš„åå¤„"></a>CSS Module çš„åå¤„</h2><p>å°½ç®¡ CSS Modue æä¾›äº†è®¸å¤šå¥½å¤„ï¼Œä½†æ˜¯ä»–è¿˜ä¸æ˜¯ä¸€ä¸ªå®Œç¾çš„è§£å†³æ–¹æ¡ˆã€‚ä»¥ä¸‹æ˜¯ä¸€äº›éœ€è¦ç‰¢è®°çš„æ³¨æ„äº‹é¡¹ã€‚</p><h3 id="éæ ‡å‡†çš„-global-å±æ€§"><a href="#éæ ‡å‡†çš„-global-å±æ€§" class="headerlink" title="éæ ‡å‡†çš„ :global å±æ€§"></a>éæ ‡å‡†çš„ <code>:global</code> å±æ€§</h3><p>å½“åœ¨å…¨å±€ä½œç”¨åŸŸå†…å®šä½é€‰æ‹©å™¨çš„æ—¶å€™ï¼Œä½ å¿…é¡»ä½¿ç”¨<code>:global</code>è§„åˆ™ã€‚è¿™ä¸æ˜¯ CSS è§„èŒƒçš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯è¢« JavaScript ç”¨å®ƒæ¥æ ‡è®°å…¨å±€æ ·å¼ã€‚</p><h3 id="æ²¡æœ‰åŠ¨æ€æ ·å¼"><a href="#æ²¡æœ‰åŠ¨æ€æ ·å¼" class="headerlink" title="æ²¡æœ‰åŠ¨æ€æ ·å¼"></a>æ²¡æœ‰åŠ¨æ€æ ·å¼</h3><p>å€ŸåŠ© CSS Moduleï¼Œæ‰€æœ‰çš„å£°æ˜éƒ½ä¼šè¿›å…¥å•ç‹¬çš„ CSS æ–‡ä»¶ã€‚å› æ­¤ä¸å¯èƒ½åƒ CSS-in-JS ä¸€æ ·å®ç°åŠ¨æ€æ ·å¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¸èƒ½åœ¨ CSS æ–‡ä»¶ä¸­å®ç°ä»»ä½• JavaScriptã€‚</p><h3 id="å¤–éƒ¨çš„-CSS-æ–‡ä»¶"><a href="#å¤–éƒ¨çš„-CSS-æ–‡ä»¶" class="headerlink" title="å¤–éƒ¨çš„ CSS æ–‡ä»¶"></a>å¤–éƒ¨çš„ CSS æ–‡ä»¶</h3><p>ä½ ä¸èƒ½çœç•¥ç»„ä»¶ä¸­å¸¦æœ‰ CSS æ¨¡å—çš„ CSS æ–‡ä»¶çš„ç”¨æ³•ã€‚ä½¿ç”¨ CSS æ¨¡å—çš„å”¯ä¸€å¯èƒ½æ–¹æ³•æ˜¯ç»´æŠ¤å’Œå¯¼å…¥å¤–éƒ¨ CSS æ–‡æ¡£ã€‚</p><h3 id="TypeScript-é™åˆ¶"><a href="#TypeScript-é™åˆ¶" class="headerlink" title="TypeScript é™åˆ¶"></a>TypeScript é™åˆ¶</h3><p>ä¸ºäº†åœ¨ TypeScript ä¸‹ä½¿ç”¨ CSS Module,ä½ å¿…é¡»åœ¨<code>index.d.ts</code>ä¸­æ·»åŠ  module å®šä¹‰æˆ–è€…ä½¿ç”¨<a href="https://blog.logrocket.com/how-to-configure-css-modules-webpack/">webpack loader</a>ï¼š</p><pre><code class="typescript">/** index.d.ts **/declare module &quot;*.module.css&quot;; // TS module for CSS Module filesdeclare module &quot;*.module.scss&quot;; // TS module for CSS Module files in SCSS format</code></pre><h2 id="æ¨èä½¿ç”¨-CSS-Module-çš„åœºæ™¯"><a href="#æ¨èä½¿ç”¨-CSS-Module-çš„åœºæ™¯" class="headerlink" title="æ¨èä½¿ç”¨ CSS Module çš„åœºæ™¯"></a>æ¨èä½¿ç”¨ CSS Module çš„åœºæ™¯</h2><p>å¦‚æœä½ åº”ç”¨ UI è§„æ¨¡å¤§å¹¶ä¸”å¯¹æ€§èƒ½è¦æ±‚ä¸¥è‹›ï¼ŒCSS Module æ˜¯ä¸€ä¸ªéå¸¸å¥½çš„é€‰æ‹©ã€‚ç”±äº CSS Module æä¾›çš„æ¯ä¸ªä¸œè¥¿æœ€ç»ˆéƒ½æ˜¯åŸºäºä¼ ç»Ÿçš„,éå®éªŒæ€§çš„ç”¨æ³•ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•è®©ç›‘æ§å’Œä¿®å¤æ€§èƒ½å˜å¾—æ›´å®¹æ˜“ã€‚<br>CSS Module æ–‡ä»¶éå¸¸å®¹æ˜“é€‚åº”ä½ é€‰æ‹©çš„ä»»æ„ CSS æ¡†æ¶çš„ä»£ç ï¼Œå› ä¸ºä½ éœ€è¦å¤„ç†çš„åªæœ‰ CSSã€‚å°±åƒå‰é¢è¯´çš„ï¼ŒåŸºç¡€çš„ CSS å¯¹äºè¿™ä¸ªä»»åŠ¡æ¥è¯´å·²ç»è¶³å¤Ÿäº†ã€‚</p><h2 id="ç°ä»£-CSS-ç‰¹æ€§"><a href="#ç°ä»£-CSS-ç‰¹æ€§" class="headerlink" title="ç°ä»£ CSS ç‰¹æ€§"></a>ç°ä»£ CSS ç‰¹æ€§</h2><p>åœ¨ä»‹ç»é‡Œï¼Œæˆ‘æåˆ°äº†ä¸€äº›ç°ä»£åŒ–çš„ CSS ç‰¹æ€§åœ¨æœªæ¥ä¸éœ€è¦ä¾èµ– CSS Moduleï¼ŒCSS-in-JS æˆ–è€…å…¶ä»–çš„ä¸€äº› JavaScript è§£å†³æ–¹æ¡ˆçš„æƒ…å†µä¸‹æ˜¯å¦‚ä½•ååŠ©è§£å†³ä½œç”¨åŸŸé—®é¢˜çš„ã€‚</p><p>æ–°çš„å¹¶ä¸”æ­£åœ¨è®¡åˆ’ä¸­çš„ç‰¹æ€§â€”â€”ä¾‹å¦‚ä½œç”¨åŸŸæŒ‡ä»¤å’Œ@scope ä¼ªå…ƒç´ â€”â€”æ—¨åœ¨ä½¿ç”¨ä¼ ç»Ÿçš„ CSS è§£å†³è€é—®é¢˜ã€‚åä¹‹ï¼Œè¿™ä¹Ÿä¼šå‡å°‘å¼€å‘è€…è½¬å‘ç±»ä¼¼ CSS-in-JS ä½œä¸ºè¿™äº›ç¼ºé™·çš„å˜é€šæ–¹æ³•çš„éœ€æ±‚</p><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹ç›®å‰çš„ scoped CSS è‰æ¡ˆæ˜¯å¦‚ä½•è§£å†³ CSS-in-JS ç”šè‡³ CSS Module çš„é—®é¢˜ã€‚å¯¹äºå…¶ä»–çš„ CSS å±æ€§çš„å®Œæ•´åˆ—è¡¨ï¼ŒæŸ¥çœ‹<a href="https://web.dev/state-of-css-2022/">the State of CSS 2022</a></p><h3 id="CSS-ä½œç”¨åŸŸçš„æ½œåœ¨å¯èƒ½æ€§"><a href="#CSS-ä½œç”¨åŸŸçš„æ½œåœ¨å¯èƒ½æ€§" class="headerlink" title="CSS ä½œç”¨åŸŸçš„æ½œåœ¨å¯èƒ½æ€§"></a>CSS ä½œç”¨åŸŸçš„æ½œåœ¨å¯èƒ½æ€§</h3><p>åœ¨ä» CSS è§„èŒƒä¸­å¥‡æ€ªçš„å¼•å…¥å’Œç§»é™¤<style scope>ä¹‹åï¼Œå½“å‰çš„ Scope CSS è‰æ¡ˆçœ‹ä¸Šå»å·²ç»è¶³å¤Ÿä¼˜ç§€åˆ°å»é€šè¿‡ç¼–å†™ CSS è§„åˆ™æ¥å®šä¹‰å…ƒç´ çš„ä½œç”¨åŸŸå‰æã€‚<br>Its current status involves using a directive and a pseudo-class to control the provision of scoping for a given element. Here is a rough picture of how it will lock an elementâ€™s scope within a boundary and maintain it regardless of the cascadeâ€™s rules of scoping:<br>ç›®å‰çš„çŠ¶æ€æ¶‰åŠäº†ä½¿ç”¨æŒ‡ä»¤å’Œä¼ªç±»æ¥æ§åˆ¶ä¸€ä¸ªç»™å®šçš„å…ƒç´ çš„ä½œç”¨åŸŸã€‚è¿™é‡Œæ˜¯ä¸€ä¸ªå¦‚ä½•å°†å…ƒç´ çš„ä½œç”¨åŸŸé”å®šåœ¨è¾¹ç•Œå†…å¹¶ç»´æŠ¤å®ƒçš„ç²—ç•¥å›¾ç‰‡ï¼Œè€Œä¸ç®¡çº§è”çš„ä½œç”¨åŸŸè§„åˆ™å¦‚ä½•ï¼š</p><pre><code class="html">&lt;div class=&quot;card&quot;&gt;  &lt;img src=&quot;...&quot; /&gt;  &lt;div class=&quot;content&quot;&gt;    &lt;p&gt;...&lt;/p&gt;  &lt;/div&gt;  &lt;!-- .content --&gt;&lt;/div&gt;&lt;!-- .card --&gt;&lt;style&gt;  @scope (.card) &#123;    :scope &#123;      display: grid;      ...;    &#125;    img &#123;      object-fit: cover;      ...;    &#125;    .content &#123;      ...;    &#125;  &#125;&lt;/style&gt;</code></pre><p>è¿™ä¸ªæ–°ç‰¹æ€§ä¹Ÿè®¸ä¼šæ¶ˆé™¤å¯¹äº CSS Module æˆ–è€… CSS-in-JS è§£å†³ä½œç”¨åŸŸé—®é¢˜çš„éœ€æ±‚ã€‚æˆ‘ä»¬æ‹­ç›®ä»¥å¾…ï¼Œç­‰å®ƒåœ¨æˆ‘ä»¬çš„æµè§ˆå™¨ä¸­å¯ä»¥ä½¿ç”¨çš„é‚£ä¸€å¤©ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>ä»¥ä¸Šï¼Œæˆ‘ä»¬é¦–å…ˆæåˆ°äº†å¯¹äºwebåº”ç”¨æ¥è¯´ï¼ŒCSS æ¸²æŸ“é˜»å¡æ˜¯ä¸€ä¸ªä¸»è¦çš„æ€§èƒ½é—®é¢˜ã€‚ç„¶åè®¨è®ºäº†ä¿®å¤è¿™äº›é—®é¢˜çš„éƒ¨åˆ†è§£å†³æ–¹æ¡ˆï¼Œè¿™ä¿ƒä½¿æˆ‘ä»¬æ¢ç´¢ CSS-in-JSã€CSS Moduleä»¥åŠæ–°ä½œç”¨åŸŸ CSS åŠŸèƒ½çš„å®˜æ–¹è¿›åº¦è‰æ¡ˆçš„å½“å‰çŠ¶æ€ã€‚</p><p>å¼€å‘è€…å–œæ¬¢JavaScriptï¼Œçˆ±CSS-in-JSæ˜¯å› ä¸ºå®ƒç”¨JavaScriptè¦†ç›–äº†å‡ ä¹æ‰€æœ‰çš„æ ·å¼è§’åº¦ã€‚å¦ä¸€æ–¹é¢ï¼Œè¿™äº›å–œæ¬¢CSSçš„â€”â€”å¹¶ä¸”æƒ³è®©å½“å‰çš„æŠ€æœ¯èƒ½æ”¯æŒå¼€å‘è€…å’Œç»ˆç«¯ç”¨æˆ·åŒæ ·ä¹Ÿè®¸ä¼šæ›´å–œæ¬¢CSS Moduleã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CSS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-goå‡½æ•°å‚æ•°é»˜è®¤å€¼</title>
      <link href="/2023/02/23/fan-yi-go-han-shu-can-shu-mo-ren-zhi/"/>
      <url>/2023/02/23/fan-yi-go-han-shu-can-shu-mo-ren-zhi/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://medium.com/@func25/golang-secret-how-to-add-default-values-to-function-parameters-60bd1e9625dc">https://medium.com/@func25/golang-secret-how-to-add-default-values-to-function-parameters-60bd1e9625dc</a></p><h2 id="GloLang-å°æŠ€å·§ï¼šå¦‚ä½•ç»™-Function-å‚æ•°æ·»åŠ é»˜è®¤å€¼"><a href="#GloLang-å°æŠ€å·§ï¼šå¦‚ä½•ç»™-Function-å‚æ•°æ·»åŠ é»˜è®¤å€¼" class="headerlink" title="GloLang å°æŠ€å·§ï¼šå¦‚ä½•ç»™ Function å‚æ•°æ·»åŠ é»˜è®¤å€¼?"></a>GloLang å°æŠ€å·§ï¼šå¦‚ä½•ç»™ Function å‚æ•°æ·»åŠ é»˜è®¤å€¼?</h2><p><img src="https://cdn-images-1.medium.com/max/4044/1*7PBtpnlYoSLWJMSOliQweQ.png"></p><p>ä½ æ›¾ç»å› ä¸º Go æ²¡æœ‰é»˜è®¤å‚æ•°å€¼è€Œæ„Ÿåˆ°è‹¦æ¼å—?äº‹å®ä¸Šä½ ä¸æ˜¯å”¯ä¸€ä¸€ä¸ª!è¿™ç§çƒ¦äººçš„é™åˆ¶ä¼šè®©ä½ çš„ä»£ç å†™èµ·æ¥å•è°ƒä¹å‘³ï¼Œè¯»èµ·æ¥ä¹Ÿæ›´å›°éš¾ã€‚</p><p>ä¸€ç›´ä»¥æ¥,ä½ ä¸å¾—ä¸å†™é¢å¤–çš„ä»£ç æ¥æ£€æµ‹æŸä¸ªå‚æ•°æ˜¯å¦æœ‰è¢«æä¾›ï¼Œå¦‚æœæ²¡æœ‰çš„è¯è¦ä½¿ç”¨ä¸€ä¸ªé»˜è®¤å€¼èµ‹ç»™è¿™ä¸ªå‚æ•°ã€‚</p><p>åˆ«æ‹…å¿ƒ!ç°åœ¨å·²ç»æœ‰æ–¹æ³•æ¥é¿å¼€è¿™äº›é™åˆ¶å¹¶ä¸”èƒ½æ·»åŠ é»˜è®¤å€¼åˆ° Go Function é‡Œé¢ã€‚å½“ç„¶è‚¯å®šä¸ä¼šåƒå†…ç½®çš„æ–¹æ³•é‚£æ ·æ–¹ä¾¿,ä½†æ˜¯è‡³å°‘ä½ ä¸éœ€è¦ä¸€ç›´èƒŒè´Ÿç€é™åˆ¶ã€‚</p><p>Golang å°æŠ€å·§ç³»åˆ—:</p><ul><li><p>GloLang å°æŠ€å·§ï¼šå¦‚ä½•ç»™ Function å‚æ•°æ·»åŠ é»˜è®¤å€¼? (å½“å‰ç¯‡)</p></li><li><p><a href="https://medium.com/@func25/golang-technique-custom-struct-tag-technique-in-go-8667bf7da457">GloLang å°æŠ€å·§: è‡ªå®šä¹‰ç»“æ„æ ‡ç­¾æ¯”å¦‚ <code>json:â€nameâ€</code></a></p></li></ul><h2 id="ç®€å•çš„-wrapper"><a href="#ç®€å•çš„-wrapper" class="headerlink" title="ç®€å•çš„ wrapper"></a>ç®€å•çš„ wrapper</h2><p>å®Œæˆè¿™ä»¶äº‹çš„æ–¹æ³•ä¹‹ä¸€å°±æ˜¯å®šä¹‰ä¸€ä¸ª wrapper å‡½æ•°,åœ¨è¿™ä¸ªå‡½æ•°é‡Œå°†é»˜è®¤å€¼ä½œä¸ºå‚æ•°è°ƒç”¨åŸå§‹å‡½æ•°ã€‚<br>å¦‚æœå®¢æˆ·ç«¯æ²¡æœ‰æŒ‡æ˜ name,é»˜è®¤çš„ name å°±æ˜¯â€Aidenâ€â€ã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªä½¿ç”¨ wrapper çš„æ¡ˆä¾‹ï¼š</p><pre><code class="go">    func greet(name string) string &#123;     return &quot;Hello, &quot; + name    &#125;    func greetWithDefaultAiden(name string) string &#123;     if name == &quot;&quot; &#123;      name = &quot;Aiden&quot;     &#125;     return greet(name)    &#125;    // you can have more than 1 default set    func greetWithDefaultJohn(name string) string &#123;     if name == &quot;&quot; &#123;      name = &quot;John&quot;     &#125;     return greet(name)    &#125;</code></pre><p>é€šè¿‡è¿™ç§æ–¹å¼ï¼Œå¯ä»¥åœ¨ä¸ä¿®æ”¹ greet å‡½æ•°å†…éƒ¨çš„ä»£ç çš„æƒ…å†µä¸‹ï¼Œä¸º greet å‡½æ•°è®¾ç½®é»˜è®¤å‚æ•°å€¼ã€‚</p><blockquote><p>â€œä½†æ˜¯è¿™å¯¹äºä¸€ä¸ªç®€å•çš„å‡½æ•°æ¥è¯´æ˜¯ä¸æ˜¯å¤ªè‡ƒè‚¿äº†?â€</p></blockquote><p>è¿™æ˜¯ä¸€ä¸ªä¸åˆ©ä¹‹å¤„ï¼Œå› ä¸ºå®ƒéœ€è¦ä½ å†™ä¸€äº›é¢å¤–çš„ä»£ç ï¼Œè¿™ä¼šè®©ä»£ç çš„å¯è¯»æ€§å˜å·®ã€‚</p><h2 id="éšè—å‚æ•°"><a href="#éšè—å‚æ•°" class="headerlink" title="éšè—å‚æ•°"></a>éšè—å‚æ•°</h2><p>æˆ‘ä»¬å¯ä»¥æŠŠå‡½æ•°çš„æƒ¨å‘¼æ”¾åœ¨ä¸€ä¸ªæœªå¯¼å‡ºçš„ struct ä¸­ï¼Œå…è®¸å®¢æˆ·ç«¯æŒ‰ç…§éœ€è¦åˆå§‹åŒ–è¿™äº›å‚æ•°ï¼š</p><pre><code class="go">  type greetingArguments struct &#123;    Name string    Age  int  &#125;  func GreetingArguments() greetingArguments &#123;    return greetingArguments&#123;    Name: &quot;Aiden&quot;,    Age:  30,    &#125;  &#125;</code></pre><p>ç°åœ¨å®šä¹‰ Greet å‡½æ•°:</p><pre><code class="go">    func Greet(options greetingArguments) string &#123;      return &quot;Hello, my name is &quot; + options.Name + &quot; and I am &quot; + strconv.Itoa(options.Age) + &quot; years old.&quot;    &#125;</code></pre><p>æ¯æ¬¡å®¢æˆ·ç«¯æƒ³è¦ä½¿ç”¨ Greet å‡½æ•°çš„æ—¶å€™,ä»–ä»¬å°±å¿…é¡»ä½¿ç”¨ GreetingArguments()å‡½æ•°æ¥åˆ›å»ºä¸€ä¸ª greetingArguments ç±»å‹çš„ structã€‚</p><p>è¿™ä¸ªæ–¹æ³•åªæœ‰åœ¨åœ¨ä»åŒ…å¤–è€Œä¸æ˜¯åŒ…å†…è°ƒç”¨å‡½æ•°æ—¶æœ‰æ•ˆã€‚</p><p>å¦å¤–ä¸€ä¸ªé€‰æ‹©å°±æ˜¯ä½¿ç”¨ functional options patternï¼Œå®ƒå¯ä»¥è®©ä½ å‘å‡½æ•°ä¼ é€’æ•°é‡å¯å˜çš„é€‰é¡¹ä½œä¸ºå‚æ•°ã€‚è¿™ä¸ªæ–¹æ³•æ›´çµæ´»ï¼Œä»£ç å¯è¯»æ€§ä¹Ÿæ›´å¥½ï¼Œä½†æ˜¯ä¹Ÿä¼šè®©ä½ çš„ä»£ç æ›´åŠ å¤æ‚ã€‚</p><h2 id="Functional-options-pattern-åŠŸèƒ½é€‰é¡¹æ¨¡å¼"><a href="#Functional-options-pattern-åŠŸèƒ½é€‰é¡¹æ¨¡å¼" class="headerlink" title="Functional options pattern åŠŸèƒ½é€‰é¡¹æ¨¡å¼"></a>Functional options pattern åŠŸèƒ½é€‰é¡¹æ¨¡å¼</h2><p>è¿™ä¸ªæ¨¡å¼å·²ç»è¢«å¾ˆå¤šåº“é‡‡ç”¨äº†ã€‚åœ¨æœ¬ç« èŠ‚ä¸­ï¼Œæˆ‘ä¼šä¸€æ­¥ä¸€æ­¥å¸¦ä½ ä½“éªŒå¦‚ä½•ä½¿ç”¨å®ƒï¼š</p><ol><li>åˆ›å»ºä¸€ä¸ª struct,ä¿å­˜æœ‰ä¸¤ä¸ªå­—æ®µçš„å‚æ•°ï¼šName å’Œ ageã€‚</li></ol><pre><code class="go">type GreetingOptions struct &#123;  Name string  Age int&#125;</code></pre><ol start="2"><li>ç°åœ¨é¡¶ä¸€ä¸ª Greet å‡½æ•°ï¼Œå°†æ–°çš„ struct ä½œä¸ºä¸€ä¸ªå‚æ•°:</li></ol><pre><code class="go">func Greet(options GreetingOptions) string &#123;  return &quot;Hello, my name is &quot; + options.Name + &quot; and I am &quot; + strconv.Itoa(options.Age) + &quot; years old.&quot;&#125;</code></pre><ol start="3"><li>ä¸º struct ä¸­çš„å­—æ®µå®šä¹‰åŠŸèƒ½é€‰é¡¹æ˜¯å¾ˆæœ‰è¶£çš„å†…å®¹:</li></ol><pre><code class="go">type GreetingOption func(*GreetingOptions)func WithName(name string) GreetingOption &#123;  return func(o *GreetingOptions) &#123;    o.Name = name  &#125;&#125;func WithAge(age int) GreetingOption &#123;  return func(o *GreetingOptions) &#123;    o.Age = age  &#125;&#125;</code></pre><ol start="4"><li>ä½¿ç”¨æ–°ç±»å‹<strong>GreetingOption</strong> åˆ›å»º wrapper:</li></ol><pre><code class="go">func GreetWithDefaultOptions(options ...GreetingOption) string &#123;  opts := GreetingOptions&#123;    Name: &quot;Aiden&quot;,    Age: 30,  &#125;  for _, o := range options &#123;    o(&amp;opts)  &#125;  return Greet(opts)&#125;</code></pre><p>GreetWithDefaultOptions å‡½æ•°ä¸º GreetingOptions struct çš„ Name(&#x3D; â€œAidenâ€)å’Œ Age (&#x3D; 30) å­—æ®µè®¾ç½®äº†é»˜è®¤å€¼ï¼Œç„¶åå°†ä½œä¸ºå‚æ•°ä¼ é€’çš„é€‰é¡¹åº”ç”¨åˆ°è¯¥ structã€‚</p><p>æœ€åï¼Œä½¿ç”¨ä¿®æ”¹åçš„ struct ä½œä¸ºå‚æ•°è°ƒç”¨ Greet å‡½æ•°</p><p>ä¸ºäº†ä½¿ç”¨è¿™æ®µä»£ç ï¼Œä½ å¯ä»¥è°ƒç”¨ä½¿ç”¨ä½ éœ€è¦çš„é€‰é¡¹è°ƒç”¨ GreetWithDefaultOptions å‡½æ•°ï¼š</p><pre><code class="go">  greeting := GreetWithDefaultOptions(WithName(&quot;Alice&quot;), WithAge(20))  // &quot;Hello, my name is Alice and I am 20 years old.&quot;</code></pre><p>è®¸å¤šåº“éƒ½ä½¿ç”¨äº† åŠŸèƒ½é€‰é¡¹æ¨¡å¼ï¼Œè¿™å…¶ä¸­åŒ…æ‹¬ mongodb, aws-sdk-go, gorm, cli å’Œè®¸å¤šå…¶ä»–çš„åº“</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webæœåŠ¡æ„å»º</title>
      <link href="/2023/02/22/web-fu-wu-gou-jian/"/>
      <url>/2023/02/22/web-fu-wu-gou-jian/</url>
      
        <content type="html"><![CDATA[<h2 id="iam-api-server-æœåŠ¡"><a href="#iam-api-server-æœåŠ¡" class="headerlink" title="iam-api-server æœåŠ¡"></a>iam-api-server æœåŠ¡</h2><p>æœ¬è´¨ï¼šweb æœåŠ¡,é€šè¿‡ä¸€ä¸ªåä¸º iam-api_server çš„è¿›ç¨‹ï¼Œå¯¹å¤–æä¾› RESTful API æ¥å£ï¼Œå®Œæˆç”¨æˆ·ã€å¯†é’¥ã€ç­–ç•¥ä¸‰ç§ REST èµ„æºçš„å¢åˆ æ”¹æŸ¥ã€‚</p><h3 id="åŠŸèƒ½"><a href="#åŠŸèƒ½" class="headerlink" title="åŠŸèƒ½"></a>åŠŸèƒ½</h3><h4 id="è®¤è¯ç›¸å…³æ¥å£"><a href="#è®¤è¯ç›¸å…³æ¥å£" class="headerlink" title="è®¤è¯ç›¸å…³æ¥å£"></a>è®¤è¯ç›¸å…³æ¥å£</h4><img src="/2023/02/22/web-fu-wu-gou-jian/authn.webp" class=""><h4 id="ç”¨æˆ·ç›¸å…³æ¥å£"><a href="#ç”¨æˆ·ç›¸å…³æ¥å£" class="headerlink" title="ç”¨æˆ·ç›¸å…³æ¥å£"></a>ç”¨æˆ·ç›¸å…³æ¥å£</h4><img src="/2023/02/22/web-fu-wu-gou-jian/user.webp" class=""><h4 id="å¯†é’¥ç›¸å…³æ¥å£"><a href="#å¯†é’¥ç›¸å…³æ¥å£" class="headerlink" title="å¯†é’¥ç›¸å…³æ¥å£"></a>å¯†é’¥ç›¸å…³æ¥å£</h4><img src="/2023/02/22/web-fu-wu-gou-jian/key.webp" class=""><h4 id="ç­–ç•¥ç›¸å…³æ¥å£"><a href="#ç­–ç•¥ç›¸å…³æ¥å£" class="headerlink" title="ç­–ç•¥ç›¸å…³æ¥å£"></a>ç­–ç•¥ç›¸å…³æ¥å£</h4><img src="/2023/02/22/web-fu-wu-gou-jian/policy.webp" class=""><h3 id="ä½¿ç”¨æ–¹æ³•"><a href="#ä½¿ç”¨æ–¹æ³•" class="headerlink" title="ä½¿ç”¨æ–¹æ³•"></a>ä½¿ç”¨æ–¹æ³•</h3><p>å®¢æˆ·ç«¯ã€å‰ç«¯ï¼ŒAPI è°ƒç”¨ï¼ŒSDK,iamctlã€‘éƒ½å¯ä»¥è®¿é—® iam-api_serverï¼Œæœ€ç»ˆéƒ½ä¼šæ‰§è¡Œ HTTP è¯·æ±‚ï¼Œè°ƒç”¨ iam-api_server æä¾›çš„ RESTful API æ¥å£,æ‰€ä»¥éœ€è¦ä¸€ä¸ª REST API å®¢æˆ·ç«¯å·¥å…·â€”â€”curl æ¥æ‰§è¡Œ HTTP è¯·æ±‚ã€‚</p><pre><code class="plain">-X/--request [GET|POST|PUT|DELETE|â€¦]  æŒ‡å®šè¯·æ±‚çš„ HTTP æ–¹æ³•-H/--header                           æŒ‡å®šè¯·æ±‚çš„ HTTP Header-d/--data                             æŒ‡å®šè¯·æ±‚çš„ HTTP æ¶ˆæ¯ä½“ï¼ˆBodyï¼‰-v/--verbose                          è¾“å‡ºè¯¦ç»†çš„è¿”å›ä¿¡æ¯-u/--user                             æŒ‡å®šè´¦å·ã€å¯†ç -b/--cookie                           è¯»å– cookie-s/--silent                           å®‰é™æ¨¡å¼-S                                    å¼ºåˆ¶å±•ç¤ºé”™è¯¯</code></pre><ol><li>ç™»å½• api-server,è·å– token</li></ol><pre><code class="bash">$ curl -s -XPOST -H&quot;Authorization: Basic `echo -n &#39;admin:Admin@2021&#39;|base64`&quot; http://127.0.0.1:8080/login | jq -r .token# å°†tokenè®¾ç½®ä¸ºç¯å¢ƒå˜é‡TOKEN=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2MzUwNTk4NDIsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MjcyODM4NDIsInN1YiI6ImFkbWluIn0.gTS0n-7njLtpCJ7mvSnct2p3TxNTUQaduNXxqqLwGfI</code></pre><ol start="2"><li>åˆ›å»ºä¸€ä¸ªåä¸º secret0 çš„ secret</li></ol><pre><code class="bash">curl -v -XPOST -H &quot;Content-Type: application/json&quot; -H&quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -d&#39;&#123;&quot;metadata&quot;:&#123;&quot;name&quot;:&quot;secret0&quot;&#125;,&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret&quot;&#125;&#39; http://iam.api.marmotedu.com:8080/v1/secrets</code></pre><ol start="3"><li>è·å– secret0 çš„è¯¦ç»†ä¿¡æ¯</li></ol><pre><code class="bash">curl -XGET -H&quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; http://iam.api.marmotedu.com:8080/v1/secrets/secret0</code></pre><ol start="4"><li>æ›´æ–° secret0 çš„æè¿°</li></ol><pre><code class="bash">curl -XPUT -H&quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; -d&#39;&#123;&quot;metadata&quot;:&#123;&quot;name&quot;:&quot;secret&quot;&#125;,&quot;expires&quot;:0,&quot;description&quot;:&quot;admin secret(modify)&quot;&#125;&#39; http://iam.api.marmotedu.com:8080/v1/secrets/secret0</code></pre><ol start="5"><li>è·å– secret åˆ—è¡¨</li></ol><pre><code class="bash">curl -XGET -H&quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; http://iam.api.marmotedu.com:8080/v1/secrets</code></pre><ol start="6"><li>åˆ é™¤ secret0s</li></ol><pre><code class="bash">curl -XDELETE -H&quot;Authorization: Bearer $&#123;TOKEN&#125;&quot; http://iam.api.marmotedu.com:8080/v1/secrets/secret0</code></pre><p>CRUD:<br>Cï¼šåˆ›å»º<br>Rï¼šè·å–æ•°æ®<br>Uï¼šä¿®æ”¹æ›´æ–°<br>Dï¼šåˆ é™¤</p><h3 id="ä»£ç å®ç°"><a href="#ä»£ç å®ç°" class="headerlink" title="ä»£ç å®ç°"></a>ä»£ç å®ç°</h3>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-chatGPT</title>
      <link href="/2023/02/21/fan-yi-chatgpt/"/>
      <url>/2023/02/21/fan-yi-chatgpt/</url>
      
        <content type="html"><![CDATA[<h2 id="ä¸€ä»½é¢å‘èµ·æ­¥ç”¨æˆ·çš„chatGPTæŒ‡å—ï¼šç†è§£ä»–æ˜¯ä»€ä¹ˆï¼Ÿä»–ä¸ºä»€ä¹ˆéå¸¸æœ‰æ„ä¹‰ï¼Œä»¥åŠä½•æ—¶-x2F-ä½•åœ°ä½¿ç”¨å®ƒã€‚"><a href="#ä¸€ä»½é¢å‘èµ·æ­¥ç”¨æˆ·çš„chatGPTæŒ‡å—ï¼šç†è§£ä»–æ˜¯ä»€ä¹ˆï¼Ÿä»–ä¸ºä»€ä¹ˆéå¸¸æœ‰æ„ä¹‰ï¼Œä»¥åŠä½•æ—¶-x2F-ä½•åœ°ä½¿ç”¨å®ƒã€‚" class="headerlink" title="ä¸€ä»½é¢å‘èµ·æ­¥ç”¨æˆ·çš„chatGPTæŒ‡å—ï¼šç†è§£ä»–æ˜¯ä»€ä¹ˆï¼Ÿä»–ä¸ºä»€ä¹ˆéå¸¸æœ‰æ„ä¹‰ï¼Œä»¥åŠä½•æ—¶&#x2F;ä½•åœ°ä½¿ç”¨å®ƒã€‚"></a>ä¸€ä»½é¢å‘èµ·æ­¥ç”¨æˆ·çš„chatGPTæŒ‡å—ï¼šç†è§£ä»–æ˜¯ä»€ä¹ˆï¼Ÿä»–ä¸ºä»€ä¹ˆéå¸¸æœ‰æ„ä¹‰ï¼Œä»¥åŠä½•æ—¶&#x2F;ä½•åœ°ä½¿ç”¨å®ƒã€‚</h2><p><img src="https://cdn-images-1.medium.com/max/2000/0*bFu1qQNJn5YloboI.png"></p><h3 id="ä»€ä¹ˆæ˜¯ChatGPT"><a href="#ä»€ä¹ˆæ˜¯ChatGPT" class="headerlink" title="ä»€ä¹ˆæ˜¯ChatGPT?"></a><strong>ä»€ä¹ˆæ˜¯ChatGPT?</strong></h3><p>ChatGPT,æ˜¯chat-based Generative Pre-trained Transformerçš„ç¼©å†™ï¼Œå®ƒæ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥è·¨é¢†åŸŸä»¥å„ç§å„æ ·çš„æ–¹å¼è¢«ç”¨æ¥æé«˜ç”Ÿäº§åŠ›ã€‚</p><p>ChatGPTæ˜¯ä¸€ç§äººå·¥æ™ºèƒ½(AI)ç§‘æŠ€ï¼Œå®ƒä½œä¸º<a href="https://en.wikipedia.org/wiki/Natural_language_processing">è‡ªç„¶è¯­è¨€å¤„ç†</a> (NLP)æ¨¡å‹è¢«è®¤è¯†ï¼Œå®ƒæ˜¯ç”±AIç ”ç©¶å’Œå¼€å‘å…¬å¸<a href="https://openai.com/">OpenAI</a>åˆ›å»ºçš„ã€‚å®ƒä½¿ç”¨æœºå™¨å­¦ä¹ ç®—æ³•æ¥åˆ†æå’Œç†è§£è¢«å†™å‡ºæ¥æˆ–è¯»å‡ºæ¥çš„è¯­è¨€ï¼Œç„¶ååŸºäºè¾“å…¥ç”Ÿæˆç›¸åº”å†…å®¹ã€‚ChatGPTæ¥å—äº†éš¾ä»¥ç½®ä¿¡çš„æµ·é‡æ–‡æœ¬æ•°æ®è®­ç»ƒï¼Œè¿™è®©å®ƒå¯ä»¥ç†è§£ä¸Šä¸‹æ–‡å’Œå•è¯å’ŒçŸ­è¯­çš„æ„æ€ï¼Œç”Ÿæˆé«˜åº¦ç›¸å…³çš„æƒ…å¢ƒå“åº”ã€‚</p><h3 id="ä¸ºä»€ä¹ˆChatGPTéå¸¸æœ‰æ„ä¹‰"><a href="#ä¸ºä»€ä¹ˆChatGPTéå¸¸æœ‰æ„ä¹‰" class="headerlink" title="ä¸ºä»€ä¹ˆChatGPTéå¸¸æœ‰æ„ä¹‰?"></a>ä¸ºä»€ä¹ˆChatGPTéå¸¸æœ‰æ„ä¹‰?</h3><p>ä½ çœŸçš„å¿…é¡»<a href="https://chat.openai.com/">ä½“éªŒä¸€ä¸‹</a>æ‰èƒ½å®Œå…¨ç†è§£å®ƒçš„æ½œåŠ›ï¼Œä½†æ˜¯æˆ‘å°†å°è¯•ç”¨ç±»æ¯”æˆ–è€…æ¯”å–»çš„æ–¹å¼æ¥è§£é‡Šã€‚å¦‚æœä½ çœ‹è¿‡é’¢é“ä¾ ç”µå½±ï¼Œä½ å¯èƒ½å¯¹Tony Starrkéå¸¸ä¿¡ä»»çš„AIåŠ©æ‰‹ Jarvisæ„Ÿè§‰éå¸¸ç†Ÿæ‚‰ã€‚ä½ å¯ä»¥æŠŠchatGPTè®¤ä¸ºæ˜¯å¹´è½»ç‰ˆæœ¬çš„Jarvisã€‚ChatGPT å¯ä»¥éå¸¸é«˜æ•ˆåœ°ç”¨äºä»¥é«˜åº¦ç²¾ç¡®çš„æ–¹å¼æœ€å¤§é™åº¦åœ°æ”¶é›†ã€æ€»ç»“ã€æç‚¼ã€ä¿®æ”¹å’ŒéªŒè¯ä¿¡æ¯ã€‚ å¯ä»¥è¯´æ˜¯ä¸€ç§èƒ½é‡å¢å¼ºå™¨ã€‚</p><h3 id="å¦‚ä½•ä½¿ç”¨-ChatGPT"><a href="#å¦‚ä½•ä½¿ç”¨-ChatGPT" class="headerlink" title="å¦‚ä½•ä½¿ç”¨ ChatGPT"></a><strong>å¦‚ä½•ä½¿ç”¨ ChatGPT</strong></h3><p>ChatGPT (åœ¨å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™) å¯ä»¥é€šè¿‡webä¸Šçš„ç½‘é¡µ <a href="https://chat.openai.com/">chat.openai.com</a>è‡ªç”±è®¿é—®ã€‚ä½¿ç”¨å®ƒä½ åªéœ€è¦ç®€å•åœ°åˆ›å»ºä¸€ä¸ªè´¦å·ï¼Œç™»å½•ç„¶åå¼€å§‹åœ¨èŠå¤©ç®±ä¸­è¾“å…¥ä½ çš„æç¤ºã€‚</p><p>å½“åˆ¶å®šä¸€ä¸ªé—®é¢˜è¯¢é—®chatGPTçš„æ—¶å€™ï¼Œä¸ºäº†è·å–æœ€å‡†ç¡®å’Œå…³è”åº¦æœ€é«˜çš„å›åº”ï¼Œç®€æ˜æ‰¼è¦æ˜¯éå¸¸é‡è¦çš„ã€‚è¿™æ„å‘³ç€ä½ éœ€è¦é¿å¼€å«ç³Šä¸æ¸…æˆ–è€…æ¨¡æ£±ä¸¤å¯çš„è¯­è¨€ï¼Œæä¾›å…·ä½“ç»†èŠ‚å’ŒæŒ‡ä»¤è®©chatGPTç”Ÿæˆå›åº”å†…å®¹ã€‚</p><p>ä½“éªŒchatGPTå¼ºå¤§èƒ½åŠ›çš„æ–¹æ³•ä¹‹ä¸€å°±æ˜¯æå‡ºåç»­é—®é¢˜æ¥å®Œå–„å®ƒä¸ºæ‚¨æä¾›çš„å›å¤ã€‚<br>**æ¯”å¦‚ï¼š</p><blockquote><p> â€œä¸ºè½¯ä»¶æœåŠ¡ç”Ÿæˆä¸€ä¸ªå•†ä¸šçµæ„Ÿâ€</p></blockquote><p><img src="https://cdn-images-1.medium.com/max/2316/1*yLEDyWYiz_KOSVM-rS1fiw.png"></p><blockquote><p> â€œç°åœ¨è¯·ä¸ºè¿™ä¸ªçµæ„Ÿåˆ›å»ºä¸€ä»½æœ‰6ä¸ªæ®µè½çš„å•†ä¸šè®¡åˆ’ä¹¦ï¼Œç€é‡å¼ºè°ƒå•†å“ç‰¹å¾â€</p></blockquote><p><img src="https://cdn-images-1.medium.com/max/2000/1*7n0sDaOolngcQ0pqHmCNxA.png"></p><blockquote><p> â€œç°åœ¨è¯·ä¸ºè¿™é¡¹ä¸šåŠ¡åˆ›å»ºä¸€ä¸ªä¸è¶…è¿‡ä¸€æ®µçš„ç”µæ¢¯æ¸¸è¯´ï¼Œå¹¶å¼ºè°ƒå¯¹å®¢æˆ·çš„å¥½å¤„â€</p></blockquote><p><img src="https://cdn-images-1.medium.com/max/2000/1*TLxW_YVpLkEI_ch5c7Q4Uw.png"></p><p>æ­£å¦‚ä½ æ‰€è§ï¼Œè¿½é—®è®©ä½ æç‚¼äº†åˆæ¬¡å“åº”çš„å†…å®¹ï¼Œå¹¶ä¸”è·å¾—äº†æ›´å¤šå…·ä½“å’Œè¯¦ç»†çš„ä¿¡æ¯ã€‚</p><p>å¦å¤–ä¸€ä¸ªæç‚¼chatGPTå“åº”å†…å®¹çš„æ–¹å¼æ˜¯æä¾›é¢å¤–çš„æ–‡æœ¬æˆ–è€…ä¿¡æ¯ã€‚æ¯”å¦‚ï¼Œå¦‚æœä½ é—®chatGPT,â€ä½ èƒ½ç”¨å›¾è¡¨å’Œå›¾å½¢ç”Ÿæˆæˆ‘ä»¬å­£åº¦é”€å”®æ•°æ®çš„æŠ¥å‘Šå—ï¼Ÿâ€ï¼Œä½ å¯ä»¥æä¾›é¢å¤–çš„ç»†èŠ‚ï¼Œç±»ä¼¼ä½ æƒ³åœ¨æŠ¥å‘Šé‡ŒåŒ…å«çš„é”€å”®æ•°æ®çš„æ—¶é—´æ®µå’Œå…·ä½“çš„å›¾è¡¨ç±»å‹ã€‚è¿™ä¸ªé¢å¤–çš„ä¿¡æ¯å¯ä»¥å¸®åŠ©chatGPTç”Ÿæˆæ›´å‡†ç¡®å’Œç›¸å…³çš„å›åº”ã€‚</p><p>æ€»ä¹‹ï¼Œè·å–åˆ°æ›´å¤šchatGPTdçš„è¾“å‡ºçš„å…³é”®æ˜¯ï¼šæä¾›æ¸…æ™°ï¼Œç®€ä»‹å…·ä½“çš„çš„æŸ¥è¯¢è¯­å¥ï¼Œæ¸è¿›å¼çš„é—®é¢˜å’Œé¢å¤–çš„ä¸Šä¸‹æ–‡æ¥ç»†åŒ–ç›¸åº”å†…å®¹ã€‚</p><h3 id="ä½•å¤„-x2F-ä½•æ—¶ä½¿ç”¨-ChatGPT"><a href="#ä½•å¤„-x2F-ä½•æ—¶ä½¿ç”¨-ChatGPT" class="headerlink" title="ä½•å¤„&#x2F;ä½•æ—¶ä½¿ç”¨ ChatGPT"></a>ä½•å¤„&#x2F;ä½•æ—¶ä½¿ç”¨ ChatGPT</h3><p>GPTChat ä¹‹æ‰€ä»¥å¦‚æ­¤å¼ºå¤§ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥æ‰©å±•åˆ°å¹¿æ³›çš„ç”¨é€”ã€‚ æ— è®ºæ˜¯æ•°å­¦é—®é¢˜è¿˜æ˜¯ä¼šè®¡é—®é¢˜ã€ç”ŸæˆæŠ¥å‘Šã€æ¼”ç¤ºè„šæœ¬ã€åšå®¢æ–‡ç« ã€æ•™ç¨‹ã€ä¸Šè¿°ä¸šåŠ¡è®¡åˆ’æˆ–ä»£ç ç‰‡æ®µç­‰ï¼Œæœ‰è¿‘ä¹æ— ç©·çš„å¯èƒ½æ€§ã€‚</p><p>ä¸ºäº†å¸®åŠ©ä½ äº†è§£å¯ä»¥ä»å“ªé‡Œå¼€å§‹ï¼Œè¿™é‡Œæœ‰å…«ä¸ªç§ç±»å¯ä»¥ä½¿ç”¨ ChatGPT æ¥æé«˜æ•ˆç‡å’Œç”Ÿäº§åŠ›ï¼š</p><ol><li><strong>é‚®ä»¶å›å¤:</strong>  chatGPTå¯ä»¥ç”¨æ¥ç”Ÿæˆå®šåˆ¶åŒ–å’Œå¸å¼•äººçš„ç”µå­é‚®ä»¶å›å¤ï¼ŒèŠ‚çœæ—¶é—´å’Œç¡®ä¿é‡è¦çš„ä¿¡æ¯å¯ä»¥è¿…é€Ÿå’Œä¸“ä¸šåœ°è¢«å›åº”ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œä½ å¯ä»¥é—®chatGPT,â€æœ‰æ²¡æœ‰ä»€ä¹ˆç¤¼è²Œä¸”ä¸“ä¸šçš„æ–¹å¼å›å¤è¿™ä¸ªé‚®ä»¶è¯·æ±‚?â€ã€‚</li><li><strong>æ–‡æ¡£ç”Ÿæˆ:</strong>  chatGPTå¯ä»¥æä¾›ä¸€äº›å…³é”®ç»†èŠ‚ç„¶åè®©chatGPTåšå‰©ä¸‹çš„å·¥ä½œçš„æ–¹å¼æ¥ç”Ÿæˆæ–‡æ¡£ï¼Œæ¯”å¦‚æŠ¥å‘Š,å±•ç¤ºå’Œææ¡ˆã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥é—®â€ä½ èƒ½ç”¨å›¾è¡¨å’Œå›¾å½¢ç”Ÿæˆå­£åº¦é”€å”®æ•°æ®çš„æŠ¥å‘Šå—?â€</li><li><strong>æ•°æ®åˆ†æ:</strong> chatGPTå¯ä»¥åˆ†æå¤§é‡çš„æ•°æ®ï¼Œç¡®å®šå…³é”®è¶‹åŠ¿å’Œè§‚ç‚¹ï¼Œå¸®åŠ©å›¢é˜Ÿåšå‡ºæ›´å¥½çš„æ•°æ®é©±åŠ¨çš„å†³å®šã€‚æ¯”å¦‚ï¼Œä½ å¯ä»¥é—®â€åœ¨è¿‡å»åå¹´æˆ‘ä»¬çš„é”€å”®æ•°æ®é‡Œå…³é”®è¶‹åŠ¿æ˜¯ä»€ä¹ˆ?â€</li><li><strong>å®¢æˆ·æœåŠ¡:</strong> chatGPTå¯ä»¥å¤„ç†å¸¸è§„çš„å®¢æˆ·å’¨è¯¢ï¼Œæä¾›åŠæ—¶å’Œå‡†ç¡®çš„å›åº”ï¼Œä»è€Œä½¿å®¢æˆ·æœåŠ¡ä»£è¡¨è…¾å‡ºæ—¶é—´æ¥ä¸“æ³¨äºæ›´å¤æ‚å’Œæ›´å…·æŒ‘æˆ˜æ€§çš„é—®é¢˜ã€‚ æ¯”å¦‚ä½ å¯ä»¥é—® ChatGPTï¼Œâ€å¤„ç†å®¢æˆ·æŠ•è¯‰ç¼ºé™·äº§å“çš„æœ€ä½³æ–¹æ³•æ˜¯ä»€ä¹ˆ?â€</li><li><strong>é¡¹ç›®ç®¡ç†ï¼š</strong> chatGPTå¯ä»¥ç®¡ç†é¡¹ç›®ä»»åŠ¡å’Œæˆªæ­¢æ—¶é—´ï¼Œè®©å›¢é˜Ÿæˆå‘˜ä¿¡æ¯çµé€šï¼ŒæŒ‰è®¡åˆ’å®Œæˆé‡è¦çš„é‡Œç¨‹ç¢‘å’Œæˆªæ­¢æœŸã€‚æ¯”å¦‚ä½ å¯ä»¥é—®ï¼šâ€æˆ‘ä»¬é¡¹ç›®çš„ä¸‹ä¸€æ­¥æ˜¯ä»€ä¹ˆï¼Œä»€ä¹ˆæ—¶å€™ç»“æŸ?â€</li><li><strong>å•†ä¸šç†å¿µ&amp; è®¡åˆ’:</strong> ChatGPT è¿˜å¯ä»¥é€šè¿‡æä¾›ä¸€äº›å…³äºè¡Œä¸šå’Œå¸‚åœºçš„ç»†èŠ‚ï¼Œè®© ChatGPT ç”Ÿæˆæ½œåœ¨çš„æ¦‚å¿µå’Œæƒ³æ³•ï¼Œä»è€Œäº§ç”Ÿæ–°çš„å•†ä¸šæ„æ€ã€‚è¿™å¯ä»¥å¸®åŠ©ä¼ä¸šå®¶å’Œå•†ä¸šé¢†è¢–ä¸ºæ–°äº§å“ã€æœåŠ¡å’Œä¼ä¸šäº§ç”Ÿåˆ›é€ æ€§å’Œåˆ›æ–°æ€§çš„æƒ³æ³•ã€‚æ¯”å¦‚ä½ å¯ä»¥é—®ï¼šâ€èƒ½ä¸ºæ–°çš„å¥åº·è¡Œä¸šçš„è½¯ä»¶æœåŠ¡ç”Ÿæˆæ–°çš„å•†ä¸šæƒ³æ³•ä¹ˆï¼Ÿâ€</li><li><strong>ä»£ç ç”Ÿæˆå’Œè°ƒè¯•:</strong> ChatGPT è¿˜å¯ç”¨äºç”Ÿæˆä»£ç å¹¶è¯†åˆ«å’Œä¿®å¤ç°æœ‰ä»£ç ä¸­çš„é”™è¯¯ã€‚é€šè¿‡æä¾›æœ‰å…³æ‰€éœ€åŠŸèƒ½çš„ä¸€äº›è¯¦ç»†ä¿¡æ¯ï¼ŒChatGPT å¯ä»¥ç”Ÿæˆå¯ç”±å¼€å‘äººå‘˜è‡ªå®šä¹‰å’Œå®Œå–„çš„å·¥ä½œä»£ç ã€‚ æ­¤å¤–ï¼ŒChatGPT å¯ç”¨äºé€šè¿‡è¯†åˆ«å¹¶æä¾›ä¿®å¤å¸¸è§ç¼–ç é”™è¯¯å’Œæ¼æ´çš„å»ºè®®æ¥è°ƒè¯•ä»£ç ã€‚ ä¾‹å¦‚ï¼Œä½ å¯ä»¥é—® ChatGPTï¼Œâ€èƒ½å¦ç”Ÿæˆä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—æ•°å­—åˆ—è¡¨çš„å¹³å‡å€¼ï¼Œå¹¶è¯†åˆ«ä»¥ä¸‹ä»£ç ä¸­çš„ä»»ä½•è¯­æ³•é”™è¯¯?â€</li><li><strong>æŠ€æœ¯æ•™ç¨‹ï¼š</strong> ChatGPTå¯ç”¨äºç”ŸæˆæŠ€æœ¯æ•™ç¨‹å’Œæ–‡æ¡£ï¼Œæä¾›ä½¿ç”¨å„ç§è½¯ä»¶å’Œå·¥å…·çš„åˆ†æ­¥è¯´æ˜ã€‚ è¿™å¯ä»¥èŠ‚çœæ—¶é—´å¹¶æé«˜æŠ€æœ¯æ•™ç¨‹çš„å‡†ç¡®æ€§å’Œè´¨é‡ï¼Œä½¿ç”¨æˆ·æ›´å®¹æ˜“å­¦ä¹ å’Œç†è§£å¤æ‚çš„æ¦‚å¿µå’Œç¨‹åºã€‚ ä¾‹å¦‚ï¼Œå¯ä»¥é—® ChatGPTï¼Œâ€èƒ½å¦æä¾›æœ‰å…³å¦‚ä½•ä½¿ç”¨ XYZ è½¯ä»¶çš„æ•™ç¨‹ï¼ŒåŒ…æ‹¬å±å¹•æˆªå›¾å’Œæ¯ä¸ªæ­¥éª¤çš„æ¸…æ™°è¯´æ˜?â€</li></ol><h2 id="æ³¨æ„äº‹é¡¹å’Œå±€é™"><a href="#æ³¨æ„äº‹é¡¹å’Œå±€é™" class="headerlink" title="æ³¨æ„äº‹é¡¹å’Œå±€é™"></a>æ³¨æ„äº‹é¡¹å’Œå±€é™</h2><p>ç°åœ¨ï¼ŒChatGPT è¿›å…¥äº†ä»¤äººéš¾ä»¥ç½®ä¿¡çš„å‘å±•ï¼Œä½†å®ƒä»ç„¶æ˜¯æ–°å…´æŠ€æœ¯ï¼Œå› æ­¤æœ‰ä¸€äº›å±€é™æ€§ã€‚ ChatGPT æœ€é€‚åˆç”¨äºå†…å®¹åˆ›ä½œå’Œæ„æ€ç­‰åˆ›é€ æ€§æ´»åŠ¨ã€‚ å®ƒåœ¨ä»¥ä¸‹æ–¹é¢ä»ç„¶ä¸æ“…é•¿ï¼šå¤æ‚çš„æ•°å­¦ã€è§£å†³ SAT æˆ– IQ ç±»å‹çš„æµ‹è¯•é—®é¢˜ã€ä»äº’è”ç½‘ä¸Šæœç´¢æ•°æ®ï¼ˆä½†æ˜¯â€¦â€¦ChatGPT å½“å‰æœªè¿æ¥åˆ°å¼€æ”¾çš„äº’è”ç½‘ï¼‰ã€æä¾›å…¶å“åº”çš„æ¥æºã€ç¼–å†™é«˜è´¨é‡çš„å¥å£®çš„ä»£ç ç­‰</p><p>ç›®å‰ ChatGPT åº”è¯¥è¢«è§†ä¸ºå¯¹æœªæ¥çš„ä¸€ç¥ï¼Œå³äººå·¥æ™ºèƒ½ä»¥æœ‰æ„ä¹‰çš„æ–¹å¼å¸®åŠ©äººç±»çš„ä»¤äººå…´å¥‹çš„æœªæ¥</p><p>æ€»çš„æ¥è¯´ï¼ŒChatGPT æ˜¯ä¸€ä¸ªå¤šåŠŸèƒ½ä¸”åŠŸèƒ½å¼ºå¤§çš„å·¥å…·ï¼Œå¯ä»¥é€šè¿‡å¤šç§æ–¹å¼ä½¿ç”¨ã€‚ ç°åœ¨è¿˜å¤„äºæ—©æœŸï¼Œä½†æˆ‘ç›¸ä¿¡åƒè¿™æ ·çš„æŠ€æœ¯ä»£è¡¨äº†äººå·¥æ™ºèƒ½è¾…åŠ©ç”Ÿäº§åŠ›çš„èŒƒå¼è½¬å˜ã€‚ ChatGPT æˆ–ç±»ä¼¼çš„ä¸œè¥¿å¾ˆå¯èƒ½æˆä¸ºä»»ä½•å¸Œæœ›æé«˜äº§å‡ºå’Œæ•ˆç‡çš„äººçš„å®è´µå·¥å…·ã€‚<br>é‚£ä¹ˆï¼Œæ¥ä¸‹æ¥ä½ æ‰“ç®—ç”¨è¿™ä¸ªå¤©æ‰AIä¸ªäººåŠ©ç†åšä»€ä¹ˆå‘¢ï¼Ÿ å¯èƒ½æ€§åªå—æ‚¨æƒ³è±¡åŠ›çš„é™åˆ¶ï¼<br>P.S. - ä½ åˆšé˜…è¯»çš„å†…å®¹é‡Œé¢70%æ˜¯ç”±chatGPTå†™çš„ğŸ˜‰<br>â€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”â€Šâ€”</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> chatGPT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å‘½ä»¤è¡Œæ¡†æ¶cobra</title>
      <link href="/2023/02/17/ming-ling-xing-kuang-jia-cobra/"/>
      <url>/2023/02/17/ming-ling-xing-kuang-jia-cobra/</url>
      
        <content type="html"><![CDATA[<p>åŸºäº</p><ol><li>Commands å‘½ä»¤</li><li>arguments éé€‰é¡¹å‚æ•°</li><li>flags é€‰é¡¹å‚æ•°ï¼ˆå³æ ‡å¿—ï¼‰</li></ol><pre><code class="bash"># clone æ˜¯ä¸€ä¸ªå‘½ä»¤ï¼ŒURLæ˜¯ä¸€ä¸ªéé€‰é¡¹å‚æ•°ï¼Œbareæ˜¯ä¸€ä¸ªé€‰é¡¹å‚æ•°git clone URL --bare </code></pre><h2 id="åˆ›å»ºå‘½ä»¤"><a href="#åˆ›å»ºå‘½ä»¤" class="headerlink" title="åˆ›å»ºå‘½ä»¤"></a>åˆ›å»ºå‘½ä»¤</h2><h3 id="ä½¿ç”¨cobraåº“"><a href="#ä½¿ç”¨cobraåº“" class="headerlink" title="ä½¿ç”¨cobraåº“"></a>ä½¿ç”¨cobraåº“</h3><ol><li>åˆ›å»ºä¸€ä¸ª rootCmdâ€”â€”æ–‡ä»¶cmd&#x2F;root.go</li></ol><pre><code class="bash">mkdir -p newApp2 &amp;&amp; cd newApp2var rootCmd = &amp;cobra.Command&#123;  Use:   &quot;hugo&quot;,  Short: &quot;Hugo is a very fast static site generator&quot;,  Long: `A Fast and Flexible Static Site Generator`,  Run: func(cmd *cobra.Command, args []string) &#123;    // Do Stuff Here  &#125;,&#125;func Execute() &#123;  if err := rootCmd.Execute(); err != nil &#123;    fmt.Println(err)    os.Exit(1)  &#125;&#125;</code></pre><ol start="2"><li>åˆ›å»ºmain.go:è°ƒç”¨rootCmd</li></ol><pre><code class="go">package mainimport (  &quot;&#123;pathToYourApp&#125;/cmd&quot;)func main() &#123;  // main.go ä¸­ä¸å»ºè®®æ”¾å¾ˆå¤šä»£ç ï¼Œé€šå¸¸åªéœ€è¦è°ƒç”¨ cmd.Execute()   cmd.Execute()&#125;</code></pre><ol start="3"><li>æ·»åŠ å‘½ä»¤</li></ol><pre><code class="go">package cmdimport (  &quot;fmt&quot;  &quot;github.com/spf13/cobra&quot;)func init() &#123;    // å®šä¹‰æ ‡å¿—å’Œå¤„ç†é…ç½®  cmd/version.goæ–‡ä»¶  rootCmd.AddCommand(versionCmd)&#125;// rootCmdä¹‹å¤–å¯ä»¥è°ƒç”¨ AddCommand æ·»åŠ å…¶ä»–å‘½ä»¤var versionCmd = &amp;cobra.Command&#123;  Use:   &quot;version&quot;,  Short: &quot;Print the version number of Hugo&quot;,  Long:  `All software has versions. This is Hugo&#39;s`,  Run: func(cmd *cobra.Command, args []string) &#123;    fmt.Println(&quot;Hugo Static Site Generator v0.9 -- HEAD&quot;)  &#125;,&#125;</code></pre><ol start="4"><li>ç¼–è¯‘è¿è¡Œ<br><code>go build -v .</code></li></ol><h3 id="ä½¿ç”¨Cobra-å‘½ä»¤"><a href="#ä½¿ç”¨Cobra-å‘½ä»¤" class="headerlink" title="ä½¿ç”¨Cobra å‘½ä»¤"></a>ä½¿ç”¨Cobra å‘½ä»¤</h3><p>ç”Ÿæˆä¸€ä¸ª Cobra å‘½ä»¤æ¨¡æ¿ï¼Œè€Œå‘½ä»¤æ¨¡æ¿ä¹Ÿæ˜¯é€šè¿‡å¼•ç”¨ Cobra åº“æ¥æ„å»ºå‘½ä»¤çš„</p><h2 id="æ ¸å¿ƒç‰¹æ€§"><a href="#æ ¸å¿ƒç‰¹æ€§" class="headerlink" title="æ ¸å¿ƒç‰¹æ€§"></a>æ ¸å¿ƒç‰¹æ€§</h2><h3 id="ä½¿ç”¨æ ‡å¿—"><a href="#ä½¿ç”¨æ ‡å¿—" class="headerlink" title="ä½¿ç”¨æ ‡å¿—"></a>ä½¿ç”¨æ ‡å¿—</h3><ol><li>ä½¿ç”¨æŒä¹…åŒ–çš„æ ‡å¿—<br>ä½œç”¨ï¼šç”¨äºå®ƒæ‰€åˆ†é…çš„å‘½ä»¤ä»¥åŠè¯¥å‘½ä»¤ä¸‹çš„æ¯ä¸ªå­å‘½ä»¤<br><code>rootCmd.PersistentFlags().BoolVarP(&amp;Verbose, &quot;verbose&quot;, &quot;v&quot;, false, &quot;verbose output&quot;)</code></li><li>ä½¿ç”¨æœ¬åœ°æ ‡å¿—<br>ä½œç”¨ï¼šæœ¬åœ°æ ‡å¿—åªèƒ½åœ¨å®ƒæ‰€ç»‘å®šçš„å‘½ä»¤ä¸Šä½¿ç”¨<br><code>rootCmd.Flags().StringVarP(&amp;Source, &quot;source&quot;, &quot;s&quot;, &quot;&quot;, &quot;Source directory to read from&quot;)</code></li><li>å°†æ ‡å¿—ç»‘åˆ°viper<br>ä½œç”¨ï¼šå¯ä»¥é€šè¿‡viper.Get()è·å–æ ‡å¿—çš„å€¼</li></ol><pre><code class="go">var author stringfunc init() &#123;  rootCmd.PersistentFlags().StringVar(&amp;author, &quot;author&quot;, &quot;YOUR NAME&quot;, &quot;Author name for copyright attribution&quot;)  viper.BindPFlag(&quot;author&quot;, rootCmd.PersistentFlags().Lookup(&quot;author&quot;))&#125;</code></pre><ol start="4"><li>è®¾ç½®æ ‡å¿—ä¸ºå¿…é€‰</li></ol><pre><code class="go">rootCmd.Flags().StringVarP(&amp;Region, &quot;region&quot;, &quot;r&quot;, &quot;&quot;, &quot;AWS region (required)&quot;)rootCmd.MarkFlagRequired(&quot;region&quot;)</code></pre><h3 id="éé€‰é¡¹å‚æ•°éªŒè¯"><a href="#éé€‰é¡¹å‚æ•°éªŒè¯" class="headerlink" title="éé€‰é¡¹å‚æ•°éªŒè¯"></a>éé€‰é¡¹å‚æ•°éªŒè¯</h3><p>ä½¿ç”¨ Command çš„ Args å­—æ®µæ¥éªŒè¯éé€‰é¡¹å‚æ•°</p><h4 id="å†…ç½®éªŒè¯å‡½æ•°"><a href="#å†…ç½®éªŒè¯å‡½æ•°" class="headerlink" title="å†…ç½®éªŒè¯å‡½æ•°"></a>å†…ç½®éªŒè¯å‡½æ•°</h4><ul><li>NoArgsï¼šå¦‚æœå­˜åœ¨ä»»ä½•éé€‰é¡¹å‚æ•°ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>ArbitraryArgsï¼šè¯¥å‘½ä»¤å°†æ¥å—ä»»ä½•éé€‰é¡¹å‚æ•°ã€‚</li><li>OnlyValidArgsï¼šå¦‚æœæœ‰ä»»ä½•éé€‰é¡¹å‚æ•°ä¸åœ¨ Command çš„ ValidArgs å­—æ®µä¸­ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>MinimumNArgs(int)ï¼šå¦‚æœæ²¡æœ‰è‡³å°‘ N ä¸ªéé€‰é¡¹å‚æ•°ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>MaximumNArgs(int)ï¼šå¦‚æœæœ‰å¤šäº N ä¸ªéé€‰é¡¹å‚æ•°ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>ExactArgs(int)ï¼šå¦‚æœéé€‰é¡¹å‚æ•°ä¸ªæ•°ä¸ä¸º Nï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>ExactValidArgs(int)ï¼šå¦‚æœéé€‰é¡¹å‚æ•°çš„ä¸ªæ•°ä¸ä¸º Nï¼Œæˆ–è€…éé€‰é¡¹å‚æ•°ä¸åœ¨ Command çš„ ValidArgs å­—æ®µä¸­ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li><li>RangeArgs(min, max)ï¼šå¦‚æœéé€‰é¡¹å‚æ•°çš„ä¸ªæ•°ä¸åœ¨ min å’Œ max ä¹‹é—´ï¼Œè¯¥å‘½ä»¤å°†æŠ¥é”™ã€‚</li></ul><pre><code class="go">var cmd = &amp;cobra.Command&#123;  Short: &quot;hello&quot;,  Args: cobra.MinimumNArgs(1), // ä½¿ç”¨å†…ç½®çš„éªŒè¯å‡½æ•°  Run: func(cmd *cobra.Command, args []string) &#123;    fmt.Println(&quot;Hello, World!&quot;)  &#125;,&#125;</code></pre><h4 id="è‡ªå®šä¹‰éªŒè¯å‡½æ•°"><a href="#è‡ªå®šä¹‰éªŒè¯å‡½æ•°" class="headerlink" title="è‡ªå®šä¹‰éªŒè¯å‡½æ•°"></a>è‡ªå®šä¹‰éªŒè¯å‡½æ•°</h4><pre><code class="go">var cmd = &amp;cobra.Command&#123;  Short: &quot;hello&quot;,  Args: func(cmd *cobra.Command, args []string) error &#123; // è‡ªå®šä¹‰éªŒè¯å‡½æ•°    if len(args) &lt; 1 &#123;      return errors.New(&quot;requires at least one arg&quot;)    &#125;    if myapp.IsValidColor(args[0]) &#123;      return nil    &#125;    return fmt.Errorf(&quot;invalid color specified: %s&quot;, args[0])  &#125;,  Run: func(cmd *cobra.Command, args []string) &#123;    fmt.Println(&quot;Hello, World!&quot;)  &#125;,&#125;</code></pre><p>è§£æå‘½ä»¤è¡Œå‚æ•°-&gt;Pflag<br>è§£æé…ç½®æ–‡ä»¶-&gt; Viper-&gt;ä»å‘½ä»¤è¡Œå‚æ•°ã€ç¯å¢ƒå˜é‡ã€é…ç½®æ–‡ä»¶ç­‰ä½ç½®è¯»å–é…ç½®é¡¹<br>å®ç°å‘½ä»¤è¡Œæ¡†æ¶-&gt;  Cobra</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>PFlag</title>
      <link href="/2023/02/16/pflag/"/>
      <url>/2023/02/16/pflag/</url>
      
        <content type="html"><![CDATA[<p>ä½œç”¨ï¼š<br>å¯¹å‘½ä»¤è¡Œå‚æ•°è¿›è¡Œå¤„ç†ã€‚ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°åœ¨PflagåŒ…ä¸­ä¼šè§£æä¸ºä¸€ä¸ª<code>Flag</code>ç»“æ„ä½“ç±»å‹çš„å˜é‡</p><pre><code class="go">type Flag struct &#123;    Name                string // flagé•¿é€‰é¡¹çš„åç§°    Shorthand           string // flagçŸ­é€‰é¡¹çš„åç§°ï¼Œä¸€ä¸ªç¼©å†™çš„å­—ç¬¦    Usage               string // flagçš„ä½¿ç”¨æ–‡æœ¬    Value               Value  // flagçš„å€¼    DefValue            string // flagçš„é»˜è®¤å€¼    Changed             bool // è®°å½•flagçš„å€¼æ˜¯å¦æœ‰è¢«è®¾ç½®è¿‡    NoOptDefVal         string // å½“flagå‡ºç°åœ¨å‘½ä»¤è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼    Deprecated          string // è®°å½•è¯¥flagæ˜¯å¦è¢«æ”¾å¼ƒ    Hidden              bool // å¦‚æœå€¼ä¸ºtrueï¼Œåˆ™ä»help/usageè¾“å‡ºä¿¡æ¯ä¸­éšè—è¯¥flag    ShorthandDeprecated string // å¦‚æœflagçš„çŸ­é€‰é¡¹è¢«åºŸå¼ƒï¼Œå½“ä½¿ç”¨flagçš„çŸ­é€‰é¡¹æ—¶æ‰“å°è¯¥ä¿¡æ¯    Annotations         map[string][]string // ç»™flagè®¾ç½®æ³¨è§£&#125;type Value interface &#123;    String() string // å°†flagç±»å‹çš„å€¼è½¬æ¢ä¸ºstringç±»å‹çš„å€¼ï¼Œå¹¶è¿”å›stringçš„å†…å®¹    Set(string) error // å°†stringç±»å‹çš„å€¼è½¬æ¢ä¸ºflagç±»å‹çš„å€¼ï¼Œè½¬æ¢å¤±è´¥æŠ¥é”™    Type() string // è¿”å›flagçš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šstringã€intã€ipç­‰&#125;</code></pre><p>æ€»ç»“ï¼š<br>é€šè¿‡å°† Flag çš„å€¼æŠ½è±¡æˆä¸€ä¸ª interface æ¥å£ï¼Œæˆ‘ä»¬å°±å¯ä»¥è‡ªå®šä¹‰ Flag çš„ç±»å‹äº†ã€‚åªè¦å®ç°äº† Value æ¥å£çš„ç»“æ„ä½“ï¼Œå°±æ˜¯ä¸€ä¸ªæ–°ç±»å‹ã€‚</p><h2 id="FlagSet"><a href="#FlagSet" class="headerlink" title="FlagSet"></a>FlagSet</h2><p>æœ¬è´¨ï¼šé¢„å…ˆå®šä¹‰å¥½çš„ä¸€äº›Flagçš„é›†åˆ,æ—¥å¸¸ç”¨FlagSetçš„æ–¹æ³•æ“ä½œPflag</p><h3 id="è·å–å¹¶ä½¿ç”¨FlagSet"><a href="#è·å–å¹¶ä½¿ç”¨FlagSet" class="headerlink" title="è·å–å¹¶ä½¿ç”¨FlagSet"></a>è·å–å¹¶ä½¿ç”¨FlagSet</h3><ol><li>è°ƒç”¨ <code>NewFlagSet</code>åˆ›å»ºä¸€ä¸ªFlagSet</li></ol><pre><code class="go">var version boolflagSet := pflag.NewFlagSet(&quot;test&quot;, pflag.ContinueOnError)flagSet.BoolVar(&amp;version, &quot;version&quot;, true, &quot;Print version information and quit.&quot;)</code></pre><ol start="2"><li>ä½¿ç”¨å…¨å±€FlagSetï¼š<code>CommandLine</code><br>ä¸»è¦ç”¨äºä¸éœ€è¦å®šä¹‰å­å‘½ä»¤çš„å‘½ä»¤è¡Œå·¥å…·</li></ol><pre><code class="go">import (    &quot;github.com/spf13/pflag&quot;)pflag.BoolVarP(&amp;version, &quot;version&quot;, &quot;v&quot;, true, &quot;Print version information and quit.&quot;)// pflag.BoolVarP å‡½æ•°å®šä¹‰func BoolVarP(p *bool, name, shorthand string, value bool, usage string) &#123;    flag := CommandLine.VarPF(newBoolValue(value, p), name, shorthand, usage)    flag.NoOptDefVal = &quot;true&quot;&#125;// CommandLine is the default set of command-line flags, parsed from os.Args.var CommandLine = NewFlagSet(os.Args[0], ExitOnError)</code></pre><h2 id="Pflagä½¿ç”¨æ–¹æ³•"><a href="#Pflagä½¿ç”¨æ–¹æ³•" class="headerlink" title="Pflagä½¿ç”¨æ–¹æ³•"></a>Pflagä½¿ç”¨æ–¹æ³•</h2><h3 id="æ”¯æŒå¤šç§å‘½ä»¤è¡Œå‚æ•°å®šä¹‰æ–¹å¼"><a href="#æ”¯æŒå¤šç§å‘½ä»¤è¡Œå‚æ•°å®šä¹‰æ–¹å¼" class="headerlink" title="æ”¯æŒå¤šç§å‘½ä»¤è¡Œå‚æ•°å®šä¹‰æ–¹å¼"></a>æ”¯æŒå¤šç§å‘½ä»¤è¡Œå‚æ•°å®šä¹‰æ–¹å¼</h3><blockquote><p>å‡½æ•°åå¸¦Var -&gt; true:å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡ï¼Œfalse:å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­<br>å‡½æ•°åå¸¦P -&gt; true:æ”¯æŒçŸ­é€‰é¡¹ï¼Œfalse:ä¸æ”¯æŒçŸ­é€‰é¡¹</p></blockquote><ol><li>æ”¯æŒé•¿é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­</li></ol><pre><code class="go">var name = pflag.String(&quot;name&quot;, &quot;colin&quot;, &quot;Input Your Name&quot;)</code></pre><ol start="2"><li>æ”¯æŒé•¿é€‰é¡¹ã€çŸ­é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­ã€‚</li></ol><pre><code class="go">var name = pflag.StringP(&quot;name&quot;, &quot;n&quot;, &quot;colin&quot;, &quot;Input Your Name&quot;)</code></pre><ol start="3"><li>æ”¯æŒé•¿é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡</li></ol><pre><code class="go">var name stringpflag.StringVar(&amp;name, &quot;name&quot;, &quot;colin&quot;, &quot;Input Your Name&quot;)</code></pre><ol start="4"><li>æ”¯æŒé•¿é€‰é¡¹ã€çŸ­é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡ã€‚</li></ol><pre><code class="go">var name stringpflag.StringVarP(&amp;name,&quot;n&quot;,&quot;colin&quot;,&quot;Input Your Name&quot;)</code></pre><h3 id="ä½¿ç”¨Getè·å–å‚æ•°çš„å€¼"><a href="#ä½¿ç”¨Getè·å–å‚æ•°çš„å€¼" class="headerlink" title="ä½¿ç”¨Getè·å–å‚æ•°çš„å€¼"></a>ä½¿ç”¨Get<Type>è·å–å‚æ•°çš„å€¼</h3><p>Type ä»£è¡¨ Pflag æ‰€æ”¯æŒçš„ç±»å‹<br>æ¡ˆä¾‹ï¼šæœ‰ä¸€ä¸ª pflag.FlagSetï¼Œå¸¦æœ‰ä¸€ä¸ªåä¸º flagname çš„ int ç±»å‹çš„æ ‡å¿—ï¼Œå¯ä»¥ä½¿ç”¨GetInt()æ¥è·å– int å€¼ã€‚éœ€è¦æ³¨æ„ flagname å¿…é¡»å­˜åœ¨ä¸”å¿…é¡»æ˜¯ int</p><pre><code class="go">i, err := flagset.GetInt(&quot;flagname&quot;)</code></pre><h3 id="è·å–éé€‰é¡¹å‚æ•°"><a href="#è·å–éé€‰é¡¹å‚æ•°" class="headerlink" title="è·å–éé€‰é¡¹å‚æ•°"></a>è·å–éé€‰é¡¹å‚æ•°</h3><pre><code class="go">package mainimport (    &quot;fmt&quot;    &quot;github.com/spf13/pflag&quot;)var flagvar = pflag.Int(&quot;flagname&quot;, 1234, &quot;help message for flagname&quot;)func main() &#123;    // è§£æå®šä¹‰çš„æ ‡å¿—    pflag.Parse()    // è¿”å›éé€‰é¡¹å‚æ•°çš„ä¸ªæ•°    fmt.Printf(&quot;argument number is: %v\n&quot;, pflag.NArg()) //2    // è¿”å›æ‰€æœ‰çš„éé€‰é¡¹å‚æ•°    fmt.Printf(&quot;argument list is: %v\n&quot;, pflag.Args()) //[arg1,arg2]    // è¿”å›ç¬¬iä¸ªéé€‰é¡¹å‚æ•°    fmt.Printf(&quot;the first argument is: %v\n&quot;, pflag.Arg(0))//arg1&#125;go run example1.go arg1 arg2</code></pre><h3 id="æŒ‡å®šäº†é€‰é¡¹ä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼"><a href="#æŒ‡å®šäº†é€‰é¡¹ä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼" class="headerlink" title="æŒ‡å®šäº†é€‰é¡¹ä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼"></a>æŒ‡å®šäº†é€‰é¡¹ä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼</h3><pre><code class="go">var ip = pflag.IntP(&quot;flagname&quot;, &quot;f&quot;, 1234, &quot;help message&quot;)pflag.Lookup(&quot;flagname&quot;).NoOptDefVal = &quot;4321&quot;--flagname=1357 -&gt; ip=1357--flagname -&gt; ip=4321[nothing] -&gt; ip=1234</code></pre><h3 id="å¼ƒç”¨æ ‡å¿—æˆ–æ ‡å¿—çš„ç®€å†™"><a href="#å¼ƒç”¨æ ‡å¿—æˆ–æ ‡å¿—çš„ç®€å†™" class="headerlink" title="å¼ƒç”¨æ ‡å¿—æˆ–æ ‡å¿—çš„ç®€å†™"></a>å¼ƒç”¨æ ‡å¿—æˆ–æ ‡å¿—çš„ç®€å†™</h3><p>å¼ƒç”¨æ ‡å¿—åœ¨å¸®åŠ©æ–‡æœ¬ä¸­ä¼šè¢«éšè—ï¼Œå¹¶åœ¨ä½¿ç”¨ä¸æ¨èçš„æ ‡å¿—æˆ–ç®€å†™æ—¶æ‰“å°æ­£ç¡®çš„ç”¨æ³•æç¤º</p><pre><code class="go">//  deprecate a flag by specifying its name and a usage messagepflag.CommandLine.MarkDeprecated(&quot;logmode&quot;, &quot;please use --log-mode instead&quot;)</code></pre><h3 id="å¼ƒç”¨ç®€å†™å½¢å¼ï¼Œä¿ç•™æ ‡å¿—"><a href="#å¼ƒç”¨ç®€å†™å½¢å¼ï¼Œä¿ç•™æ ‡å¿—" class="headerlink" title="å¼ƒç”¨ç®€å†™å½¢å¼ï¼Œä¿ç•™æ ‡å¿—"></a>å¼ƒç”¨ç®€å†™å½¢å¼ï¼Œä¿ç•™æ ‡å¿—</h3><p>éšè—äº†å¸®åŠ©æ–‡æœ¬ä¸­çš„ç®€å†™ </p><pre><code class="go">pflag.IntVarP(&amp;port, &quot;port&quot;, &quot;P&quot;, 3306, &quot;MySQL service host port.&quot;)// deprecate a flag shorthand by specifying its flag name and a usage messagepflag.CommandLine.MarkShorthandDeprecated(&quot;port&quot;, &quot;please use --port only&quot;)</code></pre><h3 id="éšè—æ ‡å¿—"><a href="#éšè—æ ‡å¿—" class="headerlink" title="éšè—æ ‡å¿—"></a>éšè—æ ‡å¿—</h3><p>ä»å°†æ­£å¸¸è¿è¡Œï¼Œä½†ä¸ä¼šæ˜¾ç¤ºåœ¨ usage&#x2F;help æ–‡æœ¬ä¸­</p><pre><code class="go">// hide a flag by specifying its namepflag.CommandLine.MarkHidden(&quot;secretFlag&quot;)</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>yarnæŠ¥é”™</title>
      <link href="/2023/02/16/yarn-bao-cuo/"/>
      <url>/2023/02/16/yarn-bao-cuo/</url>
      
        <content type="html"><![CDATA[<p>yarn install æŠ¥é”™<br>æŠ¥é”™ä¿¡æ¯ï¼š</p><blockquote><p>yarn : æ— æ³•åŠ è½½æ–‡ä»¶ C:\Users\yueyu\AppData\Roaming\npm\yarn.ps1ï¼Œå› ä¸ºåœ¨æ­¤ç³»ç»Ÿä¸Šç¦æ­¢è¿è¡Œè„šæœ¬ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… https:&#x2F;go.mi<br>crosoft.com&#x2F;fwlink&#x2F;?LinkID&#x3D;135170 ä¸­çš„ about_Execution_Policiesã€‚<br>æ‰€åœ¨ä½ç½® è¡Œ:1 å­—ç¬¦: 1</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š</p><ol><li>ä»¥ç®¡ç†å‘˜èº«ä»½æ‰“å¼€powershell,</li><li>è¾“å…¥<code>set-ExecutionPolicy RemoteSigned</code> é€‰æ‹©Y</li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yarn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>about hexo</title>
      <link href="/2023/02/16/hello-world/"/>
      <url>/2023/02/16/hello-world/</url>
      
        <content type="html"><![CDATA[<h2 id="æ›´æ–°éƒ¨ç½²å¿…é¡»å…ˆæŠŠä¿®æ”¹ä»£ç æ¨åˆ°sourceåˆ†æ”¯ï¼Œä¹‹åæ‰èƒ½è¿è¡Œ-npm-run-ci"><a href="#æ›´æ–°éƒ¨ç½²å¿…é¡»å…ˆæŠŠä¿®æ”¹ä»£ç æ¨åˆ°sourceåˆ†æ”¯ï¼Œä¹‹åæ‰èƒ½è¿è¡Œ-npm-run-ci" class="headerlink" title="æ›´æ–°éƒ¨ç½²å¿…é¡»å…ˆæŠŠä¿®æ”¹ä»£ç æ¨åˆ°sourceåˆ†æ”¯ï¼Œä¹‹åæ‰èƒ½è¿è¡Œ npm run ci"></a>æ›´æ–°éƒ¨ç½²å¿…é¡»å…ˆæŠŠä¿®æ”¹ä»£ç æ¨åˆ°sourceåˆ†æ”¯ï¼Œä¹‹åæ‰èƒ½è¿è¡Œ npm run ci</h2>]]></content>
      
      
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-ES2015-Set</title>
      <link href="/2023/02/15/fan-yi-es2015-set/"/>
      <url>/2023/02/15/fan-yi-es2015-set/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://itnext.io/what-is-the-javascript-set-in-es2015-and-when-should-you-use-it-d7e3b8048891">https://itnext.io/what-is-the-javascript-set-in-es2015-and-when-should-you-use-it-d7e3b8048891</a></p><h1 id="ES2015ä¸­çš„Setæ˜¯ä»€ä¹ˆä»¥åŠä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒï¼Ÿ"><a href="#ES2015ä¸­çš„Setæ˜¯ä»€ä¹ˆä»¥åŠä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒï¼Ÿ" class="headerlink" title="ES2015ä¸­çš„Setæ˜¯ä»€ä¹ˆä»¥åŠä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒï¼Ÿ"></a>ES2015ä¸­çš„Setæ˜¯ä»€ä¹ˆä»¥åŠä»€ä¹ˆæ—¶å€™å¯ä»¥ä½¿ç”¨å®ƒï¼Ÿ</h1><strong>ES2015è§„èŒƒå¼•å…¥äº†è®¸å¤šæ–°ç‰¹æ€§ï¼Œè¿™äº›æ–°ç‰¹æ€§ä¼šä¸æ–­åœ¨æ‰€æœ‰æ–°ç‰ˆæœ¬çš„æµè§ˆå™¨ä¸­è¢«é‡‡ç”¨ï¼ŒSeté›†åˆå°±æ˜¯è¿™äº›æ–°ç‰¹æ€§ä¹‹ä¸€ã€‚</strong><p>æˆ‘çš„ç¬¬ä¸€æƒ³æ³•å°±æ˜¯ï¼Œå¥½å§æˆ‘å¯ä»¥ä½¿ç”¨ä¸€ä¸ªæ™®é€šçš„æ•°ç»„ï¼ä½†æ˜¯è¿™ç¯‡æ–‡ç« é‡Œæˆ‘ä¼šå±•ç¤ºå¯ä»¥ç”¨Seté›†åˆåšä»€ä¹ˆã€‚</p><h2 id="ä»€ä¹ˆæ˜¯-ES2015-Set"><a href="#ä»€ä¹ˆæ˜¯-ES2015-Set" class="headerlink" title="ä»€ä¹ˆæ˜¯ ES2015 Set?"></a>ä»€ä¹ˆæ˜¯ ES2015 Set?</h2><p><code>Set</code>æ˜¯ä»€ä¹ˆï¼Ÿä½ å¯ä»¥ç”¨å®ƒæ¥åšä»€ä¹ˆï¼ŸMozillaæ–‡æ¡£å…³äºè¿™ä¸€ç‚¹è¯´å¾—å¾ˆæ¸…æ™°ï¼š</p><blockquote><p> <code>Set</code> é›†åˆå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„å”¯ä¸€å€¼ï¼Œæ— è®ºæ˜¯åŸå§‹ç±»å‹è¿˜æ˜¯å¼•ç”¨ç±»å‹ã€‚</p></blockquote><p>è¿™ä¸ªç‰¹æ®Šå¯¹è±¡å¯ä»¥åƒæ™®é€šå¯¹è±¡ä¸€æ ·å­˜å‚¨æ‰€æœ‰ç§ç±»çš„å€¼ï¼Œä½†æ˜¯ä»–ä»¬å¿…é¡»æ˜¯å”¯ä¸€çš„ï¼Œé‡å¤çš„å€¼ä¼šè¢«è¿‡æ»¤å‡ºå»ã€‚</p><p>æ„Ÿè°¢Addy Osmaniçš„æ¨ç‰¹,è®©æˆ‘å‘ç°äº† <code>Set()</code>!</p><blockquote><p>å°æç¤º: JavaScriptçš„ <code>Array.from()</code> æ¥å—ç¬¬äºŒä¸ªå‚æ•°ï¼Œæ˜¯ä¸€ä¸ª<code>map</code>å‡½æ•° ã€‚ç”¨äºè°ƒç”¨ä½ åˆ›å»ºçš„æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ã€‚ </p><img src="/2023/02/15/fan-yi-es2015-set/array_from.jpg" class=""></blockquote><p>ä»JavaScriptä¸­è¿‡æ»¤å‡ºé‡å¤å€¼ä¸€ç›´éƒ½å¾ˆéº»çƒ¦ï¼Œä½ éœ€è¦è‡ªå·±å¾ªç¯æ•´ä¸ªæ•°ç»„è®¡ç®—å‡ºæ¥ï¼Œç°åœ¨<code>Set</code> è®©è¿™ä»¶äº‹å˜å¾—å®¹æ˜“äº† ğŸ˜ã€‚</p><h2 id="å‘-Set-ä¸­æ·»åŠ æ•°æ®"><a href="#å‘-Set-ä¸­æ·»åŠ æ•°æ®" class="headerlink" title="å‘ Set ä¸­æ·»åŠ æ•°æ®"></a>å‘ Set ä¸­æ·»åŠ æ•°æ®</h2><p>ç›®å‰æœ‰å‡ ç§æ–¹æ³•æ¥å‘<code>Set</code>é›†åˆä¸­æ·»åŠ æ•°æ®ã€‚</p><h3 id="ä½œä¸ºå‚æ•°ä¼ é€’"><a href="#ä½œä¸ºå‚æ•°ä¼ é€’" class="headerlink" title="ä½œä¸ºå‚æ•°ä¼ é€’"></a>ä½œä¸ºå‚æ•°ä¼ é€’</h3><p>è¿™æ˜¯ä¸€ä¸ªå°†æ•°æ®ä½œä¸ºå‚æ•°æ·»åŠ åˆ° <code>Set</code> é›†åˆçš„ä¾‹å­ï¼š</p><pre><code class="javascript">const numbersSet = new Set([1,2,3,4,5]);const stringSet = new Set([&#39;Jan&#39;, &#39;Rick&#39;, &#39;Raymon&#39;, &#39;Tim&#39;]);const objectSet = new Set([&#123;a: 1, b: 2&#125;]);const arraySet = new Set([[&#39;javascript&#39;, &#39;coffeescript&#39;], [&#39;css&#39;, &#39;sass&#39;]]);</code></pre><h3 id="é€šè¿‡addæ–¹æ³•æ·»åŠ æ•°æ®"><a href="#é€šè¿‡addæ–¹æ³•æ·»åŠ æ•°æ®" class="headerlink" title="é€šè¿‡addæ–¹æ³•æ·»åŠ æ•°æ®"></a>é€šè¿‡addæ–¹æ³•æ·»åŠ æ•°æ®</h3><p>å¦å¤–ä¸€ç§ä¼ é€’æ•°æ®åˆ°<code>Set</code>é›†åˆçš„æ–¹æ³•æ˜¯ä½¿ç”¨ <code>add()</code> </p><pre><code class="javascript">const newSetObject = new Set();newSetObject.add(&#39;Raymon&#39;);newSetObject.add(&#123;a: 1, b: 2&#125;);newSetObject.add(1).add(2).add(3).add(4).add(5)// Result: Raymon, &#123;a: 1, b: 2&#125;, 1, 2, 3, 4, 5</code></pre><h2 id="ä½¿ç”¨has-æ£€æŸ¥Setä¸­å€¼"><a href="#ä½¿ç”¨has-æ£€æŸ¥Setä¸­å€¼" class="headerlink" title="ä½¿ç”¨has()æ£€æŸ¥Setä¸­å€¼"></a>ä½¿ç”¨has()æ£€æŸ¥Setä¸­å€¼</h2><p><code>Set</code>é›†åˆæœ‰ä¸€ä¸ªéå¸¸æ–¹ä¾¿çš„æ–¹æ³•ç”¨æ¥æ£€æŸ¥å¯¹è±¡å†…éƒ¨æ˜¯å¦æœ‰æŸä¸ªå€¼</p><pre><code class="javascript">const numbersSet = new Set([1,2,3,4,5]);const stringSet = new Set([&#39;Jan&#39;, &#39;Rick&#39;, &#39;Raymon&#39;, &#39;Tim&#39;]);const objectSet = new Set([&#123;a: 1, b: 2&#125;]);const arraySet = new Set([[&#39;javascript&#39;, &#39;coffeescript&#39;], [&#39;css&#39;, &#39;sass&#39;]]);    numberSet.has(4); // truenumberSet.has(6); // falsestringSet.has(&#39;Raymon&#39;); // trueobjectSet.has(&#123;a: 1, b: 2&#125;); // falsearraySet.has(&#39;css&#39;); // false</code></pre><p><code>has()</code> æ–¹æ³•åœ¨åŸå§‹å€¼ä¸Šéå¸¸å¥æ•ˆï¼Œä½†æ˜¯åœ¨åƒå¯¹è±¡å’Œæ•°ç»„è¿™æ ·çš„éåŸå§‹å€¼ä¸Šä¸èµ·ä½œç”¨ã€‚</p><p>å…³äºéåŸå§‹å€¼ä¸èƒ½å’ŒåŸå§‹å€¼ä¸€æ ·èµ·ä½œç”¨æ˜¯æœ‰åŸå› çš„ã€‚å› ä¸º <code>has()</code>æ–¹æ³•ä¸æ­¢æ¯”è¾ƒå€¼ï¼Œä»–åŒæ—¶è¿˜ä¼šç”¨&#x3D;&#x3D;&#x3D;æ“ä½œç¬¦æ¯”è¾ƒå¼•ç”¨ã€‚</p><p>å¦‚æœä½ åœ¨å˜é‡ä¸­æœ‰å¯¹æ•°ç»„æˆ–è€…å¯¹è±¡çš„å¼•ç”¨ï¼Œé‚£ä¹ˆç»“æœå°±ä¼šå’Œé¢„æœŸä¸€æ ·ï¼š</p><pre><code class="javascript">const exampleObject = &#123;a: 1, b: 2&#125;;const exampleArray1 = [&#39;javascript&#39;, &#39;coffeescript&#39;]const exampleArray2 = [&#39;css&#39;, &#39;sass&#39;];const objectSet = new Set([exampleObject]);const arraySet = new Set([exampleArray1, exampleArray2]);    objectSet.has(&#123;a: 1, b: 2&#125;); // falseobjectSet.has(exampleObject); // truearraySet.has(&#39;css&#39;); // falsearraySet.has(exampleArray1); // truearraySet.has(exampleArray2); // true</code></pre><p>æ‰€ä»¥è®°ä½ï¼šå½“ä½ åœ¨<code>Set</code>é›†åˆä¸­ä½¿ç”¨<code>has()</code>æ–¹æ³•çš„æ—¶å€™,å¼•ç”¨éåŸå§‹å€¼å¾ˆé‡è¦ã€‚</p><h2 id="ä»Setä¸­ç§»é™¤æ•°æ®"><a href="#ä»Setä¸­ç§»é™¤æ•°æ®" class="headerlink" title="ä»Setä¸­ç§»é™¤æ•°æ®"></a>ä»Setä¸­ç§»é™¤æ•°æ®</h2><p>å‘ Set é›†åˆä¸­æ·»åŠ æ•°æ®å¾ˆç®€å•ï¼Œåˆ é™¤æ•°æ®ä¹Ÿå¾ˆå®¹æ˜“ã€‚</p><h3 id="ä½¿ç”¨deleteæ–¹æ³•ç§»é™¤æ•°æ®"><a href="#ä½¿ç”¨deleteæ–¹æ³•ç§»é™¤æ•°æ®" class="headerlink" title="ä½¿ç”¨deleteæ–¹æ³•ç§»é™¤æ•°æ®"></a>ä½¿ç”¨deleteæ–¹æ³•ç§»é™¤æ•°æ®</h3><p>å¦‚æœæƒ³è¦ç§»é™¤<code>Set</code>é›†åˆä¸­çš„å•ä¸ªå…ƒç´ ï¼Œåªéœ€è¦ç®€å•åœ°ä½¿ç”¨ç§»é™¤æ–¹æ³•</p><pre><code class="javascript">const numbersSetObject = new Set([1,2,3,4,5,6,7,8,9]);numbersSetObject.has(2); // truenumbersSetObject.delete(2);numbersSetObject.has(2); // falseconsole.log(numbersSetObject); // 1,3,4,5,6,7,8,9</code></pre><h3 id="ç”¨clearæ–¹æ³•ç§»é™¤æ‰€æœ‰å…ƒç´ "><a href="#ç”¨clearæ–¹æ³•ç§»é™¤æ‰€æœ‰å…ƒç´ " class="headerlink" title="ç”¨clearæ–¹æ³•ç§»é™¤æ‰€æœ‰å…ƒç´ "></a>ç”¨clearæ–¹æ³•ç§»é™¤æ‰€æœ‰å…ƒç´ </h3><p>ä½†æ˜¯å¦‚æœä½ æƒ³è¦ä»Seté›†åˆä¸­ç§»é™¤æ‰€æœ‰æ•°æ®ï¼Œåªèƒ½ä½¿ç”¨clearæ–¹æ³•</p><pre><code class="javascript">const numbersSetObject = new Set([1,2,3,4,5,6,7,8,9]);numbersSetObject.has(2); // truenumbersSetObject.clear();console.log([...numbersSetObject]); // []</code></pre><h2 id="ä½¿ç”¨sizeå±æ€§æ£€æŸ¥å…ƒç´ æ•°é‡"><a href="#ä½¿ç”¨sizeå±æ€§æ£€æŸ¥å…ƒç´ æ•°é‡" class="headerlink" title="ä½¿ç”¨sizeå±æ€§æ£€æŸ¥å…ƒç´ æ•°é‡"></a>ä½¿ç”¨sizeå±æ€§æ£€æŸ¥å…ƒç´ æ•°é‡</h2><p>ç±»ä¼¼åœ¨æ•°ç»„ä¸­ï¼Œä½¿ç”¨lengthå±æ€§æ£€æŸ¥å…ƒç´ æ•°é‡ï¼ŒSeté›†åˆä¹Ÿå¯ä»¥ç”¨sizeå±æ€§å®ç°åŒæ ·çš„ç›®çš„<br>å¦‚æœæˆ‘ä»¬æ£€æŸ¥ä¸Šä¸€ä¸ªä¾‹å­ä¸­æ£€æŸ¥Seté›†åˆï¼Œä»–çš„sizeæ˜¯7ã€‚</p><pre><code class="javascript">newSetObject.size // 7</code></pre><h2 id="è¿‡æ»¤é‡å¤çš„åŸå§‹å€¼"><a href="#è¿‡æ»¤é‡å¤çš„åŸå§‹å€¼" class="headerlink" title="è¿‡æ»¤é‡å¤çš„åŸå§‹å€¼"></a>è¿‡æ»¤é‡å¤çš„åŸå§‹å€¼</h2><p>å¦‚æœå°è¯•æŠŠé‡å¤çš„åŸå§‹å€¼æ”¾å…¥Set,æœ€åä¿ç•™ä¸‹æ¥çš„åªæœ‰å”¯ä¸€çš„ä¸€ä¸ªã€‚</p><pre><code class="javascript">const uniqueArray = new Set([1,2,2,2,3,4,5,5,6,7,9,9,8]);console.log(&#39;uniqueArray: &#39;, uniqueArray)// unique: 1, 2, 3, 4, 5, 6, 7, 9, 8</code></pre><h2 id="è¿‡æ»¤éåŸå§‹ç±»å‹å€¼"><a href="#è¿‡æ»¤éåŸå§‹ç±»å‹å€¼" class="headerlink" title="è¿‡æ»¤éåŸå§‹ç±»å‹å€¼"></a>è¿‡æ»¤éåŸå§‹ç±»å‹å€¼</h2><p>åœ¨è¿‡æ»¤é‡å¤çš„éåŸå§‹å€¼çš„æ—¶å€™æƒ…å†µæœ‰ç‚¹ä¸åŒ.æ–‡æ¡£ååˆ†æ¸…æ™°,Setæœ¬èº«å¹¶æ²¡æœ‰æ¯”è¾ƒå¯¹è±¡ï¼Œè€Œæ˜¯æ¯”è¾ƒå¼•ç”¨ã€‚</p><p>å°†å®ƒçœ‹ä½œæ˜¯ä½¿ç”¨&#x3D;&#x3D;æ“ä½œç¬¦æ¯”è¾ƒå€¼ï¼Œä½†æ˜¯ä½¿ç”¨&#x3D;&#x3D;&#x3D;æ“ä½œç¬¦ä¼šæ¯”è¾ƒå¼•ç”¨å’Œå€¼ã€‚</p><p>å¦‚æœæˆ‘ä»¬å°è¯•å‘Setæ”¾å…¥å…·æœ‰ä¸åŒå¼•ç”¨çš„ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ï¼Œæ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><pre><code class="javascript">const objectSet = new Set([&#123;a: 1, b: 2&#125;, &#123;a: 1, b: 2&#125;]);console.log(&#39;objectSet: &#39;, objectSet);// objectSet: &#123;a: 1, b: 2&#125;, &#123;a: 1, b: 2&#125;;</code></pre><p>ä½†æ˜¯å¦‚æœæˆ‘ä»¬æ”¾å…¥ç›¸åŒå¼•ç”¨çš„ä¸¤ä¸ªç›¸åŒçš„å¯¹è±¡ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢ï¼Ÿ</p><pre><code class="javascript">const demoObject = &#123;a: 1, b: 2&#125;;const objectSet = new Set([demoObject, demoObject]);console.log(&#39;objectSet: &#39;, objectSet);// objectSet: &#123;a: 1, b: 2&#125;;</code></pre><p>å¸Œæœ›ä½ å·²ç»çŒœåˆ°ç»“æœäº†ï¼šobjectSetåªåŒ…å«äº†ä¸€ä¸ªdemoObjectï¼Œå»é™¤äº†å¦å¤–ä¸€ä¸ªé‡å¤çš„ğŸ˜</p><h2 id="å¾ªç¯ä¸€ä¸ª-Set"><a href="#å¾ªç¯ä¸€ä¸ª-Set" class="headerlink" title="å¾ªç¯ä¸€ä¸ª Set"></a>å¾ªç¯ä¸€ä¸ª Set</h2><p>Setçš„å¥½å¤„ä¹‹ä¸€å°±æ˜¯ä½ å¯ä»¥å¾ªç¯ä¸€ä¸ªSeté›†åˆ</p><p>è¿™ä¸ªæ–‡æ¡£è§£é‡Šäº†æ›´å¤šå…³äºSetæ–¹æ³•çš„ç»†èŠ‚ï¼š</p><blockquote><p>Set æ˜¯å€¼çš„é›†åˆ. ä½ å¯ä»¥æŒ‰ç…§æ’å…¥é¡ºåºéå†å…¶ä¸­çš„å…ƒç´ ã€‚</p></blockquote><p>To loop over a Set collection we can use the for-of loop and the forEach method which is attached to the Set.</p><p>æˆ‘ä»¬å¯ä»¥é€šè¿‡for-ofå’Œé™„åŠ åˆ°Seté›†åˆçš„forEach æ–¹æ³•æ¥å¾ªç¯ä¸€ä¸ªSeté›†åˆã€‚</p><h3 id="forEach-æ–¹æ³•å¾ªç¯"><a href="#forEach-æ–¹æ³•å¾ªç¯" class="headerlink" title="forEach æ–¹æ³•å¾ªç¯"></a>forEach æ–¹æ³•å¾ªç¯</h3><p>é€šè¿‡<code>Set.forEach()</code>,ä½ å¯ä»¥å¾ªç¯Seté›†åˆä¸­çš„æ‰€æœ‰å…ƒç´ ã€‚</p><pre><code class="javascript">const objectSet = new Set([&#123;a: 1, b: 2&#125;, &#123;a: 1, b: 2&#125;]);objectSet.forEach(object =&gt; &#123;    console.log(&#39;Object: &#39;, object);&#125;)    // result:  // Object:  &#123;a: 1, b: 2&#125;// Object:  &#123;a: 1, b: 2&#125;</code></pre><h3 id="ä½¿ç”¨-for-of"><a href="#ä½¿ç”¨-for-of" class="headerlink" title="ä½¿ç”¨ for-of"></a>ä½¿ç”¨ for-of</h3><p>é€šè¿‡for-ofå¾ªç¯ï¼Œæˆ‘ä»¬æœ‰ä¸€äº›æ–¹æ³•å¯ä»¥éå†Seté›†åˆå†…éƒ¨çš„æ‰€æœ‰å…ƒç´ ã€‚</p><ul><li>entries()</li><li>keys()</li><li>values()</li></ul><pre><code class="javascript">const objectSet = new Set([&#123;a: 1, b: 2&#125;, &#123;a: 1, b: 2&#125;]);for (let [key, value] of objectSet.entries())  &#123;   console.log(key);&#125;    // &#123;a: 1, b: 2&#125;// &#123;a: 1, b: 2&#125;</code></pre><p>å”¯ä¸€å¥‡æ€ªçš„äº‹æƒ…æ˜¯ï¼š entries, keys å’Œ valuesæ–¹æ³•åœ¨Setä¸Šä¼šè¿”å›å®Œå…¨ç›¸åŒçš„ç»“æœã€‚ä¹Ÿè®¸æ˜¯å› ä¸º Set å’Œ Map Apiæœ‰è®¸å¤šå…±åŒä¹‹å¤„ã€‚</p><h2 id="Setå’ŒMapçš„åŒºåˆ«"><a href="#Setå’ŒMapçš„åŒºåˆ«" class="headerlink" title="Setå’ŒMapçš„åŒºåˆ«"></a>Setå’ŒMapçš„åŒºåˆ«</h2><p>mapå’Œsetæœ€å¤§çš„åŒºåˆ«æ˜¯ï¼šSetçœ‹ä¸Šå»éå¸¸åƒä¸€ä¸ªæ•°ç»„ï¼Œè€Œmapçœ‹ä¸Šå»æ›´åƒä¸€ä¸ªå¯¹è±¡ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> JavaScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å¦‚ä½•ç”Ÿæˆswagger-apiæ–‡æ¡£</title>
      <link href="/2023/02/02/ru-he-sheng-cheng-swagger-api-wen-dang/"/>
      <url>/2023/02/02/ru-he-sheng-cheng-swagger-api-wen-dang/</url>
      
        <content type="html"><![CDATA[<p>ä½¿ç”¨ä¾èµ–åº“ï¼š<a href="https://github.com/swaggo/swag">https://github.com/swaggo/swag</a></p><h3 id="åœ¨makefileä¸­æä¾›ç”Ÿæˆå‘½ä»¤"><a href="#åœ¨makefileä¸­æä¾›ç”Ÿæˆå‘½ä»¤" class="headerlink" title="åœ¨makefileä¸­æä¾›ç”Ÿæˆå‘½ä»¤"></a>åœ¨makefileä¸­æä¾›ç”Ÿæˆå‘½ä»¤</h3><pre><code>##genSwaggerDoc: generate swagger docs by swaggo/swag.PHONY: genSwaggerDocgenSwaggerDoc:    swag init -g ./cmd/notepad-apiserver/apiserver.go</code></pre><h3 id="apiserver-go"><a href="#apiserver-go" class="headerlink" title="apiserver.go"></a>apiserver.go</h3><pre><code class="go">package mainimport (    _ &quot;github.com/earthaYan/notePad/docs&quot;    &quot;github.com/gin-gonic/gin&quot;    swaggerFiles &quot;github.com/swaggo/files&quot;    ginSwagger &quot;github.com/swaggo/gin-swagger&quot;)// @titlenotepad api// @version1.0// @descriptionThis is a sample server celler server.// @host116.204.108.126:8080// @BasePath/v1// @securityDefinitions.basic  BasicAuthfunc main() &#123;    r := gin.Default()    c := controller.NewController()    v1 := r.Group(&quot;v1&quot;)    &#123;        accounts := v1.Group(&quot;/accounts&quot;)        &#123;            accounts.GET(&quot;:id&quot;, c.ShowAccount)            accounts.GET(&quot;&quot;, c.ListAccounts)            accounts.POST(&quot;&quot;, c.AddAccount)            accounts.DELETE(&quot;:id&quot;, c.DeleteAccount)            accounts.PATCH(&quot;:id&quot;, c.UpdateAccount)            accounts.POST(&quot;:id/images&quot;, c.UploadAccountImage)        &#125;        r.GET(&quot;/swagger/*any&quot;, ginSwagger.WrapHandler(swaggerFiles.Handler))        r.Run(&quot;:8080&quot;)    &#125;    log.Println(&quot;start http server&quot;)    log.Fatal(http.ListenAndServe(&quot;:50052&quot;, nil))&#125;</code></pre><h3 id="controller-x2F-accounts-go"><a href="#controller-x2F-accounts-go" class="headerlink" title="controller&#x2F;accounts.go"></a>controller&#x2F;accounts.go</h3><pre><code class="go">package controllerimport (    &quot;fmt&quot;    &quot;net/http&quot;    &quot;strconv&quot;    &quot;github.com/gin-gonic/gin&quot;    &quot;github.com/swaggo/swag/example/celler/httputil&quot;    &quot;github.com/swaggo/swag/example/celler/model&quot;)// ShowAccount godoc////@SummaryShow an account//@Descriptionget string by ID//@Tagsaccounts//@Acceptjson//@Producejson//@Paramidpathinttrue&quot;Account ID&quot;//@Success200&#123;object&#125;model.Account//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts/&#123;id&#125; [get]func (c *Controller) ShowAccount(ctx *gin.Context) &#123;    id := ctx.Param(&quot;id&quot;)    aid, err := strconv.Atoi(id)    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    account, err := model.AccountOne(aid)    if err != nil &#123;        httputil.NewError(ctx, http.StatusNotFound, err)        return    &#125;    ctx.JSON(http.StatusOK, account)&#125;// ListAccounts godoc////@SummaryList accounts//@Descriptionget accounts//@Tagsaccounts//@Acceptjson//@Producejson//@Paramqquerystringfalse&quot;name search by q&quot;Format(email)//@Success200&#123;array&#125;model.Account//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts [get]func (c *Controller) ListAccounts(ctx *gin.Context) &#123;    q := ctx.Request.URL.Query().Get(&quot;q&quot;)    accounts, err := model.AccountsAll(q)    if err != nil &#123;        httputil.NewError(ctx, http.StatusNotFound, err)        return    &#125;    ctx.JSON(http.StatusOK, accounts)&#125;// AddAccount godoc////@SummaryAdd an account//@Descriptionadd by json account//@Tagsaccounts//@Acceptjson//@Producejson//@Paramaccountbodymodel.AddAccounttrue&quot;Add account&quot;//@Success200&#123;object&#125;model.Account//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts [post]func (c *Controller) AddAccount(ctx *gin.Context) &#123;    var addAccount model.AddAccount    if err := ctx.ShouldBindJSON(&amp;addAccount); err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    if err := addAccount.Validation(); err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    account := model.Account&#123;        Name: addAccount.Name,    &#125;    lastID, err := account.Insert()    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    account.ID = lastID    ctx.JSON(http.StatusOK, account)&#125;// UpdateAccount godoc////@SummaryUpdate an account//@DescriptionUpdate by json account//@Tagsaccounts//@Acceptjson//@Producejson//@Paramidpathinttrue&quot;Account ID&quot;//@Paramaccountbodymodel.UpdateAccounttrue&quot;Update account&quot;//@Success200&#123;object&#125;model.Account//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts/&#123;id&#125; [patch]func (c *Controller) UpdateAccount(ctx *gin.Context) &#123;    id := ctx.Param(&quot;id&quot;)    aid, err := strconv.Atoi(id)    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    var updateAccount model.UpdateAccount    if err := ctx.ShouldBindJSON(&amp;updateAccount); err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    account := model.Account&#123;        ID:   aid,        Name: updateAccount.Name,    &#125;    err = account.Update()    if err != nil &#123;        httputil.NewError(ctx, http.StatusNotFound, err)        return    &#125;    ctx.JSON(http.StatusOK, account)&#125;// DeleteAccount godoc////@SummaryDelete an account//@DescriptionDelete by account ID//@Tagsaccounts//@Acceptjson//@Producejson//@Paramidpathinttrue&quot;Account ID&quot;Format(int64)//@Success204&#123;object&#125;model.Account//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts/&#123;id&#125; [delete]func (c *Controller) DeleteAccount(ctx *gin.Context) &#123;    id := ctx.Param(&quot;id&quot;)    aid, err := strconv.Atoi(id)    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    err = model.Delete(aid)    if err != nil &#123;        httputil.NewError(ctx, http.StatusNotFound, err)        return    &#125;    ctx.JSON(http.StatusNoContent, gin.H&#123;&#125;)&#125;// UploadAccountImage godoc////@SummaryUpload account image//@DescriptionUpload file//@Tagsaccounts//@Acceptmultipart/form-data//@Producejson//@Paramidpathinttrue&quot;Account ID&quot;//@ParamfileformDatafiletrue&quot;account image&quot;//@Success200&#123;object&#125;controller.Message//@Failure400&#123;object&#125;httputil.HTTPError//@Failure404&#123;object&#125;httputil.HTTPError//@Failure500&#123;object&#125;httputil.HTTPError//@Router/accounts/&#123;id&#125;/images [post]func (c *Controller) UploadAccountImage(ctx *gin.Context) &#123;    id, err := strconv.Atoi(ctx.Param(&quot;id&quot;))    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    file, err := ctx.FormFile(&quot;file&quot;)    if err != nil &#123;        httputil.NewError(ctx, http.StatusBadRequest, err)        return    &#125;    ctx.JSON(http.StatusOK, Message&#123;Message: fmt.Sprintf(&quot;upload complete userID=%d filename=%s&quot;, id, file.Filename)&#125;)&#125;</code></pre><h3 id="æµè§ˆå™¨ä¸­è®¿é—®"><a href="#æµè§ˆå™¨ä¸­è®¿é—®" class="headerlink" title="æµè§ˆå™¨ä¸­è®¿é—®"></a>æµè§ˆå™¨ä¸­è®¿é—®</h3><p><a href="http://116.204.108.126:8080/swagger/index.html">http://116.204.108.126:8080/swagger/index.html</a></p><h2 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h2><blockquote><p>golang swagger internal server error doc.json<br>è§£å†³æ–¹æ³•ï¼š<br>åœ¨main.go ä¸­å¯¼å…¥docs.go </p></blockquote><pre><code class="go">import (  _ &quot;github.com/earthaYan/notePad/docs&quot;)</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>go.modæ–‡ä»¶</title>
      <link href="/2023/01/30/go-mod-wen-jian/"/>
      <url>/2023/01/30/go-mod-wen-jian/</url>
      
        <content type="html"><![CDATA[<h2 id="go-modå¸¸è§ç”¨æ³•ä»¥åŠæ³¨é‡Š"><a href="#go-modå¸¸è§ç”¨æ³•ä»¥åŠæ³¨é‡Š" class="headerlink" title="go.modå¸¸è§ç”¨æ³•ä»¥åŠæ³¨é‡Š"></a>go.modå¸¸è§ç”¨æ³•ä»¥åŠæ³¨é‡Š</h2><pre><code class="go">// module pathï¼Œä¸€èˆ¬é‡‡ç”¨ä»“åº“æˆ–è€…ä»“åº“+module_nameå®šä¹‰module github.com/actiontech/dtle// go directive,éå¿…é¡»,æŒ‡å®šä»£ç æ‰€éœ€è¦çš„goçš„æœ€ä½ç‰ˆæœ¬ï¼Œä¸€èˆ¬ä¸ºgo 1.xxgo 1.16// requireæ®µä¸­åˆ—å‡ºäº†é¡¹ç›®æ‰€éœ€è¦çš„å„ä¸ªä¾èµ–åº“ä»¥åŠå®ƒä»¬çš„ç‰ˆæœ¬require (    // æ­£è§„ç‰ˆæœ¬å·    github.com/Shopify/sarama v1.26.4    // ä¼ªç‰ˆæœ¬å·ï¼š go module ä¸ºå®ƒç”Ÿæˆçš„ä¸€ä¸ªç±»ä¼¼ç¬¦åˆè¯­ä¹‰åŒ–ç‰ˆæœ¬ 2.0.0 ç‰ˆæœ¬ï¼Œå®é™…è¿™ä¸ªåº“å¹¶æ²¡æœ‰å‘å¸ƒè¿™ä¸ªç‰ˆæœ¬    // commit çš„ base versio-æœ¬æ¬¡æäº¤æ—¶é—´-ç¬¬ä¸‰æ–¹åº“æœ¬æ¬¡æäº¤æ—¶æœ€æ–°çš„commitId    github.com/actiontech/golang-live-coverage-report v0.0.0-20210902074032-43aa91afdc2c    //indirect: é—´æ¥çš„ä½¿ç”¨äº†è¿™ä¸ªåº“ï¼Œä½†æ˜¯åˆæ²¡æœ‰è¢«åˆ—åˆ°æŸä¸ª go.mod ä¸­    // 1. å½“å‰é¡¹ç›®ä¾èµ– Aï¼Œä½†æ˜¯ A çš„go.mod é—æ¼äº† Bï¼Œé‚£ä¹ˆå°±ä¼šåœ¨å½“å‰é¡¹ç›®çš„ go.mod ä¸­è¡¥å…… Bï¼ŒåŠ  indirect æ³¨é‡Šï¼›    // 2.å½“å‰é¡¹ç›®ä¾èµ– Aï¼Œä½†æ˜¯ A æ²¡æœ‰ go.modï¼ŒåŒæ ·å°±ä¼šåœ¨å½“å‰é¡¹ç›®çš„ go.mod ä¸­è¡¥å…… Bï¼ŒåŠ  indirect æ³¨é‡Šï¼›    // 3.å½“å‰é¡¹ç›®ä¾èµ– Aï¼ŒA åˆä¾èµ– Bã€‚å½“å¯¹ A é™çº§çš„æ—¶å€™ï¼Œé™çº§çš„ A ä¸å†ä¾èµ– Bï¼Œè¿™ä¸ªæ—¶å€™ B å°±æ ‡è®° indirect æ³¨é‡Šã€‚æˆ‘ä»¬å¯ä»¥æ‰§è¡Œgo mod tidyæ¥æ¸…ç†ä¸ä¾èµ–çš„ moduleã€‚    github.com/go-playground/universal-translator v0.17.0 // indirect    // æ²¡æœ‰é‡‡ç”¨go.modç®¡ç†æˆ–è€…module path ä¸­ä¾ç„¶æ²¡æœ‰æ·»åŠ  v2ã€v3 è¿™æ ·çš„åç¼€,ä¸ç¬¦åˆ Go çš„ module ç®¡ç†è§„èŒƒ    github.com/go-playground/validator v9.31.0+incompatible)// 1. æ›¿æ¢åº“// 2.æŸä¸ªä¾èµ–åº“æœ‰é—®é¢˜ï¼Œè‡ªå·± fork åˆ°æœ¬åœ°åšä¿®æ”¹ï¼Œé€šè¿‡æ›¿æ¢æˆæœ¬åœ°æ–‡ä»¶å¤¹è¿›è¡Œè°ƒè¯•replace github.com/go-mysql-org/go-mysql =&gt; github.com/ffffwh/go-mysql v0.0.0-20211206100736-edbdc58f729a//replace github.com/Sirupsen/logrus =&gt; github.com/sirupsen/logrus v1.4.2replace github.com/araddon/qlbridge =&gt; github.com/ffffwh/qlbridge v0.0.0-20220113095321-0b48c80b13e9replace github.com/pingcap/dm =&gt; github.com/actiontech/dm v0.0.0-20211206092524-9e640f6da0acreplace github.com/pingcap/tidb =&gt; github.com/actiontech/tidb v0.0.0-20220928030323-1f192702a2c7replace github.com/pingcap/tidb/parser =&gt; github.com/actiontech/tidb/parser v0.0.0-20220928030323-1f192702a2c7// åé¢çš„commitIdä¸ºå½“æ—¶æäº¤ä»£ç çš„æ—¶å€™ä¾èµ–åŒ…çš„commitIdreplace github.com/hashicorp/go-discover =&gt; github.com/hashicorp/go-discover v0.0.0-20211203145537-8b3ddf4349a8// å°†grpcç‰ˆæœ¬å›ºå®šä¸º1.29.1replace google.golang.org/grpc =&gt; google.golang.org/grpc v1.29.1// exclude :Go åœ¨ç‰ˆæœ¬é€‰æ‹©çš„æ—¶å€™ï¼Œå¦‚go get -u æˆ–è€…go get github.com/xxx/xxx@latest å°±ä¼šä¸»åŠ¨è·³è¿‡è¿™äº›ç‰ˆæœ¬// retract :go 1.16 ä¸­æ–°å¢åŠ çš„å†…å®¹</code></pre><h2 id="ç¬¬ä¸‰æ–¹åº“çš„replace"><a href="#ç¬¬ä¸‰æ–¹åº“çš„replace" class="headerlink" title="ç¬¬ä¸‰æ–¹åº“çš„replace"></a>ç¬¬ä¸‰æ–¹åº“çš„replace</h2><h3 id="åœºæ™¯"><a href="#åœºæ™¯" class="headerlink" title="åœºæ™¯"></a>åœºæ™¯</h3><p>ç¬¬ä¸‰æ–¹åº“ä¸­ç¼ºå°‘è‡ªå·±é¡¹ç›®ä¸­éœ€è¦çš„æŸä¸ªæ–¹æ³•ï¼Œè‡ªå·±forkä¸€ä»½å¹¶åŠ å…¥è‡ªå®šä¹‰çš„æ–°æ–¹æ³•ï¼Œåœ¨é¡¹ç›®ä¸­è°ƒç”¨è¿™ä¸ªè‡ªå®šä¹‰æ–¹æ³•</p><h3 id="è§£å†³æ–¹æ³•1-å¼•ç”¨æ–°åº“"><a href="#è§£å†³æ–¹æ³•1-å¼•ç”¨æ–°åº“" class="headerlink" title="è§£å†³æ–¹æ³•1-å¼•ç”¨æ–°åº“"></a>è§£å†³æ–¹æ³•1-å¼•ç”¨æ–°åº“</h3><ol><li>å°†forkçš„åº“çš„go.modä¸­module name ä¿®æ”¹ä¸ºä¸€ä¸ªæ–°çš„ name</li><li>å¢åŠ æ‰€éœ€è¦çš„æ–¹æ³•</li><li>å¢åŠ æ–°çš„ git tag</li><li>å½“å‰é¡¹ç›®ä¸­ï¼Œå¼•ç”¨ä¿®æ”¹åçš„è¿™ä¸ª repoï¼Œæ›¿æ¢åœ°å€ä»¥åŠtagç‰ˆæœ¬å·</li></ol><h3 id="è§£å†³æ–¹æ³•2-go-mod-replace"><a href="#è§£å†³æ–¹æ³•2-go-mod-replace" class="headerlink" title="è§£å†³æ–¹æ³•2 - go mod replace"></a>è§£å†³æ–¹æ³•2 - go mod replace</h3><ol><li>forkç¬¬ä¸‰æ–¹åº“</li><li>å¢åŠ éœ€è¦çš„æ–¹æ³•</li><li>åœ¨å½“å‰é¡¹ç›®ä¸­ï¼Œæ‰§è¡Œ go mod edit -replace å‘½ä»¤:<code>go mod edit -replace=old[@v]=new[@v]</code></li></ol><pre><code class="go">go mod edit -replace=golang.org/x/image@v0.0.0-20180708004352-c73c2afc3b81=github.com/golang/image@v0.0.0-20180708004352-c73c2afc3b81</code></pre><ol start="4"><li>å¯ä»¥å‘ç¬¬ä¸‰æ–¹åº“æäº¤PRï¼Œåˆå¹¶ä¸Šå»åå¯ä»¥åˆ é™¤replaceè¯­å¥</li></ol><h2 id="è¡¥å……çŸ¥è¯†"><a href="#è¡¥å……çŸ¥è¯†" class="headerlink" title="è¡¥å……çŸ¥è¯†"></a>è¡¥å……çŸ¥è¯†</h2><h3 id="åˆå§‹åŒ–module"><a href="#åˆå§‹åŒ–module" class="headerlink" title="åˆå§‹åŒ–module"></a>åˆå§‹åŒ–module</h3><p><code>go mod init project_name</code></p><h3 id="go-mod-tidyä½œç”¨"><a href="#go-mod-tidyä½œç”¨" class="headerlink" title="go mod tidyä½œç”¨"></a>go mod tidyä½œç”¨</h3><ol><li>è§£æé¡¹ç›®æ–‡ä»¶ï¼Œå¹¶æ‰¾åˆ°æ‰€ä½¿ç”¨çš„åŒ…</li><li>ç”Ÿæˆ go.sum æ–‡ä»¶ï¼Œå…¶ä¸­ä¿å­˜äº†æ‰€ä½¿ç”¨åŒ…çš„ç‰ˆæœ¬</li></ol><h3 id="æ‰§è¡Œé¡¹ç›®"><a href="#æ‰§è¡Œé¡¹ç›®" class="headerlink" title="æ‰§è¡Œé¡¹ç›®"></a>æ‰§è¡Œé¡¹ç›®</h3><p><code>go run main.go</code></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>session vs cookie</title>
      <link href="/2023/01/13/session/"/>
      <url>/2023/01/13/session/</url>
      
        <content type="html"><![CDATA[<h2 id="cookie"><a href="#cookie" class="headerlink" title="cookie"></a>cookie</h2><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åœ¨<font color=red>æœ¬åœ°è®¡ç®—æœºã€æµè§ˆå™¨ç«¯ã€‘</font>ä¿å­˜ç”¨æˆ·æ“ä½œçš„å†å²ä¿¡æ¯ï¼Œå¦‚ç™»å½•ä¿¡æ¯ï¼Œå¹¶åœ¨ç”¨æˆ·å†æ¬¡è®¿é—®è¯¥ç«™ç‚¹æ—¶æµè§ˆå™¨é€šè¿‡HTTPåè®®å°†æœ¬åœ°cookieå†…å®¹å‘é€ç»™æœåŠ¡å™¨ï¼Œä»è€Œå®ŒæˆéªŒè¯ï¼Œæˆ–ç»§ç»­ä¸Šä¸€æ­¥æ“ä½œã€‚</p><img src="/2023/01/13/session/6.1.cookie2.png" class="" title="cookieåŸç†"><h3 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h3><p>æœ‰æ—¶é—´é™åˆ¶ï¼Œåˆ†ä¸ºä¼šè¯cookieå’ŒæŒä¹…cookie</p><ul><li>ä¼šè¯cookie:<ol><li>ä¸è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œç”Ÿå‘½å‘¨æœŸä¸ºä»åˆ›å»ºåˆ°æµè§ˆå™¨å…³é—­ä¸ºæ­¢,ä¸€èˆ¬ä¸ä¿å­˜åœ¨ç¡¬ç›˜ä¸Šè€Œæ˜¯ä¿å­˜åœ¨å†…å­˜é‡Œ</li><li>cookieæ˜¯å¦å¯ä»¥åœ¨ä¸åŒçš„æµè§ˆå™¨è¿›ç¨‹é—´å…±äº«ç”±ä¸åŒæµè§ˆå™¨å†³å®š</li></ol></li><li>æŒä¹…cookie:<ol><li>è®¾ç½®è¿‡æœŸæ—¶é—´,cookieä¿å­˜åˆ°ç¡¬ç›˜ä¸Šï¼Œå…³é—­åå†æ¬¡æ‰“å¼€æµè§ˆå™¨ï¼Œè¿™äº›cookieä¾ç„¶æœ‰æ•ˆ</li><li>cookieå¯ä»¥åœ¨ä¸åŒçš„æµè§ˆå™¨è¿›ç¨‹é—´å…±äº«</li></ol></li></ul><h3 id="goä½¿ç”¨"><a href="#goä½¿ç”¨" class="headerlink" title="goä½¿ç”¨"></a>goä½¿ç”¨</h3><h4 id="è®¾ç½®cookie"><a href="#è®¾ç½®cookie" class="headerlink" title="è®¾ç½®cookie"></a>è®¾ç½®cookie</h4><p><code>http.setCookie(w ResponseWriter, cookie *Cookie)</code></p><blockquote><p>wè¡¨ç¤ºéœ€è¦å†™å…¥çš„responseï¼Œcookieæ˜¯ä¸€ä¸ªstruct</p></blockquote><pre><code class="go">// cookieå¯¹è±¡type Cookie struct &#123;    Name       string //å¸¸ç”¨    Value      string //å¸¸ç”¨ï¼Œ    Path       string    Domain     string    Expires    time.Time//å¸¸ç”¨    RawExpires string  // MaxAge=0 means no &#39;Max-Age&#39; attribute specified.  // MaxAge&lt;0 means delete cookie now, equivalently &#39;Max-Age: 0&#39;  // MaxAge&gt;0 means Max-Age attribute present and given in seconds    MaxAge   int    Secure   bool    HttpOnly bool    Raw      string    Unparsed []string // Raw text of unparsed attribute-value pairs&#125;</code></pre><p>ç¤ºä¾‹ï¼š</p><pre><code class="go">expiration := time.Now()expiration = expiration.AddDate(1, 0, 0)cookie := http.Cookie&#123;Name: &quot;username&quot;, Value: &quot;astaxie&quot;, Expires: expiration&#125;http.SetCookie(w, &amp;cookie)</code></pre><p><a href="https://jiapan.me/2017/cookies-max-age-vs-expires/">maxAgeå’ŒexpiresåŒºåˆ«</a></p><h4 id="è¯»å–cookie"><a href="#è¯»å–cookie" class="headerlink" title="è¯»å–cookie"></a>è¯»å–cookie</h4><p>é€šè¿‡requestè·å–cookieï¼š<code>cookie, _ := r.Cookie(&quot;username&quot;)</code></p><hr><h2 id="session"><a href="#session" class="headerlink" title="session"></a>session</h2><h3 id="åŸç†-1"><a href="#åŸç†-1" class="headerlink" title="åŸç†"></a>åŸç†</h3><p>åœ¨<font color=red>æœåŠ¡å™¨</font>ä¸Šä¿å­˜ç”¨æˆ·æ“ä½œçš„å†å²ä¿¡æ¯ã€‚æœåŠ¡å™¨ä½¿ç”¨session idæ¥æ ‡è¯†sessionï¼Œsession idç”±æœåŠ¡å™¨è´Ÿè´£äº§ç”Ÿï¼Œç›¸å½“äºä¸€ä¸ªå”¯ä¸€çš„éšæœºå¯†é’¥ï¼Œé¿å…åœ¨æ¡æ‰‹æˆ–ä¼ è¾“ä¸­æš´éœ²ç”¨æˆ·çœŸå®å¯†ç ã€‚ä½†è¯¥æ–¹å¼ä¸‹ï¼Œä»ç„¶éœ€è¦å°†å‘é€è¯·æ±‚çš„å®¢æˆ·ç«¯ä¸sessionè¿›è¡Œå¯¹åº”ï¼Œæ‰€ä»¥å¯ä»¥å€ŸåŠ©cookieæœºåˆ¶æ¥è·å–å®¢æˆ·ç«¯çš„æ ‡è¯†ï¼ˆå³session idï¼‰ï¼Œä¹Ÿå¯ä»¥é€šè¿‡GETæ–¹å¼å°†idæäº¤ç»™æœåŠ¡å™¨ã€‚</p><h3 id=""><a href="#" class="headerlink" title=""></a></h3><p>sessioné€šè¿‡cookieï¼Œåœ¨å®¢æˆ·ç«¯ä¿å­˜session id</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>go-æ•°æ®åº“</title>
      <link href="/2023/01/12/go-shu-ju-ku/"/>
      <url>/2023/01/12/go-shu-ju-ku/</url>
      
        <content type="html"><![CDATA[<h2 id="mysql"><a href="#mysql" class="headerlink" title="mysql"></a>mysql</h2><pre><code class="go">package mainimport (    &quot;database/sql&quot;    &quot;fmt&quot;    _ &quot;github.com/go-sql-driver/mysql&quot;)func checkErr(err error) &#123;    if err != nil &#123;        panic(err)    &#125;&#125;func useMysql() &#123;    // æ‰“å¼€ä¸€ä¸ªæ³¨å†Œè¿‡çš„æ•°æ®åº“é©±åŠ¨,ç¬¬äºŒä¸ªå‚æ•°ä¸ºdata source name    db, err := sql.Open(&quot;mysql&quot;, &quot;root:123456@tcp(116.204.108.126:3306)/test?charset=utf8&quot;)    checkErr(err)    // æ’å…¥æ•°æ®    // è¿”å›å‡†å¤‡è¦æ‰§è¡Œçš„sqlæ“ä½œï¼Œç„¶åè¿”å›å‡†å¤‡å®Œæ¯•çš„æ‰§è¡ŒçŠ¶æ€    stmt, err := db.Prepare(&quot;INSERT INTO userinfo SET username=?,department=?,created=?&quot;)    checkErr(err)    // æ‰§è¡Œstmtå‡†å¤‡å¥½çš„SQLè¯­å¥    // ä¼ å…¥çš„å‚æ•°éƒ½æ˜¯=?å¯¹åº”çš„æ•°æ®    res, err := stmt.Exec(&quot;amy&quot;, &quot;ç ”å‘éƒ¨é—¨&quot;, &quot;2012-12-09&quot;)    checkErr(err)    id, err := res.LastInsertId()    checkErr(err)    fmt.Println(id)    // ä¿®æ”¹æ•°æ®    stmt, err = db.Prepare(&quot;update userinfo set username=? where uid=?&quot;)    checkErr(err)    res, err = stmt.Exec(&quot;astaxieupdate&quot;, id)    checkErr(err)    affect, err := res.RowsAffected()    checkErr(err)    fmt.Println(affect)    // æŸ¥è¯¢æ•°æ®    // ç›´æ¥æ‰§è¡ŒSqlè¿”å›Rowsç»“æœ    rows, err := db.Query(&quot;SELECT * FROM userinfo&quot;)    checkErr(err)    for rows.Next() &#123;        var uid int        var username string        var department string        var created string        err = rows.Scan(&amp;uid, &amp;username, &amp;department, &amp;created)        checkErr(err)        fmt.Println(uid)        fmt.Println(username)        fmt.Println(department)        fmt.Println(created)     &#125;    // åˆ é™¤æ•°æ®    stmt, err = db.Prepare(&quot;delete from userinfo where uid=?&quot;)    checkErr(err)    res, err = stmt.Exec(id)    checkErr(err)    affect, err = res.RowsAffected()    checkErr(err)    fmt.Println(affect)    db.Close() //å…³é—­æ•°æ®åº“è¿æ¥&#125;</code></pre><h3 id="sql-Openç¬¬äºŒå‚æ•°å½¢å¼"><a href="#sql-Openç¬¬äºŒå‚æ•°å½¢å¼" class="headerlink" title="sql.Openç¬¬äºŒå‚æ•°å½¢å¼"></a>sql.Openç¬¬äºŒå‚æ•°å½¢å¼</h3><pre><code class="bash">user@unix(/path/to/socket)/dbname?charset=utf8user:password@tcp(localhost:5555)/dbname?charset=utf8user:password@/dbnameuser:password@tcp([de:ad:be:ef::ca:fe]:80)/dbname</code></pre><h3 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h3><ul><li>sql.Open()ï¼šæ‰“å¼€ä¸€ä¸ªæ³¨å†Œè¿‡çš„æ•°æ®åº“é©±åŠ¨</li><li>db.Prepare()ï¼šè¿”å›å‡†å¤‡è¦æ‰§è¡Œçš„sqlæ“ä½œï¼Œç„¶åè¿”å›å‡†å¤‡å®Œæ¯•çš„æ‰§è¡ŒçŠ¶æ€</li><li>db.Query()ï¼šç”¨æ¥ç›´æ¥æ‰§è¡ŒSqlè¿”å›Rowsç»“æœ</li><li>stmt.Exec()ï¼šç”¨æ¥æ‰§è¡Œstmtå‡†å¤‡å¥½çš„SQLè¯­å¥</li></ul><blockquote><p>ä¼ å…¥çš„å‚æ•°éƒ½æ˜¯&#x3D;?å¯¹åº”çš„æ•°æ®ï¼Œå¯ä»¥ä¸€å®šç¨‹åº¦ä¸Šé˜²æ­¢SQLæ³¨å…¥</p></blockquote><h4 id="å¿…é¡»å¼•å…¥çš„ä¸¤ä¸ªåŒ…"><a href="#å¿…é¡»å¼•å…¥çš„ä¸¤ä¸ªåŒ…" class="headerlink" title="å¿…é¡»å¼•å…¥çš„ä¸¤ä¸ªåŒ…"></a>å¿…é¡»å¼•å…¥çš„ä¸¤ä¸ªåŒ…</h4><ol><li><pre><code>&quot;database/sql&quot;</code></pre></li><li>_ â€œgithub.com&#x2F;go-sql-driver&#x2F;mysqlâ€ &#x2F;&#x2F;é©±åŠ¨</li></ol><h2 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h2><h3 id="å¿…é¡»å¯¼å…¥çš„åŒ…"><a href="#å¿…é¡»å¯¼å…¥çš„åŒ…" class="headerlink" title="å¿…é¡»å¯¼å…¥çš„åŒ…"></a>å¿…é¡»å¯¼å…¥çš„åŒ…</h3><ul><li>â€œdatabase&#x2F;sqlâ€</li><li>_ â€œgithub.com&#x2F;mattn&#x2F;go-sqlite3â€ &#x2F;&#x2F;é©±åŠ¨</li></ul><h3 id="å’ŒmysqlåŒºåˆ«"><a href="#å’ŒmysqlåŒºåˆ«" class="headerlink" title="å’ŒmysqlåŒºåˆ«"></a>å’ŒmysqlåŒºåˆ«</h3><p>å¯¼å…¥é©±åŠ¨ï¼š<code>db, err := sql.Open(&quot;sqlite3&quot;, &quot;./foo.db&quot;)</code></p><h2 id="PostgreSQL"><a href="#PostgreSQL" class="headerlink" title="PostgreSQL"></a>PostgreSQL</h2><h3 id="å¿…é¡»å¯¼å…¥çš„åŒ…-1"><a href="#å¿…é¡»å¯¼å…¥çš„åŒ…-1" class="headerlink" title="å¿…é¡»å¯¼å…¥çš„åŒ…"></a>å¿…é¡»å¯¼å…¥çš„åŒ…</h3><ul><li>â€œdatabase&#x2F;sqlâ€</li><li>_ â€œgithub.com&#x2F;lib&#x2F;pqâ€ &#x2F;&#x2F;é©±åŠ¨</li></ul><h3 id="å’ŒmysqlåŒºåˆ«-1"><a href="#å’ŒmysqlåŒºåˆ«-1" class="headerlink" title="å’ŒmysqlåŒºåˆ«"></a>å’ŒmysqlåŒºåˆ«</h3><ol><li>PostgreSQLæ˜¯é€šè¿‡$1,$2è¿™ç§æ–¹å¼æ¥æŒ‡å®šè¦ä¼ é€’çš„å‚æ•°ï¼Œè€Œä¸æ˜¯MySQLä¸­çš„?</li><li>sql.Openä¸­çš„dsnä¿¡æ¯çš„æ ¼å¼ä¹Ÿä¸MySQLçš„é©±åŠ¨ä¸­çš„dsnæ ¼å¼ä¸ä¸€æ ·</li></ol><pre><code class="go">func usePostgreSQL() &#123;    connStr := &quot;postgres://postgres:123456@116.204.108.126:3306/test?sslmode=disable&quot;    db, err := sql.Open(&quot;postgres&quot;, connStr)    checkErr(err)    // æ’å…¥æ•°æ®    stmt, err := db.Prepare(&quot;INSERT INTO userinfo(username,department,created) VALUES($1,$2,$3) RETURNING uid&quot;)    checkErr(err)    res, err := stmt.Exec(&quot;astaxie&quot;, &quot;ç ”å‘éƒ¨é—¨&quot;, &quot;2012-12-09&quot;)    checkErr(err)    var lastInsertId int    err = db.QueryRow(&quot;INSERT INTO userinfo(username,department,created) VALUES($1,$2,$3) returning uid;&quot;, &quot;astaxie&quot;, &quot;ç ”å‘éƒ¨é—¨&quot;, &quot;2012-12-09&quot;).Scan(&amp;lastInsertId)    checkErr(err)    fmt.Println(&quot;æœ€åæ’å…¥id =&quot;, lastInsertId, res)    // ä¿®æ”¹æ•°æ®    stmt, err = db.Prepare(&quot;update userinfo set username=$1 where uid=$2&quot;)    checkErr(err)    res, err = stmt.Exec(&quot;astaxieupdate&quot;, lastInsertId)    checkErr(err)    affect, err := res.RowsAffected()    checkErr(err)    fmt.Println(affect)    // æŸ¥çœ‹æ•°æ®    rows, err := db.Query(&quot;SELECT * FROM userinfo&quot;)    checkErr(err)    for rows.Next() &#123;        var uid int        var username string        var department string        var created string        err = rows.Scan(&amp;uid, &amp;username, &amp;department, &amp;created)        checkErr(err)        fmt.Println(uid)        fmt.Println(username)        fmt.Println(department)        fmt.Println(created)    &#125;    // åˆ é™¤æ•°æ®    stmt, err = db.Prepare(&quot;delete from userinfo where uid=$1&quot;)    checkErr(err)    res, err = stmt.Exec(lastInsertId)    checkErr(err)    affect, err = res.RowsAffected()    checkErr(err)    fmt.Println(affect)    db.Close()&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>dockerå®‰è£…</title>
      <link href="/2023/01/11/docker-an-zhuang/"/>
      <url>/2023/01/11/docker-an-zhuang/</url>
      
        <content type="html"><![CDATA[<h2 id="åŸºäºcentos7çš„è®¾ç½®Dockeræ–¹å¼çš„å®‰è£…"><a href="#åŸºäºcentos7çš„è®¾ç½®Dockeræ–¹å¼çš„å®‰è£…" class="headerlink" title="åŸºäºcentos7çš„è®¾ç½®Dockeræ–¹å¼çš„å®‰è£…"></a>åŸºäºcentos7çš„è®¾ç½®Dockeræ–¹å¼çš„å®‰è£…</h2><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://docs.docker.com/engine/install/centos/">https://docs.docker.com/engine/install/centos/</a></p><h3 id="è®¾ç½®ä»“åº“"><a href="#è®¾ç½®ä»“åº“" class="headerlink" title="è®¾ç½®ä»“åº“"></a>è®¾ç½®ä»“åº“</h3><ol><li>åˆ é™¤æ—§ç‰ˆæœ¬çš„docker engine</li></ol><pre><code class="bash">sudo yum remove docker \                  docker-client \                  docker-client-latest \                  docker-common \                  docker-latest \                  docker-latest-logrotate \                  docker-logrotate \                  docker-engine</code></pre><ol start="2"><li>å®‰è£…æä¾›<code>yum-config-manager</code>å·¥å…·çš„yum-utilsåŒ…</li></ol><pre><code class="bash">yum install -y yum-utilsyum-config-manager \    --add-repo \    https://download.docker.com/linux/centos/docker-ce.repo</code></pre><h3 id="å®‰è£…docker-å¼•æ“"><a href="#å®‰è£…docker-å¼•æ“" class="headerlink" title="å®‰è£…docker å¼•æ“"></a>å®‰è£…docker å¼•æ“</h3><pre><code class="bash">yum install docker-ce docker-ce-cli containerd.io docker-compose-plugin #å®‰è£…æœ€æ–°ç‰ˆ#å®‰è£…æŒ‡å®šç‰ˆæœ¬yum list docker-ce --showduplicates | sort -ryum install docker-ce-&lt;VERSION_STRING&gt; docker-ce-cli-&lt;VERSION_STRING&gt; containerd.io docker-compose-plugin </code></pre><h3 id="å¯åŠ¨docker"><a href="#å¯åŠ¨docker" class="headerlink" title="å¯åŠ¨docker"></a>å¯åŠ¨docker</h3><pre><code class="bash">systemctl start docker# éªŒè¯docker run hello-world</code></pre><h3 id="åˆ›å»ºdocker-ç»„å’Œç”¨æˆ·-éå¿…é¡»"><a href="#åˆ›å»ºdocker-ç»„å’Œç”¨æˆ·-éå¿…é¡»" class="headerlink" title="åˆ›å»ºdocker ç»„å’Œç”¨æˆ·(éå¿…é¡»)"></a>åˆ›å»ºdocker ç»„å’Œç”¨æˆ·(éå¿…é¡»)</h3><pre><code class="bash">groupadd docker # åˆ›å»ºdockerç”¨æˆ·ç»„usermod -aG docker $USER #å°†ç”¨æˆ·æ·»åŠ åˆ°ç»„å†…</code></pre><p>é€€å‡ºç™»å½•åé‡æ–°ç™»å½•,ç»„å’Œç”¨æˆ·æ‰ä¼šç”Ÿæ•ˆï¼Œæ­¤æ—¶å³ä½¿æ˜¯érootç”¨æˆ·ä¹Ÿä¸éœ€è¦ä½¿ç”¨sudo</p><h4 id="è§£å†³æŠ¥é”™"><a href="#è§£å†³æŠ¥é”™" class="headerlink" title="è§£å†³æŠ¥é”™"></a>è§£å†³æŠ¥é”™</h4><blockquote><p>WARNING: Error loading config file: &#x2F;home&#x2F;user&#x2F;.docker&#x2F;config.json - stat &#x2F;home&#x2F;user&#x2F;.docker&#x2F;config.json: permission denied<br>è§£å†³æ–¹æ³•</p></blockquote><pre><code class="bash">sudo chown &quot;$USER&quot;:&quot;$USER&quot; /home/&quot;$USER&quot;/.docker -Rsudo chmod g+rwx &quot;$HOME/.docker&quot; -R</code></pre><h3 id="è®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨"><a href="#è®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨" class="headerlink" title="è®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨"></a>è®¾ç½®ä¸ºå¼€æœºè‡ªå¯åŠ¨</h3><pre><code class="bash">systemctl enable docker.servicesystemctl enable containerd.service# åœæ­¢å¼€æœºè‡ªå¯åŠ¨systemctl disable docker.servicesystemctl disable containerd.service</code></pre><h2 id="åˆ›å»ºä¸€ä¸ªmysqlå®¹å™¨"><a href="#åˆ›å»ºä¸€ä¸ªmysqlå®¹å™¨" class="headerlink" title="åˆ›å»ºä¸€ä¸ªmysqlå®¹å™¨"></a>åˆ›å»ºä¸€ä¸ªmysqlå®¹å™¨</h2><p><code>docker run --name test_sql -e MYSQL_ROOT_PASSWORD=123 -d mysql:latest</code></p><h2 id="å…¶ä»–æ“ä½œ"><a href="#å…¶ä»–æ“ä½œ" class="headerlink" title="å…¶ä»–æ“ä½œ"></a>å…¶ä»–æ“ä½œ</h2><pre><code class="bash">docker exec -it test_sql bash# æŸ¥çœ‹æ—¥å¿—docker logs test_sql </code></pre>]]></content>
      
      
      <categories>
          
          <category> Docker </category>
          
      </categories>
      
      
        <tags>
            
            <tag> docker </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>go-è¡¨å•å¤„ç†æ–‡ä»¶ä¸Šä¼ </title>
      <link href="/2023/01/11/go-biao-dan-chu-li-wen-jian-shang-chuan/"/>
      <url>/2023/01/11/go-biao-dan-chu-li-wen-jian-shang-chuan/</url>
      
        <content type="html"><![CDATA[<h2 id="formçš„enctypeå±æ€§"><a href="#formçš„enctypeå±æ€§" class="headerlink" title="formçš„enctypeå±æ€§"></a>formçš„<code>enctype</code>å±æ€§</h2><ol><li>application&#x2F;x-www-form-urlencoded   è¡¨ç¤ºåœ¨å‘é€å‰ç¼–ç æ‰€æœ‰å­—ç¬¦ï¼ˆé»˜è®¤ï¼‰</li><li>multipart&#x2F;form-data  ä¸å¯¹å­—ç¬¦ç¼–ç ã€‚åœ¨ä½¿ç”¨åŒ…å«æ–‡ä»¶ä¸Šä¼ æ§ä»¶çš„è¡¨å•æ—¶ï¼Œå¿…é¡»ä½¿ç”¨è¯¥å€¼ã€‚</li><li>text&#x2F;plain  ç©ºæ ¼è½¬æ¢ä¸º â€œ+â€ åŠ å·ï¼Œä½†ä¸å¯¹ç‰¹æ®Šå­—ç¬¦ç¼–ç ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>webå·¥ä½œæ–¹å¼</title>
      <link href="/2023/01/10/web-gong-zuo-fang-shi/"/>
      <url>/2023/01/10/web-gong-zuo-fang-shi/</url>
      
        <content type="html"><![CDATA[<h5 id="è¡¨ç°ï¼š"><a href="#è¡¨ç°ï¼š" class="headerlink" title="è¡¨ç°ï¼š"></a>è¡¨ç°ï¼š</h5><p>æµè§ˆç½‘é¡µçš„æ—¶å€™,ä¼šæ‰“å¼€æµè§ˆå™¨ï¼Œè¾“å…¥ç½‘å€åæŒ‰ä¸‹å›è½¦é”®ï¼Œç„¶åå°±ä¼šæ˜¾ç¤ºå‡ºä½ æƒ³è¦æµè§ˆçš„å†…å®¹</p><h2 id="èƒŒåæµç¨‹"><a href="#èƒŒåæµç¨‹" class="headerlink" title="èƒŒåæµç¨‹"></a>èƒŒåæµç¨‹</h2><p>æ™®é€šä¸Šç½‘è¿‡ç¨‹ï¼š</p><ol><li>è¾“å…¥URLæ—¶,æµè§ˆå™¨(å®¢æˆ·ç«¯)è¯·æ±‚DNSæœåŠ¡å™¨ï¼Œè·å–åˆ°åº”å¯¹åº”çš„IP</li><li>é€šè¿‡ipåœ°å€æ‰¾åˆ°ipå¯¹åº”çš„æœåŠ¡å™¨ï¼Œè¦æ±‚å»ºç«‹TCPè¿æ¥</li><li>æµè§ˆå™¨å‘é€å®ŒHTTP Requestï¼ˆè¯·æ±‚ï¼‰åŒ…</li><li>æœåŠ¡å™¨æ¥æ”¶åˆ°è¯·æ±‚åŒ…ä¹‹åå¼€å§‹å¤„ç†è¯·æ±‚åŒ…</li><li>æœåŠ¡å™¨è°ƒç”¨è‡ªèº«æœåŠ¡ï¼Œè¿”å›HTTP Responseï¼ˆå“åº”ï¼‰åŒ…</li><li>å®¢æˆ·ç«¯æ”¶åˆ°æ¥è‡ªæœåŠ¡å™¨çš„å“åº”åå¼€å§‹æ¸²æŸ“è¿™ä¸ªResponseåŒ…é‡Œçš„ä¸»ä½“ï¼ˆbodyï¼‰</li><li>æ”¶åˆ°å…¨éƒ¨çš„å†…å®¹éšåæ–­å¼€ä¸è¯¥æœåŠ¡å™¨ä¹‹é—´çš„TCPè¿æ¥</li></ol><h2 id="WebæœåŠ¡å™¨çš„å·¥ä½œåŸç†"><a href="#WebæœåŠ¡å™¨çš„å·¥ä½œåŸç†" class="headerlink" title="WebæœåŠ¡å™¨çš„å·¥ä½œåŸç†"></a>WebæœåŠ¡å™¨çš„å·¥ä½œåŸç†</h2><ol><li>å®¢æˆ·æœºé€šè¿‡TCP&#x2F;IPåè®®å»ºç«‹åˆ°æœåŠ¡å™¨çš„TCPè¿æ¥</li><li>å®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€HTTPåè®®è¯·æ±‚åŒ…ï¼Œè¯·æ±‚æœåŠ¡å™¨é‡Œçš„èµ„æºæ–‡æ¡£</li><li>æœåŠ¡å™¨å‘å®¢æˆ·æœºå‘é€HTTPåè®®åº”ç­”åŒ…ï¼Œå¦‚æœè¯·æ±‚çš„èµ„æºåŒ…å«æœ‰åŠ¨æ€è¯­è¨€çš„å†…å®¹ï¼Œé‚£ä¹ˆæœåŠ¡å™¨ä¼šè°ƒç”¨åŠ¨æ€è¯­è¨€çš„è§£é‡Šå¼•æ“è´Ÿè´£å¤„ç†â€œåŠ¨æ€å†…å®¹â€ï¼Œå¹¶å°†å¤„ç†å¾—åˆ°çš„æ•°æ®è¿”å›ç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·æœºä¸æœåŠ¡å™¨æ–­å¼€ã€‚ç”±å®¢æˆ·ç«¯è§£é‡ŠHTMLæ–‡æ¡£ï¼Œåœ¨å®¢æˆ·ç«¯å±å¹•ä¸Šæ¸²æŸ“å›¾å½¢ç»“æœ</li></ol><blockquote><p>æ³¨æ„ï¼šå®¢æˆ·æœºä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡æ˜¯éæŒä¹…è¿æ¥çš„ï¼Œä¹Ÿå°±æ˜¯å½“æœåŠ¡å™¨å‘é€äº†åº”ç­”åå°±ä¸å®¢æˆ·æœºæ–­å¼€è¿æ¥ï¼Œç­‰å¾…ä¸‹ä¸€æ¬¡è¯·æ±‚</p></blockquote><h2 id="urlå’ŒDNSè§£æ"><a href="#urlå’ŒDNSè§£æ" class="headerlink" title="urlå’ŒDNSè§£æ"></a>urlå’ŒDNSè§£æ</h2><h3 id="URL"><a href="#URL" class="headerlink" title="URL"></a>URL</h3><pre><code>scheme://host[:port#]/path/.../[?query-string][#anchor]scheme         æŒ‡å®šåº•å±‚ä½¿ç”¨çš„åè®®(ä¾‹å¦‚ï¼šhttp, https, ftp)host           HTTPæœåŠ¡å™¨çš„IPåœ°å€æˆ–è€…åŸŸåport#          HTTPæœåŠ¡å™¨çš„é»˜è®¤ç«¯å£æ˜¯80ï¼Œè¿™ç§æƒ…å†µä¸‹ç«¯å£å·å¯ä»¥çœç•¥ã€‚å¦‚æœä½¿ç”¨äº†åˆ«çš„ç«¯å£ï¼Œå¿…é¡»æŒ‡æ˜ï¼Œä¾‹å¦‚ http://www.cnblogs.com:8080/path           è®¿é—®èµ„æºçš„è·¯å¾„query-string   å‘é€ç»™httpæœåŠ¡å™¨çš„æ•°æ®anchor         é”š</code></pre><h3 id="DNS-åŸŸåç³»ç»Ÿ"><a href="#DNS-åŸŸåç³»ç»Ÿ" class="headerlink" title="DNS-åŸŸåç³»ç»Ÿ"></a>DNS-åŸŸåç³»ç»Ÿ</h3><p>ç”¨äºTCP&#x2F;IPç½‘ç»œï¼Œå°†ä¸»æœºåæˆ–åŸŸåè½¬æ¢ä¸ºå®é™…IPåœ°å€</p><img src="/2023/01/10/web-gong-zuo-fang-shi/3.1.dns_hierachy.png" class="" title="dns"><h4 id="DNSè§£æè¿‡ç¨‹"><a href="#DNSè§£æè¿‡ç¨‹" class="headerlink" title="DNSè§£æè¿‡ç¨‹"></a>DNSè§£æè¿‡ç¨‹</h4><ol><li>åœ¨æµè§ˆå™¨ä¸­è¾“å…¥<a href="http://www.qq.comåŸŸå,æ“ä½œç³»ç»Ÿä¼šå…ˆæ£€æŸ¥è‡ªå·±æœ¬åœ°çš„hostsæ–‡ä»¶æ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»,å¦‚æœæœ‰,å°±å…ˆè°ƒç”¨è¿™ä¸ªipåœ°å€æ˜ å°„,å®ŒæˆåŸŸåè§£æ/">www.qq.comåŸŸåï¼Œæ“ä½œç³»ç»Ÿä¼šå…ˆæ£€æŸ¥è‡ªå·±æœ¬åœ°çš„hostsæ–‡ä»¶æ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œå°±å…ˆè°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æ</a></li><li>å¦‚æœhostsé‡Œæ²¡æœ‰è¿™ä¸ªåŸŸåçš„æ˜ å°„ï¼Œåˆ™æŸ¥æ‰¾æœ¬åœ°DNSè§£æå™¨ç¼“å­˜ï¼Œæ˜¯å¦æœ‰è¿™ä¸ªç½‘å€æ˜ å°„å…³ç³»ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ï¼Œå®ŒæˆåŸŸåè§£æã€‚</li><li>å¦‚æœå‰ä¸¤æ­¥éƒ½æ²¡æœ‰ç›¸åº”çš„ç½‘å€æ˜ å°„å…³ç³»ï¼Œé¦–å…ˆä¼šæ‰¾TCP&#x2F;IPå‚æ•°ä¸­è®¾ç½®çš„é¦–é€‰DNSæœåŠ¡å™¨ã€æœ¬åœ°DNSæœåŠ¡å™¨ã€‘ï¼Œæ­¤æœåŠ¡å™¨æ”¶åˆ°æŸ¥è¯¢æ—¶ï¼Œå¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼ŒåŒ…å«åœ¨æœ¬åœ°é…ç½®åŒºåŸŸèµ„æºä¸­ï¼Œåˆ™è¿”å›è§£æç»“æœç»™å®¢æˆ·æœºï¼Œå®ŒæˆåŸŸåè§£æ</li><li>å¦‚æœè¦æŸ¥è¯¢çš„åŸŸåï¼Œä¸ç”±æœ¬åœ°DNSæœåŠ¡å™¨åŒºåŸŸè§£æï¼Œä½†è¯¥æœåŠ¡å™¨å·²ç¼“å­˜äº†æ­¤ç½‘å€æ˜ å°„å…³ç³»ï¼Œåˆ™è°ƒç”¨è¿™ä¸ªIPåœ°å€æ˜ å°„ï¼Œå®ŒæˆåŸŸåè§£æ</li><li>å¦‚æœæœ¬åœ°DNSæœåŠ¡å™¨æœ¬åœ°åŒºåŸŸæ–‡ä»¶ä¸ç¼“å­˜è§£æéƒ½å¤±æ•ˆï¼Œåˆ™æ ¹æ®æœ¬åœ°DNSæœåŠ¡å™¨çš„è®¾ç½®ï¼ˆæ˜¯å¦è®¾ç½®è½¬å‘å™¨ï¼‰è¿›è¡ŒæŸ¥è¯¢ï¼Œ<ul><li>å¦‚æœæœªç”¨è½¬å‘æ¨¡å¼ï¼Œæœ¬åœ°DNSå°±æŠŠè¯·æ±‚å‘è‡³ â€œæ ¹DNSæœåŠ¡å™¨â€ï¼Œâ€œæ ¹DNSæœåŠ¡å™¨â€æ”¶åˆ°è¯·æ±‚åä¼šåˆ¤æ–­è¿™ä¸ªåŸŸå(.com)æ˜¯è°æ¥æˆæƒç®¡ç†ï¼Œå¹¶ä¼šè¿”å›ä¸€ä¸ªè´Ÿè´£è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨çš„ä¸€ä¸ªIPã€‚æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°IPä¿¡æ¯åï¼Œå°†ä¼šè”ç³»è´Ÿè´£.comåŸŸçš„è¿™å°æœåŠ¡å™¨ã€‚è¿™å°è´Ÿè´£.comåŸŸçš„æœåŠ¡å™¨æ”¶åˆ°è¯·æ±‚åï¼Œå¦‚æœè‡ªå·±æ— æ³•è§£æï¼Œå®ƒå°±ä¼šæ‰¾ä¸€ä¸ªç®¡ç†.comåŸŸçš„ä¸‹ä¸€çº§DNSæœåŠ¡å™¨åœ°å€(qq.com)ç»™æœ¬åœ°DNSæœåŠ¡å™¨ã€‚å½“æœ¬åœ°DNSæœåŠ¡å™¨æ”¶åˆ°è¿™ä¸ªåœ°å€åï¼Œå°±ä¼šæ‰¾qq.comåŸŸæœåŠ¡å™¨ï¼Œé‡å¤ä¸Šé¢çš„åŠ¨ä½œï¼Œè¿›è¡ŒæŸ¥è¯¢ï¼Œç›´è‡³æ‰¾åˆ°<a href="http://www.qq.comä¸»æœº./">www.qq.comä¸»æœºã€‚</a></li><li>å¦‚æœç”¨çš„æ˜¯è½¬å‘æ¨¡å¼ï¼Œæ­¤DNSæœåŠ¡å™¨å°±ä¼šæŠŠè¯·æ±‚è½¬å‘è‡³ä¸Šä¸€çº§DNSæœåŠ¡å™¨ï¼Œç”±ä¸Šä¸€çº§æœåŠ¡å™¨è¿›è¡Œè§£æï¼Œä¸Šä¸€çº§æœåŠ¡å™¨å¦‚æœä¸èƒ½è§£æï¼Œæˆ–æ‰¾æ ¹DNSæˆ–æŠŠè½¬è¯·æ±‚è½¬è‡³ä¸Šä¸Šçº§ï¼Œä»¥æ­¤å¾ªç¯ã€‚ä¸ç®¡æœ¬åœ°DNSæœåŠ¡å™¨ç”¨çš„æ˜¯è½¬å‘ï¼Œè¿˜æ˜¯æ ¹æç¤ºï¼Œæœ€åéƒ½æ˜¯æŠŠç»“æœè¿”å›ç»™æœ¬åœ°DNSæœåŠ¡å™¨ï¼Œç”±æ­¤DNSæœåŠ¡å™¨å†è¿”å›ç»™å®¢æˆ·æœº</li></ul></li></ol>  <img src="/2023/01/10/web-gong-zuo-fang-shi/3.1.dns_inquery.png" class="" title="inquery"><h2 id="httpåè®®"><a href="#httpåè®®" class="headerlink" title="httpåè®®"></a>httpåè®®</h2><p>åŠŸèƒ½ï¼šè®©WebæœåŠ¡å™¨ä¸æµè§ˆå™¨(å®¢æˆ·ç«¯)é€šè¿‡Internetå‘é€ä¸æ¥æ”¶æ•°æ®<br>åŸºäºï¼šTCPåè®®ï¼Œä¸€èˆ¬ä½¿ç”¨TCP 80ç«¯å£<br>æ— çŠ¶æ€ï¼šåŒä¸€ä¸ªå®¢æˆ·ç«¯çš„è¿™æ¬¡è¯·æ±‚å’Œä¸Šæ¬¡è¯·æ±‚æ²¡æœ‰å¯¹åº”å…³ç³»ï¼Œå¯¹HTTPæœåŠ¡å™¨æ¥è¯´ï¼Œå®ƒå¹¶ä¸çŸ¥é“è¿™ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯<br>è§£å†³é—®é¢˜ï¼šå¼•å…¥äº†Cookieæœºåˆ¶æ¥ç»´æŠ¤è¿æ¥çš„å¯æŒç»­çŠ¶æ€æ¥è§£å†³è¯†åˆ«ä¸¤ä¸ªè¯·æ±‚æ˜¯å¦æ¥è‡ªåŒä¸€ä¸ªå®¢æˆ·ç«¯é—®é¢˜</p><h3 id="å®¢æˆ·ç«¯è¯·æ±‚åŒ…â€”â€”æµè§ˆå™¨ä¿¡æ¯"><a href="#å®¢æˆ·ç«¯è¯·æ±‚åŒ…â€”â€”æµè§ˆå™¨ä¿¡æ¯" class="headerlink" title="å®¢æˆ·ç«¯è¯·æ±‚åŒ…â€”â€”æµè§ˆå™¨ä¿¡æ¯"></a>å®¢æˆ·ç«¯è¯·æ±‚åŒ…â€”â€”æµè§ˆå™¨ä¿¡æ¯</h3><pre><code>GET /domains/example/ HTTP/1.1//è¯·æ±‚è¡Œ: è¯·æ±‚æ–¹æ³• è¯·æ±‚URI HTTPåè®®/åè®®ç‰ˆæœ¬Hostï¼šwww.iana.org//æœåŠ¡ç«¯çš„ä¸»æœºåUser-Agentï¼šMozilla/5.0 (Windows NT 6.1) AppleWebKit/537.4 (KHTML, like Gecko) Chrome/22.0.1229.94 Safari/537.4//æµè§ˆå™¨ä¿¡æ¯Acceptï¼štext/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8//å®¢æˆ·ç«¯èƒ½æ¥æ”¶çš„MIMEAccept-Encodingï¼šgzip,deflate,sdch//æ˜¯å¦æ”¯æŒæµå‹ç¼©Accept-Charsetï¼šUTF-8,*;q=0.5//å®¢æˆ·ç«¯å­—ç¬¦ç¼–ç é›†//ç©ºè¡Œ,ç”¨äºåˆ†å‰²è¯·æ±‚å¤´å’Œæ¶ˆæ¯ä½“//æ¶ˆæ¯ä½“Body,è¯·æ±‚èµ„æºå‚æ•°,ä¾‹å¦‚POSTä¼ é€’çš„å‚æ•°</code></pre><h4 id="ä¸æœåŠ¡å™¨äº¤äº’çš„è¯·æ±‚æ–¹æ³•"><a href="#ä¸æœåŠ¡å™¨äº¤äº’çš„è¯·æ±‚æ–¹æ³•" class="headerlink" title="ä¸æœåŠ¡å™¨äº¤äº’çš„è¯·æ±‚æ–¹æ³•"></a>ä¸æœåŠ¡å™¨äº¤äº’çš„è¯·æ±‚æ–¹æ³•</h4><p>GET,POST,PUT,DELETE-&gt;æŸ¥ï¼Œå¢ï¼Œæ”¹ï¼Œåˆ </p><h4 id="getä¸poståŒºåˆ«"><a href="#getä¸poståŒºåˆ«" class="headerlink" title="getä¸poståŒºåˆ«"></a>getä¸poståŒºåˆ«</h4><img src="/2023/01/10/web-gong-zuo-fang-shi/3.1.http.png" class="" title="getè¯·æ±‚"> <img src="/2023/01/10/web-gong-zuo-fang-shi/3.1.httpPOST.png" class="" title="postè¯·æ±‚"><ol><li>GETè¯·æ±‚æ¶ˆæ¯ä½“ä¸ºç©ºï¼ŒPOSTè¯·æ±‚å¸¦æœ‰æ¶ˆæ¯ä½“</li><li>GETæäº¤çš„æ•°æ®ä¼šæ”¾åœ¨URLä¹‹åï¼Œä»¥?åˆ†å‰²URLå’Œä¼ è¾“æ•°æ®ï¼Œå‚æ•°ä¹‹é—´ä»¥&amp;ç›¸è¿ï¼›POSTæ–¹æ³•æ˜¯æŠŠæäº¤çš„æ•°æ®æ”¾åœ¨HTTPåŒ…çš„bodyä¸­</li><li>GETæäº¤çš„æ•°æ®å¤§å°æœ‰é™åˆ¶ï¼ˆå› ä¸ºæµè§ˆå™¨å¯¹URLçš„é•¿åº¦æœ‰é™åˆ¶ï¼‰ï¼Œè€ŒPOSTæ–¹æ³•æäº¤çš„æ•°æ®æ²¡æœ‰é™åˆ¶</li><li>GETæ–¹å¼æäº¤æ•°æ®ï¼Œä¼šå¸¦æ¥å®‰å…¨é—®é¢˜ï¼Œæ¯”å¦‚ä¸€ä¸ªç™»å½•é¡µé¢ï¼Œé€šè¿‡GETæ–¹å¼æäº¤æ•°æ®æ—¶ï¼Œç”¨æˆ·åå’Œå¯†ç å°†å‡ºç°åœ¨URLä¸Šï¼Œå¦‚æœé¡µé¢å¯ä»¥è¢«ç¼“å­˜æˆ–è€…å…¶ä»–äººå¯ä»¥è®¿é—®è¿™å°æœºå™¨ï¼Œå°±å¯ä»¥ä»å†å²è®°å½•è·å¾—è¯¥ç”¨æˆ·çš„è´¦å·å’Œå¯†ç </li></ol><blockquote><p>æµè§ˆå™¨å¯¹urlé•¿åº¦é™åˆ¶:<br>IEæµè§ˆå™¨:2048å­—èŠ‚<br>360æé€Ÿæµè§ˆå™¨:2118å­—èŠ‚<br>Firefox(Browser):65536å­—èŠ‚<br>Safari(Browser):80000å­—èŠ‚<br>Opera(Browser):190000å­—èŠ‚<br>Google(chrome):8182å­—èŠ‚</p></blockquote><h3 id="æœåŠ¡å™¨ç«¯å“åº”åŒ…"><a href="#æœåŠ¡å™¨ç«¯å“åº”åŒ…" class="headerlink" title="æœåŠ¡å™¨ç«¯å“åº”åŒ…"></a>æœåŠ¡å™¨ç«¯å“åº”åŒ…</h3><pre><code>HTTP/1.1 200 OK//çŠ¶æ€è¡Œ=HTTPåè®®ç‰ˆæœ¬å·+çŠ¶æ€ç +çŠ¶æ€æ¶ˆæ¯Server: nginx/1.0.8//æœåŠ¡å™¨ä½¿ç”¨çš„WEBè½¯ä»¶ååŠç‰ˆæœ¬Date:Date: Tue, 30 Oct 2012 04:14:25 GMT//å‘é€æ—¶é—´Content-Type: text/html//æœåŠ¡å™¨å‘é€ä¿¡æ¯çš„ç±»å‹Transfer-Encoding: chunked//è¡¨ç¤ºå‘é€HTTPåŒ…æ˜¯åˆ†æ®µå‘çš„Connection: keep-alive//ä¿æŒè¿æ¥çŠ¶æ€Content-Length: 90//ä¸»ä½“å†…å®¹é•¿åº¦//ç©ºè¡Œ ç”¨æ¥åˆ†å‰²æ¶ˆæ¯å¤´å’Œä¸»ä½“&lt;!DOCTYPE html PUBLIC &quot;-//W3C//DTD XHTML 1.0 Transitional//EN&quot;... //æ¶ˆæ¯ä½“</code></pre><h4 id="çŠ¶æ€ç "><a href="#çŠ¶æ€ç " class="headerlink" title="çŠ¶æ€ç "></a>çŠ¶æ€ç </h4><ul><li>1XX æç¤ºä¿¡æ¯ - è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ï¼Œç»§ç»­å¤„ç†</li><li>2XX æˆåŠŸ - è¡¨ç¤ºè¯·æ±‚å·²è¢«æˆåŠŸæ¥æ”¶ï¼Œç†è§£ï¼Œæ¥å—</li><li>3XX é‡å®šå‘ - è¦å®Œæˆè¯·æ±‚å¿…é¡»è¿›è¡Œæ›´è¿›ä¸€æ­¥çš„å¤„ç†ï¼Œ302è¡¨ç¤ºè·³è½¬</li><li>4XX å®¢æˆ·ç«¯é”™è¯¯ - è¯·æ±‚æœ‰è¯­æ³•é”™è¯¯æˆ–è¯·æ±‚æ— æ³•å®ç°</li><li>5XX æœåŠ¡å™¨ç«¯é”™è¯¯ - æœåŠ¡å™¨æœªèƒ½å®ç°åˆæ³•çš„è¯·æ±‚</li></ul><h3 id="HTTPåè®®æ˜¯æ— çŠ¶æ€çš„å’ŒConnection-keep-aliveçš„åŒºåˆ«"><a href="#HTTPåè®®æ˜¯æ— çŠ¶æ€çš„å’ŒConnection-keep-aliveçš„åŒºåˆ«" class="headerlink" title="HTTPåè®®æ˜¯æ— çŠ¶æ€çš„å’ŒConnection: keep-aliveçš„åŒºåˆ«"></a>HTTPåè®®æ˜¯æ— çŠ¶æ€çš„å’ŒConnection: keep-aliveçš„åŒºåˆ«</h3><p>ä»HTTP&#x2F;1.1èµ·ï¼Œé»˜è®¤éƒ½å¼€å¯äº†Keep-Aliveä¿æŒè¿æ¥ç‰¹æ€§</p><ol><li>æ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼ŒæœåŠ¡å™¨ä¸çŸ¥é“å®¢æˆ·ç«¯æ˜¯ä»€ä¹ˆçŠ¶æ€ã€‚</li><li>æ— çŠ¶æ€ä¸ä»£è¡¨HTTPä¸èƒ½ä¿æŒTCPè¿æ¥ï¼Œæ›´ä¸èƒ½ä»£è¡¨HTTPä½¿ç”¨çš„æ˜¯UDPåè®®ï¼ˆé¢å¯¹æ— è¿æ¥ï¼‰</li><li>å½“ä¸€ä¸ªç½‘é¡µæ‰“å¼€å®Œæˆåï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ç”¨äºä¼ è¾“HTTPæ•°æ®çš„TCPè¿æ¥ä¸ä¼šå…³é—­ï¼Œå¦‚æœå®¢æˆ·ç«¯å†æ¬¡è®¿é—®è¿™ä¸ªæœåŠ¡å™¨ä¸Šçš„ç½‘é¡µï¼Œä¼šç»§ç»­ä½¿ç”¨è¿™ä¸€æ¡å·²ç»å»ºç«‹çš„TCPè¿æ¥</li><li>Keep-Aliveä¸ä¼šæ°¸ä¹…ä¿æŒè¿æ¥ï¼Œå®ƒæœ‰ä¸€ä¸ªä¿æŒæ—¶é—´ï¼Œå¯ä»¥åœ¨ä¸åŒæœåŠ¡å™¨è½¯ä»¶ï¼ˆå¦‚Apacheï¼‰ä¸­è®¾ç½®è¿™ä¸ªæ—¶é—´</li></ol><h3 id="ä¼˜åŒ–"><a href="#ä¼˜åŒ–" class="headerlink" title="ä¼˜åŒ–"></a>ä¼˜åŒ–</h3><ol><li>ç¬¬ä¸€æ¬¡è¯·æ±‚urlï¼ŒæœåŠ¡å™¨ç«¯è¿”å›çš„æ˜¯htmlé¡µé¢ï¼Œç„¶åæµè§ˆå™¨å¼€å§‹æ¸²æŸ“HTML</li><li>å½“è§£æåˆ°HTML DOMé‡Œé¢çš„å›¾ç‰‡è¿æ¥ï¼Œcssè„šæœ¬å’Œjsè„šæœ¬çš„é“¾æ¥ï¼Œæµè§ˆå™¨å°±ä¼šè‡ªåŠ¨å‘èµ·ä¸€ä¸ªè¯·æ±‚é™æ€èµ„æºçš„HTTPè¯·æ±‚ï¼Œè·å–ç›¸å¯¹åº”çš„é™æ€èµ„æºï¼Œç„¶åæµè§ˆå™¨å°±ä¼šæ¸²æŸ“å‡ºæ¥ï¼Œæœ€ç»ˆå°†æ‰€æœ‰èµ„æºæ•´åˆã€æ¸²æŸ“ï¼Œå®Œæ•´å±•ç°åœ¨æˆ‘ä»¬é¢å‰çš„å±å¹•ä¸Šã€‚</li></ol><h4 id="ç½‘é¡µä¼˜åŒ–ï¼š"><a href="#ç½‘é¡µä¼˜åŒ–ï¼š" class="headerlink" title="ç½‘é¡µä¼˜åŒ–ï¼š"></a>ç½‘é¡µä¼˜åŒ–ï¼š</h4><p>å‡å°‘HTTPè¯·æ±‚æ¬¡æ•°ï¼Œå°±æ˜¯æŠŠå°½é‡å¤šçš„csså’Œjsèµ„æºåˆå¹¶åœ¨ä¸€èµ·ï¼Œç›®çš„æ˜¯å°½é‡å‡å°‘ç½‘é¡µè¯·æ±‚é™æ€èµ„æºçš„æ¬¡æ•°ï¼Œæé«˜ç½‘é¡µåŠ è½½é€Ÿåº¦ï¼ŒåŒæ—¶å‡ç¼“æœåŠ¡å™¨çš„å‹åŠ›ã€‚</p><h2 id="Goä¸web"><a href="#Goä¸web" class="headerlink" title="Goä¸web"></a>Goä¸web</h2><p>ä¸€ä¸ªç®€å•çš„webæœåŠ¡å™¨</p><pre><code class="go">package mainimport (    &quot;fmt&quot;    &quot;net/http&quot;    &quot;strings&quot;    &quot;log&quot;)func sayhelloName(w http.ResponseWriter, r *http.Request) &#123;    r.ParseForm()  //è§£æå‚æ•°ï¼Œé»˜è®¤æ˜¯ä¸ä¼šè§£æçš„    fmt.Println(r.Form)  //è¿™äº›ä¿¡æ¯æ˜¯è¾“å‡ºåˆ°æœåŠ¡å™¨ç«¯çš„æ‰“å°ä¿¡æ¯    fmt.Println(&quot;path&quot;, r.URL.Path)    fmt.Println(&quot;scheme&quot;, r.URL.Scheme)    fmt.Println(r.Form[&quot;url_long&quot;])    for k, v := range r.Form &#123;        fmt.Println(&quot;key:&quot;, k)        fmt.Println(&quot;val:&quot;, strings.Join(v, &quot;&quot;))    &#125;    fmt.Fprintf(w, &quot;Hello astaxie!&quot;) //è¿™ä¸ªå†™å…¥åˆ°wçš„æ˜¯è¾“å‡ºåˆ°å®¢æˆ·ç«¯çš„&#125;func main() &#123;    http.HandleFunc(&quot;/&quot;, sayhelloName) //è®¾ç½®è®¿é—®çš„è·¯ç”±,æ³¨å†Œäº†è¯·æ±‚/çš„è·¯ç”±è§„åˆ™    err := http.ListenAndServe(&quot;:9090&quot;, nil) //è®¾ç½®ç›‘å¬çš„ç«¯å£,ç¬¬äºŒä¸ªå‚æ•°é»˜è®¤ä¸ºç©ºåˆ™è·å–handler = DefaultServeMux  // ä¸Šè¿° DefaultServeMuxå˜é‡æœ¬è´¨æ˜¯ä¸€ä¸ªè·¯ç”±å™¨ï¼Œç”¨æ¥åŒ¹é…urlè·³è½¬åˆ°å…¶ç›¸åº”çš„handleå‡½æ•°    if err != nil &#123;        log.Fatal(&quot;ListenAndServe: &quot;, err)    &#125;&#125;</code></pre><h3 id="æœåŠ¡å™¨ç«¯çš„åŸºæœ¬æ¦‚å¿µ"><a href="#æœåŠ¡å™¨ç«¯çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="æœåŠ¡å™¨ç«¯çš„åŸºæœ¬æ¦‚å¿µ"></a>æœåŠ¡å™¨ç«¯çš„åŸºæœ¬æ¦‚å¿µ</h3><ul><li>Request:ç”¨æˆ·è¯·æ±‚çš„ä¿¡æ¯ï¼Œç”¨æ¥è§£æç”¨æˆ·çš„è¯·æ±‚ä¿¡æ¯ï¼ŒåŒ…æ‹¬postã€getã€cookieã€urlç­‰ä¿¡æ¯</li><li>Response:æœåŠ¡å™¨éœ€è¦è¿”å›ç»™å®¢æˆ·ç«¯çš„ä¿¡æ¯</li><li>Conn:ç”¨æˆ·çš„æ¯æ¬¡è¯·æ±‚é“¾æ¥</li><li>Handler:å¤„ç†è¯·æ±‚å’Œç”Ÿæˆè¿”å›ä¿¡æ¯çš„å¤„ç†é€»è¾‘</li></ul><h3 id="httpåŒ…æ‰§è¡Œæµç¨‹"><a href="#httpåŒ…æ‰§è¡Œæµç¨‹" class="headerlink" title="httpåŒ…æ‰§è¡Œæµç¨‹"></a>httpåŒ…æ‰§è¡Œæµç¨‹</h3><img src="/2023/01/10/web-gong-zuo-fang-shi/3.3.http.png" class="" title="httpåŒ…æ‰§è¡Œæµç¨‹"><ol><li>åˆ›å»ºListen Socketï¼Œç›‘å¬æŒ‡å®šç«¯å£,ç­‰å¾…å®¢æˆ·ç«¯è¯·æ±‚åˆ°æ¥</li><li>Listen Socketæ¥å—å®¢æˆ·ç«¯çš„è¯·æ±‚, å¾—åˆ°Client Socket, æ¥ä¸‹æ¥é€šè¿‡Client Socketä¸å®¢æˆ·ç«¯é€šä¿¡</li><li>å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚<ul><li>é¦–å…ˆä»Client Socketè¯»å–HTTPè¯·æ±‚çš„åè®®å¤´,</li><li>å¦‚æœæ˜¯POSTæ–¹æ³•, è¿˜å¯èƒ½è¦è¯»å–å®¢æˆ·ç«¯æäº¤çš„æ•°æ®</li><li>ç„¶åäº¤ç»™ç›¸åº”çš„handlerå¤„ç†è¯·æ±‚</li><li>handlerå¤„ç†å®Œæ¯•å‡†å¤‡å¥½å®¢æˆ·ç«¯éœ€è¦çš„æ•°æ®, é€šè¿‡Client Socketå†™ç»™å®¢æˆ·ç«¯ã€‚</li></ul></li></ol><h4 id="å…³é”®ç‚¹"><a href="#å…³é”®ç‚¹" class="headerlink" title="å…³é”®ç‚¹"></a>å…³é”®ç‚¹</h4><ul><li>å¦‚ä½•ç›‘å¬ç«¯å£:ä½¿ç”¨<code>net/http</code>åŒ…çš„<code>ListenAndServe</code>æ–¹æ³•</li><li>å¦‚ä½•æ¥æ”¶å®¢æˆ·ç«¯è¯·æ±‚</li><li>å¦‚ä½•åˆ†é…handler</li></ul><pre><code class="go">// ListenAndServeæ–¹æ³•å®ç°func ListenAndServe(addr string, handler Handler) error &#123;    server := &amp;Server&#123;Addr: addr, Handler: handler&#125; //åˆå§‹åŒ–ä¸€ä¸ªServerå¯¹è±¡    return server.ListenAndServe()//è°ƒç”¨Serverå¯¹è±¡çš„æ–¹æ³•ListenAndServe&#125;func ListenAndServe(addr string, handler Handler) error &#123;    server := &amp;Server&#123;Addr: addr, Handler: handler&#125; //åˆå§‹åŒ–Serverå¯¹è±¡    return server.ListenAndServe()                  //è°ƒç”¨Serverå¯¹è±¡çš„æ–¹æ³•ListenAndServe&#125;func (srv *Server) ListenAndServe() error &#123;    addr := srv.Addr    ln, err := net.Listen(&quot;tcp&quot;, addr) //åº•å±‚ç”¨TCPåè®®æ­å»ºäº†ä¸€ä¸ªæœåŠ¡    if err != nil &#123;        return err    &#125;    return srv.Serve(ln) //è°ƒç”¨srv.Serveç›‘æ§æˆ‘ä»¬è®¾ç½®çš„ç«¯å£&#125;func (srv *Server) Serve(l net.Listener) error &#123;    ctx := context.WithValue(baseCtx, ServerContextKey, srv)    for &#123;        rw, err := l.Accept() //é€šè¿‡Listeneræ¥æ”¶è¯·æ±‚        c := srv.newConn(rw)  //åˆ›å»ºä¸€ä¸ªConn        go c.serve(connCtx)   //å•ç‹¬å¼€äº†ä¸€ä¸ªgoroutineï¼ŒæŠŠè¿™ä¸ªè¯·æ±‚çš„æ•°æ®å½“åšå‚æ•°æ‰”ç»™è¿™ä¸ªconnå»æœåŠ¡        //é«˜å¹¶å‘ä½“ç°:ç”¨æˆ·çš„æ¯ä¸€æ¬¡è¯·æ±‚éƒ½æ˜¯åœ¨ä¸€ä¸ªæ–°çš„goroutineå»æœåŠ¡ï¼Œç›¸äº’ä¸å½±å“ã€‚    // å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚éƒ½ä¼šåˆ›å»ºä¸€ä¸ªConnï¼Œè¿™ä¸ªConné‡Œé¢ä¿å­˜äº†è¯¥æ¬¡è¯·æ±‚çš„ä¿¡æ¯ï¼Œ    // ç„¶åå†ä¼ é€’åˆ°å¯¹åº”çš„handlerï¼Œè¯¥handlerä¸­ä¾¿å¯ä»¥è¯»å–åˆ°ç›¸åº”çš„headerä¿¡æ¯ï¼Œè¿™æ ·ä¿è¯äº†æ¯ä¸ªè¯·æ±‚çš„ç‹¬ç«‹æ€§ã€‚    &#125;&#125;func (c *conn) serve(ctx context.Context) &#123;    for &#123;        w, err := c.readRequest(ctx)                //è§£ærequest        serverHandler&#123;c.server&#125;.ServeHTTP(w, w.req) //è·å–ç›¸åº”çš„handlerå»å¤„ç†è¯·æ±‚    &#125;&#125;func (sh serverHandler) ServeHTTP(rw ResponseWriter, req *Request) &#123;    handler := sh.srv.Handler    if handler == nil &#123;        handler = DefaultServeMux    &#125;    handler.ServeHTTP(rw, req)&#125;</code></pre><img src="/2023/01/10/web-gong-zuo-fang-shi/3.3.illustrator.png" class="" title="ä¸€ä¸ªhttpè¿æ¥å¤„ç†æµç¨‹"><h2 id="Goçš„httpåŒ…"><a href="#Goçš„httpåŒ…" class="headerlink" title="Goçš„httpåŒ…"></a>Goçš„httpåŒ…</h2>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>googleæµè§ˆå™¨è‡ªåŠ¨æ›´æ–°å¤±è´¥</title>
      <link href="/2023/01/05/google-liu-lan-qi-zi-dong-geng-xin-shi-bai/"/>
      <url>/2023/01/05/google-liu-lan-qi-zi-dong-geng-xin-shi-bai/</url>
      
        <content type="html"><![CDATA[<p>æŠ¥é”™ï¼š</p><blockquote><p>æ— æ³•å¯åŠ¨æ›´æ–°æ£€æŸ¥ï¼ˆé”™è¯¯ä»£ç ä¸º 4: 0x80070005 â€” system levelï¼‰</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š<br>å¿«æ·é”® Win R è¾“å…¥ï¼šservices.mscï¼Œæ‰¾åˆ° â€œGoogle æ›´æ–°æœåŠ¡ (gupdatem)â€ã€â€œGoogle æ›´æ–°æœåŠ¡ (gupdate)â€æœåŠ¡ï¼Œæ”¹ä¸ºæ‰‹åŠ¨å³å¯ï¼Œå†å»æ›´æ–°Chromeã€‚</p>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>yarn-install</title>
      <link href="/2022/12/21/yarn-install/"/>
      <url>/2022/12/21/yarn-install/</url>
      
        <content type="html"><![CDATA[<h2 id="yarn-install-æŠ¥é”™ï¼š"><a href="#yarn-install-æŠ¥é”™ï¼š" class="headerlink" title="yarn install æŠ¥é”™ï¼š"></a>yarn install æŠ¥é”™ï¼š</h2><blockquote><p>Error: unable to verify the first certificate</p></blockquote><pre><code>  at TLSSocket.onConnectSecure (node:_tls_wrap:1539:34)  at TLSSocket.emit (node:events:513:28)  at TLSSocket._finishInit (node:_tls_wrap:953:8)  at TLSWrap.ssl.onhandshakedone (node:_tls_wrap:734:12)</code></pre><p>è§£å†³æ–¹æ³•ï¼šæš‚æ—¶å…³é—­ ssl éªŒè¯ <code>yarn config set strict-ssl false</code></p><h2 id="yarn-start-æŠ¥é”™ï¼š"><a href="#yarn-start-æŠ¥é”™ï¼š" class="headerlink" title="yarn start æŠ¥é”™ï¼š"></a>yarn start æŠ¥é”™ï¼š</h2><blockquote><p>node:internal&#x2F;errors:478</p></blockquote><pre><code>ErrorCaptureStackTrace(err);^Error: ENOSPC: System limit for number of file watchers reached, watch &#39;/root/umc-ui&#39;</code></pre><p>è§£å†³æ–¹æ³•ï¼š</p><pre><code class="go">echo fs.inotify.max_user_watches=524288 | sudo tee -a /etc/sysctl.conf &amp;&amp; sudo sysctl -pcat /proc/sys/fs/inotify/max_user_watches //æŸ¥çœ‹æ˜¯å¦ä¿®æ”¹æˆåŠŸ</code></pre><h2 id="å…¨å±€å®‰è£…-yarn"><a href="#å…¨å±€å®‰è£…-yarn" class="headerlink" title="å…¨å±€å®‰è£… yarn"></a>å…¨å±€å®‰è£… yarn</h2><p>node -v</p><ul><li><blockquote><p>16 æ‰§è¡Œ<code>corepack enable</code></p></blockquote></li><li>&lt;16 æ‰§è¡Œ<code>npm i -g corepack</code></li></ul><h2 id="yarn-å¸¸ç”¨æ“ä½œ"><a href="#yarn-å¸¸ç”¨æ“ä½œ" class="headerlink" title="yarn å¸¸ç”¨æ“ä½œ"></a>yarn å¸¸ç”¨æ“ä½œ</h2><pre><code class="bash"># åˆå§‹åŒ–é¡¹ç›®yarn init# å®‰è£…æ‰€æœ‰ä¾èµ–yarn yarn install# æ·»åŠ å•ä¸ªä¾èµ–yarn add [package]yarn add [package]@[version]yarn add [package]@[tag]# æ·»åŠ ä¾èµ–åˆ°ä¸åŒç§ç±»çš„ä¾èµ–yarn add [package] --dev  # dev dependenciesyarn add [package] --peer # peer dependencies# å‡çº§å•ä¸ªä¾èµ–yarn up [package]yarn up [package]@[version]yarn up [package]@[tag]# ç§»é™¤ä¾èµ–yarn remove [package]# å‡çº§yarn æœ¬èº«yarn set version latestyarn set version from sources</code></pre>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> yarn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RPC-API</title>
      <link href="/2022/12/16/rpc-api/"/>
      <url>/2022/12/16/rpc-api/</url>
      
        <content type="html"><![CDATA[<h2 id="RPCåŸºæœ¬å«ä¹‰ï¼š"><a href="#RPCåŸºæœ¬å«ä¹‰ï¼š" class="headerlink" title="RPCåŸºæœ¬å«ä¹‰ï¼š"></a>RPCåŸºæœ¬å«ä¹‰ï¼š</h2><p>è¿œç¨‹è¿‡ç¨‹è°ƒç”¨(Remote Procedure Call),å±äºè®¡ç®—æœºé€šä¿¡åè®®ã€‚<br>å…è®¸Aè®¡ç®—æœºè°ƒç”¨Bè®¡ç®—æœºçš„å­ç¨‹åºè€Œä¸ç”¨ä¸ºè¿™ä¸ªäº¤äº’ä½œç”¨ç¼–ç¨‹ï¼Œå±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚</p><img src="/2022/12/16/rpc-api/RPC.webp" class="" title="RPCçš„è°ƒç”¨è¿‡ç¨‹"><ol><li>Client é€šè¿‡æœ¬åœ°è°ƒç”¨ï¼Œè°ƒç”¨ Client Stubã€‚</li><li>Client Stub å°†å‚æ•°æ‰“åŒ…ï¼ˆä¹Ÿå« Marshallingï¼‰æˆä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åå‘é€è¿™ä¸ªæ¶ˆæ¯ã€‚</li><li>Client æ‰€åœ¨çš„ OS å°†æ¶ˆæ¯å‘é€ç»™ Serverã€‚</li><li>Server ç«¯æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™ Server Stubã€‚</li><li>Server Stub å°†æ¶ˆæ¯è§£åŒ…ï¼ˆä¹Ÿå« Unmarshallingï¼‰å¾—åˆ°å‚æ•°ã€‚</li><li>Server Stub è°ƒç”¨æœåŠ¡ç«¯çš„å­ç¨‹åºï¼ˆå‡½æ•°ï¼‰ï¼Œå¤„ç†å®Œåï¼Œå°†æœ€ç»ˆç»“æœæŒ‰ç…§ç›¸åçš„æ­¥éª¤è¿”å›ç»™ Clientã€‚</li></ol><blockquote><p>Stub è´Ÿè´£è°ƒç”¨å‚æ•°å’Œè¿”å›å€¼çš„æµåŒ–ï¼ˆserializationï¼‰ã€å‚æ•°çš„æ‰“åŒ…å’Œè§£åŒ…ï¼Œä»¥åŠç½‘ç»œå±‚çš„é€šä¿¡ã€‚Client ç«¯ä¸€èˆ¬å« Stubï¼ŒServer ç«¯ä¸€èˆ¬å« Skeleton</p></blockquote><h2 id="gRPC"><a href="#gRPC" class="headerlink" title="gRPC"></a>gRPC</h2><p>google RPC</p><ol><li>æ”¯æŒå¤šç§è¯­è¨€ï¼Œæ¯”å¦‚ç”¨Goè¯­è¨€å®ç°gRPCæœåŠ¡,å¯ä»¥é€šè¿‡Javaå®¢æˆ·ç«¯è°ƒç”¨gRPCæœåŠ¡æä¾›çš„æ–¹æ³•</li><li>åŸºäºIDLï¼ˆInterface Definition Languageï¼‰æ–‡ä»¶å®šä¹‰æœåŠ¡</li></ol><ul><li>gRPCæœåŠ¡é¢„å…ˆå®šä¹‰å¥½æ¥å£(åç§°&#x2F;å…¥å‚&#x2F;è¿”å›å€¼)ã€‚</li><li>æœåŠ¡ç«¯å®ç°å®šä¹‰çš„æ¥å£</li><li>å®¢æˆ·ç«¯,gRPCå­˜æ ¹æä¾›äº†è·ŸæœåŠ¡ç«¯ç›¸åŒçš„æ–¹æ³•</li><li>é€šè¿‡ proto3 å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯æ¥å£ä»¥åŠå®¢æˆ·ç«¯ Stub</li></ul><ol start="3"><li>é€šä¿¡åè®®åŸºäºHTTP&#x2F;2è®¾è®¡</li><li>æ”¯æŒ Protobuf å’Œ JSON åºåˆ—åŒ–æ•°æ®æ ¼å¼</li></ol><ul><li>Protobuf ï¼šå’Œè¯­è¨€æ— å…³çš„åºåˆ—åŒ–æ¡†æ¶ï¼Œå¯ä»¥å‡å°‘ç½‘ç»œä¼ è¾“æµé‡,æé«˜é€šä¿¡æ•ˆç‡</li></ul><h2 id="Protocol-Buffers"><a href="#Protocol-Buffers" class="headerlink" title="Protocol Buffers"></a>Protocol Buffers</h2><p>gRPC APIæ¥å£å¸¸ç”¨çš„æ•°æ®ä¼ è¾“æ ¼å¼ï¼Œå¯¹æ•°æ®ç»“æ„è¿›è¡Œåºåˆ—åŒ–ã€‚<br>æ—¢å¯ä»¥åšæ•°æ®é€šä¿¡åè®®ï¼Œä¹Ÿå¯ä»¥ä½œä¸ºæ•°æ®æ ¼å¼</p><ol><li>æ•°æ®ä¼ è¾“é€Ÿåº¦å¿«ï¼šä¼ è¾“æ—¶ä¼šæŠŠæ•°æ®åºåˆ—åŒ–ä¸ºäºŒè¿›åˆ¶æ•°æ®</li></ol><ul><li>ç›¸å¯¹äºXMLå’ŒJSONçš„æ–‡æœ¬ä¼ è¾“æ ¼å¼å¯ä»¥èŠ‚çœå¤§é‡IOæ“ä½œï¼Œæé«˜ä¼ è¾“é€Ÿåº¦</li></ul><ol start="2"><li>è·¨å¹³å°å¤šè¯­è¨€</li></ol><ul><li>è‡ªå¸¦çš„ç¼–è¯‘å·¥å…· protocå¯ä»¥åŸºäºprotobufå®šä¹‰æ–‡ä»¶ï¼Œç¼–è¯‘å‡ºä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯&#x2F;æœåŠ¡ç«¯</li></ul><ol start="3"><li>æ‰©å±•æ€§&#x2F;å…¼å®¹æ€§</li></ol><ul><li>ä¸ç ´ååŸæœ‰ç¨‹åºçš„åŸºç¡€æ‰‹ä¸Šæ›´æ–°å·²æœ‰çš„æ•°æ®ç»“æ„</li></ul><ol start="4"><li>åŸºäº IDL æ–‡ä»¶å®šä¹‰æœåŠ¡ï¼Œé€šè¿‡ proto3 å·¥å…·ç”ŸæˆæŒ‡å®šè¯­è¨€çš„æ•°æ®ç»“æ„ã€æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯æ¥å£</li></ol><h2 id="Protocol-Buffersåœ¨gRPCæ¥å£ä¸­çš„ä½œç”¨"><a href="#Protocol-Buffersåœ¨gRPCæ¥å£ä¸­çš„ä½œç”¨" class="headerlink" title="Protocol Buffersåœ¨gRPCæ¥å£ä¸­çš„ä½œç”¨"></a>Protocol Buffersåœ¨gRPCæ¥å£ä¸­çš„ä½œç”¨</h2><ol><li>å®šä¹‰æ•°æ®ç»“æ„</li></ol><pre><code class="go">// SecretInfo contains secret details.message SecretInfo &#123;    string name = 1;    string secret_id  = 2;    string username   = 3;    string secret_key = 4;    int64 expires = 5;    string description = 6;    string created_at = 7;    string updated_at = 8;&#125;</code></pre><ol start="2"><li>å®šä¹‰æœåŠ¡æ¥å£</li></ol><pre><code class="go">// æ­¤å¤„å®šä¹‰äº†ä¸€ä¸ªCacheæœåŠ¡,æœåŠ¡åŒ…å«ListSecretså’ŒListPoliciesä¸¤ä¸ªAPIæ¥å£// Cache implements a cache rpc service.service Cache&#123;  rpc ListSecrets(ListSecretsRequest) returns (ListSecretsResponse) &#123;&#125;  rpc ListPolicies(ListPoliciesRequest) returns (ListPoliciesResponse) &#123;&#125;&#125;</code></pre><ol start="3"><li>é€šè¿‡ protobuf åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæå‡ä¼ è¾“æ•ˆç‡</li></ol><h2 id="gRPCä½¿ç”¨"><a href="#gRPCä½¿ç”¨" class="headerlink" title="gRPCä½¿ç”¨"></a>gRPCä½¿ç”¨</h2><h3 id="å®‰è£…protoc"><a href="#å®‰è£…protoc" class="headerlink" title="å®‰è£…protoc"></a>å®‰è£…protoc</h3><pre><code class="bash"># ç¬¬ä¸€æ­¥ï¼šå®‰è£… protobuf$ cd /tmp/$ git clone -b v3.21.1 --depth=1 https://github.com/protocolbuffers/protobuf$ cd protobuf$ ./autogen.sh$ ./configure$ make$ make install $ protoc --version # æŸ¥çœ‹ protoc ç‰ˆæœ¬ï¼ŒæˆåŠŸè¾“å‡ºç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…æˆåŠŸlibprotoc 3.21.1# ç¬¬äºŒæ­¥ï¼šå®‰è£… protoc-gen-gogo install google.golang.org/protobuf/cmd/protoc-gen-go@v1.28go install google.golang.org/grpc/cmd/protoc-gen-go-grpc@v1.2# ç¬¬ä¸‰æ­¥:å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç # ç”Ÿæˆçš„ .pb.go æ–‡ä»¶åœ¨è¾“å‡ºç›®å½•ä¸­çš„æ”¾ç½®ä½ç½®å–å†³äºç¼–è¯‘å™¨æ ‡å¿—protoc   --go_out=. --go_opt=paths=source_relative  helloworld/helloworld.protoprotoc   --go-grpc_out=. --go-grpc_opt=paths=source_relative helloworld/helloworld.proto</code></pre><p>ç¼–è¯‘å™¨æ ‡å¿—ï¼šè¾“å‡ºæ¨¡å¼</p><ol><li>paths&#x3D;import: é»˜è®¤è¾“å‡ºæ¨¡å¼ï¼Œè¾“å‡ºæ–‡ä»¶å°†å­˜æ”¾åœ¨ä»¥GOè½¯ä»¶åŒ…çš„å¯¼å…¥è·¯å¾„å‘½åçš„ç›®å½•ä¸­<br>è¾“å…¥æ–‡ä»¶:&#x2F;root&#x2F;protos&#x2F;buzz.proto<br>GOæ–‡ä»¶å¯¼å…¥è·¯å¾„ï¼šexample.com&#x2F;project&#x2F;protos&#x2F;fizz<br>è¾“å‡ºæ–‡ä»¶ï¼š&#x2F;root&#x2F;..&#x2F;example.com&#x2F;project&#x2F;protos&#x2F;fizz&#x2F;buzz.pb.go</li><li>paths&#x3D;source_relative: è¾“å‡ºæ–‡ä»¶å°†ä¸è¾“å…¥æ–‡ä»¶ä½äºåŒä¸€ç›¸å¯¹ç›®å½•ä¸­<br>è¾“å…¥æ–‡ä»¶:protos&#x2F;buzz.proto<br>è¾“å‡ºæ–‡ä»¶:protos&#x2F;buzz.pb.goã€‚</li><li>module&#x3D;$PREFIX:è¾“å‡ºæ–‡ä»¶ä¼šè¢«æ”¾ç½®åœ¨ä¸€ä¸ªä»¥ Go è½¯ä»¶åŒ…çš„å¯¼å…¥è·¯å¾„å‘½åçš„ç›®å½•ä¸­ï¼Œä½†æŒ‡å®šçš„ç›®å½•å‰ç¼€ä¼šä»è¾“å‡ºæ–‡ä»¶åä¸­ç§»é™¤<br>è¾“å…¥æ–‡ä»¶ï¼šprotos&#x2F;buzz.proto<br>goå¯¼å…¥è·¯å¾„ï¼šexample.com&#x2F;project&#x2F;protos&#x2F;fizz<br>å‰ç¼€ï¼šexample.com&#x2F;project<br>è¾“å‡ºæ–‡ä»¶ï¼šprotos&#x2F;fizz&#x2F;buzz.pb.go</li></ol><blockquote><p>Go å¯¼å…¥è·¯å¾„ä¸ .proto æ–‡ä»¶ä¸­çš„ package è¯´æ˜ç¬¦ä¹‹é—´æ²¡æœ‰å…³è”ã€‚åè€…åªä¸ protobuf å‘½åç©ºé—´ç›¸å…³ï¼Œè€Œå‰è€…ä»…ä¸ &gt;  Go å‘½åç©ºé—´ç›¸å…³ã€‚æ­¤å¤–ï¼ŒGo å¯¼å…¥è·¯å¾„ä¸ .proto å¯¼å…¥è·¯å¾„ä¹‹é—´æ²¡æœ‰ä»»ä½•å…³è”ã€‚</p></blockquote><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><h4 id="æ‰§è¡Œ-x2F-autogen-shæŠ¥é”™"><a href="#æ‰§è¡Œ-x2F-autogen-shæŠ¥é”™" class="headerlink" title="æ‰§è¡Œ.&#x2F;autogen.shæŠ¥é”™"></a>æ‰§è¡Œ.&#x2F;autogen.shæŠ¥é”™</h4><ol><li>.&#x2F;autogen.sh: line 41: autoreconf: command not found<br>è§£å†³æ–¹æ³•ï¼šyumå®‰è£… autoconf</li><li>Canâ€™t exec â€œaclocalâ€: No such file or directory at &#x2F;usr&#x2F;share&#x2F;autoconf&#x2F;Autom4te&#x2F; FileUtils.pm line 326.<br>è§£å†³æ–¹æ³•ï¼šyum å®‰è£…automake</li><li>configure.ac:109: error: possibly undefined macro: AC_PROG_LIBTOOL.If this token and others are legitimate, please use m4_pattern_allow.See the Autoconf documentation.<br>è§£å†³æ–¹æ³•ï¼šyum å®‰è£…libtool</li></ol><h4 id="æ‰§è¡Œ-x2F-configureæŠ¥é”™"><a href="#æ‰§è¡Œ-x2F-configureæŠ¥é”™" class="headerlink" title="æ‰§è¡Œ.&#x2F;configureæŠ¥é”™"></a>æ‰§è¡Œ.&#x2F;configureæŠ¥é”™</h4><ol><li>configure: error: in <code>/tmp/protobuf&#39;:configure: error: C++ preprocessor &quot;/lib/cpp&quot; fails sanity check  See &#39;config.log&#39; for more details è§£å†³æ–¹æ³•ï¼šç”±äºc++ç¼–è¯‘å™¨çš„ç›¸å…³packageæ²¡æœ‰å®‰è£…ï¼Œyum å®‰è£…</code>yum install glibc-headers gcc-c++&#96;</li></ol><h2 id="gRPC-demo-å®ç°"><a href="#gRPC-demo-å®ç°" class="headerlink" title="gRPC demo å®ç°"></a>gRPC demo å®ç°</h2><ol><li>å®šä¹‰gPRCæœåŠ¡</li><li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç </li><li>å®ç°gRPCæœåŠ¡</li><li>å®ç°gRPCå®¢æˆ·ç«¯</li></ol><pre><code class="go">treeâ”œâ”€â”€ clientâ”‚   â””â”€â”€ main.goâ”œâ”€â”€ helloworldâ”‚   â”œâ”€â”€ helloworld.pb.goâ”‚   â””â”€â”€ helloworld.protoâ””â”€â”€ server    â””â”€â”€ main.go</code></pre><p>client:å­˜æ”¾å®¢æˆ·ç«¯ä»£ç <br>helloworld:å­˜æ”¾æœåŠ¡çš„IDLå®šä¹‰<br>serverï¼šå­˜æ”¾serverç›®å½•</p><h3 id="protoæ–‡ä»¶ï¼šå®šä¹‰æœåŠ¡"><a href="#protoæ–‡ä»¶ï¼šå®šä¹‰æœåŠ¡" class="headerlink" title="protoæ–‡ä»¶ï¼šå®šä¹‰æœåŠ¡"></a>protoæ–‡ä»¶ï¼šå®šä¹‰æœåŠ¡</h3><p>ç¼–è¯‘å‘½ä»¤ï¼š<br><code>protoc -I=$SRC_DIR --go_out=$DST_DIR $SRC_DIR/addressbook.proto</code></p><h3 id="æœåŠ¡æ–¹æ³•ç±»å‹"><a href="#æœåŠ¡æ–¹æ³•ç±»å‹" class="headerlink" title="æœåŠ¡æ–¹æ³•ç±»å‹"></a>æœåŠ¡æ–¹æ³•ç±»å‹</h3><ol><li>ç®€å•æ¨¡å¼:å®¢æˆ·ç«¯å‘èµ·ä¸€æ¬¡è¯·æ±‚ï¼ŒæœåŠ¡ç«¯å“åº”ä¸€ä¸ªæ•°æ®</li></ol><pre><code class="go">rpc SayHello (HelloRequest) returns (HelloReply) &#123;&#125;</code></pre><ol start="2"><li>æœåŠ¡ç«¯æ•°æ®æµæ¨¡å¼:å®¢æˆ·ç«¯å‘é€ä¸€ä¸ªè¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›æ•°æ®æµå“åº”ï¼Œå®¢æˆ·ç«¯ä»æµä¸­è¯»å–æ•°æ®ç›´åˆ°ä¸ºç©º</li></ol><pre><code class="go">rpc SayHello (HelloRequest) returns (stream HelloReply) &#123;&#125;</code></pre><ol start="3"><li>å®¢æˆ·ç«¯æ•°æ®æµæ¨¡å¼ï¼šå®¢æˆ·ç«¯å°†æ¶ˆæ¯ä»¥æµçš„æ–¹å¼å‘é€ç»™æœåŠ¡å™¨ï¼ŒæœåŠ¡å™¨å…¨éƒ¨å¤„ç†å®Œæˆä¹‹åè¿”å›ä¸€æ¬¡å“åº”ã€‚</li></ol><pre><code class="go"> rpc SayHello (stream HelloRequest) returns (HelloReply) &#123;&#125;</code></pre><ol start="4"><li>åŒå‘æ•°æ®æµæ¨¡å¼:å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½å¯ä»¥å‘å¯¹æ–¹å‘é€æ•°æ®æµï¼Œè¿™ä¸ªæ—¶å€™åŒæ–¹çš„æ•°æ®å¯ä»¥åŒæ—¶äº’ç›¸å‘é€</li></ol><pre><code class="go">rpc SayHello (stream HelloRequest) returns (stream HelloReply) &#123;&#125;</code></pre><h2 id="åŒºåˆ«"><a href="#åŒºåˆ«" class="headerlink" title="åŒºåˆ«"></a>åŒºåˆ«</h2><img src="/2022/12/16/rpc-api/grpc-vs-restful.webp" class="" title="æ¥å£ç±»å‹æ¯”è¾ƒ">]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>GOä¸­çš„while</title>
      <link href="/2022/12/15/go-zhong-de-while/"/>
      <url>/2022/12/15/go-zhong-de-while/</url>
      
        <content type="html"><![CDATA[<p>GOè¯­è¨€ä¸­æ²¡æœ‰whileå…³é”®å­—ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨forä»£æ›¿</p><pre><code class="go">package mainimport &quot;fmt&quot;func main() &#123;    sum := 1    for sum &lt; 1000 &#123;        sum += sum    &#125;    fmt.Println(sum)&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-maps-and-memory-leaks-in-go</title>
      <link href="/2022/12/10/fan-yi-maps-and-memory-leaks-in-go/"/>
      <url>/2022/12/10/fan-yi-maps-and-memory-leaks-in-go/</url>
      
        <content type="html"><![CDATA[<h1 id="Go-ä¸­çš„-Maps-å’Œå†…å­˜æ³„æ¼"><a href="#Go-ä¸­çš„-Maps-å’Œå†…å­˜æ³„æ¼" class="headerlink" title="Go ä¸­çš„ Maps å’Œå†…å­˜æ³„æ¼"></a>Go ä¸­çš„ Maps å’Œå†…å­˜æ³„æ¼</h1><p>å¾…å®Œæˆ<br><a href="https://teivah.medium.com/maps-and-memory-leaks-in-go-a85ebe6e7e69">https://teivah.medium.com/maps-and-memory-leaks-in-go-a85ebe6e7e69</a></p><p><b>é•¿è¯çŸ­è¯´ï¼š</b> map åœ¨å†…å­˜ä¸­ä¼šä¸€ç›´å¢é•¿,ä¸ä¼šç¼©å°ã€‚å› æ­¤å¦‚æœå®ƒå¼•èµ·äº†ä¸€äº›å†…å­˜é—®é¢˜ï¼Œä½ å¯ä»¥å°è¯•ä¸åŒçš„é€‰é¡¹ï¼šæ¯”å¦‚å¼ºåˆ¶ GO é‡æ–°åˆ›å»º map æˆ–è€…ä½¿ç”¨æŒ‡é’ˆã€‚</p><p>ä½¿ç”¨ Go è¯­è¨€çš„æ—¶å€™,æˆ‘ä»¬éœ€è¦äº†è§£ map å¦‚ä½•æ‰©å¤§å’Œç¼©å°çš„ä¸€äº›é‡è¦ç‰¹å¾ã€‚æ·±å…¥äº†è§£è¿™ä¸€ç‚¹å¯ä»¥é¢„é˜²ä¼šå¯¼è‡´å†…å­˜æ³„æ¼çš„é—®é¢˜ã€‚</p><p>é¦–å…ˆä¸ºäº†çœ‹è¿™ä¸ªé—®é¢˜çš„å…·ä½“çš„ä¾‹å­ï¼Œæˆ‘ä»¬å‡è®¾ä¸€ä¸ªåœºæ™¯ï¼Œåœ¨è¿™ä¸ªåœºæ™¯ä¸‹æˆ‘ä»¬ä¼šä½¿ç”¨ä¸‹é¢çš„ map:</p><pre><code class="go">m:=make(map[int][128]byte)</code></pre><p>m çš„æ¯ä¸€ä¸ªå€¼éƒ½æ˜¯ä¸€ä¸ª 128 byte çš„æ•°ç»„ã€‚æˆ‘ä»¬ä¼šæ‰§è¡Œä¸‹é¢çš„æ“ä½œï¼š</p><ol><li>åˆ†é…ä¸€ä¸ªç©ºçš„ map</li><li>æ·»åŠ ä¸€ç™¾ä¸‡ä¸ªå…ƒç´ </li><li>ç§»é™¤æ‰€æœ‰å…ƒç´ ,è¿è¡Œåƒåœ¾å›æ”¶(GC)</li></ol><p>åœ¨æ¯ä¸€æ­¥å®Œæˆåï¼Œæˆ‘ä»¬æƒ³è¦æ‰“å°å †çš„å¤§å°(ä½¿ç”¨å·¥å…·å‡½æ•° <code>printAlloc</code> )ã€‚è¿™ä¸ªç¨‹åºå‘æˆ‘ä»¬å±•ç¤ºäº†è¿™ä¸ªä¾‹å­é‡Œå†…å­˜çš„å˜åŒ–:</p><pre><code class="go">func main() &#123;    n := 1_000_000    m := make(map[int][128]byte)    printAlloc()    for i := 0; i &lt; n; i++ &#123; // Adds 1 million elements        m[i] = [128]byte&#123;&#125;    &#125;    printAlloc()    for i := 0; i &lt; n; i++ &#123; // Deletes 1 million elements        delete(m, i)    &#125;    runtime.GC() // Triggers a manual GC    printAlloc()    runtime.KeepAlive(m) // Keeps a reference to m so that the map isnâ€™t collected&#125;func printAlloc() &#123;    var m runtime.MemStats    runtime.ReadMemStats(&amp;m)    fmt.Printf(&quot;%d KB\n&quot;, m.Alloc/1024)&#125;</code></pre><p>æˆ‘ä»¬åˆ†é…ä¸€ä¸ªç©ºçš„ map,æ·»åŠ äº† 100 ä¸‡ä¸ªå…ƒç´ ,åˆç§»é™¤äº† 100 ä¸‡ä¸ªå…ƒç´ ,ç„¶åè¿è¡Œä¸€ä¸ªåƒåœ¾å›æ”¶å™¨ã€‚æˆ‘ä»¬ä¹Ÿä½¿ç”¨äº† <code>runtime.KeepAlive</code> ç¡®ä¿å¯¹ map çš„å¼•ç”¨ï¼Œè¿™æ · map ä¹Ÿä¸ä¼šè¢«å›æ”¶ã€‚è®©æˆ‘ä»¬è¿è¡Œè¿™ä¸ªä¾‹å­ï¼š</p><blockquote><p>0 MB &lt;â€“ After m is allocated<br>461 MB &lt;â€“ After we add 1 million elements<br>293 MB &lt;â€“ After we remove 1 million elements</p></blockquote><p>æˆ‘ä»¬èƒ½å¤Ÿè§‚å¯Ÿåˆ°ä»€ä¹ˆå‘¢?åˆšå¼€å§‹å †çš„å¤§å°æ˜¯æå°çš„ã€‚å‘ map é‡Œé¢æ·»åŠ  100 ä¸‡ä¸ªå…ƒç´ ä¹‹å,å®ƒå¼€å§‹æ˜æ˜¾å¢é•¿ã€‚ä½†æ˜¯å¦‚æœæˆ‘ä»¬æœŸæœ›å †å¤§å°åœ¨ç§»é™¤æ‰€æœ‰å…ƒç´ ä¹‹åæœ‰æ‰€å‡å°‘ï¼Œè¿™åœ¨ GO é‡Œæ˜¯ä¸å¯èƒ½çš„ã€‚æœ€åï¼Œå³ä½¿ GC å·²ç»å›æ”¶äº†æ‰€æœ‰å…ƒç´ ,å †å¤§å°ä»ç„¶è¿˜æœ‰ 293Mã€‚å°½ç®¡å†…å­˜å‡å°‘äº†,ä½†æ˜¯å¹¶æ²¡æœ‰è¾¾åˆ°æˆ‘ä»¬çš„æœŸæœ›ã€‚æ ¹æœ¬åŸå› æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬éœ€è¦æ·±å…¥äº†è§£ Go è¯­è¨€ä¸­ map æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚</p><p>map ä¼šæä¾›ä¸€ä¸ªæ— åºçš„é”®å€¼å¯¹é›†åˆ,å¹¶ä¸”é‡Œé¢çš„é”®åéƒ½ä¸ä¸€æ ·ã€‚åœ¨ Go è¯­è¨€ä¸­,map æ˜¯åŸºäºå“ˆå¸Œè¡¨æ•°æ®ç»“æ„ï¼šè¿™æ˜¯ä¸€ä¸ªæ•°ç»„å¹¶ä¸”å…¶ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸€æ¡¶é”®å€¼å¯¹,å¦‚å›¾ 1 æ‰€ç¤ºã€‚</p><img src="/2022/12/10/fan-yi-maps-and-memory-leaks-in-go/hash_table.webp" class="" title="å›¾1-å…³æ³¨æ¡¶0çš„å“ˆå¸Œè¡¨ç¤ºä¾‹"><p>æ¯ä¸ªæ¡¶éƒ½æ˜¯ä¸€ä¸ªå¤§å°å›ºå®šçš„æ•°ç»„,æœ‰ 8 ä¸ªå…ƒç´ ã€‚åœ¨æ’å…¥åˆ°ä¸€ä¸ªæ»¡æ¡¶(æ¡¶æº¢å‡º)çš„æƒ…å†µä¸‹,Go ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ 8 ä¸ªå…ƒç´ çš„æ¡¶å¹¶ä¸”è¿æ¥åˆ°å‰é¢é‚£ä¸ªæ¡¶ã€‚å›¾ 2 å±•ç¤ºäº†è¿™ä¸ªä¾‹å­ï¼š</p><img src="/2022/12/10/fan-yi-maps-and-memory-leaks-in-go/buket.webp" class="" title="å›¾2-åœ¨æ¡¶æº¢å‡ºçš„æƒ…å†µä¸‹ï¼ŒGoä¼šåˆ†é…ä¸€ä¸ªæ–°çš„æ¡¶å¹¶è¿æ¥åˆ°å‰é¢çš„æ¡¶"><p>ä»åº•å±‚æ¥çœ‹,ä¸€ä¸ª Go map å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆ,æŒ‡å‘ <code>runtime.hmap</code> ç»“æ„ã€‚è¿™ä¸ªç»“æ„åŒ…å«äº†å¤šä¸ªåŸŸï¼Œå¦‚ B åŸŸ,å®ƒç»™å‡ºäº† map ä¸­æ¡¶çš„æ•°é‡ï¼š</p><pre><code class="go">type hmap struct &#123;    B uint8 // log_2 of # of buckets            // (å¯ä»¥å®¹çº³ ç³»æ•°* 2^B é¡¹)    // ...&#125;</code></pre><p>åœ¨æ·»åŠ  100 ä¸‡ä¸ªå…ƒç´ ä»¥å,B çš„å€¼ä¸º 18,è¿™æ„å‘³ç€æœ‰ 2<sup>18</sup>&#x3D;262144 ä¸ªæ¡¶ã€‚å½“æˆ‘ä»¬ç§»é™¤è¿™äº›å…ƒç´ çš„æ—¶å€™,B çš„å€¼æ˜¯å¤šå°‘å‘¢?ä»ç„¶æ˜¯ 18ã€‚æ‰€ä»¥ map ä»ç„¶åŒ…å«äº†åŒæ ·æ•°é‡çš„æ¡¶ã€‚</p><p>åŸå› å°±æ˜¯ map ä¸­çš„æ¡¶çš„æ•°é‡ä¸èƒ½å‡å°‘ã€‚å› æ­¤ä» map ä¸­ç§»é™¤å…ƒç´ å¹¶ä¸å½±å“å·²ç»å­˜åœ¨çš„æ¡¶çš„æ•°é‡;å®ƒåªæ˜¯æŠŠæ¡¶å†…çš„æ’æ§½å½’é›¶ã€‚map åªä¼šå¢é•¿,å‡ºç°æ›´å¤šçš„æ¡¶;ä½†ä»æ¥ä¸ä¼šå‡å°‘ã€‚</p><p>åœ¨ä¹‹å‰çš„ä¾‹å­ä¸­,æˆ‘ä»¬ä» 461M åˆ° 293M,å› ä¸ºå…ƒç´ è¢«å›æ”¶äº†,ä½†æ˜¯è¿è¡Œ GC å¹¶ä¸å½±å“ map æœ¬èº«ã€‚å³ä½¿æ˜¯é¢å¤–æ¡¶(å› ä¸ºæ¡¶æº¢å‡ºè€Œåˆ›å»ºçš„æ¡¶)çš„æ•°é‡ä¹Ÿä¼šä¿æŒä¸€æ ·ã€‚</p><p>æˆ‘ä»¬é€€ä¸€æ­¥è®¨è®ºï¼šmap ä¸èƒ½ç¼©å°è¿™ä¸ªäº‹ä»€ä¹ˆæ—¶å€™ä¼šæˆä¸ºä¸€ä¸ªé—®é¢˜?å‡è®¾ä½¿ç”¨ <code>map[int][128]byte</code> æ„é€ ä¸€ä¸ª cacheã€‚è¿™ä¸ª map åŒ…å«æ¯ä¸ªç”¨æˆ·çš„ ID(int)ï¼Œä¸€ä¸ª 128 byte çš„åºåˆ—ã€‚ç°åœ¨å‡è®¾æˆ‘ä»¬æƒ³è¦ä¿å­˜æœ€åçš„ 1000 ä¸ªç”¨æˆ·ã€‚map çš„ size å°†ä¼šä¿æŒä¸ºä¸€ä¸ªå¸¸é‡,æ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦æ‹…å¿ƒ map ä¸èƒ½ç¼©å°çš„é—®é¢˜ã€‚</p><p>ä½†æ˜¯,å‡å¦‚æˆ‘ä»¬æƒ³è¦ä¿å­˜ä¸€å°æ—¶å†…çš„æ•°æ®å‘¢ã€‚ä¸æ­¤åŒæ—¶å…¬å¸å†³å®šåœ¨é»‘è‰²æ˜ŸæœŸäº”å¼€å±•ä¸€ä¸ªå¤§ä¿ƒé”€ï¼šåœ¨ä¸€å°æ—¶å†…å¯èƒ½ä¼šæœ‰æ•°ä»¥ç™¾ä¸‡çš„ç”¨æˆ·è¿æ¥æˆ‘ä»¬çš„ç³»ç»Ÿã€‚ä½†æ˜¯ä¹‹åçš„å‡ å¤©é‡Œ,æˆ‘ä»¬çš„ map ä¼šåŒ…å«å’Œé«˜å³°æœŸçš„æ—¶å€™åŒæ ·æ•°é‡çš„æ¡¶ã€‚è¿™å°±è§£é‡Šäº†ä¸ºä»€ä¹ˆåœ¨è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬ä¼šé‡åˆ°å†…å­˜æ¶ˆè€—å¤§ä½†æ˜¯å¹¶æ²¡æœ‰æ˜æ˜¾å‡å°‘çš„æƒ…å†µã€‚</p><p>å¦‚æœæˆ‘ä»¬ä¸æƒ³è¦æ‰‹åŠ¨é‡å¯æœåŠ¡æ¥æ¸…é™¤è¢« map æ¶ˆè€—çš„å†…å­˜æ•°é‡æœ‰ä»€ä¹ˆè§£å†³æ–¹æ¡ˆå‘¢?ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯æœ‰è§„å¾‹çš„é‡å»ºä¸€ä¸ªå½“å‰ map çš„æ‹·è´ã€‚ä¾‹å¦‚,æˆ‘ä»¬å¯ä»¥æ¯éš”ä¸€ä¸ªå°æ—¶æ„å»ºä¸€ä¸ªæ–°çš„ map,è¿™ä¸ª map ä¼šå¤åˆ¶æ‰€æœ‰çš„å…ƒç´ å¹¶é‡Šæ”¾ä¹‹å‰çš„é‚£ä¸ª mapã€‚è¿™ä¸ªæ–¹æ¡ˆçš„ä¸»è¦ç¼ºé™·æ˜¯åœ¨å¤åˆ¶å’Œç›´åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶ä¹‹å‰ï¼ŒçŸ­æœŸå†…æˆ‘ä»¬å¯èƒ½ä¼šæ¶ˆè€—å½“å‰å†…å­˜çš„ä¸¤å€ã€‚</p><p>å¦å¤–ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ˜¯ä¿®æ”¹ map ç±»å‹æ¥å­˜å‚¨ä¸€ä¸ªæ•°ç»„æŒ‡é’ˆï¼š<code>map[int]*[128]byte</code>ã€‚å®ƒå¹¶ä¸èƒ½è§£å†³æ¡¶æ•°é‡å¤§çš„é—®é¢˜;ä½†æ˜¯æ¯ä¸ªæ¡¶çš„å…¥å£å°†ä¼šä¿ç•™æŒ‡é’ˆçš„å¤§å°,è€Œä¸æ˜¯128å­—èŠ‚(64ä½ç³»ç»Ÿä¸Šçš„8å­—èŠ‚,32ä½ç³»ç»Ÿä¸Šçš„4å­—èŠ‚)ã€‚</p><p>å›åˆ°æœ€åˆçš„è®¾æƒ³åœºæ™¯,è®©æˆ‘ä»¬æ¥æ¯”è¾ƒä¸€ä¸‹æ¯ä¸ªæ­¥éª¤ä¹‹åçš„æ¯ç§mapç±»å‹çš„å†…å­˜æ¶ˆè€—ã€‚ç»“æœå¦‚ä¸‹é¢çš„è¡¨æ ¼æ‰€ç¤ºï¼š</p><table><thead><tr><th>Step</th><th><code>map[int][128]byte</code></th><th><code>map[int]*[128]byte</code></th></tr></thead><tbody><tr><td>Allocate an empty map</td><td>0 MB</td><td>0 MB</td></tr><tr><td>Add 1 million elements</td><td>461 MB</td><td>182 MB</td></tr><tr><td>Remove all the elements and run a GC</td><td>293 MB</td><td>38 MB</td></tr></tbody></table><p>æ­£å¦‚æˆ‘ä»¬æ‰€çœ‹åˆ°çš„ï¼Œç§»é™¤æ‰€æœ‰å…ƒç´ ä¹‹å,ä½¿ç”¨ <code>map[int]*[128]byte</code> ç±»å‹çš„éœ€è¦çš„å†…å­˜æ•°é‡å¾ˆæ˜æ˜¾æ›´å°‘ã€‚è€Œä¸”åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­ï¼Œç”±äºåšäº†ä¸€äº›ä¼˜åŒ–æ¥å‡å°‘å†…å­˜æ¶ˆè€—ï¼Œæ‰€ä»¥é«˜å³°æœŸéœ€è¦çš„å†…å­˜æ•°é‡ä¹Ÿæ²¡é‚£ä¹ˆé‡è¦äº†ã€‚</p><p>ã€æ³¨æ„ã€‘å¦‚æœkeyæˆ–è€…valuè¶…è¿‡128å­—èŠ‚,GOå°±ä¸ä¼šç›´æ¥åœ¨mapæ¡¶ä¸­å­˜å‚¨å®ƒã€‚è€Œæ˜¯å‚¨å­˜ä¸€ä¸ªæŒ‡å‘keyæˆ–è€…valueçš„æŒ‡é’ˆ</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>å¦‚æˆ‘ä»¬æ‰€è§,æ·»åŠ nä¸ªå…ƒç´ åˆ°mapä¸­ï¼Œç„¶åç§»é™¤æ‰€æœ‰å…ƒç´ æ„å‘³ç€åœ¨å†…å­˜ä¸­ä¿æŒç›¸åŒçš„æ¡¶æ•°é‡ã€‚æ‰€ä»¥å¿…é¡»è®°ä½ï¼šå› ä¸ºmapåœ¨sizeä¸Šåªä¼šå¢é•¿ï¼Œæ‰€ä»¥å†…å­˜æ¶ˆè€—ä¹Ÿåªä¼šå¢é•¿ã€‚ç›®å‰æ²¡æœ‰è‡ªåŠ¨åŒ–ç­–ç•¥å»ç¼©å°å®ƒã€‚å¦‚æœå› ä¸ºè¿™ä¸ªå¼•èµ·äº†é«˜å†…å­˜æ¶ˆè€—,æˆ‘ä»¬å¯ä»¥å°è¯•ä¸åŒçš„æ–¹æ³•å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæ¯”å¦‚é‡æ–°åˆ›å»ºmapæˆ–è€…ä½¿ç”¨æŒ‡é’ˆæ¥æ£€æŸ¥å®ƒæ˜¯å¦å¯ä»¥è¢«ä¼˜åŒ–ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¤è¯æœºåˆ¶</title>
      <link href="/2022/12/10/ren-zheng-ji-zhi/"/>
      <url>/2022/12/10/ren-zheng-ji-zhi/</url>
      
        <content type="html"><![CDATA[<h2 id="Basic"><a href="#Basic" class="headerlink" title="Basic"></a>Basic</h2><p>åŸºç¡€è®¤è¯</p><h3 id="åŸç†ï¼š"><a href="#åŸç†ï¼š" class="headerlink" title="åŸç†ï¼š"></a>åŸç†ï¼š</h3><p>å‰ç«¯å°† <code>ç”¨æˆ·å:å¯†ç </code> è¿›è¡Œbase64ç¼–ç åï¼Œæ”¾åˆ° HTTP Authorization Header ä¸­ã€‚<br>åç«¯æ¥å—åˆ°Httpè¯·æ±‚åï¼Œè§£æå‡ºAuthorization Header ä¸­çš„ base64 å­—ç¬¦ä¸²ï¼Œè·å–ç”¨æˆ·åå’Œå¯†ç ï¼Œå¹¶å°†ç”¨æˆ·åå’Œå¯†ç æ ¹æ•°æ®åº“è®°å½•ä¸­çš„å€¼è¿›è¡Œæ¯”è¾ƒ<br>å¦‚æœåŒ¹é…åˆ™è®¤è¯é€šè¿‡</p><h3 id="ç¼ºç‚¹ï¼š"><a href="#ç¼ºç‚¹ï¼š" class="headerlink" title="ç¼ºç‚¹ï¼š"></a>ç¼ºç‚¹ï¼š</h3><p>ä¸å®‰å…¨ï¼Œå¯†ç å’Œåç¼–è¯‘</p><h3 id="ä½¿ç”¨æ–¹æ³•ï¼š"><a href="#ä½¿ç”¨æ–¹æ³•ï¼š" class="headerlink" title="ä½¿ç”¨æ–¹æ³•ï¼š"></a>ä½¿ç”¨æ–¹æ³•ï¼š</h3><p>å°†å®ƒå’Œ SSL é…åˆä½¿ç”¨ï¼Œæ¥ç¡®ä¿æ•´ä¸ªè®¤è¯è¿‡ç¨‹æ˜¯å®‰å…¨çš„ã€‚æ¯”å¦‚æ”¯æŒå‰ç«¯é€šè¿‡ç”¨æˆ·åå’Œå¯†ç ç™»å½•ï¼Œä½¿ç”¨Basicè®¤è¯ï¼Œä½†æ˜¯å‰åç«¯ä½¿ç”¨HTTPSé€šä¿¡ï¼Œä¿è¯å®‰å…¨æ€§</p><p>æ³¨æ„ï¼šä¸è¦åœ¨è¯·æ±‚å‚æ•°ä¸­ä½¿ç”¨æ˜æ–‡å¯†ç ï¼Œä¹Ÿä¸è¦åœ¨ä»»ä½•å­˜å‚¨ä¸­ä¿å­˜æ˜æ–‡å¯†ç ã€‚</p><pre><code class="go">basic=`echo -n &#39;admin:Admin@2021&#39;|base64`curl -XPOST -H&quot;Authorization: Basic $&#123;basic&#125;&quot; http://127.0.0.1:8080/login</code></pre><h2 id="OAuth2-0â€”â€”å¼€æ”¾æˆæƒ"><a href="#OAuth2-0â€”â€”å¼€æ”¾æˆæƒ" class="headerlink" title="OAuth2.0â€”â€”å¼€æ”¾æˆæƒ"></a>OAuth2.0â€”â€”å¼€æ”¾æˆæƒ</h2><h3 id="æ¦‚å¿µ"><a href="#æ¦‚å¿µ" class="headerlink" title="æ¦‚å¿µ:"></a>æ¦‚å¿µ:</h3><p>å…è®¸ç”¨æˆ·è®©ç¬¬ä¸‰æ–¹åº”ç”¨è®¿é—®è¯¥ç”¨æˆ·å†æŸä¸€webæœåŠ¡å™¨ä¸Šå­˜å‚¨çš„ç§å¯†èµ„æºï¼Œè€Œæ— éœ€ç»™ç¬¬ä¸‰æ–¹åº”ç”¨æä¾›ç”¨æˆ·åå’Œå¯†ç ã€‚</p><h3 id="å¯†ç å¼"><a href="#å¯†ç å¼" class="headerlink" title="å¯†ç å¼"></a>å¯†ç å¼</h3><p>æ¦‚å¿µï¼šç”¨æˆ·æŠŠç”¨æˆ·å&#x2F;å¯†ç ç›´æ¥æä¾›ç»™ç¬¬ä¸‰æ–¹åº”ç”¨ç”¨æ¥æ¢å–ä»¤ç‰Œ<br>å‰æï¼šæ— æ³•ä½¿ç”¨å…¶ä»–æˆæƒæ–¹å¼ä¸”ç”¨æˆ·é«˜åº¦ä¿¡ä»»ç¬¬ä¸‰æ–¹åº”ç”¨<br>è¿‡ç¨‹ï¼š</p><ol><li>ç½‘ç«™ A å‘ç”¨æˆ·å‘å‡ºè·å–ç”¨æˆ·åå’Œå¯†ç çš„è¯·æ±‚</li><li>ç”¨æˆ·åŒæ„åï¼Œç½‘ç«™ A å‡­å€Ÿç”¨æˆ·åå’Œå¯†ç å‘ç½‘ç«™ B æ¢å–ä»¤ç‰Œ</li><li>ç½‘ç«™ B éªŒè¯ç”¨æˆ·èº«ä»½åï¼Œç»™å‡ºç½‘ç«™ A ä»¤ç‰Œï¼Œç½‘ç«™ A å‡­å€Ÿä»¤ç‰Œå¯ä»¥è®¿é—®ç½‘ç«™ B å¯¹åº”æƒé™çš„èµ„æºã€‚</li></ol><h3 id="éšè—å¼"><a href="#éšè—å¼" class="headerlink" title="éšè—å¼"></a>éšè—å¼</h3><p>é€‚ç”¨äºå‰ç«¯åº”ç”¨<br>è¿‡ç¨‹ï¼š</p><ol><li>A ç½‘ç«™æä¾›ä¸€ä¸ªè·³è½¬åˆ° B ç½‘ç«™çš„é“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»åè·³è½¬è‡³ B ç½‘ç«™ï¼Œå¹¶å‘ç”¨æˆ·è¯·æ±‚æˆæƒï¼›</li><li>ç”¨æˆ·ç™»å½• B ç½‘ç«™ï¼ŒåŒæ„æˆæƒåï¼Œè·³è½¬å› A ç½‘ç«™æŒ‡å®šçš„é‡å®šå‘ redirect_url åœ°å€ï¼Œå¹¶æºå¸¦ B ç½‘ç«™è¿”å›çš„ä»¤ç‰Œï¼Œç”¨æˆ·åœ¨ B ç½‘ç«™çš„æ•°æ®ç»™ A ç½‘ç«™ä½¿ç”¨ã€‚</li></ol><h3 id="å‡­å€Ÿå¼"><a href="#å‡­å€Ÿå¼" class="headerlink" title="å‡­å€Ÿå¼"></a>å‡­å€Ÿå¼</h3><p>é€‚ç”¨äºå‘½ä»¤è¡Œåº”ç”¨<br>è¿‡ç¨‹ï¼š</p><ol><li>åº”ç”¨ A åœ¨å‘½ä»¤è¡Œå‘åº”ç”¨ B è¯·æ±‚æˆæƒï¼Œæ­¤æ—¶åº”ç”¨ A éœ€è¦æºå¸¦åº”ç”¨ B æå‰é¢å‘çš„ secretID å’Œ secretKeyï¼Œå…¶ä¸­ secretKey å‡ºäºå®‰å…¨æ€§è€ƒè™‘ï¼Œéœ€åœ¨åç«¯å‘é€ï¼›</li><li>åº”ç”¨ B æ¥æ”¶åˆ° secretID å’Œ secretKeyï¼Œå¹¶è¿›è¡Œèº«ä»½éªŒè¯ï¼ŒéªŒè¯é€šè¿‡åè¿”å›ç»™åº”ç”¨ A ä»¤ç‰Œã€‚</li></ol><h2 id="Bearerâ€”â€”ä»¤ç‰Œè®¤è¯"><a href="#Bearerâ€”â€”ä»¤ç‰Œè®¤è¯" class="headerlink" title="Bearerâ€”â€”ä»¤ç‰Œè®¤è¯"></a>Bearerâ€”â€”ä»¤ç‰Œè®¤è¯</h2><h3 id="æ ¸å¿ƒï¼šbearer-token"><a href="#æ ¸å¿ƒï¼šbearer-token" class="headerlink" title="æ ¸å¿ƒï¼šbearer token"></a>æ ¸å¿ƒï¼šbearer token</h3><p>bearer tokenç®—æ˜¯ä¸€ä¸ªåŠ å¯†å­—ç¬¦ä¸²,ç”±æœåŠ¡ç«¯æ ¹æ®å¯†é’¥ç”Ÿæˆã€‚éœ€è¦å’ŒHTTPSä¸€èµ·ä½¿ç”¨ä¿è¯å®‰å…¨æ€§</p><h3 id="å¿…è¦æ¡ä»¶ï¼š"><a href="#å¿…è¦æ¡ä»¶ï¼š" class="headerlink" title="å¿…è¦æ¡ä»¶ï¼š"></a>å¿…è¦æ¡ä»¶ï¼š</h3><p>å®¢æˆ·ç«¯åœ¨è¯·æ±‚æœåŠ¡ç«¯æ—¶ï¼Œå¿…é¡»åœ¨è¯·æ±‚å¤´ä¸­åŒ…å«Authorization: Bearer ã€‚<br>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œè§£æå‡º ï¼Œå¹¶æ ¡éªŒ çš„åˆæ³•æ€§ï¼Œå¦‚æœæ ¡éªŒé€šè¿‡ï¼Œåˆ™è®¤è¯é€šè¿‡</p><h3 id="token-ç¼–ç æ–¹å¼ï¼š"><a href="#token-ç¼–ç æ–¹å¼ï¼š" class="headerlink" title="token ç¼–ç æ–¹å¼ï¼š"></a>token ç¼–ç æ–¹å¼ï¼š</h3><p>JSON WEB TOKEN(JWT)ï¼šBearer Token çš„ä¸€ä¸ªå…·ä½“å®ç°</p><h2 id="åŸºäº-JWT-çš„-Token-è®¤è¯æœºåˆ¶"><a href="#åŸºäº-JWT-çš„-Token-è®¤è¯æœºåˆ¶" class="headerlink" title="åŸºäº JWT çš„ Token è®¤è¯æœºåˆ¶"></a>åŸºäº JWT çš„ Token è®¤è¯æœºåˆ¶</h2><h3 id="åœºæ™¯ï¼š"><a href="#åœºæ™¯ï¼š" class="headerlink" title="åœºæ™¯ï¼š"></a>åœºæ™¯ï¼š</h3><p>ä¸ºäº†åŒºåˆ†ç”¨æˆ·å’Œä¿è¯å®‰å…¨ï¼Œå¿…é¡»å¯¹ API è¯·æ±‚è¿›è¡Œé‰´æƒï¼Œä½†æ˜¯ä¸èƒ½è¦æ±‚æ¯ä¸€ä¸ªè¯·æ±‚éƒ½è¿›è¡Œç™»å½•æ“ä½œ</p><h3 id="æ–¹æ³•ï¼š"><a href="#æ–¹æ³•ï¼š" class="headerlink" title="æ–¹æ³•ï¼š"></a>æ–¹æ³•ï¼š</h3><p>åœ¨ç¬¬ä¸€æ¬¡ç™»å½•ä¹‹åäº§ç”Ÿä¸€ä¸ªæœ‰ä¸€å®šæœ‰æ•ˆæœŸçš„ tokenï¼Œå¹¶å°†å®ƒå­˜å‚¨åœ¨æµè§ˆå™¨çš„ Cookie æˆ– LocalStorage ä¹‹ä¸­ã€‚ä¹‹åçš„è¯·æ±‚éƒ½æºå¸¦è¿™ä¸ª token ï¼Œè¯·æ±‚åˆ°è¾¾æœåŠ¡å™¨ç«¯åï¼ŒæœåŠ¡å™¨ç«¯ç”¨è¿™ä¸ª token å¯¹è¯·æ±‚è¿›è¡Œè®¤è¯ã€‚åœ¨ç¬¬ä¸€æ¬¡ç™»å½•ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šå°†è¿™ä¸ª token ç”¨æ–‡ä»¶ã€æ•°æ®åº“æˆ–ç¼“å­˜æœåŠ¡å™¨ç­‰æ–¹æ³•å­˜ä¸‹æ¥ï¼Œç”¨äºä¹‹åè¯·æ±‚ä¸­çš„æ¯”å¯¹ã€‚</p><h3 id="ä¼˜ç‚¹ï¼š"><a href="#ä¼˜ç‚¹ï¼š" class="headerlink" title="ä¼˜ç‚¹ï¼š"></a>ä¼˜ç‚¹ï¼š</h3><ol><li>æ— éœ€åœ¨æœåŠ¡ç«¯å­˜å‚¨ç”¨æˆ·æ•°æ®ï¼Œå¯ä»¥å‡è½»æœåŠ¡ç«¯å‹åŠ›</li><li>é‡‡ç”¨ JSON æ•°æ®æ ¼å¼ï¼Œæ¯”è¾ƒæ˜“è¯»</li><li>ä½¿ç”¨ JWT Token å¯ä»¥è·¨è¯­è¨€</li><li>å±äºè½»é‡çº§</li></ol><h3 id="æ­¥éª¤ï¼š"><a href="#æ­¥éª¤ï¼š" class="headerlink" title="æ­¥éª¤ï¼š"></a>æ­¥éª¤ï¼š</h3><ol><li>å®¢æˆ·ç«¯ã€å‰ç«¯ã€‘ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç è¯·æ±‚ç™»å½•</li><li>æœåŠ¡ç«¯ã€åç«¯ã€‘æ”¶åˆ°è¯·æ±‚åï¼Œå»éªŒè¯ç”¨æˆ·åå’Œå¯†ç ã€‚</li><li>å¦‚æœç”¨æˆ·åå’Œå¯†ç è·Ÿæ•°æ®åº“è®°å½•ä¸ä¸€è‡´ï¼Œåˆ™éªŒè¯å¤±è´¥ï¼›å¦‚æœä¸€è‡´åˆ™éªŒè¯é€šè¿‡ï¼ŒæœåŠ¡ç«¯ä¼šç­¾å‘ä¸€ä¸ª Token è¿”å›ç»™å®¢æˆ·ç«¯</li><li>å®¢æˆ·ç«¯æ”¶åˆ°è¯·æ±‚åä¼šå°† Token ç¼“å­˜èµ·æ¥ï¼Œæ¯”å¦‚æ”¾åœ¨æµè§ˆå™¨ Cookie ä¸­æˆ–è€… LocalStorage ä¸­ï¼Œä¹‹åæ¯æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦è¯¥ Token</li><li>æœåŠ¡ç«¯æ”¶åˆ°è¯·æ±‚åï¼Œä¼šéªŒè¯è¯·æ±‚ä¸­çš„ Tokenï¼ŒéªŒè¯é€šè¿‡åˆ™è¿›è¡Œä¸šåŠ¡é€»è¾‘å¤„ç†ï¼Œå¤„ç†å®Œåè¿”å›å¤„ç†åçš„ç»“æœã€‚</li></ol><h3 id="æ ¼å¼"><a href="#æ ¼å¼" class="headerlink" title="æ ¼å¼"></a>æ ¼å¼</h3><p>Header.Payload.Signature</p><pre><code class="go">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJhdWQiOiJpYW0uYXBpLm1hcm1vdGVkdS5jb20iLCJleHAiOjE2NDI4NTY2MzcsImlkZW50aXR5IjoiYWRtaW4iLCJpc3MiOiJpYW0tYXBpc2VydmVyIiwib3JpZ19pYXQiOjE2MzUwODA2MzcsInN1YiI6ImFkbWluIn0.Shw27RKENE_2MVBq7-c8OmgYdF92UmdwS8xE-Fts2FM</code></pre><img src="/2022/12/10/ren-zheng-ji-zhi/jwt.webp" class="" title="jwt"><h2 id="JWTç»„æˆ"><a href="#JWTç»„æˆ" class="headerlink" title="JWTç»„æˆ"></a>JWTç»„æˆ</h2><h3 id="Header"><a href="#Header" class="headerlink" title="Header"></a>Header</h3><p>åŒ…å«ä¿¡æ¯ï¼šTokenç±»å‹+Tokenæ‰€ä½¿ç”¨çš„åŠ å¯†ç®—æ³•</p><pre><code class="json">&#123;  &quot;typ&quot;: &quot;JWT&quot;,//Tokenç±»å‹  &quot;alg&quot;: &quot;HS256&quot;//åŠ å¯†ç®—æ³•&#125;//base64ç¼–ç åä¸ºeyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9</code></pre><h3 id="payload"><a href="#payload" class="headerlink" title="payload"></a>payload</h3><p>åŒ…å«ä¿¡æ¯ï¼šJWT æ ‡å‡†ä¸­æ³¨å†Œçš„å£°æ˜+å…¬å…±çš„å£°æ˜+ç§æœ‰çš„å£°æ˜</p><pre><code class="json">&#123; &quot;aud&quot;: &quot;iam.authz.marmotedu.com&quot;, &quot;exp&quot;: 1604158987,//å¼€å‘ç¯å¢ƒ7å¤©ï¼Œç”Ÿäº§ç¯å¢ƒ2å°æ—¶ &quot;iat&quot;: 1604151787, &quot;iss&quot;: &quot;iamctl&quot;, &quot;nbf&quot;: 1604151787&#125;</code></pre><img src="/2022/12/10/ren-zheng-ji-zhi/payload.webp" class="" title="payload"><h3 id="signature-ç­¾å"><a href="#signature-ç­¾å" class="headerlink" title="signature ç­¾å"></a>signature ç­¾å</h3><p>ç”Ÿæˆæ–¹å¼ï¼š</p><ol><li>å°† Header å’Œ Payload åˆ†åˆ« base64 ç¼–ç åï¼Œç”¨ . è¿æ¥</li><li>ä½¿ç”¨ Header ä¸­å£°æ˜çš„åŠ å¯†æ–¹å¼ï¼Œåˆ©ç”¨ secretKey(å¯†é’¥ï¼Œä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œé€šè¿‡é…ç½®æ–‡ä»¶æ¥ä¿å­˜) å¯¹è¿æ¥åçš„å­—ç¬¦ä¸²è¿›è¡ŒåŠ å¯†ï¼ŒåŠ å¯†åçš„å­—ç¬¦ä¸²å³ä¸ºæœ€ç»ˆçš„ Signatureã€‚<img src="/2022/12/10/ren-zheng-ji-zhi/config.webp" class="" title="å¯†é’¥é…ç½®æ–‡ä»¶">æ­¥éª¤ï¼š</li><li>ç­¾ååæœåŠ¡ç«¯ä¼šè¿”å›ç”Ÿæˆçš„ Tokenï¼Œå®¢æˆ·ç«¯ä¸‹æ¬¡è¯·æ±‚ä¼šæºå¸¦è¯¥ Tokenã€‚</li><li>æœåŠ¡ç«¯æ”¶åˆ° Token åä¼šè§£æå‡º header.payloadï¼Œ</li><li>æœåŠ¡ç«¯ç”¨ç›¸åŒçš„åŠ å¯†ç®—æ³•å’Œå¯†é’¥å¯¹ header.payload å†è¿›è¡Œä¸€æ¬¡åŠ å¯†ï¼Œå¾—åˆ° Signatureã€‚</li><li>å¯¹æ¯”åŠ å¯†åçš„ Signature å’Œæ”¶åˆ°çš„ Signature æ˜¯å¦ç›¸åŒï¼Œå¦‚æœç›¸åŒåˆ™éªŒè¯é€šè¿‡ï¼Œä¸ç›¸åŒåˆ™è¿”å› HTTP 401 Unauthorized çš„é”™è¯¯</li></ol><hr><h2 id="iamçš„è®¿é—®è®¤è¯"><a href="#iamçš„è®¿é—®è®¤è¯" class="headerlink" title="iamçš„è®¿é—®è®¤è¯"></a>iamçš„è®¿é—®è®¤è¯</h2><ul><li>IAM é¡¹ç›®çš„ iam-apiserver æœåŠ¡ï¼Œæä¾›äº† IAM ç³»ç»Ÿçš„ç®¡ç†æµåŠŸèƒ½æ¥å£ï¼Œå®ƒçš„å®¢æˆ·ç«¯å¯ä»¥æ˜¯å‰ç«¯ï¼ˆè¿™é‡Œä¹Ÿå«æ§åˆ¶å°ï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯ App ç«¯ã€‚</li><li>ä¸ºäº†æ–¹ä¾¿ç”¨æˆ·åœ¨ Linux ç³»ç»Ÿä¸‹è°ƒç”¨ï¼ŒIAM é¡¹ç›®è¿˜æä¾›äº† iamctl å‘½ä»¤è¡Œå·¥å…·ã€‚</li><li>ä¸ºäº†æ”¯æŒåœ¨ç¬¬ä¸‰æ–¹ä»£ç ä¸­è°ƒç”¨ iam-apiserver æä¾›çš„ API æ¥å£ï¼Œè¿˜æ”¯æŒäº† API è°ƒç”¨ã€‚</li><li>ä¸ºäº†æé«˜ç”¨æˆ·åœ¨ä»£ç ä¸­è°ƒç”¨ API æ¥å£çš„æ•ˆç‡ï¼ŒIAM é¡¹ç›®æä¾›äº† Go SDK</li></ul><p>æ§åˆ¶å°&#x2F;appç«¯ï¼šéœ€è¦ä½¿ç”¨<code>ç”¨æˆ·åï¼šå¯†ç </code>ç™»é™†ç³»ç»Ÿâ€”&gt;Basicè®¤è¯<br>iamctl&#x2F;APIè°ƒç”¨&#x2F;GO SDKï¼šä¸éœ€è¦ç™»å½•â€”&gt; Bearerè®¤è¯</p><blockquote><p>Basic è®¤è¯éœ€è¦ç”¨æˆ·åå’Œå¯†ç ï¼ŒBearer è®¤è¯åˆ™éœ€è¦å¯†é’¥ï¼Œæ‰€ä»¥ iam-apiserver éœ€è¦å°†ç”¨æˆ·å&#x2F;å¯†ç &#x2F;å¯†é’¥ç­‰ä¿¡æ¯ä¿å­˜åœ¨åç«¯çš„ MySQL ä¸­ï¼ŒæŒä¹…å­˜å‚¨èµ·æ¥ã€‚</p></blockquote><img src="/2022/12/10/ren-zheng-ji-zhi/design.webp" class=""><h3 id="åŒºåˆ«æ§åˆ¶æµå’Œæ•°æ®æµ"><a href="#åŒºåˆ«æ§åˆ¶æµå’Œæ•°æ®æµ" class="headerlink" title="åŒºåˆ«æ§åˆ¶æµå’Œæ•°æ®æµ"></a>åŒºåˆ«æ§åˆ¶æµå’Œæ•°æ®æµ</h3><p>å°†å¯†é’¥çš„ CURD æ“ä½œä¹Ÿæ”¾åœ¨äº† iam-apiserver ä¸­ï¼Œä½†æ˜¯ iam-authz-server éœ€è¦ç”¨åˆ°è¿™äº›å¯†é’¥ä¿¡æ¯ã€‚ iam-authz-server éœ€è¦ç”¨åˆ°è¿™äº›å¯†é’¥ä¿¡æ¯ï¼š<br>è§£å†³æ–¹æ³•ï¼š</p><ol><li>iam-authz-server é€šè¿‡ gRPC API è¯·æ±‚ iam-apiserverï¼Œè·å–æ‰€æœ‰çš„å¯†é’¥ä¿¡æ¯</li><li>å½“ iam-apiserver æœ‰å¯†é’¥æ›´æ–°æ—¶ï¼Œä¼š Pub ä¸€æ¡æ¶ˆæ¯åˆ° Redis Channel ä¸­ã€‚å› ä¸º iam-authz-server è®¢é˜…äº†åŒä¸€ä¸ª Redis Channelï¼Œiam-authz-searver ç›‘å¬åˆ° channel æœ‰æ–°æ¶ˆæ¯æ—¶ï¼Œä¼šè·å–ã€è§£ææ¶ˆæ¯ï¼Œå¹¶æ›´æ–°å®ƒç¼“å­˜çš„å¯†é’¥ä¿¡æ¯ã€‚ç¡®ä¿ iam-authz-server å†…å­˜ä¸­ç¼“å­˜çš„å¯†é’¥å’Œ iam-apiserver ä¸­çš„å¯†é’¥ä¿æŒä¸€è‡´</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>iamé¡¹ç›®çš„éƒ¨ç½²</title>
      <link href="/2022/12/08/iam-xiang-mu-de-bu-shu/"/>
      <url>/2022/12/08/iam-xiang-mu-de-bu-shu/</url>
      
        <content type="html"><![CDATA[<h2 id="IAMçš„æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨æ­¥éª¤"><a href="#IAMçš„æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨æ­¥éª¤" class="headerlink" title="IAMçš„æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨æ­¥éª¤"></a>IAMçš„æ ¸å¿ƒåŠŸèƒ½ä½¿ç”¨æ­¥éª¤</h2><h3 id="åˆ›å»ºå¹³å°èµ„æº"><a href="#åˆ›å»ºå¹³å°èµ„æº" class="headerlink" title="åˆ›å»ºå¹³å°èµ„æº"></a>åˆ›å»ºå¹³å°èµ„æº</h3><ol><li>ç”¨æˆ·é€šè¿‡å‰ç«¯è¯·æ±‚ iam-apiserver æä¾›çš„ RESTful API æ¥å£å®Œæˆç”¨æˆ·ã€å¯†é’¥ã€æˆæƒç­–ç•¥çš„å¢åˆ æ”¹æŸ¥</li><li>iam-apiserver å°†è¿™äº›èµ„æºæŒä¹…åŒ–å­˜å‚¨åœ¨MySQLä¸­</li><li>ä¸ºäº†ç¡®ä¿é€šä¿¡å®‰å…¨ï¼Œå®¢æˆ·ç«¯è®¿é—®æœåŠ¡ç«¯éƒ½æ˜¯é€šè¿‡HTTPSåè®®</li></ol><h3 id="è¯·æ±‚APIå®Œæˆèµ„æºæˆæƒ"><a href="#è¯·æ±‚APIå®Œæˆèµ„æºæˆæƒ" class="headerlink" title="è¯·æ±‚APIå®Œæˆèµ„æºæˆæƒ"></a>è¯·æ±‚APIå®Œæˆèµ„æºæˆæƒ</h3><ol><li>ç”¨æˆ·é€šè¿‡å‰ç«¯è¯·æ±‚ iam-authz-server æä¾›çš„ &#x2F;v1&#x2F;authz æ¥å£è¿›è¡Œèµ„æºæˆæƒ</li></ol><ul><li>å…ˆé€šè¿‡å¯†é’¥è®¤è¯</li><li>è®¤è¯é€šè¿‡å,&#x2F;v1&#x2F;authz æ¥å£ä¼šæŸ¥è¯¢æˆæƒç­–ç•¥ï¼Œå†³å®šèµ„æºè¯·æ±‚æ˜¯å¦è¢«å…è®¸</li></ul><ol start="2"><li>iam-authz-server å°†å¯†é’¥å’Œç­–ç•¥ä¿¡æ¯ç¼“å­˜åœ¨å†…å­˜ä¸­ï¼Œå®ç°å¿«é€ŸæŸ¥è¯¢ï¼Œæé«˜&#x2F;v1&#x2F;authzæ¥å£æ€§èƒ½</li><li>å¦‚ä½•å®ç°å¯†é’¥å’Œç­–ç•¥ä¿¡æ¯çš„ç¼“å­˜</li></ol><ul><li>iam-authz-server è°ƒç”¨ iam-apiserver æä¾›çš„ gRPCæ¥å£ï¼Œå°†ä¸Šè¿°ä¿¡æ¯ç¼“å­˜åˆ°å†…å­˜ä¸­</li><li>ä¸ºäº†ä¿æŒå†…å­˜ä¸­çš„ç¼“å­˜å’Œiam-apiserverä¿æŒä¸€è‡´ï¼Œiam-apiserveræœ‰ä¸Šè¿°ä¿¡æ¯è¢«æ›´æ–°çš„æ—¶å€™ï¼Œiam-apiserver ä¼šå¾€ç‰¹å®šçš„ Redis Channelï¼ˆiam-authz-server ä¹Ÿä¼šè®¢é˜…è¯¥ Channelï¼‰ä¸­å‘é€ PolicyChanged å’Œ SecretChanged æ¶ˆæ¯ã€‚</li><li>å½“ iam-authz-server ç›‘å¬åˆ°æœ‰æ–°æ¶ˆæ¯æ—¶å°±ä¼šè·å–å¹¶è§£ææ¶ˆæ¯ï¼Œæ ¹æ®æ¶ˆæ¯å†…å®¹åˆ¤æ–­æ˜¯å¦éœ€è¦é‡æ–°è°ƒç”¨ gRPC æ¥æ¥è·å–å¯†é’¥å’Œæˆæƒç­–ç•¥ä¿¡æ¯ï¼Œå†æ›´æ–°åˆ°å†…å­˜ä¸­ã€‚</li></ul><h3 id="æˆæƒæ—¥å¿—åˆ†æ"><a href="#æˆæƒæ—¥å¿—åˆ†æ" class="headerlink" title="æˆæƒæ—¥å¿—åˆ†æ"></a>æˆæƒæ—¥å¿—åˆ†æ</h3><ol><li>iam-authz-serverå°†æˆæƒæ—¥å¿—ä¸ŠæŠ¥åˆ°redisé«˜é€Ÿç¼“å­˜ä¸­</li><li>iam-pumpå¼‚æ­¥æ¶ˆè´¹æˆæƒæ—¥å¿—ï¼ŒæŠŠæ¸…ç†åçš„æ•°æ®ä¿å­˜åœ¨ MongoDB ä¸­ï¼Œä¾›è¿è¥ç³»ç»ŸæŸ¥è¯¢</li></ol><ul><li>iam-authz-server å°†æˆæƒæ—¥å¿—ä¿å­˜åœ¨ Redis ä¸­ï¼Œå¯ä»¥æœ€å¤§åŒ–å‡å°‘å†™å…¥å»¶æ—¶ã€‚</li><li>ä¸ä¿å­˜åœ¨å†…å­˜ä¸­æ˜¯å› ä¸ºæˆæƒæ—¥å¿—é‡æˆ‘ä»¬æ²¡æ³•é¢„æµ‹ï¼Œå½“æˆæƒæ—¥å¿—é‡å¾ˆå¤§æ—¶ï¼Œå¾ˆå¯èƒ½ä¼šå°†å†…å­˜è€—å°½ï¼Œé€ æˆæœåŠ¡ä¸­æ–­ã€‚</li></ul><h3 id="è¿è¥å¹³å°æˆæƒæ•°æ®å±•ç¤º"><a href="#è¿è¥å¹³å°æˆæƒæ•°æ®å±•ç¤º" class="headerlink" title="è¿è¥å¹³å°æˆæƒæ•°æ®å±•ç¤º"></a>è¿è¥å¹³å°æˆæƒæ•°æ®å±•ç¤º</h3><img src="/2022/12/08/iam-xiang-mu-de-bu-shu/iam-operating-system.webp" class="" title="iamæ“ä½œç³»ç»Ÿå‰åç«¯åˆ†ç¦»æ¶æ„"><p>æ€»ç»“ï¼š</p><blockquote><ol><li>é¦–å…ˆï¼Œç”¨æˆ·é€šè¿‡è°ƒç”¨ iam-apiserver æä¾›çš„ RESTful API æ¥å£å®Œæˆæ³¨å†Œå’Œç™»å½•ç³»ç»Ÿï¼Œ</li><li>å†è°ƒç”¨æ¥å£åˆ›å»ºå¯†é’¥å’Œæˆæƒç­–ç•¥ã€‚</li><li>åˆ›å»ºå®Œå¯†é’¥å¯¹å’Œæˆæƒç­–ç•¥ä¹‹åï¼ŒIAM å¯ä»¥é€šè¿‡è°ƒç”¨ iam-authz-server çš„æˆæƒæ¥å£å®Œæˆèµ„æºçš„æˆæƒã€‚<ul><li>å…·ä½“æ¥è¯´ï¼Œiam-authz-server é€šè¿‡ gRPC æ¥å£è·å– iam-apiserver ä¸­å­˜å‚¨çš„å¯†é’¥å’Œæˆæƒç­–ç•¥ä¿¡æ¯ï¼Œé€šè¿‡ JWT å®Œæˆè®¤è¯ä¹‹åï¼Œå†é€šè¿‡ ory&#x2F;ladon åŒ…å®Œæˆèµ„æºçš„æˆæƒã€‚i</li><li>iam-pump ç»„ä»¶å¼‚æ­¥æ¶ˆè´¹ Redis ä¸­çš„æ•°æ®ï¼Œå¹¶æŒä¹…åŒ–å­˜å‚¨åœ¨ MongoDB ä¸­ï¼Œä¾› iam-operating-system è¿è¥å¹³å°å±•ç¤ºã€‚</li><li>æœ€åï¼ŒIAM ç›¸å…³çš„äº§å“ã€ç ”å‘äººå‘˜å¯ä»¥é€šè¿‡ IAM çš„è¿è¥ç³»ç»Ÿ iam-operating-system æ¥æŸ¥çœ‹ IAM ç³»ç»Ÿçš„ä½¿ç”¨æƒ…å†µï¼Œè¿›è¡Œè¿è¥åˆ†æã€‚ä¾‹å¦‚æŸä¸ªç”¨æˆ·çš„æˆæƒ &#x2F; å¤±è´¥æ¬¡æ•°ã€æˆæƒå¤±è´¥æ—¶çš„æˆæƒä¿¡æ¯ç­‰ã€‚</li></ul></li></ol></blockquote><h2 id="iamä¸»è¦åŠŸèƒ½"><a href="#iamä¸»è¦åŠŸèƒ½" class="headerlink" title="iamä¸»è¦åŠŸèƒ½"></a>iamä¸»è¦åŠŸèƒ½</h2><ol><li>è®¤è¯ï¼šç”¨æ¥åˆ¤æ–­æ˜¯å¦æ˜¯å¹³å°çš„åˆæ³•ç”¨æˆ·ï¼Œæ¯”å¦‚ä½¿ç”¨ç”¨æˆ·åå’Œå¯†ç </li><li>æˆæƒï¼šç”¨æ¥åˆ¤æ–­æ˜¯å¦å¯ä»¥è®¿é—®å¹³å°çš„æŸç±»èµ„æº</li></ol>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centos7-é˜²ç«å¢™ç«¯å£</title>
      <link href="/2022/11/30/centos7-fang-huo-qiang-duan-kou/"/>
      <url>/2022/11/30/centos7-fang-huo-qiang-duan-kou/</url>
      
        <content type="html"><![CDATA[<h2 id="æŸ¥çœ‹ç«¯å£å ç”¨"><a href="#æŸ¥çœ‹ç«¯å£å ç”¨" class="headerlink" title="æŸ¥çœ‹ç«¯å£å ç”¨"></a>æŸ¥çœ‹ç«¯å£å ç”¨</h2><pre><code class="bash">lsof -i:8000</code></pre><h2 id="å¼€å¯-x2F-å…³é—­ç«¯å£"><a href="#å¼€å¯-x2F-å…³é—­ç«¯å£" class="headerlink" title="å¼€å¯&#x2F;å…³é—­ç«¯å£"></a>å¼€å¯&#x2F;å…³é—­ç«¯å£</h2><pre><code class="bash">firewall-cmd --zone=public --add-port=5672/tcp --permanent   # å¼€æ”¾5672ç«¯å£firewall-cmd --zone=public --remove-port=5672/tcp --permanent  #å…³é—­5672ç«¯å£firewall-cmd --reload   # é…ç½®ç«‹å³ç”Ÿæ•ˆ</code></pre><h2 id="æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾çš„æ‰€æœ‰ç«¯å£"><a href="#æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾çš„æ‰€æœ‰ç«¯å£" class="headerlink" title="æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾çš„æ‰€æœ‰ç«¯å£"></a>æŸ¥çœ‹é˜²ç«å¢™å¼€æ”¾çš„æ‰€æœ‰ç«¯å£</h2><pre><code class="bash">firewall-cmd --zone=public --list-ports</code></pre><h2 id="å…¨å±€å…³é—­é˜²ç«å¢™"><a href="#å…¨å±€å…³é—­é˜²ç«å¢™" class="headerlink" title="å…¨å±€å…³é—­é˜²ç«å¢™"></a>å…¨å±€å…³é—­é˜²ç«å¢™</h2><pre><code class="bash">systemctl stop firewalld.service</code></pre><h2 id="æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€"><a href="#æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€" class="headerlink" title="æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€"></a>æŸ¥çœ‹é˜²ç«å¢™çŠ¶æ€</h2><pre><code class="bash"> firewall-cmd --state</code></pre><h2 id="æ£€æŸ¥ç«¯å£è¢«è¿›ç¨‹å ç”¨æƒ…å†µ"><a href="#æ£€æŸ¥ç«¯å£è¢«è¿›ç¨‹å ç”¨æƒ…å†µ" class="headerlink" title="æ£€æŸ¥ç«¯å£è¢«è¿›ç¨‹å ç”¨æƒ…å†µ"></a>æ£€æŸ¥ç«¯å£è¢«è¿›ç¨‹å ç”¨æƒ…å†µ</h2><pre><code class="bash">netstat -lnpt |grep 5672</code></pre><h2 id="æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯"><a href="#æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯" class="headerlink" title="æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯"></a>æŸ¥çœ‹è¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯</h2><pre><code class="bash">ps pid</code></pre><h2 id="ç»ˆæ­¢è¿›ç¨‹"><a href="#ç»ˆæ­¢è¿›ç¨‹" class="headerlink" title="ç»ˆæ­¢è¿›ç¨‹"></a>ç»ˆæ­¢è¿›ç¨‹</h2><pre><code class="bash">kill -9 pid</code></pre>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>16-go-webæœåŠ¡</title>
      <link href="/2022/11/29/16-go-web-fu-wu/"/>
      <url>/2022/11/29/16-go-web-fu-wu/</url>
      
        <content type="html"><![CDATA[<img src="/2022/11/29/16-go-web-fu-wu/web%E6%9C%8D%E5%8A%A1.webp" class="" title="webæœåŠ¡åˆ†ç±»"><blockquote><p>å‰æï¼šè¦å®ç°ä¸€ä¸ªwebæœåŠ¡ï¼Œå¿…é¡»å…ˆé€‰æ‹©é€šä¿¡åè®®å’Œé€šä¿¡æ ¼å¼ã€‚å¦‚æœæœåŠ¡æœ¬èº«ä¸»è¦æ˜¯æä¾›REST é£æ ¼çš„APIï¼Œåˆ™ä½¿ç”¨HTTP+JSONã€‚åä¹‹åˆ™ä½¿ç”¨gRpc+Protobuf</p></blockquote><h2 id="åŸºç¡€åŠŸèƒ½"><a href="#åŸºç¡€åŠŸèƒ½" class="headerlink" title="åŸºç¡€åŠŸèƒ½"></a>åŸºç¡€åŠŸèƒ½</h2><h3 id="è·¯ç”±åŒ¹é…"><a href="#è·¯ç”±åŒ¹é…" class="headerlink" title="è·¯ç”±åŒ¹é…"></a>è·¯ç”±åŒ¹é…</h3><p>æ¦‚å¿µï¼šæ ¹æ®(HTTPæ–¹æ³•, è¯·æ±‚è·¯å¾„)åŒ¹é…åˆ°å¤„ç†è¿™ä¸ªè¯·æ±‚çš„å‡½æ•°ï¼Œæœ€ç»ˆç”±è¯¥å‡½æ•°å¤„ç†è¿™æ¬¡è¯·æ±‚ï¼Œå¹¶è¿”å›ç»“æœ</p><img src="/2022/11/29/16-go-web-fu-wu/%E8%B7%AF%E7%94%B1%E5%8C%B9%E9%85%8D.webp" class="" title="è·¯ç”±åŒ¹é…"><p>å¦‚ä¸Šå›¾æ‰€ç¤ºï¼š</p><ul><li>æœ€ç»ˆè¿™ä¸ªè¯·æ±‚ç”±<code>Delete(c *gin.Context)</code>å¤„ç†</li><li>å‚æ•°cå­˜æ”¾äº†è¯·æ±‚å‚æ•°</li><li>åœ¨å‡½æ•°Deleteä¸­è¿›è¡Œä¸šåŠ¡å¤„ç†(å‚æ•°è§£æ-&gt;å‚æ•°æ ¡éªŒ-&gt;é€»è¾‘å¤„ç†-&gt;è¿”å›ç»“æœ)ï¼šä¹Ÿæ˜¯webæœåŠ¡çš„æ ¸å¿ƒè¯‰æ±‚</li></ul><h3 id="è·¯ç”±åˆ†ç»„"><a href="#è·¯ç”±åˆ†ç»„" class="headerlink" title="è·¯ç”±åˆ†ç»„"></a>è·¯ç”±åˆ†ç»„</h3><p>åŸå› ï¼šAPI æ¥å£éšç€éœ€æ±‚çš„æ›´æ–°è¿­ä»£ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œä¸ºäº†ä¾¿äºç®¡ç†ï¼Œæ‰€ä»¥éœ€è¦è¿›è¡Œè·¯ç”±åˆ†ç»„</p><h3 id="ä¸€è¿›ç¨‹å¤šæœåŠ¡"><a href="#ä¸€è¿›ç¨‹å¤šæœåŠ¡" class="headerlink" title="ä¸€è¿›ç¨‹å¤šæœåŠ¡"></a>ä¸€è¿›ç¨‹å¤šæœåŠ¡</h3><p>åŸå› ï¼šé¿å…ä¸ºç›¸åŒåŠŸèƒ½å¯åŠ¨å¤šä¸ªè¿›ç¨‹<br>å…¸å‹ä¾‹å­ï¼šåœ¨ä¸€ä¸ªæœåŠ¡è¿›ç¨‹ä¸­ï¼ŒåŒæ—¶å¼€å¯ HTTP æœåŠ¡çš„ 80 ç«¯å£å’Œ HTTPS çš„ 443 ç«¯å£å¯¹å†…çš„æœåŠ¡ï¼Œè®¿é—® 80 ç«¯å£ï¼Œç®€åŒ–æœåŠ¡è®¿é—®å¤æ‚åº¦ï¼›å¯¹å¤–çš„æœåŠ¡ï¼Œè®¿é—®æ›´ä¸ºå®‰å…¨çš„ HTTPS æœåŠ¡ï¼›æ­¤æ—¶æœ‰äº†</p><hr><h2 id="é«˜çº§åŠŸèƒ½"><a href="#é«˜çº§åŠŸèƒ½" class="headerlink" title="é«˜çº§åŠŸèƒ½"></a>é«˜çº§åŠŸèƒ½</h2><h3 id="ä¸­é—´ä»¶"><a href="#ä¸­é—´ä»¶" class="headerlink" title="ä¸­é—´ä»¶"></a>ä¸­é—´ä»¶</h3><p>åŸå› ï¼šè¿›è¡Œhttpè¯·æ±‚çš„æ—¶å€™éœ€è¦é’ˆå¯¹æ¯ä¸€æ¬¡è¯·æ±‚éƒ½è®¾ç½®ä¸€äº›é€šç”¨çš„æ“ä½œï¼Œæ¯”å¦‚æ·»åŠ  Headerã€æ·»åŠ  RequestIDã€ç»Ÿè®¡è¯·æ±‚æ¬¡æ•°ç­‰</p><h3 id="è®¤è¯"><a href="#è®¤è¯" class="headerlink" title="è®¤è¯"></a>è®¤è¯</h3><ul><li>æ–¹å¼1ï¼šåŸºäºç”¨æˆ·åå’Œå¯†ç </li><li>æ–¹å¼2ï¼šåŸºäºToken</li></ul><h3 id="RequestID"><a href="#RequestID" class="headerlink" title="RequestID"></a>RequestID</h3><p>åŸå› ï¼šå®šä½å’Œè·Ÿè¸ªæŸä¸€æ¬¡è¯·æ±‚ç”¨æ¥æ’éšœ</p><h3 id="è·¨åŸŸè¯·æ±‚"><a href="#è·¨åŸŸè¯·æ±‚" class="headerlink" title="è·¨åŸŸè¯·æ±‚"></a>è·¨åŸŸè¯·æ±‚</h3><p>åŸå› ï¼šé¡¹ç›®å‰åç«¯åˆ†ç¦»ï¼Œå‰ç«¯è®¿é—®åœ°å€å’Œåç«¯è®¿é—®åœ°å€ä¸åŒï¼Œä¼šå› ä¸ºæµè§ˆå™¨çš„åŒæºç­–ç•¥äº§ç”Ÿè·¨åŸŸé—®é¢˜</p><hr><h2 id="Ginæ¡†æ¶"><a href="#Ginæ¡†æ¶" class="headerlink" title="Ginæ¡†æ¶"></a>Ginæ¡†æ¶</h2><p>åŸºäºnet&#x2F;httpåŒ…å°è£…çš„å¼€æºæ¡†æ¶</p><h3 id="é€‰æ‹©webæ¡†æ¶çš„è€ƒè™‘å› ç´ "><a href="#é€‰æ‹©webæ¡†æ¶çš„è€ƒè™‘å› ç´ " class="headerlink" title="é€‰æ‹©webæ¡†æ¶çš„è€ƒè™‘å› ç´ "></a>é€‰æ‹©webæ¡†æ¶çš„è€ƒè™‘å› ç´ </h3><ol><li>è·¯ç”±åŠŸèƒ½</li><li>æ˜¯å¦å…·æœ‰ä¸­é—´ä»¶æˆ–è€…è¿‡æ»¤åŠŸèƒ½</li><li>httpçš„å‚æ•°çš„è§£æå’Œè¿”å›èƒ½åŠ›</li><li>æ€§èƒ½ï¼Œç¨³å®šæ€§</li><li>ä½¿ç”¨é—¨æ§›</li><li>ç¤¾åŒºæ´»è·ƒåº¦</li></ol><hr><h3 id="http-x2F-httpsæ”¯æŒ"><a href="#http-x2F-httpsæ”¯æŒ" class="headerlink" title="http&#x2F;httpsæ”¯æŒ"></a>http&#x2F;httpsæ”¯æŒ</h3><pre><code class="go">// ä¸€è¿›ç¨‹å¤šç«¯å£// å¼€å¯httpæœåŠ¡insecureServer := &amp;http.Server&#123;    Addr:         &quot;:8080&quot;,    Handler:      router(),    ReadTimeout:  5 * time.Second,    WriteTimeout: 10 * time.Second,&#125;// å¼€å¯httpsç«¯å£secureServer := &amp;http.Server&#123;    Addr:         &quot;:8443&quot;,    Handler:      router(),    ReadTimeout:  5 * time.Second,    WriteTimeout: 10 * time.Second,&#125;</code></pre><hr><h3 id="json-æ•°æ®æ”¯æŒ"><a href="#json-æ•°æ®æ”¯æŒ" class="headerlink" title="json æ•°æ®æ”¯æŒ"></a>json æ•°æ®æ”¯æŒ</h3><ol><li>é€šè¿‡c.ShouldBindJSONå‡½æ•°è§£æBody ä¸­çš„ JSON æ ¼å¼æ•°æ®å‚æ•°</li><li>é€šè¿‡c.JSONå‡½æ•°è¿”å› JSON æ ¼å¼çš„æ•°æ®</li></ol><pre><code class="go">if err := c.ShouldBindJSON(&amp;product); err != nil &#123;    c.JSON(http.StatusBadRequest, gin.H&#123;&quot;error&quot;: err.Error()&#125;)    return&#125;c.JSON(http.StatusOK, product)</code></pre><hr><h3 id="è·¯ç”±åŒ¹é…-1"><a href="#è·¯ç”±åŒ¹é…-1" class="headerlink" title="è·¯ç”±åŒ¹é…"></a>è·¯ç”±åŒ¹é…</h3><h4 id="ç²¾ç¡®åŒ¹é…"><a href="#ç²¾ç¡®åŒ¹é…" class="headerlink" title="ç²¾ç¡®åŒ¹é…"></a>ç²¾ç¡®åŒ¹é…</h4><p>ç²¾ç¡®åŒ¹é…â€”â€”è·¯ç”±ä¸º &#x2F;products&#x2F;:name</p><img src="/2022/11/29/16-go-web-fu-wu/%E8%B7%AF%E7%94%B1%E7%B2%BE%E7%A1%AE%E5%8C%B9%E9%85%8D.webp" class="" title="è·¯ç”±ç²¾ç¡®åŒ¹é…"><h4 id="æ¨¡ç³ŠåŒ¹é…"><a href="#æ¨¡ç³ŠåŒ¹é…" class="headerlink" title="æ¨¡ç³ŠåŒ¹é…"></a>æ¨¡ç³ŠåŒ¹é…</h4><p>æ¨¡ç³ŠåŒ¹é…â€”â€”è·¯ç”±ä¸º &#x2F;products&#x2F;*name</p><img src="/2022/11/29/16-go-web-fu-wu/%E8%B7%AF%E7%94%B1%E6%A8%A1%E7%B3%8A%E5%8C%B9%E9%85%8D.webp" class="" title="æ¨¡ç³ŠåŒ¹é…"><hr><h3 id="è·¯ç”±åˆ†ç»„-1"><a href="#è·¯ç”±åˆ†ç»„-1" class="headerlink" title="è·¯ç”±åˆ†ç»„"></a>è·¯ç”±åˆ†ç»„</h3><p>Giné€šè¿‡Groupå‡½æ•°å®ç°åˆ†ç»„</p><pre><code class="go">func router() http.Handler &#123;    router := gin.Default()    productHandler := newProductHandler()    // è·¯ç”±åˆ†ç»„ã€ä¸­é—´ä»¶ã€è®¤è¯    // ç»™æ‰€æœ‰å±äº v1 åˆ†ç»„çš„è·¯ç”±éƒ½æ·»åŠ  gin.BasicAuth ä¸­é—´ä»¶ï¼Œä»¥å®ç°è®¤è¯åŠŸèƒ½    v1 := router.Group(&quot;/v1&quot;, gin.BasicAuth(gin.Accounts&#123;&quot;foo&quot;: &quot;bar&quot;, &quot;colin&quot;: &quot;colin404&quot;&#125;))    &#123;        productv1 := v1.Group(&quot;/products&quot;)        &#123;            // è·¯ç”±åŒ¹é…            productv1.POST(&quot;&quot;, productHandler.Create)            productv1.GET(&quot;:name&quot;, productHandler.Get)        &#125;    &#125;    return router&#125;</code></pre><hr><h3 id="ä¸€è¿›ç¨‹å¤šæœåŠ¡-1"><a href="#ä¸€è¿›ç¨‹å¤šæœåŠ¡-1" class="headerlink" title="ä¸€è¿›ç¨‹å¤šæœåŠ¡"></a>ä¸€è¿›ç¨‹å¤šæœåŠ¡</h3><h4 id="goçš„å¹¶å‘"><a href="#goçš„å¹¶å‘" class="headerlink" title="goçš„å¹¶å‘"></a>goçš„å¹¶å‘</h4><p>Goè¯­è¨€æ”¯æŒå¹¶å‘,é€šè¿‡goå…³é”®è¯æ¥å¼€å¯ä¸€ä¸ªgoroutine(è½»é‡çº§çº¿ç¨‹,å…¶è°ƒåº¦ç”±GoLangè¿è¡Œæ—¶è¿›è¡Œç®¡ç†)</p><pre><code class="go">go å‡½æ•°å( å‚æ•°åˆ—è¡¨ )</code></pre><h4 id="å®ä¾‹"><a href="#å®ä¾‹" class="headerlink" title="å®ä¾‹"></a>å®ä¾‹</h4><p>å®ç°äº†2ä¸ªç›¸åŒçš„æœåŠ¡ï¼Œåˆ†åˆ«ç›‘å¬åœ¨ä¸åŒç«¯å£ã€‚</p><pre><code class="go">var eg errgroup.GroupinsecureServer := &amp;http.Server&#123;...&#125;secureServer := &amp;http.Server&#123;...&#125;// insecureServer// å¯åŠ¨ä¸€ä¸ª goroutine å»å¤„ç†eg.Go(func() error &#123;  err := insecureServer.ListenAndServe()  if err != nil &amp;&amp; err != http.ErrServerClosed &#123;    log.Fatal(err)  &#125;  return err&#125;)// secureServereg.Go(func() error &#123;  err := secureServer.ListenAndServeTLS(&quot;server.pem&quot;, &quot;server.key&quot;)  if err != nil &amp;&amp; err != http.ErrServerClosed &#123;    log.Fatal(err)  &#125;  return err&#125;// ç­‰å¾…æ‰€æœ‰çš„ goroutine ç»“æŸåé€€å‡ºï¼Œè¿”å›çš„é”™è¯¯æ˜¯ä¸€ä¸ªå‡ºé”™çš„ errif err := eg.Wait(); err != nil &#123;  log.Fatal(err)&#125;)</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ç¿»è¯‘-Slice length vs. capacity in Go</title>
      <link href="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/"/>
      <url>/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/</url>
      
        <content type="html"><![CDATA[<p>åŸæ–‡åœ°å€ï¼š<a href="https://teivah.medium.com/slice-length-vs-capacity-in-go-af71a754b7d8">https://teivah.medium.com/slice-length-vs-capacity-in-go-af71a754b7d8</a></p><h1 id="Go-è¯­è¨€ä¸­çš„åˆ‡ç‰‡-length-å’Œ-capacity"><a href="#Go-è¯­è¨€ä¸­çš„åˆ‡ç‰‡-length-å’Œ-capacity" class="headerlink" title="Go è¯­è¨€ä¸­çš„åˆ‡ç‰‡ length å’Œ capacity"></a>Go è¯­è¨€ä¸­çš„åˆ‡ç‰‡ length å’Œ capacity</h1><p><b>é•¿è¯çŸ­è¯´</b>:åˆ‡ç‰‡é•¿åº¦æ˜¯æŒ‡åˆ‡ç‰‡ä¸­å¯è®¿é—®å…ƒç´ çš„æ•°é‡,è€Œåˆ‡ç‰‡å®¹é‡æ˜¯æŒ‡ä»åˆ‡ç‰‡ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹,æ•°ç»„ä¸­å…ƒç´ çš„æ•°é‡ã€‚</p><hr><p>Go å¼€å‘è€…æ··æ·†æˆ–è€…æ²¡æœ‰å®Œå…¨ç†è§£åˆ‡ç‰‡ length å’Œ capacity çš„ç°è±¡éå¸¸æ™®éã€‚ç†è§£è¿™ä¸¤ä¸ªæ¦‚å¿µæœ‰åˆ©äºé«˜æ•ˆåœ°å¤„ç†ä¸€äº›æ ¸å¿ƒæ“ä½œ,æ¯”å¦‚åˆå§‹åŒ–åˆ‡ç‰‡,ä½¿ç”¨ append æ·»åŠ å…ƒç´ ,å¤åˆ¶,æˆªå–ã€‚è€Œè¿™ç§é”™è¯¯ç†è§£ä¼šå¯¼è‡´åˆ‡ç‰‡æ»¥ç”¨ç”šè‡³å†…å­˜æ³„æ¼ã€‚</p><p>åœ¨ Go è¯­è¨€ä¸­, slice æ˜¯ç”±æ•°ç»„è¿”å›çš„ã€‚è¿™æ„å‘³ç€åˆ‡ç‰‡çš„æ•°æ®æ˜¯æŒä¹…åŒ–çš„å­˜åœ¨ä¸€ä¸ªæ•°ç»„å½¢å¼çš„æ•°æ®ç»“æ„ä¸­ã€‚å¦‚æœæ•°ç»„æ»¡äº†ï¼Œåˆ‡ç‰‡å¯ä»¥å¤„ç†æ·»åŠ å…ƒç´ çš„é€»è¾‘,æˆ–è€…å¦‚æœæ•°ç»„å‡ ä¹æ˜¯ç©ºçš„è¯,åˆ‡ç‰‡ä¹Ÿå¯ä»¥å¤„ç†ç¼©å°æ•°ç»„çš„é€»è¾‘ã€‚</p><p>åœ¨è®¡ç®—æœºå†…éƒ¨, åˆ‡ç‰‡åŒ…å«ä¸€ä¸ªæŒ‡å‘æ•°ç»„çš„æŒ‡é’ˆ,ä¸€ä¸ª length å±æ€§å’Œä¸€ä¸ª capacity å±æ€§ã€‚length æ˜¯åˆ‡ç‰‡åŒ…å«çš„å…ƒç´ ä¸ªæ•°,è€Œ capacity æ˜¯ä»åˆ‡ç‰‡ç¬¬ä¸€ä¸ªå…ƒç´ å¼€å§‹è®¡ç®—çš„åå¤‡æ•°ç»„çš„å…ƒç´ ä¸ªæ•°ã€‚è®©æˆ‘ä»¬é€šè¿‡ä¸€äº›ä¾‹å­æ¥è®©äº‹æƒ…æ›´æ¸…æ™°ä¸€äº›ã€‚é¦–å…ˆé€šè¿‡ç»™å®šçš„ length å’Œ capacity åˆå§‹åŒ–åˆ‡ç‰‡ï¼š</p><pre><code class="go">s := make([]int, 3, 6)  /// length 3, å®¹é‡ 6 çš„åˆ‡ç‰‡</code></pre><p>ä»£è¡¨ length çš„ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯å¿…é¡»çš„ï¼Œä½†æ˜¯ä»£è¡¨ capacity çš„ç¬¬äºŒä¸ªå‚æ•°æ˜¯å¯é€‰å‚æ•°ã€‚å›¾ 1 å±•ç¤ºäº†è¿™æ®µä»£ç åœ¨å†…å­˜ä¸­çš„æ‰§è¡Œç»“æœã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/slice.webp" class="" title="å›¾1-ä¸€ä¸ªé•¿åº¦3ï¼Œå®¹é‡6çš„åˆ‡ç‰‡"><p>è¿™ä¸ªä¾‹å­é‡Œ,<code>make</code> åˆ›å»ºäº†ä¸€ä¸ª 6(capacity) ä¸ªå…ƒç´ çš„æ•°ç»„ã€‚ä½†æ˜¯å› ä¸º length è¢«è®¾ç½®ä¸º 3, æ‰€ä»¥ Go åªåˆå§‹åŒ–äº†å‰ 3 ä¸ªå…ƒç´ ã€‚è€Œä¸”ç”±äº slice è¢«è®¾ç½®ä¸º <code>[]int</code> ç±»å‹ï¼Œæ‰€ä»¥å‰ä¸‰ä¸ªå…ƒç´ çš„åˆå§‹å€¼è¢«è®¾ç½®ä¸º <code>int</code> çš„é›¶å€¼: 0ã€‚ç°è‰²å…ƒç´ æ˜¯å·²ç»åˆ†é…ä½†è¿˜æ²¡è¢«ä½¿ç”¨ã€‚</p><p>æˆ‘ä»¬æ‰“å°è¿™ä¸ªåˆ‡ç‰‡,å¯ä»¥å¾—åˆ° length èŒƒå›´å†…çš„å…ƒç´ : <code>[0,0,0]</code>ã€‚å¦‚æœæˆ‘ä»¬è®¾ç½® <code>s[1]</code> ä¸º 1,åˆ‡ç‰‡çš„ç¬¬äºŒä¸ªå…ƒç´ ä¼šè¢«ä¿®æ”¹ï¼Œä½†æ˜¯ä¸ä¼šå½±å“å®ƒçš„ length å’Œ capacityã€‚å›¾ 2 è¯´æ˜äº†è¿™ä¸€ç‚¹ã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/slice_update.webp" class="" title="å›¾2â€”â€”æ›´æ–°åˆ‡ç‰‡ç¬¬äºŒä¸ªå…ƒç´ :s[1]&#x3D;1"><p>ä½†æ˜¯, length èŒƒå›´ä»¥å¤–çš„å…ƒç´ å³ä½¿å·²ç»åœ¨å†…å­˜ä¸­åˆ†é…äº†ç©ºé—´å·²ç»ä¹Ÿæ˜¯ç¦æ­¢è®¿é—®çš„ã€‚ä¸¾ä¸ªä¾‹å­, <code>s[4]=0</code> å°±ä¼šå¼•å‘ä¸‹é¢çš„æŠ¥é”™:</p><blockquote><p>panic: runtime error: index out of range [4] with length 3</p></blockquote><p>é‚£æˆ‘ä»¬æ€æ ·ä½¿ç”¨åˆ‡ç‰‡çš„å‰©ä½™ç©ºé—´å‘¢?ç­”æ¡ˆæ˜¯é€šè¿‡å†…ç½®çš„ <code>append</code> æ–¹æ³•:</p><pre><code class="go">s = append(s, 2)</code></pre><p>è¿™è¡Œä»£ç ä¼šè¿½åŠ ä¸€ä¸ªæ–°çš„å…ƒç´ åˆ°å·²ç»å­˜åœ¨çš„ <code>s</code> åˆ‡ç‰‡ã€‚å¦‚å›¾ 3 æ‰€ç¤º,ä»–ä¼šä½¿ç”¨ç¬¬ä¸€ä¸ªç°è‰²å…ƒç´ (å·²ç»è¢«åˆ†é…ç©ºé—´ä½†è¿˜æœªä½¿ç”¨)æ¥å­˜å‚¨å…ƒç´  <code>2</code></p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/slice_3.webp" class="" title="å›¾3â€”â€”è¿½åŠ å…ƒç´ åˆ°s"><p>æ­¤æ—¶åˆ‡ç‰‡çš„ length ä¼šä» 3 æ›´æ–°åˆ° 4,å› ä¸ºåˆ‡ç‰‡ç°åœ¨åŒ…å«äº† 4 ä¸ªå…ƒç´ ã€‚å¦‚æœæˆ‘ä»¬ç°åœ¨å†è¿½åŠ  3 ä¸ªå…ƒç´ ,è®©èƒŒåçš„æ•°ç»„ä¸å¤Ÿå¤§çš„è¯ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?</p><pre><code class="go">s=append(s,3,4,5)fmt.Println(s)</code></pre><p>è¿è¡Œè¿™æ®µä»£ç ,æˆ‘ä»¬çœ‹åˆ°åˆ‡ç‰‡ä¾ç„¶èƒ½å¤Ÿå¤„ç†æˆ‘ä»¬çš„è¯·æ±‚:</p><blockquote><p>[0 1 0 2 3 4 5]</p></blockquote><p>æ•°ç»„æ˜¯å¤§å°å›ºå®šçš„ç»“æ„,æ‰€ä»¥åªèƒ½å­˜å‚¨æ–°å…ƒç´ åˆ° 4 ã€‚å½“æˆ‘ä»¬æƒ³è¦æ’å…¥å…ƒç´  5 çš„æ—¶å€™,æ•°ç»„å·²ç»æ»¡äº†:æ­¤æ—¶ Go ä¼šåœ¨å†…éƒ¨å¦å¤–åˆ›å»ºä¸€ä¸ªæ•°ç»„ï¼šcapacity æ˜¯åŸæ¥çš„ä¸¤å€,æ‹·è´åŸæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ ,ç„¶åæ’å…¥å…ƒç´  5ã€‚å›¾ 4 å±•ç¤ºäº†è¿™ä¸ªè¿‡ç¨‹ã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/new.webp" class="" title="å›¾4â€”â€”åˆå§‹æ•°ç»„å·²æ»¡,GOåˆ›å»ºäº†å¦ä¸€ä¸ªæ•°ç»„å¹¶å¤åˆ¶äº†æ‰€æœ‰çš„å…ƒç´ "><p>åˆ‡ç‰‡ç°åœ¨æŒ‡å‘äº†æ–°çš„åå¤‡æ•°ç»„ã€‚é‚£ä¹‹å‰çš„åå¤‡æ•°ç»„ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?å¦‚æœå †ä¸­åˆ†é…äº†ç©ºé—´,ä¸”å®ƒä¸å†è¢«å¼•ç”¨,é‚£ä¹ˆæœ€ç»ˆä¼šè¢«åƒåœ¾æ”¶é›†å™¨(GC)é‡Šæ”¾ã€‚(æˆ‘ä»¬åœ¨ #95 é”™è¯¯ä¸­è®¨è®ºäº†å †å†…å­˜:â€<a href="https://livebook.manning.com/book/100-go-mistakes-and-how-to-avoid-them/chapter-12/240">ä¸ç†è§£æ ˆå’Œå †</a>â€œ,å¹¶ä¸”åœ¨ #99 é”™è¯¯ä¸­å­¦ä¹ äº† GC æ˜¯å¦‚ä½•å·¥ä½œçš„ã€‚)</p><p>æˆªå–åˆ‡ç‰‡ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?æˆªå–æ˜¯åœ¨æ•°ç»„æˆ–åˆ‡ç‰‡æ‰§è¡Œçš„æ“ä½œ,æä¾›äº†åŠå¼€åŒºé—´èŒƒå›´ã€‚ç´¢å¼• 1 æ˜¯è¢«åŒ…å«çš„,è€Œç´¢å¼• 2 æ˜¯ä¸è¢«åŒ…å«çš„ã€‚æ¥ä¸‹æ¥çš„ä¾‹å­å±•ç¤ºäº†è¿™ä¸ªå½±å“ï¼Œå›¾ 5 å±•ç¤ºäº†å†…å­˜ä¸­çš„ç»“æœï¼š</p><pre><code class="go">s1 := make([]int,3,6)s2 := s1[1:3] //æˆªå–è‡ªç´¢å¼•1~3</code></pre><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/slicing.webp" class="" title="å›¾5â€”â€”s1å’Œs2ä»¥ä¸åŒçš„lengthå’Œcapacityå¼•ç”¨äº†åŒä¸€ä¸ªåå¤‡æ•°ç»„"><p>é¦–å…ˆ <code>s1</code> ä½œä¸º length 3 å’Œ capacity 6 çš„åˆ‡ç‰‡è¢«åˆ›å»ºã€‚å½“é€šè¿‡æˆªå– <code>s1</code> åˆ›å»º <code>s2</code> æ—¶,ä¸¤ä¸ªåˆ‡ç‰‡å¼•ç”¨äº†åŒä¸€ä¸ªåå¤‡æ•°ç»„ã€‚ä½†æ˜¯ <code>s2</code> æ˜¯ä»ç´¢å¼• 1 å¼€å§‹çš„ã€‚å› æ­¤å®ƒçš„ length å’Œ capacity å’Œ s1 æ˜¯ä¸ä¸€æ ·çš„(length ç­‰äº 2,capacity ä¸º 5)ã€‚å¦‚æœæˆ‘ä»¬ä¿®æ”¹ <code>s1[0]</code> æˆ–è€… <code>s2[0]</code>,è¿™ä¸ªä¿®æ”¹æ˜¯ä½œç”¨åŸŸåŒä¸€ä¸ªæ•°ç»„çš„,å› æ­¤ä¼šå¦‚å›¾ 6 æ‰€ç¤ºåœ¨ä¸¤ä¸ªåˆ‡ç‰‡ä¸­éƒ½æ˜¯å¯è§çš„ã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/visible_change.webp" class="" title="å›¾6â€”â€”å› ä¸ºs1å’Œs2å…±ç”¨ä¸€ä¸ªåå¤‡æ•°ç»„ï¼Œæ‰€ä»¥ä¿®æ”¹ä¸€ä¸ªå…ƒç´ ä¼šä½¿å¾—ä¸¤ä¸ªåˆ‡ç‰‡éƒ½ä¼šäº§ç”Ÿå˜åŒ–"><p>ç°åœ¨å¦‚æœæˆ‘ä»¬è¿½åŠ ä¸€ä¸ªå…ƒç´ åˆ° <code>s2</code> ä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?æ¥ä¸‹æ¥çš„ä»£ç ä¹Ÿä¼šä¿®æ”¹ <code>s1</code> ä¹ˆ?</p><pre><code class="go">s2 = append(s2, 2)</code></pre><p>å…±äº«çš„åå¤‡æ•°ç»„ä¼šè¢«ä¿®æ”¹,ä½†æ˜¯åªæœ‰ <code>s2</code> çš„ length å˜äº†ã€‚å›¾ 7 å±•ç¤ºäº†è¿½åŠ å…ƒç´ åˆ° <code>s2</code> çš„ç»“æœã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/append.webp" class="" title="å›¾7â€”â€”è¿½åŠ ä¸€ä¸ªå…ƒç´ åˆ°s2"><p><code>s1</code> ä»ç„¶æ˜¯ä¸€ä¸ª length ä¸º 3,capacity ä¸º 6 çš„åˆ‡ç‰‡ã€‚å› æ­¤å¦‚æœæ‰“å° <code>s1</code> å’Œ <code>s2</code>,æ·»åŠ çš„å…ƒç´ åªåœ¨ <code>s2</code>ä¸­å¯è§ï¼š</p><blockquote><p>s1&#x3D;[0 1 0], s2&#x3D;[1 0 2]</p></blockquote><p>ç†è§£è¿™ä¸ªè¡Œä¸ºéå¸¸é‡è¦ï¼Œè¿™æ ·æˆ‘ä»¬åœ¨ä½¿ç”¨ append çš„æ—¶å€™ä¸ä¼šåšå‡ºé”™è¯¯çš„å‡è®¾ã€‚</p><p>ã€æ³¨æ„ã€‘ï¼šåœ¨è¿™äº›ä¾‹å­ä¸­,åå¤‡æ•°ç»„éƒ½æ˜¯å†…éƒ¨åˆ›å»º, GO å¼€å‘è€…ä¸èƒ½ç›´æ¥è·å–ã€‚å”¯ä¸€çš„ä¾‹å¤–æ˜¯ï¼šåˆ‡ç‰‡æ˜¯ä»å¯¹ç°æœ‰æ•°ç»„è¿›è¡Œåˆ‡ç‰‡åˆ›å»ºçš„ã€‚</p><p>æœ€åéœ€è¦æ³¨æ„çš„ä¸€ç‚¹æ˜¯:å‡ä½¿æˆ‘ä»¬ä¸€ç›´è¿½åŠ å…ƒç´ åˆ° s2 åˆ°åå¤‡æ•°ç»„å˜æ»¡ä¼šæ€ä¹ˆæ ·å‘¢?å°±æ™ºèƒ½å†…å­˜è€Œè¨€çŠ¶æ€ä¼šæ˜¯ä»€ä¹ˆæ ·? è®©æˆ‘ä»¬å†æ·»åŠ  3 ä¸ªå…ƒç´ ï¼Œè¿™æ ·åå¤‡æ•°ç»„å°±ä¸ä¼šæœ‰å‰©ä½™çš„å®¹é‡äº†ï¼š</p><pre><code class="go">s2 = append(s2, 3)s2 = append(s2, 4) // At this stage, the backing is already fulls2 = append(s2, 5)</code></pre><p>è¿™æ®µä»£ç ä¼šä½¿å¾— GO åˆ›å»ºå¦ä¸€ä¸ªåå¤‡æ•°ç»„ã€‚å›¾ 8 å±•ç¤ºäº†å†…å­˜ä¸­çš„ç»“æœã€‚</p><img src="/2022/11/25/fan-yi-slice-length-vs-capacity-in-go/figure8.webp" class="" title="å›¾8â€”â€”å‘s2è¿½åŠ å…ƒç´ ç›´è‡³åå¤‡å…ƒç´ æ²¡æœ‰å‰©ä½™ç©ºé—´"><p>æ­¤æ—¶ s1 å’Œ s2 æŒ‡å‘äº†ä¸¤ä¸ªä¸åŒçš„æ•°ç»„ã€‚å› ä¸º s1 ä¾æ—§ length ä¸º 3,capacity ä¸º 6,ä»ç„¶æœ‰å¯ç”¨çš„ç¼“å­˜ç©ºé—´ï¼Œæ‰€ä»¥å®ƒè¿˜æ˜¯å¼•ç”¨åŸæ¥çš„æ•°ç»„ã€‚åŒæ—¶ï¼Œæ–°çš„åå¤‡æ•°ç»„é€šè¿‡ä» s2 çš„ç¬¬ä¸€ä¸ªç´¢å¼•å¼€å§‹å¤åˆ¶åŸæ•°ç»„åˆ›å»ºã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆæ–°æ•°ç»„ä»å…ƒç´  1 è€Œä¸æ˜¯ä»å…ƒç´  0 å¼€å§‹ã€‚</p><h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ€»çš„æ¥è¯´, slice length æ˜¯åˆ‡ç‰‡ä¸­å¯ç”¨å…ƒç´ çš„ä¸ªæ•°,è€Œ slice capacity æ˜¯åå¤‡æ•°ç»„ä¸­å…ƒç´ ä¸ªæ•°ã€‚å‘ä¸€ä¸ªæ»¡åˆ‡ç‰‡(length &#x3D;&#x3D; capacity) æ·»åŠ å…ƒç´ ä¼šåˆ›å»ºä¸€ä¸ªæ–°åå¤‡æ•°ç»„,è¿™ä¸ªæ•°ç»„æ‹¥æœ‰æ–°çš„ capacity,ç„¶åä»ä¹‹å‰çš„æ•°ç»„ä¸­å¤åˆ¶æ‰€æœ‰å…ƒç´ ï¼Œä¿®æ”¹åˆ‡ç‰‡æŒ‡é’ˆæŒ‡å‘æ–°çš„æ•°ç»„ã€‚</p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>15-go-viper-cobra-pflag</title>
      <link href="/2022/11/22/15-go-viper-cobra-pflag/"/>
      <url>/2022/11/22/15-go-viper-cobra-pflag/</url>
      
        <content type="html"><![CDATA[<h2 id="å¦‚ä½•æ„å»ºåº”ç”¨æ¡†æ¶"><a href="#å¦‚ä½•æ„å»ºåº”ç”¨æ¡†æ¶" class="headerlink" title="å¦‚ä½•æ„å»ºåº”ç”¨æ¡†æ¶"></a>å¦‚ä½•æ„å»ºåº”ç”¨æ¡†æ¶</h2><h3 id="å‘½ä»¤è¡Œå‚æ•°è§£æ-pflag-åŒ…"><a href="#å‘½ä»¤è¡Œå‚æ•°è§£æ-pflag-åŒ…" class="headerlink" title="å‘½ä»¤è¡Œå‚æ•°è§£æ pflag åŒ…"></a>å‘½ä»¤è¡Œå‚æ•°è§£æ pflag åŒ…</h3><p>ç”¨æ¥è§£æå‘½ä»¤è¡Œå‚æ•°ã€å¯åŠ¨å‚æ•°ã€‘ï¼Œè¿™äº›å‘½ä»¤è¡Œå‚æ•°å¯ä»¥å½±å“å‘½ä»¤çš„è¿è¡Œæ•ˆæœã€‚</p><h4 id="flag-å®šä¹‰"><a href="#flag-å®šä¹‰" class="headerlink" title="flag å®šä¹‰"></a>flag å®šä¹‰</h4><p>ä¸€ä¸ªå‘½ä»¤è¡Œå‚æ•°åœ¨ Pflag åŒ…ä¸­ä¼šè§£æä¸ºä¸€ä¸ª Flag ç±»å‹çš„å˜é‡ï¼Œå³:</p><pre><code class="go">type Flag struct &#123;    Name                string // flagé•¿é€‰é¡¹çš„åç§°    Shorthand           string // flagçŸ­é€‰é¡¹çš„åç§°ï¼Œä¸€ä¸ªç¼©å†™çš„å­—ç¬¦    Usage               string // flagçš„ä½¿ç”¨æ–‡æœ¬    Value               Value  // flagçš„å€¼    DefValue            string // flagçš„é»˜è®¤å€¼    Changed             bool // è®°å½•flagçš„å€¼æ˜¯å¦æœ‰è¢«è®¾ç½®è¿‡    NoOptDefVal         string // å½“flagå‡ºç°åœ¨å‘½ä»¤è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼    Deprecated          string // è®°å½•è¯¥flagæ˜¯å¦è¢«æ”¾å¼ƒ    Hidden              bool // å¦‚æœå€¼ä¸ºtrueï¼Œåˆ™ä»help/usageè¾“å‡ºä¿¡æ¯ä¸­éšè—è¯¥flag    ShorthandDeprecated string // å¦‚æœflagçš„çŸ­é€‰é¡¹è¢«åºŸå¼ƒï¼Œå½“ä½¿ç”¨flagçš„çŸ­é€‰é¡¹æ—¶æ‰“å°è¯¥ä¿¡æ¯    Annotations         map[string][]string // ç»™flagè®¾ç½®æ³¨è§£&#125;</code></pre><p>Flag çš„å€¼æ˜¯ä¸€ä¸ª Value ç±»å‹çš„æ¥å£ï¼Œé€šè¿‡å°† Flag çš„å€¼æŠ½è±¡æˆä¸€ä¸ª interface æ¥å£ï¼Œå¯ä»¥è‡ªå®šä¹‰ Flag çš„ç±»å‹äº†,åªè¦å®ç°äº† Value æ¥å£çš„ç»“æ„ä½“ï¼Œå°±æ˜¯ä¸€ä¸ªæ–°ç±»å‹</p><pre><code class="go">type Value interface &#123;    String() string // å°†flagç±»å‹çš„å€¼è½¬æ¢ä¸ºstringç±»å‹çš„å€¼ï¼Œå¹¶è¿”å›stringçš„å†…å®¹    Set(string) error // å°†stringç±»å‹çš„å€¼è½¬æ¢ä¸ºflagç±»å‹çš„å€¼ï¼Œè½¬æ¢å¤±è´¥æŠ¥é”™    Type() string // è¿”å›flagçš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šstringã€intã€ipç­‰&#125;</code></pre><p>å®é™…ä½¿ç”¨ï¼š</p><pre><code class="go">package mainimport (    &quot;fmt&quot;)type Value interface &#123;    String() string // å°†flagç±»å‹çš„å€¼è½¬æ¢ä¸ºstringç±»å‹çš„å€¼ï¼Œå¹¶è¿”å›stringçš„å†…å®¹    Set(string) error // å°†stringç±»å‹çš„å€¼è½¬æ¢ä¸ºflagç±»å‹çš„å€¼ï¼Œè½¬æ¢å¤±è´¥æŠ¥é”™    Type() string // è¿”å›flagçš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šstringã€intã€ipç­‰&#125;type Flag struct &#123;    Name                string // flagé•¿é€‰é¡¹çš„åç§°    Shorthand           string // flagçŸ­é€‰é¡¹çš„åç§°ï¼Œä¸€ä¸ªç¼©å†™çš„å­—ç¬¦    Usage               string // flagçš„ä½¿ç”¨æ–‡æœ¬    Value               Value  // flagçš„å€¼    DefValue            string // flagçš„é»˜è®¤å€¼    Changed             bool // è®°å½•flagçš„å€¼æ˜¯å¦æœ‰è¢«è®¾ç½®è¿‡    NoOptDefVal         string // å½“flagå‡ºç°åœ¨å‘½ä»¤è¡Œï¼Œä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼    Deprecated          string // è®°å½•è¯¥flagæ˜¯å¦è¢«æ”¾å¼ƒ    Hidden              bool // å¦‚æœå€¼ä¸ºtrueï¼Œåˆ™ä»help/usageè¾“å‡ºä¿¡æ¯ä¸­éšè—è¯¥flag    ShorthandDeprecated string // å¦‚æœflagçš„çŸ­é€‰é¡¹è¢«åºŸå¼ƒï¼Œå½“ä½¿ç”¨flagçš„çŸ­é€‰é¡¹æ—¶æ‰“å°è¯¥ä¿¡æ¯    Annotations         map[string][]string // ç»™flagè®¾ç½®æ³¨è§£&#125;func (flag1 Flag) String() &#123;    fmt.Println(&quot;å°†flagç±»å‹çš„å€¼è½¬æ¢ä¸ºstringç±»å‹çš„å€¼ï¼Œå¹¶è¿”å›stringçš„å†…å®¹&quot;)&#125;type Flag2 struct &#123;  Value               Value  // flagçš„å€¼&#125;func (flag2 Flag2) String() &#123;    fmt.Println(&quot;è‡ªå®šä¹‰flagç±»å‹&quot;)&#125;func main() &#123;    var val Value    flag1 = new(Flag)    flag1.String()    flag2 = new(Flag2)    flag2.String()&#125;</code></pre><h4 id="FlagSet-å®šä¹‰"><a href="#FlagSet-å®šä¹‰" class="headerlink" title="FlagSet å®šä¹‰"></a>FlagSet å®šä¹‰</h4><p>é¢„å…ˆå®šä¹‰å¥½çš„ Flag çš„é›†åˆ<br>è·å–å¹¶ä½¿ç”¨ Flag çš„æ–¹æ³•ï¼š</p><ol><li>è°ƒç”¨ NewFlagSet åˆ›å»ºä¸€ä¸ª FlagSet,é€šè¿‡å®šä¹‰ä¸€ä¸ªæ–°çš„ FlagSet æ¥å®šä¹‰å‘½ä»¤åŠå…¶å­å‘½ä»¤çš„ Flagã€‚</li></ol><pre><code class="go">var version boolflagSet:=pflag.NewFlagSet(&quot;test&quot;,pflag.ContinueOnError)flagSet.BoolVar(&amp;version,&quot;version&quot;,true,&quot;Print version information and quit.&quot;)</code></pre><ol start="2"><li>ä½¿ç”¨ Pflag åŒ…å®šä¹‰çš„å…¨å±€ FlagSetï¼šCommandLineã€‚å®é™…ä¸Š CommandLine ä¹Ÿæ˜¯ç”± NewFlagSet å‡½æ•°åˆ›å»ºçš„<br>åœ¨ä¸€äº›ä¸éœ€è¦å®šä¹‰å­å‘½ä»¤çš„å‘½ä»¤è¡Œå·¥å…·ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨å…¨å±€çš„ FlagSet</li></ol><pre><code class="go">import (    &quot;github.com/spf13/pflag&quot;)pflag.BoolVarP(&amp;version, &quot;version&quot;, &quot;v&quot;, true, &quot;Print version information and quit.&quot;)func BoolVarP(p *bool, name, shorthand string, value bool, usage string) &#123;  flag := CommandLine.VarPF(newBoolValue(value, p), name, shorthand, usage)  flag.NoOptDefVal = &quot;true&quot;&#125;</code></pre><h4 id="å¸¸ç”¨æ–¹æ³•"><a href="#å¸¸ç”¨æ–¹æ³•" class="headerlink" title="å¸¸ç”¨æ–¹æ³•"></a>å¸¸ç”¨æ–¹æ³•</h4><hr><ol><li>æ”¯æŒå¤šç§å‘½ä»¤è¡Œå‚æ•°å®šä¹‰æ–¹å¼</li></ol><ul><li>æ”¯æŒé•¿é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­</li></ul><pre><code class="go">var name=pflag.String(&quot;name&quot;,&quot;colin&quot;,&quot;Input ur name&quot;)</code></pre><ul><li>æ”¯æŒé•¿é€‰é¡¹ã€çŸ­é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­</li></ul><pre><code class="go">var name=pflag.StringP(&quot;name&quot;,&quot;n&quot;,&quot;colin&quot;,&quot;input ur name&quot;)</code></pre><ul><li>æ”¯æŒé•¿é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡</li></ul><pre><code class="go">var name stringpflag.StringVar(&amp;name,&quot;name&quot;,&quot;colin&quot;,&quot;Input ur name&quot;)</code></pre><ul><li>æ”¯æŒé•¿é€‰é¡¹ã€çŸ­é€‰é¡¹ã€é»˜è®¤å€¼å’Œä½¿ç”¨æ–‡æœ¬ï¼Œå¹¶å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡</li></ul><pre><code class="go">var name stringpflag.StringVarP(&amp;name, &quot;name&quot;, &quot;n&quot;,&quot;colin&quot;, &quot;Input Your Name&quot;)</code></pre><blockquote><ol><li>å‡½æ•°åå¸¦æœ‰ Var è¯´æ˜æ˜¯å°†æ ‡å¿—çš„å€¼ç»‘å®šåˆ°å˜é‡ï¼Œå¦åˆ™å°±æ˜¯å°†æ ‡å¿—çš„å€¼å­˜å‚¨åœ¨æŒ‡é’ˆä¸­</li><li>å‡½æ•°åå¸¦ P è¯´æ˜æ”¯æŒçŸ­é€‰é¡¹ï¼Œå¦åˆ™ä¸æ”¯æŒçŸ­é€‰é¡¹ã€‚</li></ol></blockquote><hr><ol start="2"><li>ä½¿ç”¨ Get<Type> è·å–å‚æ•°çš„å€¼</li></ol><pre><code class="go">i, err := flagset.GetInt(&quot;flagname&quot;)</code></pre><hr><ol start="3"><li>è·å–éé€‰é¡¹å‚æ•°</li></ol><pre><code class="go">package mainimport (    &quot;fmt&quot;    &quot;github.com/spf13/pflag&quot;)// å®šä¹‰æ ‡å¿—var  flagvar = pflag.Int(&quot;flagname&quot;, 1234, &quot;help message for flagname&quot;)func main() &#123;    // è§£æå®šä¹‰çš„æ ‡å¿—    pflag.Parse()    // è¿”å›æ— é€‰é¡¹å‚æ•°    fmt.Printf(&quot;argument number is: %v\n&quot;, pflag.NArg())    // è¿”å›æ‰€æœ‰çš„éé€‰é¡¹å‚æ•°    fmt.Printf(&quot;argument list is: %v\n&quot;, pflag.Args())    //pflag.Arg(i) è¿”å›ç¬¬ i ä¸ªéé€‰é¡¹å‚æ•°    fmt.Printf(&quot;the first argument is: %v\n&quot;, pflag.Arg(0))&#125;// go run example1.go arg1 arg2// argument number is: 2// argument list is: [arg1 arg2]// the first argument is: arg1</code></pre><hr><ol start="4"><li>æŒ‡å®šäº†é€‰é¡¹ä½†æ˜¯æ²¡æœ‰æŒ‡å®šé€‰é¡¹å€¼æ—¶çš„é»˜è®¤å€¼</li></ol><pre><code class="go">// å®šä¹‰æ ‡å¿—var ip = pflag.IntP(&quot;flagname&quot;, &quot;f&quot;, 1234, &quot;help message&quot;)// ä¸ºipè¿™ä¸ªflagè®¾ç½®NoOptDefVal,pflag.Lookup(&quot;flagname&quot;).NoOptDefVal = &quot;4321&quot;</code></pre><table><thead><tr><th>å‘½ä»¤è¡Œå‚æ•°</th><th>è§£æç»“æœ</th></tr></thead><tbody><tr><td>â€“flagname&#x3D;1357</td><td>ip&#x3D;1357</td></tr><tr><td>â€“flagname</td><td>ip&#x3D;4321</td></tr><tr><td></td><td>ip&#x3D;1234</td></tr></tbody></table><hr><ol start="5"><li>å¼ƒç”¨æ ‡å¿—æˆ–è€…å¼ƒç”¨æ ‡å¿—çš„ç®€å†™</li></ol><p>åœ¨å¸®åŠ©æ–‡æœ¬ä¸­ä¼šè¢«éšè—ï¼Œå¹¶åœ¨ä½¿ç”¨ä¸æ¨èçš„æ ‡å¿—æˆ–ç®€å†™æ—¶æ‰“å°æ­£ç¡®çš„ç”¨æ³•æç¤º</p><pre><code class="go">pflag.CommandLine.MarkDeprecated(&quot;logmode&quot;,&quot;please use --log-mode instead&quot;)//éšè—å¸®åŠ©æ–‡æœ¬ä¸­çš„logmode.å½“ä½¿ç”¨logmodeçš„æ—¶å€™ï¼Œæ‰“å°å‡º Flag --logmode has been deprecated, please use --log-mode insteadã€‚</code></pre><hr><ol start="6"><li>åªå¼ƒç”¨ç®€å†™å½¢å¼</li></ol><pre><code class="go">pflag.IntVarP(&amp;port,&quot;port&quot;,&quot;p&quot;,3306,&quot;MySQL service host port.&quot;)// å¼ƒç”¨ç®€å†™å½¢å¼pflag.CommandLine.MarkShorthandDeprecated(&quot;port&quot;, &quot;please use --port only&quot;)// è¿™æ ·éšè—äº†å¸®åŠ©æ–‡æœ¬ä¸­çš„ç®€å†™ Pï¼Œå¹¶ä¸”å½“ä½¿ç”¨ç®€å†™ P æ—¶ï¼Œæ‰“å°äº†Flag shorthand -P has been deprecated, please use --port onlyã€‚usage message åœ¨æ­¤å¤„å¿…ä¸å¯å°‘ï¼Œå¹¶ä¸”ä¸åº”ä¸ºç©ºã€‚</code></pre><hr><ol start="7"><li>éšè—æ ‡å¿—</li></ol><p>å°† Flag æ ‡è®°ä¸ºéšè—ï¼Œä»ç„¶å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†ä¸ä¼šæ˜¾ç¤ºåœ¨ usage&#x2F;help ä¸­,åªåœ¨å†…éƒ¨ä½¿ç”¨</p><pre><code class="go">// hide a flag by specifying its namepflag.CommandLine.MarkHidden(&quot;secretFlag&quot;)</code></pre><hr><h3 id="é…ç½®æ–‡ä»¶è§£æ-viper"><a href="#é…ç½®æ–‡ä»¶è§£æ-viper" class="headerlink" title="é…ç½®æ–‡ä»¶è§£æ viper"></a>é…ç½®æ–‡ä»¶è§£æ viper</h3><p>å°å‹åº”ç”¨ï¼šé…ç½®é¡¹è¾ƒå°‘,å¯ä»¥é€šè¿‡å‘½ä»¤è¡Œå‚æ•°æ¥ä¼ é€’é…ç½®<br>å¤§å‹åº”ç”¨ï¼šé…ç½®é¡¹è¾ƒå¤š,é€šå¸¸å…·æœ‰å¾ˆå¤šå‚æ•°ï¼Œé€šè¿‡å‘½ä»¤è¡Œå‚æ•°ä¼ é€’ä¸å¥½ç»´æŠ¤ã€‚<br>è§£å†³æ–¹æ³•ï¼šå°†è¿™äº›é…ç½®ä¿¡æ¯ä¿å­˜åœ¨é…ç½®æ–‡ä»¶ä¸­ï¼Œç”±ç¨‹åºå¯åŠ¨æ—¶åŠ è½½å’Œè§£æ<br>Viper ç‰¹ç‚¹ï¼š<br>é«˜ä¼˜å…ˆçº§é…ç½®ä¼šè¦†ç›–ä½ä¼˜å…ˆçº§ç›¸åŒé…ç½®</p><h4 id="ä¼˜å…ˆçº§æ’åº"><a href="#ä¼˜å…ˆçº§æ’åº" class="headerlink" title="ä¼˜å…ˆçº§æ’åº"></a>ä¼˜å…ˆçº§æ’åº</h4><ol><li>é€šè¿‡ viper.Set å‡½æ•°æ˜¾ç¤ºè®¾ç½®çš„é…ç½®</li><li>å‘½ä»¤è¡Œå‚æ•°</li><li>ç¯å¢ƒå˜é‡</li><li>é…ç½®æ–‡ä»¶</li><li>Key&#x2F;Value å­˜å‚¨</li><li>é»˜è®¤å€¼</li></ol><h4 id="è¯»å…¥é…ç½®ï¼šå°†é…ç½®è¯»å…¥åˆ°-Viper-ä¸­"><a href="#è¯»å…¥é…ç½®ï¼šå°†é…ç½®è¯»å…¥åˆ°-Viper-ä¸­" class="headerlink" title="è¯»å…¥é…ç½®ï¼šå°†é…ç½®è¯»å…¥åˆ° Viper ä¸­"></a>è¯»å…¥é…ç½®ï¼šå°†é…ç½®è¯»å…¥åˆ° Viper ä¸­</h4><ol><li>è®¾ç½®é»˜è®¤çš„é…ç½®æ–‡ä»¶å</li></ol><pre><code class="go">viper.SetDefault(&quot;ContentDir&quot;, &quot;content&quot;)viper.SetDefault(&quot;LayoutDir&quot;, &quot;layouts&quot;)viper.SetDefault(&quot;Taxonomies&quot;, map[string]string&#123;&quot;tag&quot;: &quot;tags&quot;, &quot;category&quot;: &quot;categories&quot;&#125;)</code></pre><hr><ol start="2"><li>è¯»å–é…ç½®æ–‡ä»¶</li></ol><p>æ”¯æŒ JSONã€TOMLã€YAMLã€YMLã€Propertiesã€Propsã€Propã€HCLã€Dotenvã€Env æ ¼å¼çš„é…ç½®æ–‡ä»¶</p><pre><code class="go">package mainimport (  &quot;fmt&quot;  &quot;github.com/spf13/pflag&quot;  &quot;github.com/spf13/viper&quot;)var (  cfg  = pflag.StringP(&quot;config&quot;, &quot;c&quot;, &quot;&quot;, &quot;Configuration file.&quot;)  help = pflag.BoolP(&quot;help&quot;, &quot;h&quot;, false, &quot;Show this help message.&quot;))func main() &#123;  pflag.Parse()  if *help &#123;    pflag.Usage()    return  &#125;  // ä»é…ç½®æ–‡ä»¶ä¸­è¯»å–é…ç½®  if *cfg != &quot;&quot; &#123;    viper.SetConfigFile(*cfg)   // æŒ‡å®šé…ç½®æ–‡ä»¶å    // å¦‚æœé…ç½®æ–‡ä»¶åä¸­æ²¡æœ‰æ–‡ä»¶æ‰©å±•åï¼Œåˆ™éœ€è¦æŒ‡å®šé…ç½®æ–‡ä»¶çš„æ ¼å¼ï¼Œå‘Šè¯‰viperä»¥ä½•ç§æ ¼å¼è§£ææ–‡ä»¶    viper.SetConfigType(&quot;yaml&quot;)  &#125; else &#123;    // ä¼šæ ¹æ®æ·»åŠ çš„è·¯å¾„é¡ºåºæœç´¢é…ç½®æ–‡ä»¶ï¼Œå¦‚æœæ‰¾åˆ°åˆ™åœæ­¢æœç´¢    viper.AddConfigPath(&quot;.&quot;)          // æŠŠå½“å‰ç›®å½•åŠ å…¥åˆ°é…ç½®æ–‡ä»¶çš„æœç´¢è·¯å¾„ä¸­    viper.AddConfigPath(&quot;$HOME/.iam&quot;) // é…ç½®æ–‡ä»¶æœç´¢è·¯å¾„ï¼Œå¯ä»¥è®¾ç½®å¤šä¸ªé…ç½®æ–‡ä»¶æœç´¢è·¯å¾„    viper.SetConfigName(&quot;config&quot;)     // é…ç½®æ–‡ä»¶åç§°ï¼ˆæ²¡æœ‰æ–‡ä»¶æ‰©å±•åï¼‰  &#125;  if err := viper.ReadInConfig(); err != nil &#123;    // è¯»å–é…ç½®æ–‡ä»¶ã€‚å¦‚æœæŒ‡å®šäº†é…ç½®æ–‡ä»¶åï¼Œåˆ™ä½¿ç”¨æŒ‡å®šçš„é…ç½®æ–‡ä»¶ï¼Œå¦åˆ™åœ¨æ³¨å†Œçš„æœç´¢è·¯å¾„ä¸­æœç´¢    panic(fmt.Errorf(&quot;Fatal error config file: %s \n&quot;, err))  &#125;  fmt.Printf(&quot;Used configuration file is: %s\n&quot;, viper.ConfigFileUsed())&#125;</code></pre><hr><ol start="3"><li>ç›‘å¬å’Œé‡æ–°è¯»å–é…ç½®æ–‡ä»¶ã€ä¸æ¨èã€‘</li></ol><p>åœ¨è¿è¡Œçš„æ—¶å€™åº”ç”¨ç¨‹åºå®æ—¶è¯»å–é…ç½®æ–‡ä»¶[çƒ­åŠ è½½é…ç½®]ã€‚é€šè¿‡<code>WatchConfig</code>å‡½æ•°è¿›è¡Œæ“ä½œã€‚<br>åœ¨æ“ä½œä¹‹å‰éœ€è¦ç¡®ä¿å·²ç»æ·»åŠ äº†é…ç½®æ–‡ä»¶çš„æœç´¢è·¯å¾„<br>å¯ä»¥ä¸º Viper æä¾›ä¸€ä¸ªå›è°ƒå‡½æ•°ï¼Œä»¥ä¾¿åœ¨æ¯æ¬¡å‘ç”Ÿæ›´æ”¹æ—¶è¿è¡Œ<br>ä¸æ¨èä½¿ç”¨åŸå› ï¼šå› ä¸ºå³ä½¿é…ç½®çƒ­åŠ è½½äº†ï¼Œç¨‹åºä¸­çš„ä»£ç ä¹Ÿä¸ä¸€å®šä¼šçƒ­åŠ è½½ã€‚ä¾‹å¦‚ï¼šä¿®æ”¹äº†æœåŠ¡ç›‘å¬ç«¯å£ï¼Œä½†æ˜¯æœåŠ¡æ²¡æœ‰é‡å¯ï¼Œè¿™æ—¶å€™æœåŠ¡è¿˜æ˜¯ç›‘å¬åœ¨è€çš„ç«¯å£ä¸Šï¼Œä¼šé€ æˆä¸ä¸€è‡´ã€‚</p><pre><code class="go">viper.WatchConfig()viper.OnConfigChange(func(e fsnotify.Event) &#123;   // é…ç½®æ–‡ä»¶å‘ç”Ÿå˜æ›´ä¹‹åä¼šè°ƒç”¨çš„å›è°ƒå‡½æ•°  fmt.Println(&quot;Config file changed:&quot;, e.Name)&#125;)</code></pre><hr><ol start="4"><li>ä» io.Reader è¯»å–é…ç½®</li></ol><hr><ol start="5"><li>ä»ç¯å¢ƒå˜é‡è¯»å–ã€åŒºåˆ†å¤§å°å†™ã€‘<ul><li>AutomaticEnv()</li><li>BindEnv(input â€¦string)</li><li>errorSetEnvPrefix(in string)</li><li>SetEnvKeyReplacer(r *strings.Replacer)</li><li>AllowEmptyEnv(allowEmptyEnv bool)</li></ul></li></ol><hr><ol start="6"><li>ä»å‘½ä»¤è¡Œæ ‡å¿—è¯»å–</li></ol><pre><code class="go">// ç»‘å®šå•ä¸ªæ ‡å¿—viper.BindPFlag(&quot;token&quot;, pflag.Lookup(&quot;token&quot;))</code></pre><hr><ol start="7"><li>ä»è¿œç¨‹ Key&#x2F;Value å­˜å‚¨è¯»å–</li></ol><hr><h4 id="è¯»å–é…ç½®"><a href="#è¯»å–é…ç½®" class="headerlink" title="è¯»å–é…ç½®"></a>è¯»å–é…ç½®</h4><h3 id="åº”ç”¨çš„å‘½ä»¤è¡Œæ¡†æ¶-Cobra"><a href="#åº”ç”¨çš„å‘½ä»¤è¡Œæ¡†æ¶-Cobra" class="headerlink" title="åº”ç”¨çš„å‘½ä»¤è¡Œæ¡†æ¶ Cobra"></a>åº”ç”¨çš„å‘½ä»¤è¡Œæ¡†æ¶ Cobra</h3><ol><li>å‘½ä»¤éœ€è¦å…·å¤‡ Help åŠŸèƒ½ï¼Œè¿™æ ·æ‰èƒ½å‘Šè¯‰ä½¿ç”¨è€…å¦‚ä½•å»ä½¿ç”¨</li><li>å‘½ä»¤éœ€è¦èƒ½å¤Ÿè§£æå‘½ä»¤è¡Œå‚æ•°å’Œé…ç½®æ–‡ä»¶</li><li>å‘½ä»¤éœ€è¦èƒ½å¤Ÿåˆå§‹åŒ–ä¸šåŠ¡ä»£ç ï¼Œå¹¶æœ€ç»ˆå¯åŠ¨ä¸šåŠ¡è¿›ç¨‹</li></ol><h2 id="åº”ç”¨çš„ä¸‰å¤§åŸºæœ¬åŠŸèƒ½"><a href="#åº”ç”¨çš„ä¸‰å¤§åŸºæœ¬åŠŸèƒ½" class="headerlink" title="åº”ç”¨çš„ä¸‰å¤§åŸºæœ¬åŠŸèƒ½"></a>åº”ç”¨çš„ä¸‰å¤§åŸºæœ¬åŠŸèƒ½</h2><ul><li><p>API æœåŠ¡ï¼šé€šè¿‡å¯¹å¤–æä¾› HTTP&#x2F;RPC æ¥å£æ¥å®ŒæˆæŒ‡å®šçš„åŠŸèƒ½ã€‚æ¯”å¦‚è®¢å•æœåŠ¡ï¼Œé€šè¿‡è°ƒç”¨åˆ›å»ºè®¢å•çš„ API æ¥å£ï¼Œæ¥åˆ›å»ºå•†å“è®¢å•ã€‚</p></li><li><p>é API æœåŠ¡ï¼šé€šè¿‡ç›‘å¬ã€å®šæ—¶è¿è¡Œç­‰æ–¹å¼ï¼Œè€Œä¸æ˜¯é€šè¿‡ API è°ƒç”¨æ¥å®ŒæˆæŸäº›ä»»åŠ¡ã€‚æ¯”å¦‚æ•°æ®å¤„ç†æœåŠ¡ï¼Œå®šæ—¶ä» Redis ä¸­è·å–æ•°æ®ï¼Œå¤„ç†åå­˜å…¥åç«¯å­˜å‚¨ä¸­ã€‚å†æ¯”å¦‚æ¶ˆæ¯å¤„ç†æœåŠ¡ï¼Œç›‘å¬æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆå¦‚ NSQ&#x2F;Kafka&#x2F;RabbitMQï¼‰ï¼Œæ”¶åˆ°æ¶ˆæ¯åè¿›è¡Œå¤„ç†ã€‚</p></li></ul><h3 id="å¯åŠ¨æµç¨‹ä¸€è‡´"><a href="#å¯åŠ¨æµç¨‹ä¸€è‡´" class="headerlink" title="å¯åŠ¨æµç¨‹ä¸€è‡´"></a>å¯åŠ¨æµç¨‹ä¸€è‡´</h3><img src="/2022/11/22/15-go-viper-cobra-pflag/%E5%90%AF%E5%8A%A8%E6%B5%81%E7%A8%8B.webp" class="" title="å¯åŠ¨æµç¨‹"><ol><li>åº”ç”¨æ¡†æ¶æ„å»º<br>a. å‘½ä»¤è¡Œç¨‹åº<br>b. å‘½ä»¤è¡Œå‚æ•°è§£æ<br>c. é…ç½®æ–‡ä»¶è§£æ</li><li>åº”ç”¨åˆå§‹åŒ–</li><li>æœåŠ¡å¯åŠ¨<br>a. åˆ›å»º API æœåŠ¡æˆ–é API æœåŠ¡<br>b. å¯åŠ¨æœåŠ¡</li></ol><blockquote><p>åº”ç”¨æ¡†æ¶æ„å»ºå’Œä¸šåŠ¡å…³ç³»ä¸å¤§ï¼Œå¯ä»¥æŠ½è±¡æˆç»Ÿä¸€çš„æ¡†æ¶ã€‚<br>åº”ç”¨åˆå§‹åŒ–å’ŒæœåŠ¡å¯åŠ¨ï¼Œä¸ä¸šåŠ¡è”ç³»è¾ƒå¯†åˆ‡ï¼Œéš¾ä»¥æŠ½è±¡ç§°ä¸€ä¸ªç»Ÿä¸€çš„æ¡†æ¶</p></blockquote><h2 id="iam-apiServer"><a href="#iam-apiServer" class="headerlink" title="iam-apiServer"></a>iam-apiServer</h2>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Golang</title>
      <link href="/2022/11/21/fan-yi-why-i-love-golang/"/>
      <url>/2022/11/21/fan-yi-why-i-love-golang/</url>
      
        <content type="html"><![CDATA[<h1 id="ä¸ºä»€ä¹ˆæˆ‘å–œæ¬¢-Golang"><a href="#ä¸ºä»€ä¹ˆæˆ‘å–œæ¬¢-Golang" class="headerlink" title="ä¸ºä»€ä¹ˆæˆ‘å–œæ¬¢ Golang"></a>ä¸ºä»€ä¹ˆæˆ‘å–œæ¬¢ Golang</h1><p>æˆ‘å–œæ¬¢ Go è¯­è¨€ç¼–ç¨‹,ä¹Ÿå°±æ˜¯ä¸€äº›äººæåˆ°çš„ Golangã€‚å®ƒç®€å•ä¸”ä¼Ÿå¤§ã€‚</p><p>æˆ‘å†™çš„æœ‰ç‚¹è·‘é¢˜ã€‚æ²¡æƒ³åˆ° GoLang ä¼šè¿™ä¹ˆå¥½ã€‚</p><p>æˆ‘ç¬¬ä¸€æ¬¡é‡åˆ° Go å¤§æ¦‚æ˜¯åœ¨ 2016 å¹´ 1 æœˆä»½,å®ƒåœ¨ä»¥è‰²åˆ—æœ‰ä¸€ä¸ªæ¯”è¾ƒå°ä¼—å´å¾ˆæ´»è·ƒçš„ç¤¾åŒºã€‚</p><p>å½“æ—¶ä¹Ÿæ²¡å¤šæƒ³,åªæ˜¯æƒ³ç£¨ç»ƒç¼–ç¨‹æŠ€èƒ½,GoLang ä¹Ÿåªæ˜¯æˆ‘ç”¨æ¥å®Œæˆä»»åŠ¡çš„ä¸€ä¸ªå·¥å…·ã€‚</p><p>å³ä½¿æ˜¯ä¸€å¹´ä»¥å‰,ä½¿ç”¨ Go ä¹Ÿæ˜¯éå¸¸æ˜æ™ºçš„ã€‚ä¸€æ—¦æŒæ¡äº†è¿™é—¨è¯­è¨€çš„æ ¸å¿ƒè¦é¢†,æ•´ä¸ªè¿‡ç¨‹å°±å¾ˆç®€å•æ˜“æ‡‚ã€‚</p><p>æˆ‘ä¸ºå…¬å¸<a href="https://www.visualead.com/">Visualead</a>å†™äº†ä¸€æ®µå…³é”®ä»£ç ,å®ƒæ²¡æœ‰è®©æˆ‘ä»¬å¤±æœ›,ä¸€å¹´ä¹‹åä»ç„¶ä»¥é›¶ç»´æŠ¤çš„å½¢å¼è¿è¡Œåœ¨ç”Ÿäº§ç¯å¢ƒã€‚</p><p>æœ€è¿‘æˆ‘å‘ç°è‡ªå·±ä¸€æ¬¡åˆä¸€æ¬¡åœ°ä½¿ç”¨äº† Golang,æ„Ÿè§‰æœ‰å¿…è¦å†™ä¸€ç¯‡æ–‡ç« æ¥æè¿°æˆ‘ä¸ºä»€ä¹ˆå¯¹ GoLang æƒ…æœ‰ç‹¬é’Ÿäº†ã€‚</p><h2 id="GoPATH-ç¯å¢ƒ"><a href="#GoPATH-ç¯å¢ƒ" class="headerlink" title="GoPATH ç¯å¢ƒ"></a>GoPATH ç¯å¢ƒ</h2><p>å½“ä½ å¼€å§‹ä½¿ç”¨ Go å†™ä»£ç çš„æ—¶å€™,è¿™æ˜¯ä½ å¿…é¡»è¦å¤„ç†çš„äº‹æƒ…ä¹‹ä¸€ã€‚</p><p>å°†ä½ çš„ç”µè„‘ä¸Šçš„ä»»æ„ä¸€ä¸ªä½ç½®è®¾ç½®ä¸º GOPATH ç›®å½•,å¹¶ä¸”é‡Œé¢åŒ…å« bin,src å’Œ pkg ç›®å½•,é‚£å°±å¯ä»¥å¼€å§‹ç¼–ç äº†ã€‚</p><pre><code class="bash">// How the directory structure looks like:go- bin- pkg- src</code></pre><p>æˆ‘åœ¨ home ç›®å½•ä¸‹ä¸ºç”¨åˆ°çš„æ¯ç§ç¼–ç¨‹è¯­è¨€éƒ½åˆ›å»ºäº†ä¸€ä¸ªæ–°ç›®å½•ã€‚home ç›®å½•çš„æ–‡ä»¶å¤¹ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="bash">chefcppelixirelmgojavascriptmeteorocamlphppythonscala</code></pre><p>é™¤äº† Go ä»¥å¤–,æ²¡æœ‰ä¸€ç§è¯­è¨€æ˜¯å¼ºåˆ¶æ‰§è¡Œè¿™ç§ç»“æ„çš„ã€‚Go è¿«ä½¿ä½ ä¸ºæ‰€æœ‰çš„ GoLang é¡¹ç›®å®šä¹‰ä¸€ä¸ªæ ¹ç›®å½•ï¼Œè¿™æ ·åšæ˜¯éå¸¸æœ‰å¥½å¤„çš„,æ¥ä¸‹æ¥æˆ‘ä»¬é©¬ä¸Šå°±ä¼šè®²åˆ°ã€‚</p><h2 id="GoLang-åº”ç”¨"><a href="#GoLang-åº”ç”¨" class="headerlink" title="GoLang åº”ç”¨"></a>GoLang åº”ç”¨</h2><p>æƒ³è¦åˆ›å»ºä¸€ä¸ªæ–°çš„ GoLang åº”ç”¨?éå¸¸ç®€å•ã€‚</p><p>è¿›å…¥ <code>$GOPATH/src</code> ç›®å½•,åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶å¤¹,å¹¶ä¸”åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>file.go</code>ï¼Œè°ƒç”¨ <code>main</code> åŒ…,æ·»åŠ ä¸€ä¸ª <code>func main() &#123;&#125;</code> å‡½æ•°,è¿™å°±å¤§åŠŸå‘Šæˆäº†ã€‚ä»æ­¤ä»¥åä½ å¯ä»¥ä½¿ç”¨ go æ‰€æœ‰çš„å¥½ä¸œè¥¿äº†ã€‚</p><p>æ›´å¤š Go çš„å¥½ä¸œè¥¿å‡ºç°ï¼ä½†é¦–å…ˆè¦æçš„å¿…é¡»æ˜¯ GoLang modulesã€‚</p><h2 id="GoLang-modules"><a href="#GoLang-modules" class="headerlink" title="GoLang modules"></a>GoLang modules</h2><p>æˆ‘æœ€å–œæ¬¢çš„ç¼–ç¨‹èŒƒå¼åšå¾—å¾ˆå¥½ï¼Œæˆ‘æŠŠæ¨¡å—ç³»ç»Ÿè§†ä¸ºé¢å‘å¯¹è±¡ç±»ç³»ç»Ÿçš„ä¸€ç§æ›¿ä»£æ–¹æ¡ˆã€‚</p><p>GoLang è°ƒç”¨å®ƒçš„æ¨¡å—åŒ…ã€‚æ‰€ä»¥ä»ç°åœ¨èµ·æ¯æ¬¡æˆ‘ä»¬è¯´ä¸€ä¸ªæ¨¡å—å°±æ„å‘³ç€ä¸€ä¸ªåŒ…ï¼Œåä¹‹äº¦ç„¶ã€‚</p><pre><code class="bash">Module == Package == Module</code></pre><p>åœ¨ GoLang é‡Œé¢,ä½ åˆ›å»ºçš„æ¯ä¸€ä¸ªç›®å½•éƒ½ä¼šå˜æˆä¸€ä¸ªåŒ…ã€‚å¦‚æœåŒ…çš„åç§°æ˜¯ main,é‚£ä»–ä¼šå˜æˆä¸€ä¸ªåº”ç”¨ã€‚è¿™æœ‰åŠ©äºå°†ä»£ç è‡ªç„¶åˆ†éš”ä¸ºå¯ç®¡ç†çš„é€»è¾‘å—ã€‚</p><p>ä½ æ€»æ˜¯æƒ³è¦ä»å¯å¤ç”¨çš„ç»„ä»¶æˆ–è€… Golang çš„åŒ…ä¸­åˆ›å»ºä¸šåŠ¡é€»è¾‘ã€‚</p><p>åœ¨ç°åœ¨çš„åº”ç”¨ä¸­,æˆ‘å¿…é¡»åœ¨éƒ¨åˆ†æ–‡ä»¶ä¸­æ“ä½œä¸€äº›è¡Œ,å¹¶ä¸”ä¸€æ—¦å®Œæˆå°±ä¼šå°†ä»–ä»¬ä¸Šä¼ åˆ° AWS S3ã€‚</p><p>æˆ‘çš„åº”ç”¨ç»“æ„å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="bash">src- my_app- - main.go- - main_test.go- - uploader- - - uploader.go- - - uploader_test.go- - replace_file_lines- - - replace.go- - - replace_test.go- - - strings_util.go- - - strings_util_test.go</code></pre><p><code>_test.go</code> æ–‡ä»¶æ¯«æ— ç–‘é—®æ˜¯ Golang çš„å•å…ƒæµ‹è¯•æ–‡ä»¶,å…¶æ ¸å¿ƒéƒ¨åˆ†æœ‰ä¸€ä¸ªæ„å»ºå¥½çš„æµ‹è¯•æ¡†æ¶ã€‚</p><p>å¯¹äºæ¥è‡ªé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€çš„äººæ¥è¯´,æŠŠæ¯ä¸ªç›®å½•è®¤ä¸ºæ˜¯ä¸€ä¸ªå®Œæ•´çš„é™æ€ç±»æ˜¯å¾ˆæœ‰ç”¨çš„,å¹¶ä¸” <code>.go</code> æ–‡ä»¶ä¸­çš„æ¯ä¸ªå‡½æ•°æˆ–è€…å˜é‡ä¼šå˜æˆå®ƒçš„å±æ€§æˆ–è€…æ–¹æ³•ã€‚</p><p>è¿™é‡Œæœ‰ä¸ª <code>replace.go</code> çš„ä¾‹å­ï¼š</p><pre><code class="go">package replace_file_linesimport (  // ...)// Variables that begin with an uppercase is exposedvar PublicVariable int = 42// While those that begin with loweracse are private to the modulevar privateVariable int = 0// Function that begins with an uppercase is exposedfunc Replace(oldFilePath, outputFilePath, with, what string) &#123; // ...&#125;// Function that begins with an uppercase is exposedfunc PublicFunction(/* .. */) &#123;  // ...)// While lowercase names makes functions private to the modulefunc privateFunction(/* .. */) &#123;  // ...)</code></pre><p>å¦‚æœä¸€ä¸ªç›®å½•æœ‰ä¸æ­¢ä¸€ä¸ªçš„ <code>.go</code> æ–‡ä»¶,æ‰€æœ‰çš„æ–¹æ³•å’Œå˜é‡ç”šè‡³æ˜¯ç§æœ‰çš„,åœ¨æ•´ä¸ªåŒ…é‡Œé¢éƒ½æ˜¯å¯å…±äº«çš„ã€‚è¿™æœ‰åŠ©äºå°†ä¸€ä¸ªåŒ…åˆ†å‰²æˆæ›´å°çš„å—,ä¹Ÿå¯ä»¥é¿å…å¤§çš„å•ä¸ªæ–‡ä»¶å‡ºç°ã€‚</p><p>åœ¨ä¸è®¨è®ºé¢å‘å¯¹è±¡ vs åŠŸèƒ½&#x2F;ç¨‹åºçš„æƒ…å†µä¸‹,çŸ¥é“ Go åˆ›å§‹äººå†³å®šä¸å†å°†ç»å…¸çš„ç±»æ”¾åœ¨è¯­è¨€é‡Œæ˜¯å¾ˆé‡è¦çš„ã€‚å–è€Œä»£ä¹‹çš„æ˜¯ä½¿ç”¨ struct&#x2F;interface ï¼Œå½“ç„¶è¿˜æœ‰åŒ…ã€‚</p><h2 id="Golang-gofmt"><a href="#Golang-gofmt" class="headerlink" title="Golang gofmt"></a>Golang gofmt</h2><p>GoLang æœ‰ä¸€ä¸ªå…¬çº¦:ä¸€åˆ‡è¯¥å¦‚ä½•çœ‹å¾…ï¼Œæ¯ä¸ªæ¡ˆä¾‹å’Œæ¯è¡Œéœ€è¦çš„ç²¾ç¡®ç©ºé—´ã€‚</p><p>è¿™å…è®¸å¼€å‘è€…å¯ä»¥ä¸“æ³¨äºå†™ä»£ç è€Œä¸æ˜¯å¼€å§‹å…³äºèŠ±æ‹¬å·ä½ç½®çš„æˆ˜äº‰ã€‚</p><p>æ—§çš„ {} vs {\n} æˆ˜äº‰ï¼š</p><img src="/2022/11/21/fan-yi-why-i-love-golang/cruly-brarce.png" class="" title="Or perhaps I am only happy because my side won in Go?"><p>ç‚¹å‡»æ­¤å¤„é˜…è¯»å…³äºè¯¥é—®é¢˜çš„æ›´å¤šä¿¡æ¯:<a href="https://golang.org/cmd/gofmt/">https://golang.org/cmd/gofmt/</a></p><h2 id="GoLang-Import"><a href="#GoLang-Import" class="headerlink" title="GoLang Import"></a>GoLang Import</h2><p>import æ€»æ˜¯ç›¸å¯¹äº <code>GOPATH/src</code> æ¥è¯´çš„ã€‚ä¸€ç›´å¦‚æ­¤ã€‚æˆ‘ä¸ä¼šå¤¸å¤§è¿™ä¸ªå†³å®šåœ¨è¿™ä¸ªç¨‹åº¦ä¸Šåœ¨æ²®ä¸§ä¸­æ‹¯æ•‘äº†æˆ‘ã€‚</p><p>è­¦å‘Šï¼šä¸‹ä¸€è¡Œä¼šä»¤äººè¿·æƒ‘ã€‚ã€todo:æ­¤å¤„ç¿»è¯‘ä¸ç¡®å®šã€‘</p><p>å½“ä½¿ç”¨å…¶ä»–è¯­è¨€çš„æ—¶å€™,ä½ æ—¢å¯ä»¥ä½¿ç”¨ç›¸å¯¹&#x2F;ç»å¯¹è·¯å¾„,ä¹Ÿå¯ä»¥ä»¥æŸç§æ–¹å¼è®¾ç½®å¤æ€ªçš„ import,è¿™ä½¿å¾—ä½ å¯ä»¥ä»é¬¼çŸ¥é“çš„ä»»æ„åœ°æ–¹å¯¼å…¥ä¸€ä¸ªæ–‡ä»¶(Python æˆ‘å·²ç»æ³¨æ„åˆ°ä½ äº†)ã€‚</p><p>Go ç”¨ä¸€ç§ç‹¬ç‰¹çš„æ–¹å¼è§£å†³äº†è¿™ä¸ªé—®é¢˜ã€‚æ‰€æœ‰çš„ importï¼Œæ— è®ºæ˜¯å“ªä¸€ä¸ªæ–‡ä»¶ï¼Œéƒ½æ˜¯ç›¸å¯¹äº <code>GOPATH/src</code> è€Œè¨€ã€‚</p><p>æ‰€ä»¥åœ¨ my_app ä¸­,ä¸»è¦çš„ import å¦‚ä¸‹æ‰€ç¤ºï¼š</p><pre><code class="go">package mainimport (    &quot;my_app/replace_file_lines&quot;    &quot;my_app/uploader&quot;    // ...)</code></pre><p>my_app åœ¨ src ç›®å½•ä¸‹,æ‰€ä»¥æˆ‘ä»¬é¦–å…ˆéœ€è¦æåˆ°å®ƒ,ç„¶åå¯¼å…¥å­˜åœ¨äº my_app ä¸‹çš„åŒ…,æ¯”å¦‚ <code>uploader</code> å’Œ <code>replace_file_lines</code>ã€‚æ³¨æ„,æˆ‘ä»¬ä¸å†æ˜¯å¼•å…¥å•ä¸ªæ–‡ä»¶,è€Œæ˜¯å¼•å…¥äº†æ•´ä¸ªåŒ…ã€‚åƒæŒ‚ä»¶ä¸€æ ·å·¥ä½œå¹¶ä¸”å¼•èµ· é›¶å€¼å¯ç”¨ã€‚ã€todo:æ­¤å¤„ç¿»è¯‘ä¸ç¡®å®šã€‘</p><p>æ­¤å¤–,é™¤éä½ å®é™…ä½¿ç”¨äº†å¯¼å…¥çš„åŒ…,å¦åˆ™ GoLang ä¸ä¼šç¼–è¯‘,è¿™ä¸ªå°ç‰¹æ€§æœ‰åŠ©äºä½ äº†è§£å®é™…ä½¿ç”¨çš„æ¯ä¸€ä¸ª importã€‚</p><p>æœŸæœ›ä½ çš„ç¨‹åºå‘˜èƒ½å¤Ÿå†™ä¸€ä¸ªæ²¡æœ‰æœªä½¿ç”¨çš„ import çš„å¹²å‡€ä»£ç ?é‚£ä¸ºä»€ä¹ˆä¸è®©ä½ æœ¬åœ°çš„ Go å…³æ³¨è¿™ä¸ªå‘¢?</p><h2 id="Golang-Get-System"><a href="#Golang-Get-System" class="headerlink" title="Golang Get System"></a>Golang Get System</h2><p>import ç« èŠ‚è®©æˆ‘ä»¬äº†è§£äº† GoLang ä¸‹ä¸€ä¸ªä¼Ÿå¤§çš„ç‰¹æ€§, <code>go get</code> ç‰¹æ€§ã€‚å½“å…¶ä»–äººå¯¹<a href="https://www.npmjs.com/">JavaScripts NPM</a> åŒ…ç®¡ç†å°è±¡æ·±åˆ»,Go é‡‡ç”¨äº†ä»»æ„çš„ git ä»“åº“ä½œä¸ºå®ƒçš„åŒ…ç®¡ç†ã€‚</p><p>å®ƒæ˜¯æ€ä¹ˆå·¥ä½œçš„å‘¢?</p><p>æˆ‘ä¹‹å‰å†™è¿‡æˆ‘éœ€è¦ä¸Šä¼ åˆ° S3 å¯¹ä¹ˆ?ç„¶åè¿™æ„å‘³ç€æˆ‘éœ€è¦ AWS SDK æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ã€‚</p><p>ä¸ºäº†è®©å®ƒå¯ä»¥å·¥ä½œ,æˆ‘åªéœ€è¦æ‰“å¼€ç»ˆç«¯å¹¶ä¸”å†™ä¸‹:</p><pre><code>go get github.com/aws/aws-sdk-go</code></pre><p>ç„¶åä¼šå‘ç”Ÿä»€ä¹ˆå‘¢?æ²¡æœ‰ä»€ä¹ˆç‰¹æ®Šçš„,GoLang åªæ˜¯ä»<a href="https://github.com/aws/aws-sdk-go">https://github.com/aws/aws-sdk-go</a> ä¸‹è½½äº†ä»“åº“åˆ°ä½ çš„ <code>GOPATH/src</code> ç›®å½•ä¸‹ã€‚</p><p>ç„¶åä½ ä¸ºäº†ä½¿ç”¨ aws-sdk éœ€è¦åšçš„åªæ˜¯å¯¼å…¥å®ƒï¼š</p><pre><code class="go">package uploaderimport (    &quot;github.com/aws/aws-sdk-go/service/s3&quot;    &quot;github.com/aws/aws-sdk-go/aws/session&quot;    &quot;github.com/aws/aws-sdk-go/aws&quot;    // ...)</code></pre><p>è¿˜è®°å¾—æ‰€æœ‰çš„ import éƒ½æ˜¯ç›¸å¯¹äº <code>GOPATH/src</code> ä¹ˆ? ç°åœ¨ä½ å¯ä»¥çŸ¥é“ <code>s3</code> åŒ…ä½äº<code>GOPATH/src/github.com/aws/aws-sdk-go/services/s3</code> ä¸‹é¢ã€‚</p><p>ç®€å•,ä¼˜é›…ã€‚å¯¹äº Go è€Œè¨€æ˜¯å¦å¤–ä¸€ä¸ªé—ªå…‰ç‚¹ã€‚</p><h2 id="Golang-Build-å’Œ-Package-Systems"><a href="#Golang-Build-å’Œ-Package-Systems" class="headerlink" title="Golang Build å’Œ Package Systems"></a>Golang Build å’Œ Package Systems</h2><p>æˆ‘ä»¬ä¸€ç›´å…³æ³¨ <code>GOPATH/src</code> ,ä½†æ˜¯ä»ç„¶æœ‰å…¶ä»–ç›®å½•æˆ‘ä»¬éœ€è¦å¤„ç†,<code>GOPATH/pkg</code> å’Œ <code>GOPATH/bin</code>ã€‚</p><p>GoLang æ˜¯ä¸€ç§ç¼–è¯‘å‹è¯­è¨€,è¿™æ„å‘³ç€ä»£ç å¿…é¡»å…ˆå®Œæˆç¼–è¯‘æ‰èƒ½è¿è¡Œã€‚GoLang ç¼–è¯‘é€Ÿåº¦å¾ˆå¿«ã€‚å®ƒæ˜¯æ€ä¹ˆåšçš„å‘¢?</p><p>æ¯æ¬¡ä½ ç¼–è¯‘ä»£ç è¿è¡Œçš„æ—¶å€™,GoLang ä¼šåœ¨åŒæ ·çš„è·¯å¾„åˆ›å»ºä¸€ä¸ª <code>.a</code> æ–‡ä»¶ä½œä¸ºåŒ…ï¼Œå®ƒåªå‡ºç°åœ¨ <code>GOPATH/pkg</code> ç›®å½•é‡Œã€‚è¿™<br>æ„å‘³ç€æ¯”å¦‚ä½ ç¼–è¯‘äº† aws-sdk,ä¸€æ¬¡ç¼–è¯‘ä¹‹å,å°±å¯ä»¥åœ¨ä½ å…¶ä»–ä»£ç ä¹‹é—´å…±äº«ã€‚</p><p>è¿™å½“ç„¶ä¸æ˜¯ GoLang ç¼–è¯‘å¿«é€Ÿçš„å”¯ä¸€åŸå› ,ä½†æ˜¯å®ƒåªæ˜¯ä¸€ä¸ªå¼•å­æ¥å¸®åŠ©ä½ ç†è§£ <code>GOPATH/pkg</code> çš„è§’è‰²ã€‚</p><p>ç°åœ¨,å…³äº <code>GOPATH/bin</code> æœ‰å“ªäº›ç”¨é€”å‘¢? å½“ä½ è¿è¡Œ <code>go install</code> å‘½ä»¤çš„æ—¶å€™,go ä¼šåˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶,æ”¾åœ¨ <code>GOPATH/bin</code> ä¸‹é¢,æ–‡ä»¶è·å–åˆ°ä½ çš„ main åŒ…ç›®å½•çš„åå­—,å³æˆ‘ä»¬æ¡ˆä¾‹é‡Œé¢çš„ <code>my_app</code>ã€‚</p><p>ä¸ºä»€ä¹ˆè¯´å®ƒéå¸¸æ£’å‘¢? å› ä¸ºä½ å¯ä»¥æ·»åŠ  <code>GOPATH/bin</code> åˆ°ç¯å¢ƒå˜é‡ä¸­,è¿™æ ·æ„å»ºçš„æ‰€æœ‰äºŒè¿›åˆ¶æ–‡ä»¶éƒ½å¯ä»¥åœ¨å‘½ä»¤è¡Œä¸­è·å–åˆ°,è€Œä¸”ä¸éœ€è¦åšä»»ä½•é¢å¤–çš„å·¥ä½œ!(æ˜¯ä¸æ˜¯å¾ˆæ£’å‘¢?)</p><h2 id="GoLang-è·¨å¹³å°æ„å»º"><a href="#GoLang-è·¨å¹³å°æ„å»º" class="headerlink" title="GoLang è·¨å¹³å°æ„å»º"></a>GoLang è·¨å¹³å°æ„å»º</h2><p>æƒ³è¦éƒ¨ç½²åˆ°ç¼–ç å¹³å°ä»¥å¤–çš„å…¶ä»–å¹³å°?åˆ«æ‹…å¿ƒ,ä½ ä¸éœ€è¦ä½¿ç”¨ windows æœºå™¨æ¥æ„å»ºä½ çš„ windows ç‰ˆæœ¬çš„ä»£ç ã€‚<a href="https://github.com/golang/go/wiki/WindowsCrossCompiling">GoLang å·²ç»ä¸ºä½ åšå¥½äº†</a>ã€‚</p><p>ä¸»è¦è¿è¡Œ:</p><pre><code class="bash">GOOS=windows GOARCH=amd64 go install</code></pre><p>æˆ‘ä»¬çš„ä»£ç å°†ä¼šè¾“å‡ºå¯ä»¥åœ¨ windows æœºå™¨ä¸Šéƒ¨ç½²çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚ <code>.exe</code> æ–‡ä»¶ä¼šå‡ºç°åœ¨ <code>GOPATH/bin/windows_amd64/my_app.exe</code>ã€‚éš¾åº¦å°±åƒåœ¨å…¬å›­é‡Œæ•£æ­¥ä¸€æ ·ã€‚</p><h2 id="Golang-ç¼–ç¨‹è¯­è¨€"><a href="#Golang-ç¼–ç¨‹è¯­è¨€" class="headerlink" title="Golang ç¼–ç¨‹è¯­è¨€"></a>Golang ç¼–ç¨‹è¯­è¨€</h2><p>GoLang æ—¨åœ¨æˆä¸ºä¸€é—¨ç®€å•çš„ç¼–ç¨‹è¯­è¨€ã€‚</p><p>æˆ‘å¾ˆå–œæ¬¢ä¸‹é¢è¿™ä¸ªå¸–å­,å®ƒé—®é“:ä¸ºä»€ä¹ˆ Go æ²¡æœ‰è¢«è®¾è®¡æˆå‡½æ•°å¼è¯­è¨€ï¼š <a href="https://www.quora.com/Why-wasnt-Go-written-as-a-functional-language">https://www.quora.com/Why-wasnt-Go-written-as-a-functional-language</a></p><blockquote><p>åœ¨ google å·¥ä½œçš„ç¨‹åºå‘˜èŒä¸šç”Ÿæ¶¯å¼€å§‹å¾—å¾ˆæ—©ï¼Œå¹¶ä¸”æœ€ç†Ÿæ‚‰è¿‡ç¨‹å¼ç¼–ç¨‹è¯­è¨€ï¼Œå°¤å…¶æ˜¯æ¥è‡ªäº c è¯­è¨€å®¶æ—çš„ã€‚éœ€è¦ç¨‹åºå‘˜å¿«é€Ÿæé«˜ç”Ÿäº§åŠ›,è¿™æ„å‘³ç€è¯­è¨€ä¸èƒ½è¿‡äºæ¿€è¿›ã€‚</p></blockquote><p>å®ƒç¡®å®å¾ˆç®€å•ã€‚</p><p>è¿™æ˜¯ GoLang ä¸æ”¯æŒçš„éƒ¨åˆ†ç‰¹æ€§æ¸…å•:</p><ol><li>ç±»</li><li>æ“ä½œç¬¦é‡è½½</li><li>å‡½æ•°é‡è½½</li><li>å¯é€‰å‚æ•°</li><li>å¼‚å¸¸</li></ol><p>å°½ç®¡æœ‰æ—¶å€™æˆ‘å‘ç°å†™ Go çš„æ—¶å€™ä¼šä¸¢æ‰ä¸€äº›è¯­è¨€ç‰¹æ€§,ä½†æ˜¯æœ€ç»ˆæ€»æ˜¯èƒ½å¤Ÿå®Œæˆæƒ³åšçš„äº‹ã€‚åªæ˜¯æœ‰æ—¶å€™,éœ€è¦æ›´å¤šçš„å†™å’Œå¶å°”çš„æ€è€ƒã€‚åº•çº¿å°±æ˜¯å®ƒä½¿å¾—ä»£ç æ›´å®¹æ˜“æ¨ç†,ä¸ä¼šé‚£ä¹ˆæŠ½è±¡ã€‚</p><p>æœ‰æ—¶å€™æˆ‘å¾ˆæƒŠè®¶,åœ¨æ²¡æœ‰å¤šå¹´ç»éªŒçš„æƒ…å†µä¸‹,ç”¨ Go å†™ä»£ç ,æˆ‘ç«Ÿç„¶å¯ä»¥å¦‚æ­¤ä¹‹å¿«åœ°è¾¾åˆ°ç›®æ ‡,ä»…ä»…å› ä¸ºè¿™é—¨è¯­è¨€å¦‚æ­¤åŒ…å®¹å’Œæ¸…æ™°ã€‚</p><h2 id="Golang-å¹¶å‘"><a href="#Golang-å¹¶å‘" class="headerlink" title="Golang å¹¶å‘"></a>Golang å¹¶å‘</h2><p>æˆ‘æœ‰æ„æŠŠå…³äºå¹¶å‘çš„è®¨è®ºç•™åœ¨æœ€åã€‚ä¸ºä»€ä¹ˆ?å› ä¸ºæˆ‘ä¸è®¤ä¸ºå®ƒä¸æ˜¯é‚£ä¹ˆé‡è¦ã€‚</p><p>å®ƒæ˜¯ Go è¯­è¨€ä¸­ä»¤äººéœ‡æƒŠçš„ç‰¹æ€§ã€‚ä½†æ˜¯æœ‰æ—¶å€™è¢«è®¤ä¸ºæ˜¯ Go è¯­è¨€çš„æœ¬è´¨,æˆ‘ä¸è®¤åŒè¿™ç§è¯´æ³•ã€‚</p><p>å› æ­¤æˆ‘å‡†å¤‡å°è¯•ç”¨ä¸€æ®µè¯æ€»ç»“ä¸€ä¸‹ã€‚</p><p>æ˜¯çš„,GoLang æœ‰å¾ˆæ£’çš„å¹¶å‘æ€§ã€‚ä½ ä¸éœ€è¦å¤„ç†çº¿ç¨‹,åªéœ€è¦åˆ›å»ºç®€å•çš„ goroutine,å®ƒçš„åˆ¶ä½œå’Œç®¡ç†éƒ½å¾ˆç®€å•ã€‚ Goroutines ä½¿ä½ å¯ä»¥åœ¨æ‰€æœ‰çš„ CPU ä¸Šåˆ†é…è´Ÿè½½ï¼Œè€Œä¸éœ€è¦æ‹…å¿ƒå¦‚ä½•ç®¡ç†ã€‚</p><p>æœ‰å…´è¶£è¿›ä¸€æ­¥äº†è§£ goroutines?å¯ä»¥é˜…è¯»ï¼š<a href="https://tour.golang.org/concurrency/1">https://tour.golang.org/concurrency/1</a></p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>14-goé™æ€ä»£ç æ£€æŸ¥</title>
      <link href="/2022/11/20/14-go-jing-tai-dai-ma-jian-cha/"/>
      <url>/2022/11/20/14-go-jing-tai-dai-ma-jian-cha/</url>
      
        <content type="html"><![CDATA[<h2 id="é™æ€ä»£ç æ ¡éªŒ"><a href="#é™æ€ä»£ç æ ¡éªŒ" class="headerlink" title="é™æ€ä»£ç æ ¡éªŒ"></a>é™æ€ä»£ç æ ¡éªŒ</h2><p>å·¥å…·ï¼šgolangci-lint</p><ol><li>å®‰è£…ï¼š</li></ol><pre><code class="bash">go get github.com/golangci/golangci-lint/cmd/golangci-lint@latestgolangci-lint version # è¾“å‡º golangci-lint ç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…æˆåŠŸgolangci-lint has version v1.39.0 built from (unknown, mod sum: &quot;h1:aAUjdBxARwkGLd5PU0vKuym281f2rFOyqh3GB4nXcq8=&quot;) on (unknown)</code></pre><ol start="2"><li>ä½¿ç”¨ï¼š</li></ol><pre><code class="bash">golangci-lint run</code></pre><h2 id="ç”Ÿæˆ-swagger-api-æ–‡æ¡£"><a href="#ç”Ÿæˆ-swagger-api-æ–‡æ¡£" class="headerlink" title="ç”Ÿæˆ swagger api æ–‡æ¡£"></a>ç”Ÿæˆ swagger api æ–‡æ¡£</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><p>æ–¹æ³• 1ï¼š</p><pre><code class="bash">go get -u github.com/go-swagger/go-swagger/cmd/swaggerswagger version</code></pre><p>æ–¹æ³• 2ï¼š</p><pre><code class="bash">yum install binutils binutils-devel -yrm -rf ~/.cache/go-build# å®‰è£…devç‰ˆæœ¬go install ./cmd/swagger# å®‰è£…æŒ‡å®šç‰ˆæœ¬git checkout v0.25.0go install -ldflags &quot;-X github.com/go-swagger/go-swagger/cmd/swagger/commands.Version=$(git describe --tags) -X github.com/go-swagger/go-swagger/cmd/swagger/commands.Commit=$(git rev-parse HEAD)&quot; ./cmd/swagger# éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸswagger version</code></pre><h3 id="ä½¿ç”¨"><a href="#ä½¿ç”¨" class="headerlink" title="ä½¿ç”¨"></a>ä½¿ç”¨</h3><p>é€šè¿‡è§£ææºç ä¸­çš„æ³¨é‡Šæ¥ç”Ÿæˆ Swagger æ–‡æ¡£</p><pre><code class="bash"> swagger generate spec -o docs/swagger.yaml swagger serve --no-open -F=swagger --port 36666  ./docs/swagger.yaml # åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€localhost:36666/docs</code></pre><h3 id="æŠ¥é”™"><a href="#æŠ¥é”™" class="headerlink" title="æŠ¥é”™"></a>æŠ¥é”™</h3><p><a href="https://github.com/go-swagger/go-swagger/issues/2756">#2756</a></p><h3 id="å¸¸ç”¨å‘½ä»¤ï¼š"><a href="#å¸¸ç”¨å‘½ä»¤ï¼š" class="headerlink" title="å¸¸ç”¨å‘½ä»¤ï¼š"></a>å¸¸ç”¨å‘½ä»¤ï¼š</h3><ol><li>swagger:routeï¼šswagger:route ä»£è¡¨ API æ¥å£æè¿°çš„å¼€å§‹ï¼Œåé¢çš„å­—ç¬¦ä¸²æ ¼å¼ä¸º HTTP æ–¹æ³• URL Tag IDã€‚å¯ä»¥å¡«å†™å¤šä¸ª tagï¼Œç›¸åŒ tag çš„ API æ¥å£åœ¨ Swagger æ–‡æ¡£ä¸­ä¼šè¢«åˆ†ä¸ºä¸€ç»„ã€‚ID æ˜¯ä¸€ä¸ªæ ‡è¯†ç¬¦ï¼Œswagger:parameters æ˜¯å…·æœ‰ç›¸åŒ ID çš„ swagger:route çš„è¯·æ±‚å‚æ•°ã€‚swagger:route ä¸‹é¢çš„ä¸€è¡Œæ˜¯è¯¥ API æ¥å£çš„æè¿°ï¼Œéœ€è¦ä»¥è‹±æ–‡ç‚¹å·ä¸ºç»“å°¾ã€‚responses:å®šä¹‰äº† API æ¥å£çš„è¿”å›å‚æ•°ï¼Œä¾‹å¦‚å½“ HTTP çŠ¶æ€ç æ˜¯ 200 æ—¶ï¼Œè¿”å› createUserResponseï¼ŒcreateUserResponse ä¼šè·Ÿ swagger:response è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸçš„ swagger:response å°±æ˜¯è¯¥ API æ¥å£è¿”å› 200 çŠ¶æ€ç æ—¶çš„è¿”å›ã€‚</li><li>swagger:responseï¼šswagger:response å®šä¹‰äº† API æ¥å£çš„è¿”å›ï¼Œä¾‹å¦‚ getUserResponseWrapperï¼Œå…³äºåå­—ï¼Œæˆ‘ä»¬å¯ä»¥æ ¹æ®éœ€è¦è‡ªç”±å‘½åï¼Œå¹¶ä¸ä¼šå¸¦æ¥ä»»ä½•ä¸åŒã€‚getUserResponseWrapper ä¸­æœ‰ä¸€ä¸ª Body å­—æ®µï¼Œå…¶æ³¨é‡Šä¸º&#x2F;&#x2F; in:bodyï¼Œè¯´æ˜è¯¥å‚æ•°æ˜¯åœ¨ HTTP Body ä¸­è¿”å›ã€‚swagger:response ä¹‹ä¸Šçš„æ³¨é‡Šä¼šè¢«è§£æä¸ºè¿”å›å‚æ•°çš„æè¿°ã€‚api.User è‡ªåŠ¨è¢« go-swagger è§£æä¸º Example Value å’Œ Modelã€‚æˆ‘ä»¬ä¸ç”¨å†å»ç¼–å†™é‡å¤çš„è¿”å›å­—æ®µï¼Œåªéœ€è¦å¼•ç”¨å·²æœ‰çš„ Go ç»“æ„ä½“å³å¯ï¼Œè¿™ä¹Ÿæ˜¯é€šè¿‡å·¥å…·ç”Ÿæˆ Swagger æ–‡æ¡£çš„é­…åŠ›æ‰€åœ¨</li><li>swagger:parametersï¼šswagger:parameters å®šä¹‰äº† API æ¥å£çš„è¯·æ±‚å‚æ•°ï¼Œä¾‹å¦‚ userParamsWrapperã€‚userParamsWrapper ä¹‹ä¸Šçš„æ³¨é‡Šä¼šè¢«è§£æä¸ºè¯·æ±‚å‚æ•°çš„æè¿°ï¼Œ&#x2F;&#x2F; in:body ä»£è¡¨è¯¥å‚æ•°æ˜¯ä½äº HTTP Body ä¸­ã€‚åŒæ ·ï¼ŒuserParamsWrapper ç»“æ„ä½“åæˆ‘ä»¬ä¹Ÿå¯ä»¥éšæ„å‘½åï¼Œä¸ä¼šå¸¦æ¥ä»»ä½•ä¸åŒã€‚swagger:parameters ä¹‹åçš„ createUserRequest ä¼šè·Ÿ swagger:route çš„ ID è¿›è¡ŒåŒ¹é…ï¼ŒåŒ¹é…æˆåŠŸåˆ™è¯´æ˜æ˜¯è¯¥ ID æ‰€åœ¨ API æ¥å£çš„è¯·æ±‚å‚æ•°ã€‚</li></ol><h2 id="é”™è¯¯ç è®¾è®¡"><a href="#é”™è¯¯ç è®¾è®¡" class="headerlink" title="é”™è¯¯ç è®¾è®¡"></a>é”™è¯¯ç è®¾è®¡</h2><ul><li>é”™è¯¯ç ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼šHTTP status code å’Œ ä¸šåŠ¡codeã€‚</li><li>ä¸šåŠ¡codeé‡‡ç”¨æ•°å­—æ ¼å¼æ‹¼æ¥è€Œæˆï¼Œä¸€èˆ¬åŒ…æ‹¬ï¼ŒæœåŠ¡ï¼Œæ¨¡å—ï¼Œé”™è¯¯ä¸‰éƒ¨åˆ†</li><li>è¿”å›çš„æ•°æ®æ ¼å¼åº”è¯¥æ˜¯å›ºå®šçš„ã€è§„èŒƒçš„ã€‚</li></ul><h3 id="é”™è¯¯ä»£ç è¯´æ˜ï¼š100101"><a href="#é”™è¯¯ä»£ç è¯´æ˜ï¼š100101" class="headerlink" title="é”™è¯¯ä»£ç è¯´æ˜ï¼š100101:"></a>é”™è¯¯ä»£ç è¯´æ˜ï¼š100101:</h3><ul><li>10ï¼šæœåŠ¡</li><li>01: æŸä¸ªæœåŠ¡ä¸‹çš„æŸä¸ªæ¨¡å—ã€‚</li><li>01: æ¨¡å—ä¸‹çš„é”™è¯¯ç åºå·ï¼Œæ¯ä¸ªæ¨¡å—å¯ä»¥æ³¨å†Œ 100 ä¸ªé”™è¯¯ã€‚<br>ç»“è®ºï¼šæœåŠ¡ Aï¼Œæ•°æ®åº“æ¨¡å—ä¸‹çš„è®°å½•æ²¡æœ‰æ‰¾åˆ°é”™è¯¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>13-goåœ¨vscodeä¸­çš„è°ƒè¯•</title>
      <link href="/2022/11/18/13-go-zai-vscode-zhong-de-diao-shi/"/>
      <url>/2022/11/18/13-go-zai-vscode-zhong-de-diao-shi/</url>
      
        <content type="html"><![CDATA[<ol><li>æ–°å»º.vscode&#x2F;launch.json</li><li>æ–‡ä»¶-å°†æ–‡ä»¶å¤¹æ·»åŠ åˆ°å·¥ä½œåŒº</li></ol><pre><code class="json">// launch.json&#123;  // ä½¿ç”¨ IntelliSense äº†è§£ç›¸å…³å±æ€§ã€‚  // æ‚¬åœä»¥æŸ¥çœ‹ç°æœ‰å±æ€§çš„æè¿°ã€‚  // æ¬²äº†è§£æ›´å¤šä¿¡æ¯ï¼Œè¯·è®¿é—®: https://go.microsoft.com/fwlink/?linkid=830387  &quot;version&quot;: &quot;0.2.0&quot;,  &quot;configurations&quot;: [    &#123;      &quot;name&quot;: &quot;Launch file&quot;,      &quot;type&quot;: &quot;go&quot;,      &quot;request&quot;: &quot;launch&quot;,      &quot;mode&quot;: &quot;debug&quot;,      &quot;program&quot;: &quot;$&#123;workspaceFolder&#125;/main.go&quot;    &#125;  ]&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
            <tag> ç¼–è¾‘å™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>12-go-å¸¸ç”¨è®¾è®¡æ¨¡å¼</title>
      <link href="/2022/10/24/12-go-chang-yong-she-ji-mo-shi/"/>
      <url>/2022/10/24/12-go-chang-yong-she-ji-mo-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="go-é¡¹ç›®ã€å·¥ç¨‹åŒ–ã€‘"><a href="#go-é¡¹ç›®ã€å·¥ç¨‹åŒ–ã€‘" class="headerlink" title="go é¡¹ç›®ã€å·¥ç¨‹åŒ–ã€‘"></a>go é¡¹ç›®ã€å·¥ç¨‹åŒ–ã€‘</h2><img src="/2022/10/24/12-go-chang-yong-she-ji-mo-shi/go_engeneer.webp" class="" title="goé¡¹ç›®"><h3 id="go-åº”ç”¨"><a href="#go-åº”ç”¨" class="headerlink" title="go åº”ç”¨"></a>go åº”ç”¨</h3><img src="/2022/10/24/12-go-chang-yong-she-ji-mo-shi/go_app.webp" class="" title="goåº”ç”¨"><h4 id="æ¨¡å—æ‹†åˆ†"><a href="#æ¨¡å—æ‹†åˆ†" class="headerlink" title="æ¨¡å—æ‹†åˆ†"></a>æ¨¡å—æ‹†åˆ†</h4><p>æ¨èï¼šæŒ‰åŠŸèƒ½æ‹†åˆ†<br>ä¸æ¨èï¼šæŒ‰ MVC è¿™æ ·çš„å±‚æ‹†åˆ†<br>æ¡ˆä¾‹ï¼š<br>è®¢å•ç³»ç»Ÿ&#x3D;ç”¨æˆ·æ¨¡å—+è®¢å•æ¨¡å—+è®¡è´¹æ¨¡å—</p><blockquote><p>ã€æ³¨ã€‘:æŒ‰åŠŸèƒ½æ‹†åˆ†çš„</p></blockquote><h4 id="ä»£ç è§„èŒƒ"><a href="#ä»£ç è§„èŒƒ" class="headerlink" title="ä»£ç è§„èŒƒ"></a>ä»£ç è§„èŒƒ</h4><p><a href="https://github.com/xxjwxc/uber_go_guide_cn">Uber Go è¯­è¨€ç¼–ç è§„èŒƒ</a></p><ul><li>æœ€ä½³å®è·µ<br><a href="https://go.dev/doc/effective_go">Effective Go</a><br><a href="https://github.com/golang/go/wiki/CodeReviewComments">CodeReviewComments</a><br><a href="https://rakyll.org/style-packages/">Style guideline for Go packages</a></li></ul><h4 id="å•å…ƒæµ‹è¯•"><a href="#å•å…ƒæµ‹è¯•" class="headerlink" title="å•å…ƒæµ‹è¯•"></a>å•å…ƒæµ‹è¯•</h4><ol><li><p>å°½å¯èƒ½å‡å°‘ function ä¸­çš„ä¾èµ–ï¼Œè®©å…¶åªä¾èµ–å¿…è¦æ¨¡å—</p></li><li><p>ä¾èµ–æ¨¡å—åº”è¯¥æ˜“äº mock</p></li><li><p>æé«˜å•å…ƒæµ‹è¯•è¦†ç›–ç‡</p><ul><li>ä½¿ç”¨ gotests å·¥å…·è‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ä»£ç ï¼Œå‡å°‘ç¼–å†™å•å…ƒæµ‹è¯•ç”¨ä¾‹çš„å·¥ä½œé‡</li><li>å®šæœŸæ£€æŸ¥å•å…ƒæµ‹è¯•è¦†ç›–ç‡ã€‚ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹æ³•æ¥æ£€æŸ¥</li></ul><pre><code class="go">$ go test -race -cover -coverprofile=./coverage.out -timeout=10m -short -v ./...$ go tool cover -func ./coverage.out</code></pre></li></ol><p>ä¸å¯æµ‹è¯•ä»£ç ï¼š</p><pre><code class="go">package postimport &quot;google.golang.org/grpc&quot;type Post struct &#123;Name    stringAddress string&#125;func ListPosts(client *grpc.ClientConn) ([]*Post, error) &#123;return client.ListPosts()&#125;</code></pre><p>å¯æµ‹è¯•ä»£ç ï¼š</p><pre><code class="go">package maintype Post struct &#123;  Name    string  Address string&#125;type Service interface &#123;  ListPosts() ([]*Post, error)&#125;func ListPosts(svc Service) ([]*Post, error) &#123;  return svc.ListPosts()&#125;</code></pre><p>å¸¸ç”¨ mock å·¥å…·ï¼š<br><a href="https://github.com/golang/mock">golang&#x2F;mock</a><br><a href="https://github.com/DATA-DOG/go-sqlmock">sqlmock</a><br><a href="https://github.com/jarcoal/httpmock">httpmock</a><br><a href="https://github.com/bouk/monkey">bouk&#x2F;monkey</a></p><h4 id="è‡ªåŠ¨ç”Ÿæˆä»£ç "><a href="#è‡ªåŠ¨ç”Ÿæˆä»£ç " class="headerlink" title="è‡ªåŠ¨ç”Ÿæˆä»£ç "></a>è‡ªåŠ¨ç”Ÿæˆä»£ç </h4><ul><li>é”™è¯¯ç ã€é”™è¯¯ç è¯´æ˜æ–‡æ¡£ã€‚</li><li>è‡ªåŠ¨ç”Ÿæˆç¼ºå¤±çš„ doc.go æ–‡ä»¶ã€‚</li><li>åˆ©ç”¨ gotests å·¥å…·ï¼Œè‡ªåŠ¨ç”Ÿæˆå•å…ƒæµ‹è¯•ç”¨ä¾‹ã€‚</li><li>ä½¿ç”¨ Swagger å·¥å…·ï¼Œè‡ªåŠ¨ç”Ÿæˆ Swagger æ–‡æ¡£ã€‚</li><li>ä½¿ç”¨ Mock å·¥å…·ï¼Œè‡ªåŠ¨ç”Ÿæˆæ¥å£çš„ Mock å®ä¾‹ã€‚</li></ul><h2 id="è®¾è®¡æ¨¡å¼"><a href="#è®¾è®¡æ¨¡å¼" class="headerlink" title="è®¾è®¡æ¨¡å¼"></a>è®¾è®¡æ¨¡å¼</h2><img src="/2022/10/24/12-go-chang-yong-she-ji-mo-shi/%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.webp" class=""><h3 id="å•ä¾‹æ¨¡å¼"><a href="#å•ä¾‹æ¨¡å¼" class="headerlink" title="å•ä¾‹æ¨¡å¼"></a>å•ä¾‹æ¨¡å¼</h3><p>å®šä¹‰ï¼šå…¨å±€åªæœ‰ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶ä¸”å®ƒè´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡<br>ä¼˜åŠ¿ï¼šæœ‰åˆ©äºå‡å°‘å†…å­˜å¼€æ”¯ï¼Œè¿˜èƒ½å‡å°‘ç³»ç»Ÿæ€§èƒ½å¼€é”€ã€é˜²æ­¢å¤šä¸ªå®ä¾‹äº§ç”Ÿå†²çª<br>é€‚åˆåœºæ™¯ï¼šå…¨å±€å…±äº«ä¸€ä¸ªå®ä¾‹ï¼Œä¸”åªéœ€è¦è¢«åˆå§‹åŒ–ä¸€æ¬¡ï¼Œå¦‚æ•°æ®åº“å®ä¾‹ã€å…¨å±€é…ç½®ã€å…¨å±€ä»»åŠ¡æ± </p><h4 id="é¥¿æ±‰æ¨¡å¼"><a href="#é¥¿æ±‰æ¨¡å¼" class="headerlink" title="é¥¿æ±‰æ¨¡å¼"></a>é¥¿æ±‰æ¨¡å¼</h4><p>å®šä¹‰ï¼šå…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨åŒ…è¢«åŠ è½½æ—¶åˆ›å»º</p><pre><code class="go">package singletontype singleton struct &#123;&#125;var ins *singleton = &amp;singleton&#123;&#125;func GetInsOr() *singleton &#123;    return ins&#125;</code></pre><hr><h4 id="æ‡’æ±‰æ¨¡å¼"><a href="#æ‡’æ±‰æ¨¡å¼" class="headerlink" title="æ‡’æ±‰æ¨¡å¼"></a>æ‡’æ±‰æ¨¡å¼</h4><p>å®šä¹‰ï¼šå…¨å±€çš„å•ä¾‹å®ä¾‹åœ¨ç¬¬ä¸€æ¬¡è¢«ä½¿ç”¨æ—¶åˆ›å»º</p><pre><code class="go">package singletontype singleton struct &#123;&#125;var ins *singletonfunc GetInsOr() *singleton &#123;    if ins == nil &#123;        ins = &amp;singleton&#123;&#125;    &#125;    return ins&#125;// å¸¦æ£€æŸ¥é”import &quot;sync&quot;type singleton struct &#123;&#125;var ins *singletonvar mu sync.Mutexfunc GetIns() *singleton &#123;  if ins == nil &#123;    mu.Lock()    if ins == nil &#123;      ins = &amp;singleton&#123;&#125;    &#125;        mu.Unlock()  &#125;  return ins&#125;// =======================æ›´å®Œç¾æ–¹å¼package singletonimport (    &quot;sync&quot;)type singleton struct &#123;&#125;var ins *singletonvar once sync.Oncefunc GetInsOr() *singleton &#123;    once.Do(func() &#123;      //ä½¿ç”¨once.Doå¯ä»¥ç¡®ä¿ ins å®ä¾‹å…¨å±€åªè¢«åˆ›å»ºä¸€æ¬¡ï¼Œonce.Do å‡½æ•°è¿˜å¯ä»¥ç¡®ä¿å½“åŒæ—¶æœ‰å¤šä¸ªåˆ›å»ºåŠ¨ä½œæ—¶ï¼Œåªæœ‰ä¸€ä¸ªåˆ›å»ºåŠ¨ä½œåœ¨è¢«æ‰§è¡Œã€‚        ins = &amp;singleton&#123;&#125;    &#125;)    return ins&#125;</code></pre><h3 id="å·¥å‚æ¨¡å¼"><a href="#å·¥å‚æ¨¡å¼" class="headerlink" title="å·¥å‚æ¨¡å¼"></a>å·¥å‚æ¨¡å¼</h3><p>Go ä¸­çš„ç»“æ„ä½“ï¼Œå¯ä»¥ç†è§£ä¸ºé¢å‘å¯¹è±¡ç¼–ç¨‹ä¸­çš„ç±»ï¼Œä¾‹å¦‚ Person ç»“æ„ä½“ï¼ˆç±»ï¼‰å®ç°äº† Greet æ–¹æ³•ã€‚</p><pre><code class="go">type Person struct &#123;  Name string  Age int&#125;func (p Person) Greet() &#123;  fmt.Printf(&quot;Hi! My name is %s&quot;, p.Name)&#125;</code></pre><h4 id="ç®€å•å·¥å‚æ¨¡å¼"><a href="#ç®€å•å·¥å‚æ¨¡å¼" class="headerlink" title="ç®€å•å·¥å‚æ¨¡å¼"></a>ç®€å•å·¥å‚æ¨¡å¼</h4><p>ä¸€ä¸ªæ¥å—ä¸€äº›å‚æ•°ï¼Œç„¶åè¿”å› Person å®ä¾‹çš„å‡½æ•°ã€‚ç¡®ä¿æˆ‘ä»¬åˆ›å»ºçš„å®ä¾‹å…·æœ‰éœ€è¦çš„å‚æ•°ï¼Œè¿›è€Œä¿è¯å®ä¾‹çš„æ–¹æ³•å¯ä»¥æŒ‰é¢„æœŸæ‰§è¡Œï¼Œä¾‹å¦‚ï¼Œé€šè¿‡ NewPerson åˆ›å»º Person å®ä¾‹æ—¶ï¼Œå¯ä»¥ç¡®ä¿å®ä¾‹çš„ name å’Œ age å±æ€§è¢«è®¾ç½®ã€‚</p><pre><code class="go">type Person struct &#123;  Name string  Age int&#125;func (p Person) Greet() &#123;  fmt.Printf(&quot;Hi! My name is %s&quot;, p.Name)&#125;func NewPerson(name string, age int) *Person &#123;  return &amp;Person&#123;    Name: name,    Age: age,  &#125;&#125;</code></pre><h4 id="æŠ½è±¡å·¥å‚æ¨¡å¼"><a href="#æŠ½è±¡å·¥å‚æ¨¡å¼" class="headerlink" title="æŠ½è±¡å·¥å‚æ¨¡å¼"></a>æŠ½è±¡å·¥å‚æ¨¡å¼</h4><p>å’Œç®€å•å·¥å‚æ¨¡å¼çš„å”¯ä¸€åŒºåˆ«ï¼Œå°±æ˜¯å®ƒè¿”å›çš„æ˜¯æ¥å£è€Œä¸æ˜¯ç»“æ„ä½“</p><pre><code class="go">type Person interface &#123;  Greet()&#125;type person struct &#123;  name string  age int&#125;func (p person) Greet() &#123;  fmt.Printf(&quot;Hi! My name is %s&quot;, p.name)&#125;// Here, NewPerson returns an interface, and not the person struct itselffunc NewPerson(name string, age int) Person &#123;  return person&#123;    name: name,    age: age,  &#125;&#125;</code></pre><h4 id="å·¥å‚æ–¹æ³•æ¨¡å¼"><a href="#å·¥å‚æ–¹æ³•æ¨¡å¼" class="headerlink" title="å·¥å‚æ–¹æ³•æ¨¡å¼"></a>å·¥å‚æ–¹æ³•æ¨¡å¼</h4><pre><code class="go">type Person struct &#123;  name string  age int&#125;func NewPersonFactory(age int) func(name string) Person &#123;  return func(name string) Person &#123;    return Person&#123;      name: name,      age: age,    &#125;  &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>centosäºŒä¸‰äº‹</title>
      <link href="/2022/10/20/centos-er-san-shi/"/>
      <url>/2022/10/20/centos-er-san-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="centos7-å®‰è£…-mariadb"><a href="#centos7-å®‰è£…-mariadb" class="headerlink" title="centos7 å®‰è£… mariadb"></a>centos7 å®‰è£… mariadb</h2><ol><li>é…ç½® MariaDB Yum æº</li></ol><pre><code class="bash">#/etc/yum.repos.d/mariadb.repo# MariaDB 10.5 CentOS repository list - created 2020-10-23 01:54 UTC# http://downloads.mariadb.org/mariadb/repositories/[mariadb]name = MariaDBbaseurl = http://mirrors.aliyun.com/mariadb/mariadb-10.7.6/yum/centos/7/x86_64/module_hotfixes=1gpgkey=https://yum.mariadb.org/RPM-GPG-KEY-MariaDBgpgcheck=0</code></pre><ol start="2"><li>å®‰è£… MariaDB å’Œ MariaDB å®¢æˆ·ç«¯<br><code>yum -y install MariaDB-server MariaDB-client</code></li><li>å¯åŠ¨ MariaDBï¼Œå¹¶è®¾ç½®å¼€æœºå¯åŠ¨<br><code>systemctl enable mariadb</code><br><code>systemctl start mariadb</code></li><li>è®¾ç½® root åˆå§‹å¯†ç <br><code>mysqladmin -u$&#123;MARIADB_ADMIN_USERNAME&#125; password $&#123;MARIADB_ADMIN_PASSWORD&#125;</code></li><li>éªŒè¯<br><code>mysql -h127.0.0.1 -uroot -p&#39;iam59!z$&#39;</code></li></ol><h2 id="centos7-å®‰è£…-redis"><a href="#centos7-å®‰è£…-redis" class="headerlink" title="centos7 å®‰è£… redis"></a>centos7 å®‰è£… redis</h2><p>ç”±äº yum ä¸æ”¯æŒ redisï¼Œæ‰€ä»¥é€šè¿‡æºç æ–¹å¼å®‰è£…</p><ol><li><p>è·å–æœ€æ–°ç¨³å®šç‰ˆæœ¬çš„ redis å¹¶è§£å‹<br><code>wget https://download.redis.io/redis-stable.tar.gz</code><br><code>tar -zxvf redis-4.0.8.tar.gz</code></p></li><li><p>å®‰è£… python3</p></li><li><p>ç¼–è¯‘</p></li></ol><pre><code class="bash">cd redis-stablemakemake install prefix=/usr/local/redismkdir /usr/local/redis/etcmv redis.conf /usr/local/redis/etc</code></pre><ol start="4"><li>ä¿®æ”¹ä¸ºåå°å¯åŠ¨<br><code>å°†daemonize no æ”¹æˆdaemonize yes</code></li><li>å°† redis åŠ å…¥åˆ°å¼€æœºå¯åŠ¨</li></ol><h2 id="centos7-å®‰è£…-Python3-7"><a href="#centos7-å®‰è£…-Python3-7" class="headerlink" title="centos7 å®‰è£… Python3.7"></a>centos7 å®‰è£… Python3.7</h2><ol><li>å®‰è£…ä¾èµ–åŒ…<br><code>yum install gcc patch libffi-devel python-devel zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gdbm-devel db4-devel libpcap-devel xz-devel -y </code></li><li>ä¸‹è½½ Python<br><code>wget https://www.python.org/ftp/python/3.7.10/Python-3.7.10.tgz</code></li><li>åˆ›å»ºä¸€ä¸ªç©ºæ–‡ä»¶å¤¹ï¼Œå­˜æ”¾ python3 ç¨‹åº<br><code>mkdir /usr/local/python3</code></li><li>ç¼–è¯‘&#x2F;å®‰è£…</li></ol><pre><code class="bash">./configure --prefix=/usr/local/python3./configure --enable-optimizationmakemake install prefix=/usr/local/python3</code></pre><h2 id="centos7æ›¿æ¢å›½å†…yumæº"><a href="#centos7æ›¿æ¢å›½å†…yumæº" class="headerlink" title="centos7æ›¿æ¢å›½å†…yumæº"></a>centos7æ›¿æ¢å›½å†…yumæº</h2><ol><li>å¤‡ä»½æºyumæ–‡ä»¶ <code>mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo_bak</code></li><li>ä¸‹è½½é˜¿é‡Œäº‘é•œåƒæ–‡ä»¶  <code>wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</code></li><li>æ¸…ç©ºç¼“å­˜ <code>yum clean all</code></li><li>é‡æ–°ç”Ÿæˆç¼“å­˜ <code>yum makecache</code></li></ol>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>gitäºŒä¸‰äº‹</title>
      <link href="/2022/10/19/git-er-san-shi/"/>
      <url>/2022/10/19/git-er-san-shi/</url>
      
        <content type="html"><![CDATA[<h2 id="git-é“¾æ¥å¤±è´¥"><a href="#git-é“¾æ¥å¤±è´¥" class="headerlink" title="git é“¾æ¥å¤±è´¥"></a>git é“¾æ¥å¤±è´¥</h2><p>æŠ¥é”™å¤±è´¥ï¼škex_exchange_identification: Connection closed by remote host<br>è§£å†³æ–¹æ³•ï¼šå°† Github çš„è¿æ¥ç«¯å£ä» 22 æ”¹ä¸º 443 å³å¯<br>.ssh&#x2F;config æ–‡ä»¶</p><pre><code class="bash">Host github.com    HostName ssh.github.com    User git    Port 443</code></pre><h2 id="git-clone-æŠ¥é”™-1"><a href="#git-clone-æŠ¥é”™-1" class="headerlink" title="git clone æŠ¥é”™ 1"></a>git clone æŠ¥é”™ 1</h2><p>å…·ä½“æŠ¥é”™ä¿¡æ¯ï¼š</p><blockquote><p>git clone <a href="mailto:&#103;&#105;&#116;&#64;&#x67;&#105;&#116;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;">&#103;&#105;&#116;&#64;&#x67;&#105;&#116;&#104;&#117;&#98;&#x2e;&#99;&#x6f;&#x6d;</a>:marmotedu&#x2F;iam.git<br>Cloning into â€˜iamâ€™â€¦<br>Unable to negotiate with 192.30.255.112 port 22: no matching MAC found. Their offer: <a href="mailto:&#104;&#x6d;&#x61;&#99;&#x2d;&#x73;&#104;&#97;&#50;&#45;&#x35;&#x31;&#50;&#x2d;&#x65;&#x74;&#x6d;&#64;&#x6f;&#112;&#101;&#x6e;&#x73;&#x73;&#104;&#x2e;&#99;&#x6f;&#x6d;">&#104;&#x6d;&#x61;&#99;&#x2d;&#x73;&#104;&#97;&#50;&#45;&#x35;&#x31;&#50;&#x2d;&#x65;&#x74;&#x6d;&#64;&#x6f;&#112;&#101;&#x6e;&#x73;&#x73;&#104;&#x2e;&#99;&#x6f;&#x6d;</a>,<br><a href="mailto:&#104;&#109;&#x61;&#x63;&#x2d;&#115;&#104;&#x61;&#x32;&#45;&#x32;&#53;&#54;&#45;&#x65;&#x74;&#109;&#x40;&#111;&#x70;&#x65;&#110;&#x73;&#115;&#x68;&#x2e;&#99;&#x6f;&#109;">&#104;&#109;&#x61;&#x63;&#x2d;&#115;&#104;&#x61;&#x32;&#45;&#x32;&#53;&#54;&#45;&#x65;&#x74;&#109;&#x40;&#111;&#x70;&#x65;&#110;&#x73;&#115;&#x68;&#x2e;&#99;&#x6f;&#109;</a>,hmac-sha2-512,hmac-sha2-256<br>fatal: Could not read from remote repository.<br>Please make sure you have the correct access rights</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š<br>åœ¨<code>/etc/ssh/ssh_config</code>æ–‡ä»¶æœ€åä¸€è¡Œä¿®æ”¹<code>MACs hmac-sha1</code>ä¸º<code>MACs hmac-sha1,hmac-sha2-256,hmac-sha2-512</code></p><h2 id="git-clone-æŠ¥é”™-2"><a href="#git-clone-æŠ¥é”™-2" class="headerlink" title="git clone æŠ¥é”™ 2"></a>git clone æŠ¥é”™ 2</h2><blockquote><p>fatal: unable to access â€˜<a href="https://github.com/protocolbuffers/protobuf/&#39;">https://github.com/protocolbuffers/protobuf/&#39;</a>: Failed connect to github.com:443; Connection timed out</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š<br>ä½¿ç”¨ ssh é“¾æ¥ <code>git clone -b v3.21.1 --depth=1 git@github.com:protocolbuffers/protobuf.git</code></p><h2 id="git-clone-æŠ¥é”™-3"><a href="#git-clone-æŠ¥é”™-3" class="headerlink" title="git clone æŠ¥é”™ 3"></a>git clone æŠ¥é”™ 3</h2><blockquote><p>ERROR: Youâ€™re using an RSA key with SHA-1, which is no longer allowed. Please use a newer client or a different key type.<br>Please see <a href="https://github.blog/2021-09-01-improving-git-protocol-security-github/">https://github.blog/2021-09-01-improving-git-protocol-security-github/</a> for more information.</p></blockquote><p>è§£å†³æ–¹æ³•ï¼š<br>ssh-keygen -t ecdsa -b 521 -C â€œ<a href="mailto:&#121;&#111;&#x75;&#x72;&#x5f;&#101;&#x6d;&#x61;&#105;&#x6c;&#x40;&#101;&#x78;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#x63;&#111;&#109;">&#121;&#111;&#x75;&#x72;&#x5f;&#101;&#x6d;&#x61;&#105;&#x6c;&#x40;&#101;&#x78;&#x61;&#x6d;&#x70;&#108;&#101;&#x2e;&#x63;&#111;&#109;</a>â€œ</p><h2 id="centos7-å®‰è£…-æœ€æ–°ç‰ˆ-git"><a href="#centos7-å®‰è£…-æœ€æ–°ç‰ˆ-git" class="headerlink" title="centos7 å®‰è£… æœ€æ–°ç‰ˆ git"></a>centos7 å®‰è£… æœ€æ–°ç‰ˆ git</h2><ol><li>å°†æœ€æ–°ç‰ˆå‹ç¼©åŒ…ä¸Šä¼ åˆ°äº‘æœåŠ¡å™¨ï¼ˆscp å‘½ä»¤ï¼‰<code>scp git-2.38.1.tar.gz root@36.133.137.19:/root/setup/</code></li><li>å®‰è£…ä¾èµ–å¹¶è§£å‹ï¼Œè¿›å…¥è§£å‹åçš„æ–‡ä»¶å¤¹</li></ol><pre><code class="bash">yum -y install curl-devel expat-devel openssl-devel zlib-develyum -y install gcctar -zxf git-2.38.1.tar.gzcd git-2.38.1</code></pre><ol start="3"><li>ç¼–è¯‘å¹¶å®‰è£…</li></ol><pre><code class="bash">makemake install prefix=/usr/local/git</code></pre><p>æ­¤æ—¶ä¼šåœ¨&#x2F;usr&#x2F;local&#x2F;ä¸‹ç”Ÿæˆæ–‡ä»¶å¤¹ git</p><img src="/2022/10/19/git-er-san-shi/make.jpg" class="" title="ç”Ÿæˆæ–‡ä»¶å¤¹git"><p>è¿›å…¥æ–‡ä»¶å¤¹åæ‰§è¡Œ<code>./git --version</code></p><ol start="4"><li>ä½¿å…¶å…¨å±€ç”Ÿæ•ˆ</li></ol><ul><li>é€šè¿‡å°†å…¶æ·»åŠ è‡³ç¯å¢ƒå˜é‡</li></ul><pre><code class="bash"># /etc/profilePATH=$PATH:/usr/local/git/binEXPORT PATH# shellsource /etc/profile</code></pre><ul><li>è½¯é“¾æ¥[å®æµ‹å¹¶ä¸ç”Ÿæ•ˆ]</li></ul><h3 id="å…‹éš†æŒ‡å®šåˆ†æ”¯-x2F-tagä»£ç "><a href="#å…‹éš†æŒ‡å®šåˆ†æ”¯-x2F-tagä»£ç " class="headerlink" title="å…‹éš†æŒ‡å®šåˆ†æ”¯&#x2F;tagä»£ç "></a>å…‹éš†æŒ‡å®šåˆ†æ”¯&#x2F;tagä»£ç </h3><p>git clone -b v1.1.0  <a href="mailto:&#x67;&#x69;&#x74;&#x40;&#103;&#x69;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#x6f;&#x6d;">&#x67;&#x69;&#x74;&#x40;&#103;&#x69;&#116;&#x68;&#x75;&#x62;&#x2e;&#x63;&#x6f;&#x6d;</a>:marmotedu&#x2F;iam.git</p><h3 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« :"></a>å‚è€ƒæ–‡ç« :</h3><ol><li><a href="https://git-scm.com/download/linux">https://git-scm.com/download/linux</a></li><li><a href="https://www.cnblogs.com/zhi-leaf/p/10978538.html">https://www.cnblogs.com/zhi-leaf/p/10978538.html</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> github </category>
          
      </categories>
      
      
        <tags>
            
            <tag> github </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>11-go-api</title>
      <link href="/2022/10/18/11-go-api/"/>
      <url>/2022/10/18/11-go-api/</url>
      
        <content type="html"><![CDATA[<h2 id="å¸¸ç”¨çš„-API-é£æ ¼"><a href="#å¸¸ç”¨çš„-API-é£æ ¼" class="headerlink" title="å¸¸ç”¨çš„ API é£æ ¼"></a>å¸¸ç”¨çš„ API é£æ ¼</h2><ol><li>REST:è¡¨ç°å±‚çŠ¶æ€è½¬ç§»(REpresentational State Transfer)</li><li>RPC</li><li>GraphQL[ä¸å¸¸ç”¨]<img src="/2022/10/18/11-go-api/http.webp" class=""></li></ol><h2 id="REST-API"><a href="#REST-API" class="headerlink" title="REST API"></a>REST API</h2><p>ä»¥èµ„æº (resource) ä¸ºä¸­å¿ƒï¼Œæ‰€æœ‰çš„ä¸œè¥¿éƒ½æŠ½è±¡æˆèµ„æº</p><ul><li>èµ„æº<ul><li>Collection:<br>ä¸€å †èµ„æºçš„é›†åˆ,æ¯”å¦‚ç”¨æˆ·(User)çš„é›†åˆå°±æ˜¯ Collectionã€‚<br>åŸŸå&#x2F;èµ„æºåå¤æ•°:<code>https://xxx.com/users</code></li><li>Member<br>å•ä¸ªç‰¹å®šèµ„æº<br>åŸŸå&#x2F;èµ„æºåå¤æ•°&#x2F;èµ„æºåç§°:<code>https://xxx.com/users/admin</code></li></ul></li></ul><h3 id="è§„èŒƒ"><a href="#è§„èŒƒ" class="headerlink" title="è§„èŒƒ"></a>è§„èŒƒ</h3><ol><li>URI ç»“å°¾ä¸åº”åŒ…å«&#x2F;</li><li>URI ä¸­ä¸èƒ½å‡ºç°ä¸‹åˆ’çº¿ _ï¼Œå¿…é¡»ç”¨ä¸­æ çº¿ - ä»£æ›¿ã€ä¸å¼ºåˆ¶ã€‘</li><li>è·¯å¾„ç”¨å°å†™ï¼Œä¸è¦ç”¨å¤§å†™</li><li>é¿å…å±‚çº§è¿‡æ·±çš„ URIã€‚è¶…è¿‡ 2 å±‚çš„èµ„æºåµŒå¥—ä¼šå¾ˆä¹±ï¼Œå»ºè®®å°†å…¶ä»–èµ„æºè½¬åŒ–ä¸º?å‚æ•°</li><li>æœ‰äº›æ“ä½œä¸èƒ½å¾ˆå¥½åœ°æ˜ å°„ä¸ºä¸€ä¸ª REST èµ„æºçš„æ—¶å€™,å°†ä¸€ä¸ªæ“ä½œå˜æˆèµ„æºçš„ä¸€ä¸ªå±æ€§æˆ–è€…å°†æ“ä½œå½“ä½œæ˜¯ä¸€ä¸ªèµ„æºçš„åµŒå¥—èµ„æº</li><li>è¿”å›æ ¼å¼ç»Ÿä¸€ã€æˆåŠŸå’Œå¤±è´¥ã€‘</li></ol><pre><code class="bash">/schools/tsinghua/classes/rooma/students/zhang # ä¸æ¨è/students?school=qinghua&amp;class=rooma # æ¨è/users/zhangsan?active=false # ç¦ç”¨æŸä¸ªç”¨æˆ·PUT /gists/:id/star # github star actionDELETE /gists/:id/star # github unstar action</code></pre><h3 id="å®‰å…¨æ€§å’Œå¹‚ç­‰æ€§"><a href="#å®‰å…¨æ€§å’Œå¹‚ç­‰æ€§" class="headerlink" title="å®‰å…¨æ€§å’Œå¹‚ç­‰æ€§"></a>å®‰å…¨æ€§å’Œå¹‚ç­‰æ€§</h3><p>å®‰å…¨æ€§ï¼šä¸ä¼šæ”¹å˜èµ„æºçŠ¶æ€ï¼Œå¯ä»¥ç†è§£ä¸ºåªè¯»çš„ã€‚<br>å¹‚ç­‰æ€§ï¼šæ‰§è¡Œ 1 æ¬¡å’Œæ‰§è¡Œ N æ¬¡ï¼Œå¯¹èµ„æºçŠ¶æ€æ”¹å˜çš„æ•ˆæœæ˜¯ç­‰ä»·çš„ã€‚</p><img src="/2022/10/18/11-go-api/safe.webp" class=""><h3 id="æ‰¹é‡åˆ é™¤"><a href="#æ‰¹é‡åˆ é™¤" class="headerlink" title="æ‰¹é‡åˆ é™¤"></a>æ‰¹é‡åˆ é™¤</h3><p>HTTP çš„ DELETE æ–¹æ³•ä¸èƒ½æºå¸¦å¤šä¸ªèµ„æºå<br>è§£å†³æ–¹æ³•ï¼š</p><ol><li>å‘èµ·å¤šä¸ª DELETE è¯·æ±‚ã€‚</li><li>æ“ä½œè·¯å¾„ä¸­å¸¦å¤šä¸ª idï¼Œid ä¹‹é—´ç”¨åˆ†éš”ç¬¦åˆ†éš”, ä¾‹å¦‚ï¼šDELETE &#x2F;users?ids&#x3D;1,2,3 ã€‚</li><li>ç›´æ¥ä½¿ç”¨ POST æ–¹å¼æ¥æ‰¹é‡åˆ é™¤ï¼Œbody ä¸­ä¼ å…¥éœ€è¦åˆ é™¤çš„èµ„æºåˆ—è¡¨ã€‚</li></ol><h3 id="ç‰ˆæœ¬ç®¡ç†"><a href="#ç‰ˆæœ¬ç®¡ç†" class="headerlink" title="ç‰ˆæœ¬ç®¡ç†"></a>ç‰ˆæœ¬ç®¡ç†</h3><p>&#x2F;v1&#x2F;login</p><h3 id="API-å‘½å"><a href="#API-å‘½å" class="headerlink" title="API å‘½å"></a>API å‘½å</h3><ul><li>é©¼å³°å‘½åæ³• ï¼š&#x2F;resetUserPasswd</li><li>è›‡å½¢å‘½åæ³• ï¼š&#x2F;reset_user_passwd</li><li>è„ŠæŸ±å‘½åæ³• ï¼š&#x2F;reset-user-passwd</li></ul><h3 id="ç»Ÿä¸€åˆ†é¡µï¼Œæ’åºï¼Œè¿‡æ»¤"><a href="#ç»Ÿä¸€åˆ†é¡µï¼Œæ’åºï¼Œè¿‡æ»¤" class="headerlink" title="ç»Ÿä¸€åˆ†é¡µï¼Œæ’åºï¼Œè¿‡æ»¤"></a>ç»Ÿä¸€åˆ†é¡µï¼Œæ’åºï¼Œè¿‡æ»¤</h3><p>èµ„æºçš„æŸ¥è¯¢æ¥å£ï¼Œé€šå¸¸æƒ…å†µä¸‹éƒ½éœ€è¦å®ç°åˆ†é¡µã€è¿‡æ»¤ã€æ’åºã€æœç´¢åŠŸèƒ½ï¼Œå› ä¸ºè¿™äº›åŠŸèƒ½æ˜¯æ¯ä¸ª REST èµ„æºéƒ½èƒ½ç”¨åˆ°çš„ï¼Œæ‰€ä»¥å¯ä»¥å®ç°ä¸ºä¸€ä¸ªå…¬å…±çš„ API ç»„ä»¶</p><ul><li>åˆ†é¡µï¼šåœ¨åˆ—å‡ºä¸€ä¸ª Collection ä¸‹æ‰€æœ‰çš„ Member æ—¶ï¼Œåº”è¯¥æä¾›åˆ†é¡µåŠŸèƒ½ï¼Œä¾‹å¦‚&#x2F;users?offset&#x3D;0&amp;limit&#x3D;20ï¼ˆlimitï¼ŒæŒ‡å®šè¿”å›è®°å½•çš„æ•°é‡ï¼›offsetï¼ŒæŒ‡å®šè¿”å›è®°å½•çš„å¼€å§‹ä½ç½®ï¼‰ã€‚</li><li>è¿‡æ»¤ï¼šå¦‚æœç”¨æˆ·ä¸éœ€è¦ä¸€ä¸ªèµ„æºçš„å…¨éƒ¨çŠ¶æ€å±æ€§ï¼Œå¯ä»¥åœ¨ URI å‚æ•°é‡ŒæŒ‡å®šè¿”å›å“ªäº›å±æ€§ï¼Œä¾‹å¦‚&#x2F;users?fields&#x3D;email,username,addressã€‚</li><li>æ’åºï¼šç”¨æˆ·å¾ˆå¤šæ—¶å€™ä¼šæ ¹æ®åˆ›å»ºæ—¶é—´æˆ–è€…å…¶ä»–å› ç´ ï¼Œåˆ—å‡ºä¸€ä¸ª Collection ä¸­å‰ 100 ä¸ª Memberï¼Œè¿™æ—¶å¯ä»¥åœ¨ URI å‚æ•°ä¸­æŒ‡æ˜æ’åºå‚æ•°ï¼Œä¾‹å¦‚&#x2F;users?sort&#x3D;age,descã€‚</li><li>æœç´¢ï¼šå½“ä¸€ä¸ªèµ„æºçš„ Member å¤ªå¤šæ—¶ï¼Œç”¨æˆ·å¯èƒ½æƒ³é€šè¿‡æœç´¢ï¼Œå¿«é€Ÿæ‰¾åˆ°æ‰€éœ€è¦çš„ Memberï¼Œæˆ–ç€æƒ³æœä¸‹æœ‰æ²¡æœ‰åå­—ä¸º xxx çš„æŸç±»èµ„æºï¼Œè¿™æ—¶å€™å°±éœ€è¦æä¾›æœç´¢åŠŸèƒ½ã€‚æœç´¢å»ºè®®æŒ‰æ¨¡ç³ŠåŒ¹é…æ¥æœç´¢ã€‚</li></ul><hr><h2 id="RPC-API"><a href="#RPC-API" class="headerlink" title="RPC API"></a>RPC API</h2><p>æœåŠ¡ç«¯å®ç°äº†ä¸€ä¸ªå‡½æ•°ï¼Œå®¢æˆ·ç«¯ä½¿ç”¨ RPC æ¡†æ¶æä¾›çš„æ¥å£ï¼Œåƒè°ƒç”¨æœ¬åœ°å‡½æ•°ä¸€æ ·è°ƒç”¨è¿™ä¸ªå‡½æ•°ï¼Œå¹¶è·å–è¿”å›å€¼ã€‚RPC å±è”½äº†åº•å±‚çš„ç½‘ç»œé€šä¿¡ç»†èŠ‚ï¼Œä½¿å¾—å¼€å‘äººå‘˜æ— éœ€å…³æ³¨ç½‘ç»œç¼–ç¨‹çš„ç»†èŠ‚ï¼Œå¯ä»¥å°†æ›´å¤šçš„æ—¶é—´å’Œç²¾åŠ›æ”¾åœ¨ä¸šåŠ¡é€»è¾‘æœ¬èº«çš„å®ç°ä¸Šï¼Œä»è€Œæé«˜å¼€å‘æ•ˆç‡ã€‚</p><img src="/2022/10/18/11-go-api/RPC.webp" class=""><h3 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h3><ol><li>Client é€šè¿‡æœ¬åœ°è°ƒç”¨ï¼Œè°ƒç”¨ Client Stubã€‚</li><li>Client Stub å°†å‚æ•°æ‰“åŒ…ï¼ˆä¹Ÿå« Marshallingï¼‰æˆä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åå‘é€è¿™ä¸ªæ¶ˆæ¯ã€‚</li><li>Client æ‰€åœ¨çš„ OS å°†æ¶ˆæ¯å‘é€ç»™ Serverã€‚</li><li>Server ç«¯æ¥æ”¶åˆ°æ¶ˆæ¯åï¼Œå°†æ¶ˆæ¯ä¼ é€’ç»™ Server Stubã€‚</li><li>Server Stub å°†æ¶ˆæ¯è§£åŒ…ï¼ˆä¹Ÿå« Unmarshallingï¼‰å¾—åˆ°å‚æ•°ã€‚</li><li>Server Stub è°ƒç”¨æœåŠ¡ç«¯çš„å­ç¨‹åºï¼ˆå‡½æ•°ï¼‰ï¼Œå¤„ç†å®Œåï¼Œå°†æœ€ç»ˆç»“æœæŒ‰ç…§ç›¸åçš„æ­¥éª¤è¿”å›ç»™ Clientã€‚</li></ol><h3 id="gRPC"><a href="#gRPC" class="headerlink" title="gRPC"></a>gRPC</h3><p>google Remote Procedure Call</p><h4 id="Protocol-Buffers"><a href="#Protocol-Buffers" class="headerlink" title="Protocol Buffers"></a>Protocol Buffers</h4><p>å¯¹æ•°æ®ç»“æ„è¿›è¡Œåºåˆ—åŒ–çš„æ–¹æ³•ï¼Œå¯ç”¨ä½œï¼ˆæ•°æ®ï¼‰é€šä¿¡åè®®ã€æ•°æ®å­˜å‚¨æ ¼å¼ç­‰ï¼Œä¹Ÿæ˜¯ä¸€ç§æ›´åŠ çµæ´»ã€é«˜æ•ˆçš„æ•°æ®æ ¼å¼ï¼Œä¸ XMLã€JSON ç±»ä¼¼ã€‚å®ƒçš„ä¼ è¾“æ€§èƒ½éå¸¸å¥½ï¼Œæ‰€ä»¥å¸¸è¢«ç”¨åœ¨ä¸€äº›å¯¹æ•°æ®ä¼ è¾“æ€§èƒ½è¦æ±‚æ¯”è¾ƒé«˜çš„ç³»ç»Ÿä¸­ï¼Œä½œä¸ºæ•°æ®ä¼ è¾“æ ¼å¼</p><ol><li>å®šä¹‰æ•°æ®ç»“æ„</li></ol><pre><code class="go">// å®šä¹‰ä¸€ä¸ª SecretInfo æ•°æ®ç»“æ„// SecretInfo contains secret details.message SecretInfo &#123;  string name = 1;  string secret_id  = 2;  string username   = 3;  string secret_key = 4;  int64 expires = 5;  string description = 6;  string created_at = 7;  string updated_at = 8;&#125;</code></pre><ol start="2"><li>å®šä¹‰æœåŠ¡æ¥å£</li></ol><pre><code class="go">// Cache implements a cache rpc service.service Cache&#123;  rpc ListSecrets(ListSecretsRequest) returns (ListSecretsResponse) &#123;&#125;  rpc ListPolicies(ListPoliciesRequest) returns (ListPoliciesResponse) &#123;&#125;&#125;</code></pre><ol start="3"><li>é€šè¿‡ protobuf åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæå‡ä¼ è¾“æ•ˆç‡</li></ol><h4 id="gRPC-demo"><a href="#gRPC-demo" class="headerlink" title="gRPC demo"></a>gRPC demo</h4><ul><li>å®šä¹‰ gRPC æœåŠ¡ã€‚</li><li>ç”Ÿæˆå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä»£ç ã€‚</li><li>å®ç° gRPC æœåŠ¡ã€‚</li><li>å®ç° gRPC å®¢æˆ·ç«¯ã€‚</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>10-go-é¡¹ç›®å®æˆ˜</title>
      <link href="/2022/10/17/10-go-gui-fan/"/>
      <url>/2022/10/17/10-go-gui-fan/</url>
      
        <content type="html"><![CDATA[<img src="/2022/10/17/10-go-gui-fan/landscape.webp" class="" title="go"><h1 id="ç¯å¢ƒå‡†å¤‡"><a href="#ç¯å¢ƒå‡†å¤‡" class="headerlink" title="ç¯å¢ƒå‡†å¤‡"></a>ç¯å¢ƒå‡†å¤‡</h1><h2 id="å®‰è£…ä¾èµ–"><a href="#å®‰è£…ä¾èµ–" class="headerlink" title="å®‰è£…ä¾èµ–"></a>å®‰è£…ä¾èµ–</h2><p><code>yum -y install make autoconf automake cmake perl-CPAN libcurl-devel libtool gcc gcc-c++ glibc-headers zlib-devel git-lfs telnet lrzsz jq expat-devel openssl-devel </code></p><h2 id="Go-ç¼–è¯‘ç¯å¢ƒå®‰è£…å’Œé…ç½®"><a href="#Go-ç¼–è¯‘ç¯å¢ƒå®‰è£…å’Œé…ç½®" class="headerlink" title="Go ç¼–è¯‘ç¯å¢ƒå®‰è£…å’Œé…ç½®"></a>Go ç¼–è¯‘ç¯å¢ƒå®‰è£…å’Œé…ç½®</h2><p>è§ <a href="https://earthayan.github.io/2022/10/01/01-golang-proxy/">https://earthayan.github.io/2022/10/01/01-golang-proxy/</a></p><h2 id="å®‰è£…-ProtoBuf-çš„ç¼–è¯‘ç¯å¢ƒ"><a href="#å®‰è£…-ProtoBuf-çš„ç¼–è¯‘ç¯å¢ƒ" class="headerlink" title="å®‰è£… ProtoBuf çš„ç¼–è¯‘ç¯å¢ƒ"></a>å®‰è£… ProtoBuf çš„ç¼–è¯‘ç¯å¢ƒ</h2><pre><code class="bash"># ç¬¬ä¸€æ­¥ï¼šå®‰è£… protobuf$ cd /tmp/$ git clone -b v3.21.1 --depth=1 https://github.com/protocolbuffers/protobuf$ cd protobuf$ ./autogen.sh$ ./configure$ make$ make install$ protoc --version # æŸ¥çœ‹ protoc ç‰ˆæœ¬ï¼ŒæˆåŠŸè¾“å‡ºç‰ˆæœ¬å·ï¼Œè¯´æ˜å®‰è£…æˆåŠŸ# ç¬¬äºŒæ­¥ï¼šå®‰è£… protoc-gen-go$ go install github.com/golang/protobuf/protoc-gen-go@v1.5.2</code></pre><blockquote><p>go install ä¹‹åä¼šåœ¨ GOPATH çš„ pkg ç›®å½•ä¸‹ç”Ÿæˆå¯¹åº”çš„æ–‡ä»¶å¤¹</p></blockquote><h3 id="å¤šå·¥ä½œåŒºæ¨¡å¼"><a href="#å¤šå·¥ä½œåŒºæ¨¡å¼" class="headerlink" title="å¤šå·¥ä½œåŒºæ¨¡å¼"></a>å¤šå·¥ä½œåŒºæ¨¡å¼</h3><ol><li>go work init .&#x2F;testDemo</li><li>go work use .&#x2F;iam</li></ol><p>ä¸Šè¿°æ“ä½œä¼šåœ¨ workSpace ç›®å½•ä¸‹ç”Ÿæˆ go.work æ–‡ä»¶</p><h1 id="è§„èŒƒ"><a href="#è§„èŒƒ" class="headerlink" title="è§„èŒƒ"></a>è§„èŒƒ</h1><h2 id="ç»Ÿä¸€è§„èŒƒçš„ä½œç”¨ï¼š"><a href="#ç»Ÿä¸€è§„èŒƒçš„ä½œç”¨ï¼š" class="headerlink" title="ç»Ÿä¸€è§„èŒƒçš„ä½œç”¨ï¼š"></a>ç»Ÿä¸€è§„èŒƒçš„ä½œç”¨ï¼š</h2><ul><li>ç»Ÿä¸€ä»£ç é£æ ¼ï¼Œå¢åŠ å¯è¯»æ€§</li><li>ç»Ÿä¸€ç›®å½•ï¼Œå¢åŠ ä»£ç çš„å¯ç»´æŠ¤æ€§</li><li>ç»Ÿä¸€å¯¹å¤–æä¾›çš„ API æ¥å£</li><li>è§„èŒƒé”™è¯¯ç ï¼Œé™ä½ç”¨æˆ·ç†è§£éš¾åº¦</li></ul><h2 id="è§„èŒƒçš„åˆ†ç±»ï¼š"><a href="#è§„èŒƒçš„åˆ†ç±»ï¼š" class="headerlink" title="è§„èŒƒçš„åˆ†ç±»ï¼š"></a>è§„èŒƒçš„åˆ†ç±»ï¼š</h2><h3 id="éç¼–ç ç±»è§„èŒƒï¼š"><a href="#éç¼–ç ç±»è§„èŒƒï¼š" class="headerlink" title="éç¼–ç ç±»è§„èŒƒï¼š"></a>éç¼–ç ç±»è§„èŒƒï¼š</h3><blockquote><ul><li>å¼€æºè§„èŒƒ</li><li>æ–‡æ¡£è§„èŒƒ</li><li>ç‰ˆæœ¬è§„èŒƒ</li><li>commit è§„èŒƒ</li><li>é¡¹ç›®å‘å¸ƒè§„èŒƒ</li></ul></blockquote><h3 id="ç¼–ç ç±»è§„èŒƒ"><a href="#ç¼–ç ç±»è§„èŒƒ" class="headerlink" title="ç¼–ç ç±»è§„èŒƒ"></a>ç¼–ç ç±»è§„èŒƒ</h3><blockquote><ul><li>ç›®å½•è§„èŒƒ</li><li>ä»£ç è§„èŒƒ</li><li>æ¥å£è§„èŒƒ</li><li>æ—¥å¿—è§„èŒƒ</li><li>é”™è¯¯ç è§„èŒƒ</li></ul></blockquote><h1 id="å¼€æºè§„èŒƒ"><a href="#å¼€æºè§„èŒƒ" class="headerlink" title="å¼€æºè§„èŒƒ"></a>å¼€æºè§„èŒƒ</h1><img src="/2022/10/17/10-go-gui-fan/opensource.webp" class="" title="å¼€æºè§„èŒƒé€‰æ‹©"><p>å¼€æºé¡¹ç›®é™„åŠ è§„èŒƒï¼š</p><ol><li>é«˜å•å…ƒæµ‹è¯•è¦†ç›–ç‡</li><li>ä»£ç åº“å’Œæäº¤è®°å½•ä¸­ä¸èƒ½å‡ºç°æ•æ„Ÿä¿¡æ¯å’Œå†…éƒ¨ä¸šåŠ¡ç›¸å…³ä¿¡æ¯</li><li>åŠæ—¶å¤„ç† issue ,PR ç­‰</li><li>èƒ½å¤ŸæŒç»­åœ°æ›´æ–°åŠŸèƒ½ï¼Œä¿®å¤ Bug,å¹¶åŠæ—¶è¿›è¡Œæ–‡æ¡£è¾“å‡º</li></ol><h1 id="æ–‡æ¡£è§„èŒƒ"><a href="#æ–‡æ¡£è§„èŒƒ" class="headerlink" title="æ–‡æ¡£è§„èŒƒ"></a>æ–‡æ¡£è§„èŒƒ</h1><ul><li>README è§„èŒƒï¼šä¸»è¦æ˜¯ç”¨æ¥ä»‹ç»é¡¹ç›®çš„åŠŸèƒ½ã€å®‰è£…ã€éƒ¨ç½²å’Œä½¿ç”¨</li></ul><pre><code># é¡¹ç›®åç§°&lt;!-- å†™ä¸€æ®µç®€çŸ­çš„è¯æè¿°é¡¹ç›® --&gt;## åŠŸèƒ½ç‰¹æ€§&lt;!-- æè¿°è¯¥é¡¹ç›®çš„æ ¸å¿ƒåŠŸèƒ½ç‚¹ --&gt;## è½¯ä»¶æ¶æ„(å¯é€‰)&lt;!-- å¯ä»¥æè¿°ä¸‹é¡¹ç›®çš„æ¶æ„ --&gt;## å¿«é€Ÿå¼€å§‹### ä¾èµ–æ£€æŸ¥&lt;!-- æè¿°è¯¥é¡¹ç›®çš„ä¾èµ–ï¼Œæ¯”å¦‚ä¾èµ–çš„åŒ…ã€å·¥å…·æˆ–è€…å…¶ä»–ä»»ä½•ä¾èµ–é¡¹ --&gt;### æ„å»º&lt;!-- æè¿°å¦‚ä½•æ„å»ºè¯¥é¡¹ç›® --&gt;### è¿è¡Œ&lt;!-- æè¿°å¦‚ä½•è¿è¡Œè¯¥é¡¹ç›® --&gt;## ä½¿ç”¨æŒ‡å—&lt;!-- æè¿°å¦‚ä½•ä½¿ç”¨è¯¥é¡¹ç›® --&gt;## å¦‚ä½•è´¡çŒ®&lt;!-- å‘Šè¯‰å…¶ä»–å¼€å‘è€…å¦‚æœç»™è¯¥é¡¹ç›®è´¡çŒ®æºç  --&gt;## ç¤¾åŒº(å¯é€‰)&lt;!-- å¦‚æœæœ‰éœ€è¦å¯ä»¥ä»‹ç»ä¸€äº›ç¤¾åŒºç›¸å…³çš„å†…å®¹ --&gt;## å…³äºä½œè€…&lt;!-- è¿™é‡Œå†™ä¸Šé¡¹ç›®ä½œè€… --&gt;## è°åœ¨ç”¨(å¯é€‰)&lt;!-- å¯ä»¥åˆ—å‡ºä½¿ç”¨æœ¬é¡¹ç›®çš„å…¶ä»–æœ‰å½±å“åŠ›çš„é¡¹ç›®ï¼Œç®—æ˜¯ç»™é¡¹ç›®æ‰“ä¸ªå¹¿å‘Šå§ --&gt;## è®¸å¯è¯&lt;!-- è¿™é‡Œé“¾æ¥ä¸Šè¯¥é¡¹ç›®çš„å¼€æºè®¸å¯è¯ --&gt;</code></pre><ul><li>é¡¹ç›®æ–‡æ¡£è§„èŒƒï¼šåŒ…æ‹¬ä¸€åˆ‡éœ€è¦æ–‡æ¡£åŒ–çš„å†…å®¹ï¼Œé›†ä¸­æ”¾åœ¨ &#x2F;docs ç›®å½•ä¸‹</li></ul><p>å¸¸ç”¨ç›®å½•ç»“æ„</p><pre><code class="bash">docsâ”œâ”€â”€ devel                            # å¼€å‘æ–‡æ¡£ï¼Œå¯ä»¥æå‰è§„åˆ’å¥½ï¼Œè‹±æ–‡ç‰ˆæ–‡æ¡£å’Œä¸­æ–‡ç‰ˆæ–‡æ¡£â”‚   â”œâ”€â”€ en-US/                       # è‹±æ–‡ç‰ˆæ–‡æ¡£ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ç»„ç»‡æ–‡ä»¶ç»“æ„â”‚   â””â”€â”€ zh-CN                        # ä¸­æ–‡ç‰ˆæ–‡æ¡£ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ç»„ç»‡æ–‡ä»¶ç»“æ„â”‚       â””â”€â”€ development.md           # å¼€å‘æ‰‹å†Œï¼Œå¯ä»¥è¯´æ˜å¦‚ä½•ç¼–è¯‘ã€æ„å»ºã€è¿è¡Œé¡¹ç›®â”œâ”€â”€ guide                            # ç”¨æˆ·æ–‡æ¡£â”‚   â”œâ”€â”€ en-US/                       # è‹±æ–‡ç‰ˆæ–‡æ¡£ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ç»„ç»‡æ–‡ä»¶ç»“æ„â”‚   â””â”€â”€ zh-CN                        # ä¸­æ–‡ç‰ˆæ–‡æ¡£ï¼Œå¯ä»¥æ ¹æ®éœ€è¦ç»„ç»‡æ–‡ä»¶ç»“æ„â”‚       â”œâ”€â”€ api/                     # APIæ–‡æ¡£â”‚       â”œâ”€â”€ best-practice            # æœ€ä½³å®è·µï¼Œå­˜æ”¾ä¸€äº›æ¯”è¾ƒé‡è¦çš„å®è·µæ–‡ç« â”‚       â”‚   â””â”€â”€ authorization.mdâ”‚       â”œâ”€â”€ faq                      # å¸¸è§é—®é¢˜â”‚       â”‚   â”œâ”€â”€ iam-apiserverâ”‚       â”‚   â””â”€â”€ installationâ”‚       â”œâ”€â”€ installation             # å®‰è£…æ–‡æ¡£â”‚       â”‚   â””â”€â”€ installation.mdâ”‚       â”œâ”€â”€ introduction/            # äº§å“ä»‹ç»æ–‡æ¡£â”‚       â”œâ”€â”€ operation-guide          # æ“ä½œæŒ‡å—ï¼Œé‡Œé¢å¯ä»¥æ ¹æ®RESTfulèµ„æºå†åˆ’åˆ†ä¸ºæ›´ç»†çš„å­ç›®å½•ï¼Œç”¨æ¥å­˜æ”¾ç³»ç»Ÿæ ¸å¿ƒ/å…¨éƒ¨åŠŸèƒ½çš„æ“ä½œæ‰‹å†Œâ”‚       â”‚   â”œâ”€â”€ policy.mdâ”‚       â”‚   â”œâ”€â”€ secret.mdâ”‚       â”‚   â””â”€â”€ user.mdâ”‚       â”œâ”€â”€ quickstart               # å¿«é€Ÿå…¥é—¨â”‚       â”‚   â””â”€â”€ quickstart.mdâ”‚       â”œâ”€â”€ README.md                # ç”¨æˆ·æ–‡æ¡£å…¥å£æ–‡ä»¶â”‚       â””â”€â”€ sdk                      # SDKæ–‡æ¡£â”‚           â””â”€â”€ golang.mdâ””â”€â”€ images                           # å›¾ç‰‡å­˜æ”¾ç›®å½•    â””â”€â”€ éƒ¨ç½²æ¶æ„v1.png</code></pre><ul><li><p>å¼€å‘æ–‡æ¡£ï¼šè¯´æ˜é¡¹ç›®çš„å¼€å‘æµç¨‹ï¼Œæ¯”å¦‚å¦‚ä½•æ­å»ºå¼€å‘ç¯å¢ƒã€æ„å»ºäºŒè¿›åˆ¶æ–‡ä»¶ã€æµ‹è¯•ã€éƒ¨ç½²</p><ul><li>API æ¥å£æ–‡æ¡£ï¼šæè¿°ç»„ä»¶æä¾›çš„ API æ¥å£ï¼Œä»¥åŠå¦‚ä½•è°ƒç”¨è¿™äº› API æ¥å£<img src="/2022/10/17/10-go-gui-fan/api.webp" class="" title="æ¥å£æ–‡æ¡£ç¼–å†™æ–¹å¼"></li></ul></li><li><p>ç”¨æˆ·æ–‡æ¡£ï¼šè½¯ä»¶çš„ä½¿ç”¨æ‰‹å†Œ</p></li></ul><h1 id="ç‰ˆæœ¬è§„èŒƒ"><a href="#ç‰ˆæœ¬è§„èŒƒ" class="headerlink" title="ç‰ˆæœ¬è§„èŒƒ"></a>ç‰ˆæœ¬è§„èŒƒ</h1><ol><li>ä¸»ç‰ˆæœ¬å·.æ¬¡ç‰ˆæœ¬å·.ä¿®è®¢å·ï¼ˆX.Y.Zï¼‰ï¼ˆåˆå§‹å€¼ï¼š0.1.0ï¼‰<blockquote><p>Xã€Y å’Œ Z ä¸ºéè´Ÿçš„æ•´æ•°ï¼Œä¸”ç¦æ­¢åœ¨æ•°å­—å‰æ–¹è¡¥é›¶ã€‚<br>ä¸»ç‰ˆæœ¬å·ï¼šå½“åšäº†ä¸å…¼å®¹çš„ API ä¿®æ”¹<br>æ¬¡ç‰ˆæœ¬å·ï¼šå½“åšäº†å‘ä¸‹å…¼å®¹çš„åŠŸèƒ½æ€§æ–°å¢åŠä¿®æ”¹ã€‚è¿™é‡Œæœ‰ä¸ªä¸æˆæ–‡çš„çº¦å®šéœ€è¦ä½ æ³¨æ„ï¼Œå¶æ•°ä¸ºç¨³å®šç‰ˆæœ¬ï¼Œå¥‡æ•°ä¸ºå¼€å‘ç‰ˆæœ¬ã€‚<br>ä¿®è®¢å·ï¼ˆPATCHï¼‰ï¼šå½“åšäº†å‘ä¸‹å…¼å®¹çš„é—®é¢˜ä¿®æ­£</p></blockquote></li><li>æ ‡è®°ç‰ˆæœ¬å·çš„è½¯ä»¶å‘è¡Œåï¼Œç¦æ­¢æ”¹å˜è¯¥ç‰ˆæœ¬è½¯ä»¶çš„å†…å®¹ï¼Œä»»ä½•ä¿®æ”¹éƒ½å¿…é¡»ä»¥æ–°ç‰ˆæœ¬å‘è¡Œ</li><li>1.0.0 çš„ç‰ˆæœ¬å·è¢«ç•Œå®šä¸ºç¬¬ä¸€ä¸ªç¨³å®šç‰ˆæœ¬ï¼Œä¹‹åçš„æ‰€æœ‰ç‰ˆæœ¬å·æ›´æ–°éƒ½åŸºäºè¯¥ç‰ˆæœ¬è¿›è¡Œä¿®æ”¹</li></ol><h2 id="å¸¸ç”¨æ–¹æ³•ï¼š"><a href="#å¸¸ç”¨æ–¹æ³•ï¼š" class="headerlink" title="å¸¸ç”¨æ–¹æ³•ï¼š"></a>å¸¸ç”¨æ–¹æ³•ï¼š</h2><ol><li>åœ¨å®é™…å¼€å‘çš„æ—¶å€™ï¼Œä½¿ç”¨ 0.1.0 ä½œä¸ºç¬¬ä¸€ä¸ªå¼€å‘ç‰ˆæœ¬å·ï¼Œå¹¶åœ¨åç»­çš„æ¯æ¬¡å‘è¡Œæ—¶é€’å¢æ¬¡ç‰ˆæœ¬å·</li><li>å½“æˆ‘ä»¬çš„ç‰ˆæœ¬æ˜¯ä¸€ä¸ªç¨³å®šçš„ç‰ˆæœ¬ï¼Œå¹¶ä¸”ç¬¬ä¸€æ¬¡å¯¹å¤–å‘å¸ƒæ—¶ï¼Œç‰ˆæœ¬å·å¯ä»¥å®šä¸º 1.0.0</li><li>ä¸¥æ ¼æŒ‰ç…§ Angular commit message è§„èŒƒæäº¤ä»£ç æ—¶ï¼Œç‰ˆæœ¬å·å¯ä»¥è¿™ä¹ˆæ¥ç¡®å®šï¼š<ul><li>fix ç±»å‹çš„ commit å¯ä»¥å°†ä¿®è®¢å· +1</li><li>feat ç±»å‹çš„ commit å¯ä»¥å°†æ¬¡ç‰ˆæœ¬å· +1</li><li>å¸¦æœ‰ BREAKING CHANGE çš„ commit å¯ä»¥å°†ä¸»ç‰ˆæœ¬å· +1</li></ul></li></ol><h1 id="commit-è§„èŒƒ"><a href="#commit-è§„èŒƒ" class="headerlink" title="commit è§„èŒƒ"></a>commit è§„èŒƒ</h1><ol><li>æ¯ä¸ª commit çš„å˜æ›´å†…å®¹æ¸…æ™°ï¼Œç¬¦åˆè¯­ä¹‰åŒ–</li><li>å¯ä¾æ® commit message è¿›è¡Œè¿‡æ»¤æŸ¥æ‰¾ <code>git log --oneline --grep &quot;^feat|^fix|^perf&quot;</code></li><li>å¯ä»¥ä¾æ® commit message ç”Ÿæˆ Change Log</li><li>æ ¼å¼è§„èŒƒåŒ–ï¼Œå¯ä»¥ä¾æ®æŸäº›ç±»å‹çš„ Commit Message è§¦å‘æ„å»ºæˆ–è€…å‘å¸ƒæµç¨‹ï¼Œæ¯”å¦‚å½“ type ç±»å‹ä¸º featã€fix æ—¶æ‰è§¦å‘ CI æµç¨‹<img src="/2022/10/17/10-go-gui-fan/commit.webp" class="" title="commitè§„èŒƒ"></li><li>Commit Message è§„èŒƒè‡ªåŠ¨åŒ–</li></ol><blockquote><p>æ³¨æ„:</p><ul><li>æäº¤é¢‘ç‡:<ol><li>åªè¦å¯¹é¡¹ç›®è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¸€é€šè¿‡æµ‹è¯•å°±ç«‹å³ commitï¼Œæ¯”å¦‚ä¿®å¤å®Œä¸€ä¸ª bugã€å¼€å‘å®Œä¸€ä¸ªå°åŠŸèƒ½ï¼Œæˆ–è€…å¼€å‘å®Œä¸€ä¸ªå®Œæ•´çš„åŠŸèƒ½ï¼Œè‡ªæµ‹å’Œå•å…ƒæµ‹è¯•é€šè¿‡åå°±æäº¤</li><li>è§„å®šä¸€ä¸ªæ—¶é—´ï¼Œå®šæœŸæäº¤ã€‚ä¸‹ç­å‰å›ºå®šæäº¤ä¸€æ¬¡ï¼Œå¹¶ä¸”è¦ç¡®ä¿æœ¬åœ°æœªæäº¤çš„ä»£ç ï¼Œå»¶æœŸä¸è¶…è¿‡ 1 å¤©</li></ol></li></ul></blockquote><h1 id="ç›®å½•è§„èŒƒ"><a href="#ç›®å½•è§„èŒƒ" class="headerlink" title="ç›®å½•è§„èŒƒ"></a>ç›®å½•è§„èŒƒ</h1><ol><li>å‘½åæ¸…æ™°ç®€æ´ï¼šèƒ½æ¸…æ™°è¡¨è¾¾å‡ºè¯¥ç›®å½•å®ç°çš„åŠŸèƒ½</li><li>åŠŸèƒ½æ˜ç¡®ï¼šå½“éœ€è¦æ–°å¢ä¸€ä¸ªåŠŸèƒ½æ—¶ï¼Œèƒ½å¤Ÿéå¸¸æ¸…æ¥šåœ°çŸ¥é“æŠŠè¿™ä¸ªåŠŸèƒ½æ”¾åœ¨å“ªä¸ªç›®å½•ä¸‹</li><li>å…¨é¢æ€§ï¼šç›®å½•ç»“æ„åº”è¯¥å°½å¯èƒ½å…¨é¢åœ°åŒ…å«ç ”å‘è¿‡ç¨‹ä¸­éœ€è¦çš„åŠŸèƒ½ï¼Œä¾‹å¦‚æ–‡æ¡£ã€è„šæœ¬ã€æºç ç®¡ç†ã€API å®ç°ã€å·¥å…·ã€ç¬¬ä¸‰æ–¹åŒ…ã€æµ‹è¯•ã€ç¼–è¯‘äº§ç‰©ç­‰ã€‚</li><li>å¯é¢„æµ‹æ€§ï¼šé¡¹ç›®è§„æ¨¡ä¸€å®šæ˜¯ä»å°åˆ°å¤§çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªå¥½çš„ç›®å½•ç»“æ„åº”è¯¥èƒ½å¤Ÿåœ¨é¡¹ç›®å˜å¤§æ—¶ï¼Œä»ç„¶ä¿æŒä¹‹å‰çš„ç›®å½•ç»“æ„ã€‚</li><li>å¯æ‰©å±•æ€§ï¼šæ¯ä¸ªç›®å½•ä¸‹å­˜æ”¾äº†åŒç±»çš„åŠŸèƒ½ï¼Œåœ¨é¡¹ç›®å˜å¤§æ—¶ï¼Œè¿™äº›ç›®å½•åº”è¯¥å¯ä»¥å­˜æ”¾æ›´å¤šåŒç±»åŠŸèƒ½</li></ol><h1 id="ç›®å½•è¯¦è§£"><a href="#ç›®å½•è¯¦è§£" class="headerlink" title="ç›®å½•è¯¦è§£"></a>ç›®å½•è¯¦è§£</h1><img src="/2022/10/17/10-go-gui-fan/dir.webp" class="" title="ç›®å½•"><h2 id="Go-åº”ç”¨-å‰åç«¯ä»£ç ï¼š"><a href="#Go-åº”ç”¨-å‰åç«¯ä»£ç ï¼š" class="headerlink" title="Go åº”ç”¨-å‰åç«¯ä»£ç ï¼š"></a>Go åº”ç”¨-å‰åç«¯ä»£ç ï¼š</h2><ul><li><p>&#x2F;cmd<br>ä¸€ä¸ªé¡¹ç›®æœ‰å¾ˆå¤šç»„ä»¶ï¼Œå¯ä»¥æŠŠç»„ä»¶ main å‡½æ•°æ‰€åœ¨çš„æ–‡ä»¶å¤¹ç»Ÿä¸€æ”¾åœ¨&#x2F;cmd ç›®å½•ä¸‹ï¼Œéœ€è¦ä¿è¯</p><ol><li>æ¯ä¸ªç»„ä»¶çš„ç›®å½•ååº”è¯¥è·Ÿä½ æœŸæœ›çš„å¯æ‰§è¡Œæ–‡ä»¶åæ˜¯ä¸€è‡´çš„</li><li>ä¿è¯ &#x2F;cmd&#x2F;&lt;ç»„ä»¶å&gt; ç›®å½•ä¸‹ä¸è¦å­˜æ”¾å¤ªå¤šçš„ä»£ç ï¼Œå¦‚æœä½ è®¤ä¸ºä»£ç å¯ä»¥å¯¼å…¥å¹¶åœ¨å…¶ä»–é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œé‚£ä¹ˆå®ƒåº”è¯¥ä½äº &#x2F;pkg ç›®å½•ä¸­</li><li>å¦‚æœä»£ç ä¸æ˜¯å¯é‡ç”¨çš„ï¼Œæˆ–è€…ä½ ä¸å¸Œæœ›å…¶ä»–äººé‡ç”¨å®ƒï¼Œè¯·å°†è¯¥ä»£ç æ”¾åˆ° &#x2F;internal ç›®å½•ä¸­</li></ol></li><li><p>&#x2F;internal<br>å­˜æ”¾ç§æœ‰åº”ç”¨å’Œåº“ä»£ç ã€‚å¦‚æœä¸€äº›ä»£ç ï¼Œä½ ä¸å¸Œæœ›åœ¨å…¶ä»–åº”ç”¨å’Œåº“ä¸­è¢«å¯¼å…¥ï¼Œå¯ä»¥å°†è¿™éƒ¨åˆ†ä»£ç æ”¾åœ¨&#x2F;internal ç›®å½•ä¸‹.</p><blockquote><p>åœ¨å¼•å…¥å…¶å®ƒé¡¹ç›® internal ä¸‹çš„åŒ…æ—¶ï¼ŒGo è¯­è¨€ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™</p></blockquote><ul><li><p>&#x2F;internal&#x2F;appName<br>å­˜æ”¾çœŸå®çš„åº”ç”¨ä»£ç ï¼Œåº”ç”¨çš„å…±äº«ä»£ç å­˜æ”¾åœ¨&#x2F;- internal&#x2F;pkg ä¸­</p><ul><li>&#x2F;internal&#x2F;appName&#x2F;api&#x2F;v1:HTTP API æ¥å£çš„å…·ä½“å®ç°</li><li>&#x2F;internal&#x2F;appName&#x2F;options:åº”ç”¨çš„ command flag</li><li>&#x2F;internal&#x2F;appName&#x2F;configï¼šæ ¹æ®å‘½ä»¤è¡Œå‚æ•°åˆ›å»ºåº”ç”¨é…ç½®</li><li>&#x2F;internal&#x2F;appName&#x2F;serviceï¼šå­˜æ”¾åº”ç”¨å¤æ‚ä¸šåŠ¡å¤„ç†ä»£ç </li><li>&#x2F;internal&#x2F;appName&#x2F;store&#x2F;mysqlï¼šä¸€ä¸ªåº”ç”¨å¯èƒ½è¦æŒä¹…åŒ–çš„å­˜å‚¨ä¸€äº›æ•°æ®ï¼Œè¿™é‡Œä¸»è¦å­˜æ”¾è·Ÿæ•°æ®åº“äº¤äº’çš„ä»£ç ï¼Œæ¯”å¦‚ Createã€Updateã€Deleteã€Getã€List ç­‰</li></ul></li><li><p>&#x2F;internal&#x2F;pkg<br>å­˜æ”¾é¡¹ç›®å†…å¯å…±äº«ï¼Œé¡¹ç›®å¤–ä¸å…±äº«çš„åŒ…ã€‚è¿™äº›åŒ…æä¾›äº†æ¯”è¾ƒåŸºç¡€ã€é€šç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚å·¥å…·ã€é”™è¯¯ç ã€ç”¨æˆ·éªŒè¯ç­‰åŠŸèƒ½ã€‚</p><ul><li>&#x2F;internal&#x2F;pkg&#x2F;codeï¼šé¡¹ç›®ä¸šåŠ¡ Code ç </li><li>&#x2F;internal&#x2F;pkg&#x2F;validationï¼šä¸€äº›é€šç”¨çš„éªŒè¯å‡½æ•°</li><li>&#x2F;internal&#x2F;pkg&#x2F;middlewareï¼šHTTP å¤„ç†é“¾</li></ul></li></ul></li><li><p>&#x2F;pkg<br>å­˜æ”¾å¯ä»¥è¢«å¤–éƒ¨åº”ç”¨ä½¿ç”¨çš„ä»£ç åº“ï¼Œå…¶ä»–é¡¹ç›®å¯ä»¥ç›´æ¥é€šè¿‡ import å¯¼å…¥è¿™é‡Œçš„ä»£ç </p></li><li><p>&#x2F;vendor<br>å¯é€šè¿‡ <code>go mod vendor</code> åˆ›å»º</p></li><li><p>&#x2F;third_party<br>å¤–éƒ¨å¸®åŠ©å·¥å…·ï¼Œåˆ†æ”¯ä»£ç æˆ–å…¶ä»–ç¬¬ä¸‰æ–¹åº”ç”¨ï¼ˆä¾‹å¦‚ Swagger UIï¼‰</p></li></ul><hr><h2 id="Go-åº”ç”¨-æµ‹è¯•ç›¸å…³ï¼š"><a href="#Go-åº”ç”¨-æµ‹è¯•ç›¸å…³ï¼š" class="headerlink" title="Go åº”ç”¨-æµ‹è¯•ç›¸å…³ï¼š"></a>Go åº”ç”¨-æµ‹è¯•ç›¸å…³ï¼š</h2><ul><li>&#x2F;test<br>æµ‹è¯•ç›¸å…³ä»£ç </li></ul><hr><h2 id="Go-åº”ç”¨-éƒ¨ç½²ç›¸å…³ï¼š"><a href="#Go-åº”ç”¨-éƒ¨ç½²ç›¸å…³ï¼š" class="headerlink" title="Go åº”ç”¨-éƒ¨ç½²ç›¸å…³ï¼š"></a>Go åº”ç”¨-éƒ¨ç½²ç›¸å…³ï¼š</h2><ul><li><p>&#x2F;configs<br>è¿™ä¸ªç›®å½•ç”¨æ¥é…ç½®æ–‡ä»¶æ¨¡æ¿æˆ–é»˜è®¤é…ç½®ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥åœ¨è¿™é‡Œå­˜æ”¾ confd æˆ– consul-template æ¨¡æ¿æ–‡ä»¶ã€‚è¿™é‡Œæœ‰ä¸€ç‚¹è¦æ³¨æ„ï¼Œé…ç½®ä¸­ä¸èƒ½æºå¸¦æ•æ„Ÿä¿¡æ¯ï¼Œè¿™äº›æ•æ„Ÿä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å ä½ç¬¦æ¥æ›¿ä»£</p></li><li><p>&#x2F;deployments<br>ç”¨æ¥å­˜æ”¾ Iaasã€PaaS ç³»ç»Ÿå’Œå®¹å™¨ç¼–æ’éƒ¨ç½²é…ç½®å’Œæ¨¡æ¿ï¼ˆDocker-Composeï¼ŒKubernetes&#x2F;Helmï¼ŒMesosï¼ŒTerraformï¼ŒBoshï¼‰ã€‚åœ¨ä¸€äº›é¡¹ç›®ï¼Œç‰¹åˆ«æ˜¯ç”¨ Kubernetes éƒ¨ç½²çš„é¡¹ç›®ä¸­ï¼Œè¿™ä¸ªç›®å½•å¯èƒ½å‘½åä¸º deployã€‚</p></li><li><p>&#x2F;init<br>å­˜æ”¾åˆå§‹åŒ–ç³»ç»Ÿï¼ˆsystemdï¼Œupstartï¼Œsysvï¼‰å’Œè¿›ç¨‹ç®¡ç†é…ç½®æ–‡ä»¶ï¼ˆrunitï¼Œsupervisordï¼‰ã€‚æ¯”å¦‚ sysemd çš„ unit æ–‡ä»¶ã€‚è¿™ç±»æ–‡ä»¶ï¼Œåœ¨éå®¹å™¨åŒ–éƒ¨ç½²çš„é¡¹ç›®ä¸­ä¼šç”¨åˆ°ã€‚</p><hr></li></ul><h2 id="é¡¹ç›®ç®¡ç†"><a href="#é¡¹ç›®ç®¡ç†" class="headerlink" title="é¡¹ç›®ç®¡ç†"></a>é¡¹ç›®ç®¡ç†</h2><ul><li>&#x2F;Makefile<br>é¡¹ç›®ç®¡ç†,format -&gt; lint -&gt; test -&gt; build</li><li>&#x2F;scripts<br>è¯¥ç›®å½•ä¸»è¦ç”¨æ¥å­˜æ”¾è„šæœ¬æ–‡ä»¶ï¼Œå®ç°æ„å»ºã€å®‰è£…ã€åˆ†æç­‰ä¸åŒåŠŸèƒ½<ul><li>&#x2F;scripts&#x2F;make-rules<br>ç”¨æ¥å­˜æ”¾ makefile æ–‡ä»¶ï¼Œå®ç° &#x2F;Makefile æ–‡ä»¶ä¸­çš„å„ä¸ªåŠŸ</li><li>&#x2F;scripts&#x2F;lib<br>shell åº“ï¼Œç”¨æ¥å­˜æ”¾ shell è„šæœ¬ã€‚ä¸€ä¸ªå¤§å‹é¡¹ç›®ä¸­æœ‰å¾ˆå¤šè‡ªåŠ¨åŒ–ä»»åŠ¡ï¼Œæ¯”å¦‚å‘å¸ƒã€æ›´æ–°æ–‡æ¡£ã€ç”Ÿæˆä»£ç ç­‰</li><li>&#x2F;scripts&#x2F;install<br>å¦‚æœé¡¹ç›®æ”¯æŒè‡ªåŠ¨åŒ–éƒ¨ç½²ï¼Œå¯ä»¥å°†è‡ªåŠ¨åŒ–éƒ¨ç½²è„šæœ¬æ”¾åœ¨æ­¤ç›®å½•ä¸‹ã€‚å¦‚æœéƒ¨ç½²è„šæœ¬ç®€å•ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ”¾åœ¨ &#x2F;scripts ç›®å½•ä¸‹ã€‚</li></ul></li><li>&#x2F;build<br>è¿™é‡Œå­˜æ”¾å®‰è£…åŒ…å’ŒæŒç»­é›†æˆç›¸å…³çš„æ–‡ä»¶ã€‚<ul><li>&#x2F;build&#x2F;packageï¼šå­˜æ”¾å®¹å™¨ï¼ˆDockerï¼‰ã€ç³»ç»Ÿï¼ˆdeb, rpm, pkgï¼‰çš„åŒ…é…ç½®å’Œè„šæœ¬ã€‚</li><li>&#x2F;build&#x2F;ciï¼šå­˜æ”¾ CIï¼ˆtravisï¼Œcircleï¼Œdroneï¼‰çš„é…ç½®æ–‡ä»¶å’Œè„šæœ¬ã€‚</li><li>&#x2F;build&#x2F;dockerï¼šå­˜æ”¾å­é¡¹ç›®å„ä¸ªç»„ä»¶çš„ Dockerfile æ–‡ä»¶</li></ul></li><li>&#x2F;tools<br>å­˜æ”¾è¿™ä¸ªé¡¹ç›®çš„æ”¯æŒå·¥å…·ã€‚è¿™äº›å·¥å…·å¯å¯¼å…¥æ¥è‡ª &#x2F;pkg å’Œ &#x2F;internal ç›®å½•çš„ä»£ç </li><li>&#x2F;githooks<br>Git é’©å­ã€‚æ¯”å¦‚ï¼Œæˆ‘ä»¬å¯ä»¥å°† commit-msg å­˜æ”¾åœ¨è¯¥ç›®å½•</li><li>&#x2F;assets<br>é™æ€èµ„æº</li><li>&#x2F;website<br>æ”¾ç½®é¡¹ç›®ç½‘ç«™ç›¸å…³çš„æ•°æ®</li></ul><hr><h2 id="æ–‡æ¡£ï¼š"><a href="#æ–‡æ¡£ï¼š" class="headerlink" title="æ–‡æ¡£ï¼š"></a>æ–‡æ¡£ï¼š</h2><ul><li>&#x2F;README.md</li><li>&#x2F;docs<ul><li>&#x2F;docs&#x2F;develï¼šå­˜æ”¾å¼€å‘æ–‡æ¡£ã€hack æ–‡æ¡£ç­‰ã€‚</li><li>&#x2F;docs&#x2F;guide: å­˜æ”¾ç”¨æˆ·æ‰‹å†Œï¼Œå®‰è£…ã€quickstartã€äº§å“æ–‡æ¡£ç­‰ï¼Œåˆ†ä¸ºä¸­æ–‡æ–‡æ¡£å’Œè‹±æ–‡æ–‡æ¡£ã€‚</li><li>&#x2F;docs&#x2F;imagesï¼šå­˜æ”¾å›¾ç‰‡æ–‡ä»¶</li></ul></li><li>&#x2F;api<br>å­˜æ”¾çš„æ˜¯å½“å‰é¡¹ç›®å¯¹å¤–æä¾›çš„å„ç§ä¸åŒç±»å‹çš„ API æ¥å£å®šä¹‰æ–‡ä»¶</li><li>&#x2F;examples<br>å­˜æ”¾åº”ç”¨ç¨‹åºæˆ–è€…å…¬å…±åŒ…çš„ç¤ºä¾‹ä»£ç ã€‚è¿™äº›ç¤ºä¾‹ä»£ç å¯ä»¥é™ä½ä½¿ç”¨è€…çš„ä¸Šæ‰‹é—¨æ§›</li></ul><hr><h2 id="åŸºç¡€ç›®å½•ç»“æ„"><a href="#åŸºç¡€ç›®å½•ç»“æ„" class="headerlink" title="åŸºç¡€ç›®å½•ç»“æ„"></a>åŸºç¡€ç›®å½•ç»“æ„</h2><pre><code class="bash">$ tree --noreport -L 2 tmstmsâ”œâ”€â”€ cmdâ”œâ”€â”€ internalâ”œâ”€â”€ pkgâ””â”€â”€ README.md</code></pre><p>[æ³¨]åœ¨è®¾è®¡ç›®å½•ç»“æ„æ—¶ï¼Œä¸€äº›ç©ºç›®å½•æ— æ³•æäº¤åˆ° Git ä»“åº“ä¸­ï¼Œä½†æˆ‘ä»¬åˆæƒ³å°†è¿™ä¸ªç©ºç›®å½•ä¸Šä¼ åˆ° Git ä»“åº“ä¸­ï¼Œä»¥ä¿ç•™ç›®å½•ç»“æ„ã€‚è¿™æ—¶å€™ï¼Œå¯ä»¥åœ¨ç©ºç›®å½•ä¸‹åŠ ä¸€ä¸ª .keep æ–‡ä»¶</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>09-go-å¹¶å‘</title>
      <link href="/2022/10/17/09-go-bing-fa/"/>
      <url>/2022/10/17/09-go-bing-fa/</url>
      
        <content type="html"><![CDATA[<p>å¼€å¯æ–¹æ³•ï¼šé€šè¿‡ go å…³é”®å­—æ¥å¼€å¯ goroutine <code>go å‡½æ•°å( å‚æ•°åˆ—è¡¨ )</code></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>08-go-é”™è¯¯å¤„ç†</title>
      <link href="/2022/10/17/08-go-cuo-wu-chu-li/"/>
      <url>/2022/10/17/08-go-cuo-wu-chu-li/</url>
      
        <content type="html"><![CDATA[<p>goLang å†…éƒ¨é”™è¯¯å¤„ç†<br>æ–¹æ³•ï¼šå‡½æ•°é€šå¸¸åœ¨æœ€åçš„è¿”å›å€¼ä¸­è¿”å›é”™è¯¯ä¿¡æ¯ã€‚ä½¿ç”¨ errors.New å¯è¿”å›ä¸€ä¸ªé”™è¯¯ä¿¡æ¯</p><pre><code class="go">type DivideError struct &#123;    dividee int    divider int&#125;func (de *DivideError) Error() string &#123;    strFormat := `    Cannot proceed, the divider is zero.    dividee: %d    divider: 0    `    return fmt.Sprintf(strFormat, de.dividee)&#125;// å®šä¹‰ `int` ç±»å‹é™¤æ³•è¿ç®—çš„å‡½æ•°func Divide(varDividee int, varDivider int) (result int, errorMsg string) &#123;    if varDivider == 0 &#123;        dData := DivideError&#123;            dividee: varDividee,            divider: varDivider,        &#125;        errorMsg = dData.Error()        return    &#125; else &#123;        return varDividee / varDivider, &quot;&quot;    &#125;&#125;func TestError() &#123;    // æ­£å¸¸æƒ…å†µ    if result, errorMsg := Divide(100, 10); errorMsg == &quot;&quot; &#123;        fmt.Println(&quot;100/10 = &quot;, result)    &#125;    // å½“é™¤æ•°ä¸ºé›¶çš„æ—¶å€™ä¼šè¿”å›é”™è¯¯ä¿¡æ¯    if _, errorMsg := Divide(100, 0); errorMsg != &quot;&quot; &#123;        fmt.Println(&quot;errorMsg is: &quot;, errorMsg)    &#125;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>07-go-é€’å½’å’Œç±»å‹è½¬æ¢</title>
      <link href="/2022/10/17/07-go-di-gui-he-lei-xing-zhuan-huan/"/>
      <url>/2022/10/17/07-go-di-gui-he-lei-xing-zhuan-huan/</url>
      
        <content type="html"><![CDATA[<h2 id="é€’å½’"><a href="#é€’å½’" class="headerlink" title="é€’å½’"></a>é€’å½’</h2><p>é€’å½’çš„æ¦‚å¿µï¼šåœ¨è¿è¡Œçš„è¿‡ç¨‹ä¸­è°ƒç”¨è‡ªå·±<br>é€’å½’çš„ç”¨æ³•ï¼šåœ¨ä½¿ç”¨é€’å½’æ—¶ï¼Œå¼€å‘è€…éœ€è¦è®¾ç½®é€€å‡ºæ¡ä»¶ï¼Œå¦åˆ™é€’å½’å°†é™·å…¥æ— é™å¾ªç¯ä¸­</p><pre><code class="go">func recursion() &#123;   recursion() /* å‡½æ•°è°ƒç”¨è‡ªèº« */&#125;func main() &#123;   recursion()&#125;</code></pre><h2 id="ç±»å‹è½¬æ¢"><a href="#ç±»å‹è½¬æ¢" class="headerlink" title="ç±»å‹è½¬æ¢"></a>ç±»å‹è½¬æ¢</h2><p>æ ¼å¼ï¼šç±»å‹åç§°(è¡¨è¾¾å¼)<br>æ³¨æ„ï¼šä¸æ”¯æŒéšå¼è½¬æ¢ç±»å‹</p><h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p>å®šä¹‰ï¼šæŠŠæ‰€æœ‰çš„å…·æœ‰å…±æ€§çš„æ–¹æ³•å®šä¹‰åœ¨ä¸€èµ·ï¼Œä»»ä½•å…¶ä»–ç±»å‹åªè¦å®ç°äº†è¿™äº›æ–¹æ³•å°±æ˜¯å®ç°äº†è¿™ä¸ªæ¥å£</p><pre><code class="go">/* å®šä¹‰æ¥å£ */type æ¥å£åç§° interface &#123;   æ–¹æ³•å1 [è¿”å›ç±»å‹]   ...   æ–¹æ³•ån [è¿”å›ç±»å‹]&#125;/* å®šä¹‰ç»“æ„ä½“ */type ç»“æ„ä½“åç§° struct &#123;   /* variables */&#125;/* å®ç°æ¥å£æ–¹æ³• */func (struct_name_variable ç»“æ„ä½“åç§°)  æ–¹æ³•å1 () [è¿”å›ç±»å‹] &#123;   /* æ–¹æ³•å®ç° */&#125;...func (struct_name_variable ç»“æ„ä½“åç§°) æ–¹æ³•ån() [è¿”å›ç±»å‹] &#123;   /* æ–¹æ³•å®ç°*/&#125;</code></pre><h3 id="å…·ä½“æ¡ˆä¾‹"><a href="#å…·ä½“æ¡ˆä¾‹" class="headerlink" title="å…·ä½“æ¡ˆä¾‹"></a>å…·ä½“æ¡ˆä¾‹</h3><pre><code class="go">type Phone interface &#123;    call()&#125;type NokiaPhone struct &#123;&#125;type IPhone struct &#123;&#125;func (nokiaPhone NokiaPhone) call() &#123;    fmt.Println(&quot;I am Nokia, I can call you!&quot;)&#125;func (iPhone IPhone) call() &#123;    fmt.Println(&quot;I am iPhone, I can call you!&quot;)&#125;func TestInterface() &#123;    var phone Phone    phone = new(NokiaPhone)    phone.call()    phone = new(IPhone)    phone.call()&#125;/**I am Nokia, I can call you!I am iPhone, I can call you! */</code></pre><pre><code class="go">type MobilePhone interface &#123;    call()    call2()&#125;type ApplePhone struct &#123;    id            int    name          string    category_id   int    category_name string&#125;func (test ApplePhone) call() &#123;    fmt.Println(&quot;è¿™æ˜¯ç¬¬ä¸€ä¸ªç±»çš„ç¬¬ä¸€ä¸ªæ¥å£å›è°ƒå‡½æ•° ç»“æ„ä½“æ•°æ®ï¼š&quot;, ApplePhone&#123;id: 1, name: &quot;æµ…ç¬‘&quot;&#125;)&#125;func (test ApplePhone) call2() &#123;    fmt.Println(&quot;è¿™æ˜¯ä¸€ä¸ªç±»çš„ç¬¬äºŒä¸ªæ¥å£å›è°ƒå‡½æ•°call2&quot;, ApplePhone&#123;id: 1, name: &quot;æµ…ç¬‘&quot;, category_id: 4, category_name: &quot;åˆ†ç±»åç§°&quot;&#125;)&#125;type Android struct &#123;    member_id       int    member_balance  float32    member_sex      bool    member_nickname string&#125;func (test Android) call() &#123;    fmt.Println(&quot;è¿™æ˜¯ç¬¬äºŒä¸ªç±»çš„ç¬¬ä¸€ä¸ªæ¥å£å›è°ƒå‡½æ•°call&quot;, Android&#123;member_id: 22, member_balance: 15.23, member_sex: false, member_nickname: &quot;æµ…ç¬‘18&quot;&#125;)&#125;func (test Android) call2() &#123;    fmt.Println(&quot;è¿™æ˜¯ç¬¬äºŒä¸ªç±»çš„ç¬¬äºŒä¸ªæ¥å£å›è°ƒå‡½æ•°call2&quot;, Android&#123;member_id: 44, member_balance: 100, member_sex: true, member_nickname: &quot;é™ˆè¶…&quot;&#125;)&#125;func TestInterfaceDemo() &#123;    var phoneD MobilePhone    phoneD = new(ApplePhone)    phoneD.call()    phoneD.call2()    phoneD = new(Android)    phoneD.call()    phoneD.call2()&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>06-goæ•°ç»„</title>
      <link href="/2022/10/14/06-go-shu-zu/"/>
      <url>/2022/10/14/06-go-shu-zu/</url>
      
        <content type="html"><![CDATA[<h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><h3 id="å®šä¹‰ï¼š"><a href="#å®šä¹‰ï¼š" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h3><p>å…·æœ‰<font color=red>ç›¸åŒå”¯ä¸€ç±»å‹</font>ï¼ˆåŸå§‹ç±»å‹&#x2F;è‡ªå®šä¹‰ç±»å‹ï¼‰çš„ä¸€ç»„å·²ç¼–å·ä¸”<font color=red>é•¿åº¦å›ºå®š</font>çš„æ•°æ®é¡¹åºåˆ—</p><h3 id="å£°æ˜ï¼š"><a href="#å£°æ˜ï¼š" class="headerlink" title="å£°æ˜ï¼š"></a>å£°æ˜ï¼š</h3><ul><li>ä¸€ç»´æ•°ç»„ï¼švar balance [10] float32</li><li>äºŒç»´æ•°ç»„ï¼švar arrayName [ x ][ y ] float32</li></ul><h3 id="åˆå§‹åŒ–ï¼š"><a href="#åˆå§‹åŒ–ï¼š" class="headerlink" title="åˆå§‹åŒ–ï¼š"></a>åˆå§‹åŒ–ï¼š</h3><h4 id="ä¸€ç»´æ•°ç»„"><a href="#ä¸€ç»´æ•°ç»„" class="headerlink" title="ä¸€ç»´æ•°ç»„"></a>ä¸€ç»´æ•°ç»„</h4><ul><li><code>balance := [5]float32&#123;1000.0, 2.0, 3.4, 7.0, 50.0&#125;</code></li><li>å¦‚æœæ•°ç»„é•¿åº¦ä¸ç¡®å®šï¼Œå¯ä»¥ä½¿ç”¨ â€¦ ä»£æ›¿æ•°ç»„çš„é•¿åº¦ï¼Œç¼–è¯‘å™¨ä¼šæ ¹æ®å…ƒç´ ä¸ªæ•°è‡ªè¡Œæ¨æ–­æ•°ç»„çš„é•¿åº¦</li><li>é€šè¿‡æŒ‡å®šä¸‹æ ‡åˆå§‹åŒ–å…ƒç´ ï¼š<code>balance := [5]float32&#123;1:2.0,3:7.0&#125;</code><blockquote><p>â€¦æ˜¯goçš„è¯­æ³•ç³–ï¼Œæœ‰ä¸¤ç§ç”¨å¤„ï¼š</p><ol><li>ç”¨äºå‡½æ•°æœ‰å¤šä¸ªä¸å®šå‚æ•°çš„æƒ…å†µï¼Œå¯ä»¥æ¥å—å¤šä¸ªä¸ç¡®å®šæ•°é‡çš„å‚æ•°</li><li>åˆ‡ç‰‡å¯ä»¥æ‰“æ•£è¿›è¡Œä¼ é€’</li></ol></blockquote></li></ul><pre><code class="go">func test1(args ...string) &#123; //ç”¨æ³•1    for _, v:= range args&#123;        fmt.Println(v)    &#125;&#125;func main()&#123;    var strss= []string&#123;        &quot;qwr&quot;,        &quot;234&quot;,        &quot;yui&quot;,        &quot;cvbc&quot;,    &#125;    test1(strss...) //ç”¨æ³•2&#125;</code></pre><h4 id="äºŒç»´æ•°ç»„"><a href="#äºŒç»´æ•°ç»„" class="headerlink" title="äºŒç»´æ•°ç»„"></a>äºŒç»´æ•°ç»„</h4><pre><code class="go">a := [3][4]int&#123; &#123;0, 1, 2, 3&#125; ,   /*  ç¬¬ä¸€è¡Œç´¢å¼•ä¸º 0 */ &#123;4, 5, 6, 7&#125; ,   /*  ç¬¬äºŒè¡Œç´¢å¼•ä¸º 1 */ &#123;8, 9, 10, 11&#125;,   /* ç¬¬ä¸‰è¡Œç´¢å¼•ä¸º 2 */&#125;</code></pre><h3 id="è®¿é—®æ•°ç»„å…ƒç´ ï¼š"><a href="#è®¿é—®æ•°ç»„å…ƒç´ ï¼š" class="headerlink" title="è®¿é—®æ•°ç»„å…ƒç´ ï¼š"></a>è®¿é—®æ•°ç»„å…ƒç´ ï¼š</h3><p>æ–¹æ³•ï¼šé€šè¿‡ç´¢å¼•æœªçŸ¥æ¥è¯»å–ï¼Œ<code>var salary float32 = balance[9]</code></p><h2 id="æŒ‡é’ˆ"><a href="#æŒ‡é’ˆ" class="headerlink" title="æŒ‡é’ˆ"></a>æŒ‡é’ˆ</h2><p>å–åœ°å€ç¬¦ï¼š&amp;<br>ä¸€ä¸ªæŒ‡é’ˆå˜é‡æŒ‡å‘äº†ä¸€ä¸ªå€¼çš„å†…å­˜åœ°å€</p><h3 id="ä½¿ç”¨æµç¨‹"><a href="#ä½¿ç”¨æµç¨‹" class="headerlink" title="ä½¿ç”¨æµç¨‹"></a>ä½¿ç”¨æµç¨‹</h3><ul><li>å®šä¹‰æŒ‡é’ˆå˜é‡ã€‚</li><li>ä¸ºæŒ‡é’ˆå˜é‡èµ‹å€¼ã€‚</li><li>è®¿é—®æŒ‡é’ˆå˜é‡ä¸­æŒ‡å‘åœ°å€çš„å€¼ã€‚</li></ul><pre><code class="go">func main() &#123;    var a int = 20    var ip *int //å£°æ˜æŒ‡é’ˆï¼ŒæŒ‡é’ˆå˜é‡æŒ‡å‘äº†ä¸€ä¸ªå€¼çš„å†…å­˜åœ°å€    ip = &amp;a     //å¯¹æŒ‡é’ˆå˜é‡èµ‹å€¼    fmt.Printf(&quot;aå˜é‡çš„åœ°å€æ˜¯:%x\n&quot;, &amp;a)    fmt.Printf(&quot;ip å˜é‡å­˜å‚¨çš„æŒ‡é’ˆåœ°å€:%x\n&quot;, ip)    fmt.Printf(&quot;*ip å˜é‡çš„å€¼: %v\n&quot;, *ip)&#125;// è¾“å‡ºç»“æœï¼š===========// aå˜é‡çš„åœ°å€æ˜¯:c00001c030// ip å˜é‡å­˜å‚¨çš„æŒ‡é’ˆåœ°å€:c00001c030// *ip å˜é‡çš„å€¼: 20</code></pre><h3 id="ç©ºæŒ‡é’ˆ-nil"><a href="#ç©ºæŒ‡é’ˆ-nil" class="headerlink" title="ç©ºæŒ‡é’ˆ nil"></a>ç©ºæŒ‡é’ˆ <code>nil</code></h3><h3 id="æŒ‡é’ˆæ•°ç»„var-ptr-MAX-int"><a href="#æŒ‡é’ˆæ•°ç»„var-ptr-MAX-int" class="headerlink" title="æŒ‡é’ˆæ•°ç»„var ptr [MAX]*int;"></a>æŒ‡é’ˆæ•°ç»„<code>var ptr [MAX]*int;</code></h3><pre><code class="go">const MAX int = 3func main() &#123;    var ptr [MAX]*int//å£°æ˜äº†æ•´å‹æŒ‡é’ˆæ•°ç»„    a := []int&#123;10, 100, 200&#125;    var i int    for i = 0; i &lt; MAX; i++ &#123;        ptr[i] = &amp;a[i]    &#125;    for i = 0; i &lt; MAX; i++ &#123;        fmt.Printf(&quot;a[%d]=%d\n&quot;, i, *ptr[i])    &#125;&#125;// è¾“å‡ºç»“æœ:=============// a[0]=10// a[1]=100// a[2]=200</code></pre><h3 id="æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ"><a href="#æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ" class="headerlink" title="æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ"></a>æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆ</h3><pre><code class="go">func main() &#123;    var a int    var ptr *int    var pptr **int    a = 3000    ptr = &amp;a    pptr = &amp;ptr    fmt.Printf(&quot;å˜é‡a=%d\n&quot;, a)    fmt.Printf(&quot;æŒ‡é’ˆå˜é‡ *ptr=%d\n&quot;, *ptr)    fmt.Printf(&quot;æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆå˜é‡ **pptr = %d\n&quot;, **pptr)    fmt.Printf(&quot;å˜é‡açš„åœ°å€æ˜¯:%v\n&quot;, &amp;a)    fmt.Printf(&quot;æŒ‡é’ˆptrçš„å€¼ä¸º:%v\n&quot;, ptr)    fmt.Printf(&quot;æŒ‡é’ˆptrçš„åœ°å€æ˜¯:%v\n&quot;, &amp;ptr)    fmt.Printf(&quot;æŒ‡é’ˆpptrçš„å€¼ä¸º:%v\n&quot;, pptr)&#125;//è¾“å‡ºç»“æœ================// å˜é‡a=3000// æŒ‡é’ˆå˜é‡ *ptr=3000// æŒ‡å‘æŒ‡é’ˆçš„æŒ‡é’ˆå˜é‡ **pptr = 3000// å˜é‡açš„åœ°å€æ˜¯:0xc0000b2000// æŒ‡é’ˆptrçš„å€¼ä¸º:0xc0000b2000// æŒ‡é’ˆptrçš„åœ°å€æ˜¯:0xc0000ac018// æŒ‡é’ˆpptrçš„å€¼ä¸º:0xc0000ac018</code></pre><h3 id="æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å‚æ•°ä½¿ç”¨"><a href="#æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å‚æ•°ä½¿ç”¨" class="headerlink" title="æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å‚æ•°ä½¿ç”¨"></a>æŒ‡é’ˆä½œä¸ºå‡½æ•°çš„å‚æ•°ä½¿ç”¨</h3><p>å¯ä½¿ç”¨å‰æ:éœ€è¦åœ¨å‡½æ•°å®šä¹‰çš„å‚æ•°ä¸Šè®¾ç½®ä¸ºæŒ‡é’ˆç±»å‹</p><pre><code class="go">func main() &#123;    var a int = 100    var b int = 200    fmt.Printf(&quot;äº¤æ¢å‰ a çš„å€¼ : %d\n&quot;, a)    fmt.Printf(&quot;äº¤æ¢å‰ b çš„å€¼ : %d\n&quot;, b)    fmt.Printf(&quot;äº¤æ¢å‰ a çš„åœ°å€ : %v\n&quot;, &amp;a)    fmt.Printf(&quot;äº¤æ¢å‰ b çš„åœ°å€ : %v\n&quot;, &amp;b)    swap(&amp;a, &amp;b)    fmt.Printf(&quot;äº¤æ¢å a çš„å€¼ : %d\n&quot;, a)    fmt.Printf(&quot;äº¤æ¢å b çš„å€¼ : %d\n&quot;, b)    fmt.Printf(&quot;äº¤æ¢å a çš„åœ°å€ : %v\n&quot;, &amp;a)    fmt.Printf(&quot;äº¤æ¢å b çš„åœ°å€ : %v\n&quot;, &amp;b)&#125;func swap(x *int, y *int) &#123;    var temp int    temp = *x    *x = *y    *y = temp&#125;// è¾“å‡ºç»“æœ// äº¤æ¢å‰ a çš„å€¼ : 100// äº¤æ¢å‰ b çš„å€¼ : 200// äº¤æ¢å‰ a çš„åœ°å€ : 0xc00001c030// äº¤æ¢å‰ b çš„åœ°å€ : 0xc00001c038// äº¤æ¢å a çš„å€¼ : 200// äº¤æ¢å b çš„å€¼ : 100// äº¤æ¢å a çš„åœ°å€ : 0xc00001c030// äº¤æ¢å b çš„åœ°å€ : 0xc00001c038</code></pre><h2 id="ç»“æ„ä½“"><a href="#ç»“æ„ä½“" class="headerlink" title="ç»“æ„ä½“"></a>ç»“æ„ä½“</h2><h3 id="å®šä¹‰ï¼š-1"><a href="#å®šä¹‰ï¼š-1" class="headerlink" title="å®šä¹‰ï¼š"></a>å®šä¹‰ï¼š</h3><p>ç”±ä¸€ç³»åˆ—å…·æœ‰ç›¸åŒç±»å‹æˆ–ä¸åŒç±»å‹çš„æ•°æ®æ„æˆçš„æ•°æ®é›†åˆï¼Œä¸€ä¸ªç»“æ„ä½“è¡¨ç¤ºä¸€é¡¹è®°å½•</p><pre><code class="go">type Book struct &#123;    title   string    author  string    subject string    book_id int&#125;func main() &#123;    book1 := Book&#123;&quot;Go è¯­è¨€&quot;, &quot;www.runoob.com&quot;, &quot;Go è¯­è¨€æ•™ç¨‹&quot;, 6495407&#125;    book1.subject = &quot;ç¼–ç¨‹&quot;    fmt.Println(book1)    book2 := Book&#123;title: &quot;Go è¯­è¨€2&quot;, author: &quot;www.runoob.com&quot;, subject: &quot;Go è¯­è¨€æ•™ç¨‹2&quot;, book_id: 6495408&#125;    fmt.Println(book2)    book3 := Book&#123;title: &quot;Go è¯­è¨€3&quot;, subject: &quot;www.runoob.com&quot;&#125;    book3.book_id = 111    fmt.Println(book3.book_id)    fmt.Println(book3.author)    book4 := Book&#123;&quot;Go è¯­è¨€&quot;, &quot;www.runoob.com&quot;&#125;    fmt.Println(book4)    // è¾“å‡ºç»“æœ============// &#123;Go è¯­è¨€ www.runoob.com ç¼–ç¨‹ 6495407&#125;// &#123;Go è¯­è¨€2 www.runoob.com Go è¯­è¨€æ•™ç¨‹2 6495408&#125;// 111// Error:too few values in Book&#123;â€¦&#125;&#125;</code></pre><h3 id="è®¿é—®ç»“æ„ä½“æˆå‘˜"><a href="#è®¿é—®ç»“æ„ä½“æˆå‘˜" class="headerlink" title="è®¿é—®ç»“æ„ä½“æˆå‘˜"></a>è®¿é—®ç»“æ„ä½“æˆå‘˜</h3><p>æ–¹å¼ï¼šç»“æ„ä½“.æˆå‘˜å</p><pre><code class="go">type Book struct &#123;    title   string    author  string    subject string    book_id int&#125;func printBook(book *Book) &#123;    fmt.Printf(&quot;Book title:%s\n&quot;, book.title)&#125;func main() &#123;    var Book1 Book    var Book2 Book    Book1.title = &quot;Goè¯­è¨€&quot;    Book2.title = &quot;Goè¯­è¨€2&quot;    printBook(&amp;Book1)    printBook(&amp;Book2)&#125;</code></pre><h2 id="åˆ‡ç‰‡-Slice"><a href="#åˆ‡ç‰‡-Slice" class="headerlink" title="åˆ‡ç‰‡ Slice"></a>åˆ‡ç‰‡ Slice</h2><p>æœ¬è´¨ï¼šå¯¹æ•°ç»„çš„æŠ½è±¡,å³åŠ¨æ€æ•°ç»„<br>åŒºåˆ«ï¼š</p><ol><li>é•¿åº¦ä¸å›ºå®š</li><li>å¯ä»¥è¿½åŠ å…ƒç´ </li><li>è¿½åŠ å…ƒç´ çš„æ—¶å€™å¯èƒ½ä½¿åˆ‡ç‰‡å®¹é‡å¢å¤§</li></ol><h3 id="åˆ›å»ºï¼š"><a href="#åˆ›å»ºï¼š" class="headerlink" title="åˆ›å»ºï¼š"></a>åˆ›å»ºï¼š</h3><ol><li>ä½¿ç”¨makeåˆ›å»º:<br>make([]ç±»å‹,åˆå§‹é•¿åº¦,å®¹é‡)</li></ol><pre><code class="go">nodes:=make([]int,3,10)</code></pre><ol start="2"><li>å£°æ˜ä¸€ä¸ªæœªçŸ¥é•¿åº¦çš„æ•°ç»„</li></ol><pre><code class="go">var nodes int[]</code></pre><h3 id="åˆå§‹åŒ–ï¼š-1"><a href="#åˆå§‹åŒ–ï¼š-1" class="headerlink" title="åˆå§‹åŒ–ï¼š"></a>åˆå§‹åŒ–ï¼š</h3><ol><li>s :&#x3D;[] int {1,2,3 } </li><li>åˆå§‹åŒ–åˆ‡ç‰‡ sï¼Œæ˜¯æ•°ç»„ arr çš„å¼•ç”¨ã€‚ s:&#x3D;arr[èµ·å§‹ä½ç½®index1:ç»“æŸä½ç½®index2],ä»index1~index2-1</li></ol><h3 id="å¸¸è§å‡½æ•°"><a href="#å¸¸è§å‡½æ•°" class="headerlink" title="å¸¸è§å‡½æ•°:"></a>å¸¸è§å‡½æ•°:</h3><ul><li>len() è·å–é•¿åº¦</li><li>cap() è®¡ç®—å®¹é‡,æµ‹é‡åˆ‡ç‰‡æœ€é•¿å¯ä»¥è¾¾åˆ°å¤šå°‘</li><li>append(åˆ‡ç‰‡åç§°,å…ƒç´ ) å‘åˆ‡ç‰‡è¿½åŠ æ–°å…ƒç´ :<code>numbers=append(numbers,1,2)</code></li><li>copy(numbers1,numbers) æ‹·è´ numbers çš„å†…å®¹åˆ° numbers1 <code>copy(numbers1,numbers)</code><br>copyå‡½æ•°åªä¼šæ‹·è´numbers1çš„é•¿åº¦</li></ul><pre><code class="go">func printSlice(x []int) &#123;    fmt.Printf(&quot;len=%d cap=%d slice=%v\n&quot;, len(x), cap(x), x)&#125;func main() &#123;    numbers := []int&#123;0, 1, 2, 3, 4, 5, 6, 7, 8&#125;    printSlice(numbers)    numbers1 := make([]int, 2, 5)    printSlice(numbers1)    copy(numbers1, numbers)    printSlice(numbers1)&#125;// ======è¾“å‡ºç»“æœ// len=9 cap=9 slice=[0 1 2 3 4 5 6 7 8]// len=2 cap=5 slice=[0 0]// len=2 cap=5 slice=[0 1]</code></pre><h2 id="èŒƒå›´-Range"><a href="#èŒƒå›´-Range" class="headerlink" title="èŒƒå›´ Range"></a>èŒƒå›´ Range</h2><p>å…³é”®å­—ï¼šrange<br>ä½œç”¨ï¼šç”¨äº for å¾ªç¯ä¸­è¿­ä»£æ•°ç»„(array)ã€åˆ‡ç‰‡(slice)ã€é€šé“(channel)æˆ–é›†åˆ(map)çš„å…ƒç´ <br>è¿”å›å€¼ï¼šåœ¨æ•°ç»„å’Œåˆ‡ç‰‡ä¸­å®ƒè¿”å›å…ƒç´ çš„ç´¢å¼•å’Œç´¢å¼•å¯¹åº”çš„å€¼ï¼Œåœ¨é›†åˆä¸­è¿”å› key-value å¯¹</p><pre><code class="go">for key, value := range oldMap &#123;    newMap[key] = value&#125;</code></pre><h2 id="é›†åˆ-Map"><a href="#é›†åˆ-Map" class="headerlink" title="é›†åˆ Map"></a>é›†åˆ Map</h2><p>æ¦‚å¿µï¼šæ— åºçš„é”®å€¼å¯¹çš„é›†åˆ<br>å®ç°ï¼šhash è¡¨</p><h3 id="delete"><a href="#delete" class="headerlink" title="delete()"></a>delete()</h3><p>ä½œç”¨ï¼šç”¨äºåˆ é™¤é›†åˆçš„å…ƒç´ , å‚æ•°ä¸º map å’Œå…¶å¯¹åº”çš„ key</p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>05-go-å‡½æ•°ä¸ä½œç”¨åŸŸ</title>
      <link href="/2022/10/10/05-go-han-shu-yu-zuo-yong-yu/"/>
      <url>/2022/10/10/05-go-han-shu-yu-zuo-yong-yu/</url>
      
        <content type="html"><![CDATA[<h2 id="å‡½æ•°"><a href="#å‡½æ•°" class="headerlink" title="å‡½æ•°"></a>å‡½æ•°</h2><h3 id="å‡½æ•°å‚æ•°"><a href="#å‡½æ•°å‚æ•°" class="headerlink" title="å‡½æ•°å‚æ•°"></a>å‡½æ•°å‚æ•°</h3><ul><li>å½¢å‚ï¼šå®šä¹‰å‡½æ•°æ—¶ï¼Œç”¨äºæ¥æ”¶å¤–éƒ¨ä¼ å…¥çš„æ•°æ®ï¼Œå«åšå½¢å¼å‚æ•°ï¼Œç®€ç§°å½¢å‚</li><li>å®å‚ï¼šè°ƒç”¨å‡½æ•°æ—¶ï¼Œä¼ ç»™å½¢å‚çš„å®é™…çš„æ•°æ®ï¼Œå«åšå®é™…å‚æ•°ï¼Œç®€ç§°å®å‚ã€‚</li></ul><h4 id="ä¼ å‚æ–¹å¼"><a href="#ä¼ å‚æ–¹å¼" class="headerlink" title="ä¼ å‚æ–¹å¼"></a>ä¼ å‚æ–¹å¼</h4><ul><li>å€¼ä¼ é€’ï¼ˆé»˜è®¤ï¼‰ï¼š<ul><li>å®šä¹‰ï¼šæŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°å¤åˆ¶ä¸€ä»½ä¼ é€’åˆ°å‡½æ•°ä¸­</li><li>å½±å“ï¼šåœ¨å‡½æ•°ä¸­å¦‚æœå¯¹å‚æ•°è¿›è¡Œä¿®æ”¹ï¼Œå°†ä¸ä¼šå½±å“åˆ°å®é™…å‚æ•°</li></ul><pre><code class="go">func SwapByValPass(x,y int) int&#123;    var temp int    temp=x    x=y    y=temp    return temp   //äº¤æ¢å‰100ï¼Œ200,äº¤æ¢åä¸å˜&#125;</code></pre></li><li>å¼•ç”¨ä¼ é€’<ul><li>å®šä¹‰ï¼šæŒ‡åœ¨è°ƒç”¨å‡½æ•°æ—¶å°†å®é™…å‚æ•°çš„åœ°å€ä¼ é€’åˆ°å‡½æ•°ä¸­</li><li>å½±å“ï¼šåœ¨å‡½æ•°ä¸­å¯¹å‚æ•°æ‰€è¿›è¡Œçš„ä¿®æ”¹ï¼Œå°†å½±å“åˆ°å®é™…å‚æ•°</li><li>å®é™…æµ‹è¯•ï¼šå‚æ•°å€¼å˜åŒ–ï¼Œä½†æ˜¯å‚æ•°åœ°å€ä¸å˜</li></ul><pre><code class="go">func SwapByReferPass(x *int,y *int)&#123;    var temp int    temp = *x    *x=*y    *y=temp//äº¤æ¢å‰100ï¼Œ200,äº¤æ¢å200ï¼Œ100&#125;</code></pre></li></ul><h3 id="é—­åŒ…"><a href="#é—­åŒ…" class="headerlink" title="é—­åŒ…"></a>é—­åŒ…</h3><p>åŒ¿åå‡½æ•°ï¼Œå¯ä½œä¸ºé—­åŒ…ã€‚ä¼˜è¶Šæ€§åœ¨äºå¯ä»¥ç›´æ¥ä½¿ç”¨å‡½æ•°å†…çš„å˜é‡ï¼Œä¸å¿…ç”³æ˜</p><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><p>ä¸€ä¸ªæ–¹æ³•å°±æ˜¯ä¸€ä¸ªåŒ…å«äº†æ¥å—è€…çš„å‡½æ•°ï¼Œæ¥å—è€…å¯ä»¥æ˜¯å‘½åç±»å‹æˆ–è€…ç»“æ„ä½“ç±»å‹çš„ä¸€ä¸ªå€¼æˆ–è€…æ˜¯ä¸€ä¸ªæŒ‡é’ˆã€‚æ‰€æœ‰ç»™å®šç±»å‹çš„æ–¹æ³•å±äºè¯¥ç±»å‹çš„æ–¹æ³•é›†</p><pre><code class="go">// æ™®é€šå‡½æ•°func function_name( [parameter list] ) [return_types] &#123;   å‡½æ•°ä½“&#125;// æ–¹æ³•func (variable_name variable_data_type) function_name() [return_type]&#123;   /* å‡½æ•°ä½“*/&#125;/* å®šä¹‰ç»“æ„ä½“ */type Circle struct &#123;  radius float64&#125;func main() &#123;  var c1 Circle  c1.radius = 10.00  fmt.Println(&quot;åœ†çš„é¢ç§¯ = &quot;, c1.getArea())&#125;//è¯¥ method å±äº Circle ç±»å‹å¯¹è±¡ä¸­çš„æ–¹æ³•func (c Circle) getArea() float64 &#123;  //c.radius å³ä¸º Circle ç±»å‹å¯¹è±¡ä¸­çš„å±æ€§  return 3.14 * c.radius * c.radius&#125;</code></pre><h2 id="å˜é‡ä½œç”¨åŸŸ"><a href="#å˜é‡ä½œç”¨åŸŸ" class="headerlink" title="å˜é‡ä½œç”¨åŸŸ"></a>å˜é‡ä½œç”¨åŸŸ</h2><ul><li>å±€éƒ¨å˜é‡ï¼šå‡½æ•°å†…å®šä¹‰çš„å˜é‡ï¼Œä½œç”¨åŸŸåªåœ¨å‡½æ•°ä½“å†…</li><li>å…¨å±€å˜é‡ï¼šå‡½æ•°å¤–å®šä¹‰çš„å˜é‡ï¼Œå¯ä»¥åœ¨æ•´ä¸ªåŒ…ç”šè‡³å¤–éƒ¨åŒ…ï¼ˆè¢«å¯¼å‡ºåï¼‰ä½¿ç”¨</li><li>å…¨å±€å˜é‡ä¸å±€éƒ¨å˜é‡åç§°å¯ä»¥ç›¸åŒï¼Œä½†æ˜¯å‡½æ•°å†…çš„å±€éƒ¨å˜é‡ä¼šè¢«ä¼˜å…ˆè€ƒè™‘</li><li>å½¢å¼å‚æ•°ï¼šå‡½æ•°å®šä¹‰ä¸­çš„å˜é‡ç§°ä¸ºå½¢å¼å‚æ•°</li></ul>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>04-è¿ç®—ç¬¦å’Œè¯­å¥</title>
      <link href="/2022/10/09/04-go-yun-suan-fu-he-yu-ju/"/>
      <url>/2022/10/09/04-go-yun-suan-fu-he-yu-ju/</url>
      
        <content type="html"><![CDATA[<h2 id="è¿ç®—ç¬¦"><a href="#è¿ç®—ç¬¦" class="headerlink" title="è¿ç®—ç¬¦"></a>è¿ç®—ç¬¦</h2><ul><li>ç®—æœ¯è¿ç®—ç¬¦ï¼š<code>+ - * / % ++ --</code></li><li>å…³ç³»è¿ç®—ç¬¦ï¼š<code>== != &gt; &lt; &gt;= &lt;= </code></li><li>é€»è¾‘è¿ç®—ç¬¦ï¼š<code>&amp;&amp; || !</code></li><li>ä½è¿ç®—ç¬¦ï¼š<code>&amp; | ^(å¼‚æˆ–) &lt;&lt;(*2^n) &gt;&gt;(/2^n)</code></li><li>èµ‹å€¼è¿ç®—ç¬¦ï¼š<code>= += -= *= /= </code>ç­‰</li><li>&amp;ï¼šè¿”å›å˜é‡å®é™…å­˜å‚¨åœ°å€</li><li>*ï¼šæŒ‡é’ˆå˜é‡</li></ul><h3 id="ä¼˜å…ˆçº§"><a href="#ä¼˜å…ˆçº§" class="headerlink" title="ä¼˜å…ˆçº§"></a>ä¼˜å…ˆçº§</h3><table><thead><tr><th>ä¼˜å…ˆçº§</th><th>è¿ç®—ç¬¦</th></tr></thead><tbody><tr><td>5</td><td>ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ* &#x2F; % ï¼‰ï¼Œä½è¿ç®—ç¬¦(&lt;&lt; &gt;&gt; &amp;)</td></tr><tr><td>4</td><td>ç®—æœ¯è¿ç®—ç¬¦ï¼ˆ+ - ï¼‰,ä½è¿ç®—ç¬¦ï¼ˆ| ^ï¼‰</td></tr><tr><td>3</td><td>å…³ç³»è¿ç®—ç¬¦ï¼ˆ&#x3D;&#x3D; !&#x3D; &lt; &lt;&#x3D; &gt; &gt;&#x3D;ï¼‰ï¼Œ</td></tr><tr><td>2</td><td>é€»è¾‘è¿ç®—ç¬¦ï¼ˆ&amp;&amp;ï¼‰</td></tr><tr><td>1</td><td>é€»è¾‘è¿ç®—ç¬¦ï¼ˆ | | ï¼‰</td></tr></tbody></table><blockquote><p>æ³¨æ„ç‚¹ï¼šGo çš„è‡ªå¢ï¼Œè‡ªå‡åªèƒ½ä½œä¸ºè¡¨è¾¾å¼ä½¿ç”¨ï¼Œè€Œä¸èƒ½ç”¨äºèµ‹å€¼è¯­å¥ã€‚</p></blockquote><h2 id="æ¡ä»¶è¯­å¥"><a href="#æ¡ä»¶è¯­å¥" class="headerlink" title="æ¡ä»¶è¯­å¥"></a>æ¡ä»¶è¯­å¥</h2><blockquote><ol><li>ä¸æ”¯æŒä¸‰ç›®è¿ç®—ç¬¦</li><li>switch å¦‚æœ case å¸¦æœ‰ fallthroughï¼Œç¨‹åºä¼šå¼ºåˆ¶æ‰§è¡Œä¸‹ä¸€æ¡ case</li></ol></blockquote><h3 id="æ™®é€š-if-x2F-else-å’Œ-switch"><a href="#æ™®é€š-if-x2F-else-å’Œ-switch" class="headerlink" title="æ™®é€š if&#x2F;else å’Œ switch"></a>æ™®é€š if&#x2F;else å’Œ switch</h3><pre><code class="go">// if/elsevar a int = 10if a &lt; 20 &#123;  /* å¦‚æœæ¡ä»¶ä¸º true åˆ™æ‰§è¡Œä»¥ä¸‹è¯­å¥ */  fmt.Printf(&quot;a å°äº 20\n&quot; )&#125;// switchvar grade string = &quot;B&quot;var marks int = 90switch marks &#123;  case 90: grade = &quot;A&quot;  case 80: grade = &quot;B&quot;  case 50,60,70 : grade = &quot;C&quot;  default: grade = &quot;D&quot;&#125;switch &#123;  case grade == &quot;A&quot; :      fmt.Printf(&quot;ä¼˜ç§€!\n&quot; )  case grade == &quot;B&quot;, grade == &quot;C&quot; :      fmt.Printf(&quot;è‰¯å¥½\n&quot; )  case grade == &quot;D&quot; :      fmt.Printf(&quot;åŠæ ¼\n&quot; )  case grade == &quot;F&quot;:      fmt.Printf(&quot;ä¸åŠæ ¼\n&quot; )  default:      fmt.Printf(&quot;å·®\n&quot; );&#125;</code></pre><h3 id="Type-Switch"><a href="#Type-Switch" class="headerlink" title="Type Switch"></a>Type Switch</h3><p>åˆ¤æ–­æŸä¸ª interface å˜é‡ä¸­å®é™…å­˜å‚¨çš„å˜é‡ç±»å‹</p><pre><code class="go">var x interface&#123;&#125;switch i := x.(type) &#123;  case nil:      fmt.Printf(&quot; x çš„ç±»å‹ :%T&quot;,i)  case int:      fmt.Printf(&quot;x æ˜¯ int å‹&quot;)  case float64:      fmt.Printf(&quot;x æ˜¯ float64 å‹&quot;)  case func(int) float64:      fmt.Printf(&quot;x æ˜¯ func(int) å‹&quot;)  case bool, string:      fmt.Printf(&quot;x æ˜¯ bool æˆ– string å‹&quot; )  default:      fmt.Printf(&quot;æœªçŸ¥å‹&quot;)&#125;</code></pre><h3 id="select-è¯­å¥-æ²¡çœ‹æ‡‚"><a href="#select-è¯­å¥-æ²¡çœ‹æ‡‚" class="headerlink" title="select è¯­å¥(æ²¡çœ‹æ‡‚)"></a>select è¯­å¥(æ²¡çœ‹æ‡‚)</h3><blockquote><ol><li>éšæœºæ‰§è¡Œä¸€ä¸ªå¯è¿è¡Œçš„ caseã€‚å¦‚æœæ²¡æœ‰ case å¯è¿è¡Œï¼Œå®ƒå°†é˜»å¡ï¼Œç›´åˆ°æœ‰ case å¯è¿è¡Œã€‚ä¸€ä¸ªé»˜è®¤çš„å­å¥åº”è¯¥æ€»æ˜¯å¯è¿è¡Œçš„</li><li>å¦‚æœæœ‰å¤šä¸ª case éƒ½å¯ä»¥è¿è¡Œï¼ŒSelect ä¼šéšæœºé€‰å‡ºä¸€ä¸ªæ‰§è¡Œã€‚å…¶ä»–ä¸ä¼šæ‰§è¡Œ</li></ol></blockquote><pre><code class="go">var c1, c2, c3 chan intvar i1, i2 intselect &#123;  case i1 = &lt;-c1:      fmt.Printf(&quot;received &quot;, i1, &quot; from c1\n&quot;)  case c2 &lt;- i2:      fmt.Printf(&quot;sent &quot;, i2, &quot; to c2\n&quot;)  case i3, ok := (&lt;-c3):  // same as: i3, ok := &lt;-c3      if ok &#123;        fmt.Printf(&quot;received &quot;, i3, &quot; from c3\n&quot;)      &#125; else &#123;        fmt.Printf(&quot;c3 is closed\n&quot;)      &#125;  default:      fmt.Printf(&quot;no communication\n&quot;)&#125;</code></pre><h2 id="å¾ªç¯è¯­å¥"><a href="#å¾ªç¯è¯­å¥" class="headerlink" title="å¾ªç¯è¯­å¥"></a>å¾ªç¯è¯­å¥</h2><h3 id="å¾ªç¯ç±»å‹"><a href="#å¾ªç¯ç±»å‹" class="headerlink" title="å¾ªç¯ç±»å‹"></a>å¾ªç¯ç±»å‹</h3><h4 id="for-å¾ªç¯"><a href="#for-å¾ªç¯" class="headerlink" title="for å¾ªç¯"></a>for å¾ªç¯</h4><p>ä½œç”¨ï¼šé‡å¤æ‰§è¡Œè¯­å¥å—<br>æ ¼å¼ï¼š</p><ol><li><font color=red>for init; condition; post { }</font></li></ol><pre><code class="go">func GetSum()&#123;    sum:=0    for i:=0;i&lt;=10;i++&#123;        sum+=i    &#125;    fmt.Println(sum)&#125;</code></pre><ol start="2"><li><font color=red>for condition { }</font></li></ol><pre><code class="go">func GetSumOnlyCondition()&#123;  sum:=0  for ;sum&lt;=10;&#123;      sum+=sum  &#125;  for sum&lt;=10&#123;      sum+=sum  &#125;  fmt.Println(sum)&#125;</code></pre><ol start="3"><li><font color=red>for { }</font>(æ— é™å¾ªç¯)</li></ol><blockquote><ul><li>init:èµ‹å€¼è¡¨è¾¾å¼ï¼Œç»™æ§åˆ¶å˜é‡èµ‹åˆå€¼</li><li>å…³ç³»è¡¨è¾¾å¼æˆ–é€»è¾‘è¡¨è¾¾å¼ï¼Œå¾ªç¯æ§åˆ¶æ¡ä»¶</li><li>ä¸€èˆ¬ä¸ºèµ‹å€¼è¡¨è¾¾å¼ï¼Œç»™æ§åˆ¶å˜é‡å¢é‡æˆ–å‡é‡</li></ul></blockquote><p>æ­¥éª¤ï¼š</p><ol><li>å¯¹è¡¨è¾¾å¼ 1 èµ‹åˆå€¼</li><li>åˆ¤åˆ«èµ‹å€¼è¡¨è¾¾å¼ init æ˜¯å¦æ»¡è¶³ç»™å®šæ¡ä»¶<br>a. è‹¥å…¶å€¼ä¸ºçœŸï¼Œæ»¡è¶³å¾ªç¯æ¡ä»¶ï¼Œåˆ™æ‰§è¡Œå¾ªç¯ä½“å†…è¯­å¥ï¼Œç„¶åæ‰§è¡Œ postï¼Œè¿›å…¥ç¬¬äºŒæ¬¡å¾ªç¯ï¼Œå†åˆ¤åˆ« condition<br>b. å¦åˆ™åˆ¤æ–­ condition çš„å€¼ä¸ºå‡ï¼Œä¸æ»¡è¶³æ¡ä»¶ï¼Œå°±ç»ˆæ­¢ for å¾ªç¯ï¼Œæ‰§è¡Œå¾ªç¯ä½“å¤–è¯­å¥</li></ol><h4 id="range-å¾ªç¯"><a href="#range-å¾ªç¯" class="headerlink" title="range å¾ªç¯"></a>range å¾ªç¯</h4><p>ä½œç”¨ï¼šå¯¹å­—ç¬¦ä¸²ã€æ•°ç»„ã€åˆ‡ç‰‡ç­‰è¿›è¡Œè¿­ä»£è¾“å‡ºå…ƒç´ </p><pre><code class="go">strings := []string&#123;&quot;google&quot;, &quot;runoob&quot;&#125;//å®šä¹‰æ•°ç»„for i, s := range strings &#123;  fmt.Println(i, s)&#125;numbers := [6]int&#123;1, 2, 3, 5&#125;for i,x:= range numbers &#123;  fmt.Printf(&quot;ç¬¬ %d ä½ x çš„å€¼ = %d\n&quot;, i,x)&#125;</code></pre><h3 id="å¾ªç¯æ§åˆ¶è¯­å¥"><a href="#å¾ªç¯æ§åˆ¶è¯­å¥" class="headerlink" title="å¾ªç¯æ§åˆ¶è¯­å¥"></a>å¾ªç¯æ§åˆ¶è¯­å¥</h3><h4 id="break"><a href="#break" class="headerlink" title="break"></a>break</h4><ul><li>æœ‰æ ‡è®°ï¼šè·³å‡ºæ ‡è®°å¤„å¾ªç¯</li><li>æ— æ ‡è®°ï¼šè·³å‡ºå½“å‰å¾ªç¯</li></ul><pre><code class="go">func LoopBreakWithLabel()&#123;  for i := 1; i &lt;= 3; i++ &#123;    fmt.Printf(&quot;i: %d\n&quot;, i)    ref:      for i2 := 11; i2 &lt;= 13; i2++ &#123;          fmt.Printf(&quot;i2: %d\n&quot;, i2)          break ref      &#125;  &#125;&#125;</code></pre><h4 id="continue"><a href="#continue" class="headerlink" title="continue"></a>continue</h4><p>è·³è¿‡å½“å‰å¾ªç¯æ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯è¯­å¥</p><ul><li>æœ‰æ ‡è®°ï¼šåœ¨æ ‡è®°å¤„é‡æ–°æ‰§è¡Œ</li><li>æ— æ ‡è®°ï¼šç›´æ¥åœ¨å½“å‰å¾ªç¯é‡æ–°æ‰§è¡Œ</li></ul><h4 id="goto"><a href="#goto" class="headerlink" title="goto"></a>goto</h4><p>é€šå¸¸ä¸æ¡ä»¶è¯­å¥é…åˆä½¿ç”¨ï¼Œå®ç°æ¡ä»¶è½¬ç§»ï¼Œ æ„æˆå¾ªç¯ï¼Œè·³å‡ºå¾ªç¯ä½“</p><pre><code class="go">/* å®šä¹‰å±€éƒ¨å˜é‡ */var a int = 10/* å¾ªç¯ */LOOP: for a &lt; 20 &#123;  if a == 15 &#123;      /* è·³è¿‡è¿­ä»£ */      a = a + 1      goto LOOP  &#125;  fmt.Printf(&quot;açš„å€¼ä¸º : %d\n&quot;, a)  a++&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>03-go åŸºç¡€è¯­æ³•</title>
      <link href="/2022/10/09/03-go-basic-synax/"/>
      <url>/2022/10/09/03-go-basic-synax/</url>
      
        <content type="html"><![CDATA[<p>å…³é”®å­—ï¼Œæ ‡è¯†ç¬¦(å˜é‡ï¼Œç±»å‹)ï¼Œå¸¸é‡ï¼Œå­—ç¬¦ä¸²ï¼Œç¬¦å·-&gt;æ ‡è®°-&gt;GO ç¨‹åº</p><h3 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h3><ol><li>æ ‡è¯†ç¬¦ï¼š<code>A-Z,a-z,0-9,ä¸‹åˆ’çº¿\_</code>ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—</li><li>å­—ç¬¦ä¸²æ‹¼æ¥ï¼šä½¿ç”¨<code>+</code>å®ç°</li><li>ä¿ç•™å­—æˆ–è€…å…³é”®å­—ä¸èƒ½ä½œä¸ºæ ‡è¯†ç¬¦å</li><li>å˜é‡çš„å£°æ˜å¿…é¡»ä½¿ç”¨ç©ºæ ¼éš”å¼€ <code>var age int</code></li><li>Go ç¨‹åºæ˜¯é€šè¿‡ package æ¥ç»„ç»‡çš„ï¼Œåªæœ‰ package åç§°ä¸º main çš„æºç æ–‡ä»¶å¯ä»¥åŒ…å« main å‡½æ•°ï¼Œä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæœ‰ä¸”ä»…æœ‰ä¸€ä¸ª main åŒ…ï¼Œå…¶ä»–åŒ…ä¸­å³ä½¿æœ‰ main å‡½æ•°ä¹Ÿä¸ä¼šæ‰§è¡Œ</li></ol><h3 id="æ•°æ®ç±»å‹"><a href="#æ•°æ®ç±»å‹" class="headerlink" title="æ•°æ®ç±»å‹"></a>æ•°æ®ç±»å‹</h3><ul><li>å¸ƒå°”å‹ï¼š<ul><li>true</li><li>false</li></ul></li><li>æ•°å­—:<ul><li>int&#x2F;float32&#x2F;float64</li><li>æ”¯æŒå¤æ•°</li><li>ä½çš„è¿ç®—é‡‡ç”¨è¡¥ç </li><li>æ— éœ€å®šä¹‰ int åŠ float32ã€float64ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨è¯†åˆ«</li></ul></li><li>å­—ç¬¦ä¸²</li><li>æ´¾ç”Ÿç±»å‹<ul><li>æŒ‡é’ˆç±»å‹ Pointer</li><li>æ•°ç»„ç±»å‹</li><li>ç»“æ„åŒ–ç±»å‹ struct</li><li>Channel ç±»å‹ chan</li><li>å‡½æ•°ç±»å‹ func</li><li>åˆ‡ç‰‡ç±»å‹</li><li>æ¥å£ç±»å‹ interface</li><li>Map ç±»å‹</li></ul></li></ul><h3 id="å˜é‡"><a href="#å˜é‡" class="headerlink" title="å˜é‡"></a>å˜é‡</h3><h3 id="å˜é‡ç»„æˆ"><a href="#å˜é‡ç»„æˆ" class="headerlink" title="å˜é‡ç»„æˆ"></a>å˜é‡ç»„æˆ</h3><p><code>A-Z,a-z,0-9,ä¸‹åˆ’çº¿\_</code>ï¼Œç¬¬ä¸€ä¸ªå­—ç¬¦ä¸èƒ½æ˜¯æ•°å­—</p><h3 id="å˜é‡å£°æ˜"><a href="#å˜é‡å£°æ˜" class="headerlink" title="å˜é‡å£°æ˜"></a>å˜é‡å£°æ˜</h3><ol><li>å¯ä¸€æ¬¡å£°æ˜å¤šä¸ªå˜é‡ <code>var identifier1, identifier2 type</code></li><li>ä¸åŒç±»å‹çš„å˜é‡ä¸å¯ä»¥ä¸€æ¬¡å£°æ˜å¤šä¸ª <code>var i int,f float64</code>ä¼šè¯­æ³•æŠ¥é”™</li></ol><h4 id="ç±»å‹å’Œå˜é‡å£°æ˜"><a href="#ç±»å‹å’Œå˜é‡å£°æ˜" class="headerlink" title="ç±»å‹å’Œå˜é‡å£°æ˜"></a>ç±»å‹å’Œå˜é‡å£°æ˜</h4><ol><li>æŒ‡å®šå˜é‡ç±»å‹ï¼Œå¦‚æœæ²¡æœ‰åˆå§‹åŒ–ï¼Œåˆ™å˜é‡é»˜è®¤ä¸ºé›¶å€¼ï¼ˆå³è¯¥ç±»å‹çš„ç³»ç»Ÿé»˜è®¤å€¼ï¼‰</li><li>ç³»ç»Ÿæ ¹æ®å€¼è‡ªè¡Œåˆ¤å®šå˜é‡ç±»å‹</li><li>å¦‚æœå˜é‡å·²ç»ä½¿ç”¨ var å£°æ˜è¿‡äº†ï¼Œå†ä½¿ç”¨ :&#x3D; å£°æ˜å˜é‡ï¼Œå°±äº§ç”Ÿç¼–è¯‘é”™è¯¯ï¼Œ</li></ol><pre><code class="go">intVal := 1//ä¸Šä¸‹ä¸¤è€…æ„ä¹‰ä¸€è‡´var intVal intintVal =1</code></pre><h4 id="å¤šå˜é‡å£°æ˜"><a href="#å¤šå˜é‡å£°æ˜" class="headerlink" title="å¤šå˜é‡å£°æ˜"></a>å¤šå˜é‡å£°æ˜</h4><pre><code class="go">//ç±»å‹ç›¸åŒå¤šä¸ªå˜é‡, éå…¨å±€å˜é‡var vname1, vname2, vname3 typevname1, vname2, vname3 = v1, v2, v3var vname1, vname2, vname3 = v1, v2, v3 // å’Œ python å¾ˆåƒ,ä¸éœ€è¦æ˜¾ç¤ºå£°æ˜ç±»å‹ï¼Œè‡ªåŠ¨æ¨æ–­vname1, vname2, vname3 := v1, v2, v3 //  := å·¦ä¾§çš„å˜é‡ä¸åº”è¯¥æ˜¯å·²ç»è¢«å£°æ˜è¿‡çš„ï¼Œå¦åˆ™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯// è¿™ç§å› å¼åˆ†è§£å…³é”®å­—çš„å†™æ³•ä¸€èˆ¬ç”¨äºå£°æ˜å…¨å±€å˜é‡var (    vname1 v_type1    vname2 v_type2)</code></pre><h3 id="å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹"><a href="#å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹" class="headerlink" title="å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹"></a>å€¼ç±»å‹å’Œå¼•ç”¨ç±»å‹</h3><h4 id="å€¼ç±»å‹"><a href="#å€¼ç±»å‹" class="headerlink" title="å€¼ç±»å‹"></a>å€¼ç±»å‹</h4><ul><li>å®šä¹‰ï¼šä½¿ç”¨è¿™äº›ç±»å‹çš„å˜é‡ç›´æ¥æŒ‡å‘å­˜åœ¨å†…å­˜ä¸­çš„å€¼</li><li>èŒƒå›´ï¼šåŸºæœ¬ç±»å‹éƒ½å±äºå€¼ç±»å‹</li><li>æ‹·è´ï¼šå½“ä½¿ç”¨ç­‰å· &#x3D; å°†ä¸€ä¸ªå˜é‡çš„å€¼èµ‹å€¼ç»™å¦ä¸€ä¸ªå˜é‡æ—¶ï¼Œå¦‚ï¼šj &#x3D; iï¼Œå®é™…ä¸Šæ˜¯åœ¨å†…å­˜ä¸­å°† i çš„å€¼è¿›è¡Œäº†æ‹·è´</li><li>å­˜å‚¨ï¼šå­˜å‚¨åœ¨å †ä¸­ï¼Œé€šè¿‡ &amp;i æ¥è·å–å˜é‡ i çš„å†…å­˜åœ°å€ <code> fmt.Printf(&quot;åœ°å€ï¼š%d&quot;,&amp;i)</code></li></ul><h4 id="å¼•ç”¨ç±»å‹"><a href="#å¼•ç”¨ç±»å‹" class="headerlink" title="å¼•ç”¨ç±»å‹"></a>å¼•ç”¨ç±»å‹</h4><ul><li>å­˜å‚¨ï¼šä¸€ä¸ªå¼•ç”¨ç±»å‹çš„å˜é‡ r1 å­˜å‚¨çš„æ˜¯ r1 çš„å€¼æ‰€åœ¨çš„å†…å­˜åœ°å€ï¼ˆæ•°å­—ï¼‰ï¼Œæˆ–å†…å­˜åœ°å€ä¸­ç¬¬ä¸€ä¸ªå­—æ‰€åœ¨çš„ä½ç½®ã€‚å†…å­˜åœ°å€ç§°ä¹‹ä¸ºæŒ‡é’ˆ</li><li>æ‹·è´ï¼šå½“ä½¿ç”¨èµ‹å€¼è¯­å¥ r2 &#x3D; r1 æ—¶ï¼Œåªæœ‰å¼•ç”¨ï¼ˆåœ°å€ï¼‰è¢«å¤åˆ¶ï¼Œä¿®æ”¹å˜é‡ r1 å’Œ r2 ä¼šäº’ç›¸å½±å“</li></ul><h3 id="å¸¸é‡"><a href="#å¸¸é‡" class="headerlink" title="å¸¸é‡"></a>å¸¸é‡</h3><ul><li>ç±»å‹ï¼šå¸ƒå°”å‹ã€æ•°å­—å‹å’Œå­—ç¬¦ä¸²å‹</li><li>åœ¨å®šä¹‰å¸¸é‡ç»„çš„æ—¶å€™ï¼Œå¦‚æœä¸æä¾›åˆå§‹å€¼ï¼Œåˆ™åˆå§‹å€¼è‡ªåŠ¨è®¾ç½®ä¸ºä¸Šä¸€è¡Œçš„<font color=red><strong>è¡¨è¾¾å¼</strong></font></li><li>å®šä¹‰ï¼š</li></ul><pre><code class="go">const b string = &quot;abc&quot; //æ˜¾å¼ç±»å‹å®šä¹‰const b = &quot;abc&quot; //éšå¼ç±»å‹å®šä¹‰</code></pre><ul><li>å¸¸é‡è¡¨è¾¾å¼ä¸­ï¼Œå‡½æ•°å¿…é¡»æ˜¯ <code>len(), cap(), unsafe.Sizeof()</code>è¿™äº›å†…ç½®å‡½æ•°</li></ul><h3 id="ç‰¹æ®Šå¸¸é‡-iota"><a href="#ç‰¹æ®Šå¸¸é‡-iota" class="headerlink" title="ç‰¹æ®Šå¸¸é‡ iota"></a>ç‰¹æ®Šå¸¸é‡ iota</h3><p>ç‰¹æ®Šä¹‹å¤„ï¼š</p><ul><li>å¯ä»¥è¢«ç¼–è¯‘å™¨ä¿®æ”¹çš„å¸¸é‡</li><li>iota åœ¨ const å…³é”®å­—ä¸‹æ¬¡å‡ºç°æ—¶å°†è¢«é‡ç½®ä¸º 0ï¼Œconst ä¸­æ¯æ–°å¢ä¸€è¡Œå¸¸é‡å£°æ˜å°†ä½¿ iota è®¡æ•°ä¸€æ¬¡</li></ul><pre><code class="go">func GetIOTA()&#123;    const (        a = iota   //0        b          //1        c          //2        d = &quot;ha&quot;   //ç‹¬ç«‹å€¼ï¼Œiota += 1        e          //&quot;ha&quot;   iota += 1        f = 100    //iota +=1        g          //100  iota +=1        h = iota   //7,æ¢å¤è®¡æ•°        i          //8    )    fmt.Printf(&quot;ITOA:%v %v %v %q %q %v %v %v %v\n&quot;,a,b,c,d,e,f,g,h,i)//0 1 2 ha ha 100 100 7 8&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>02-ç”¨goå†™ä¸€ä¸ªhello_wordç¨‹åº</title>
      <link href="/2022/10/08/02-go-hello-world/"/>
      <url>/2022/10/08/02-go-hello-world/</url>
      
        <content type="html"><![CDATA[<p>å»é™¤ go.mod æ–‡ä»¶ä¸­é¡¹ç›®ä¸éœ€è¦çš„ä¾èµ–ï¼š<code>go mod tidy </code></p><h2 id="ç”¨-go-å†™ä¸€ä¸ª-hello-word-ç¨‹åº"><a href="#ç”¨-go-å†™ä¸€ä¸ª-hello-word-ç¨‹åº" class="headerlink" title="ç”¨ go å†™ä¸€ä¸ª hello_word ç¨‹åº"></a>ç”¨ go å†™ä¸€ä¸ª hello_word ç¨‹åº</h2><p>go_demo&#x2F;pki&#x2F;main.go</p><pre><code class="go">// åŒ…å£°æ˜:æºæ–‡ä»¶ä¸­éæ³¨é‡Šçš„ç¬¬ä¸€è¡Œ,æŒ‡æ˜è¿™ä¸ªæ–‡ä»¶å±äºå“ªä¸ªåŒ…// package mainè¡¨ç¤ºä¸€ä¸ªå¯ç‹¬ç«‹æ‰§è¡Œçš„ç¨‹åºï¼Œæ¯ä¸ª Go åº”ç”¨ç¨‹åºéƒ½åŒ…å«ä¸€ä¸ªåä¸º main çš„åŒ…package main// å¼•å…¥åŒ…:å‘Šè¯‰ Go ç¼–è¯‘å™¨è¿™ä¸ªç¨‹åºéœ€è¦ä½¿ç”¨ fmt åŒ…// æ–¹å¼1ï¼šç¼–å†™å¤šä¸ªå¯¼å…¥è¯­å¥// æ–¹å¼2: ç”¨åœ†æ‹¬å·ç»„åˆäº†å¯¼å…¥import &quot;fmt&quot;// ç¨‹åºå¼€å§‹æ‰§è¡Œçš„å‡½æ•°ã€‚main å‡½æ•°æ˜¯æ¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºæ‰€å¿…é¡»åŒ…å«çš„ï¼Œ// ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯åœ¨å¯åŠ¨åç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‡½æ•°ï¼ˆå¦‚æœæœ‰ init() å‡½æ•°åˆ™ä¼šå…ˆæ‰§è¡Œè¯¥å‡½æ•°ï¼‰func main()&#123;    /* è¿™æ˜¯æˆ‘çš„ç¬¬ä¸€ä¸ªç®€å•çš„ç¨‹åº */    fmt.Println(&quot;Hello, World!&quot;)&#125;func init()&#123;    fmt.Println(&quot;init me first!&quot;)&#125;</code></pre><blockquote><h5 id="æ³¨æ„ç‚¹ï¼š"><a href="#æ³¨æ„ç‚¹ï¼š" class="headerlink" title="æ³¨æ„ç‚¹ï¼š"></a>æ³¨æ„ç‚¹ï¼š</h5><ol><li>å½“æ ‡è¯†ç¬¦ä»¥ä¸€ä¸ªå¤§å†™å­—æ¯å¼€å¤´,ä½¿ç”¨è¿™ç§å½¢å¼çš„æ ‡è¯†ç¬¦çš„å¯¹è±¡å°±å¯ä»¥è¢«å¤–éƒ¨åŒ…çš„ä»£ç æ‰€ä½¿ç”¨ï¼Œå³å¯¼å‡º</li><li>æ ‡è¯†ç¬¦å¦‚æœä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œåˆ™å¯¹åŒ…å¤–æ˜¯ä¸å¯è§çš„ï¼Œä½†æ˜¯ä»–ä»¬åœ¨æ•´ä¸ªåŒ…çš„å†…éƒ¨æ˜¯å¯è§å¹¶ä¸”å¯ç”¨çš„</li><li>å‡½æ•°çš„å·¦ä¾§å¤§æ‹¬å·ä¸èƒ½å•ç‹¬ä¸€è¡Œï¼Œå¦åˆ™ä¼šæŠ¥é”™</li><li>å¯¼å…¥ï¼šæ–¹å¼ 1-ç¼–å†™å¤šä¸ªå¯¼å…¥è¯­å¥;æ–¹å¼ 2-ç”¨åœ†æ‹¬å·ç»„åˆå¯¼å…¥</li></ol></blockquote><h2 id="è¿è¡Œç¨‹åº"><a href="#è¿è¡Œç¨‹åº" class="headerlink" title="è¿è¡Œç¨‹åº"></a>è¿è¡Œç¨‹åº</h2><pre><code class="bash"> go run pki/main.go</code></pre><p>è¿è¡Œç»“æœ</p><img src="/2022/10/08/02-go-hello-world/hello.jpg" class="" title="æ‰§è¡Œgo run"><h2 id="ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶"><a href="#ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶" class="headerlink" title="ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶"></a>ç”ŸæˆäºŒè¿›åˆ¶æ–‡ä»¶</h2><p>åœ¨æ ¹ç›®å½•å¤„ç”ŸæˆåŒåäºŒè¿›åˆ¶æ–‡ä»¶</p><pre><code class="bash">go build pki/main.go</code></pre><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><h3 id="å¯¼å…¥åŒä¸€ä¸ªé¡¹ç›®ä¸­çš„æœ¬åœ°åŒ…æŠ¥é”™"><a href="#å¯¼å…¥åŒä¸€ä¸ªé¡¹ç›®ä¸­çš„æœ¬åœ°åŒ…æŠ¥é”™" class="headerlink" title="å¯¼å…¥åŒä¸€ä¸ªé¡¹ç›®ä¸­çš„æœ¬åœ°åŒ…æŠ¥é”™"></a>å¯¼å…¥åŒä¸€ä¸ªé¡¹ç›®ä¸­çš„æœ¬åœ°åŒ…æŠ¥é”™</h3><img src="/2022/10/08/02-go-hello-world/error.jpg" class="" title="å¯¼å…¥æœ¬åœ°åŒ…æŠ¥é”™"><p>å®˜æ–¹æ–‡æ¡£(1.16)æä¾›çš„æ–¹æ³•:</p><ol><li>è¿›å…¥å¾…å¯¼å…¥æœ¬åœ°åŒ…ç›®å½•</li><li>æ‰§è¡Œ <code>go build</code></li><li>è¿›å…¥é¡¹ç›®æ ¹ç›®å½•</li><li>æ‰§è¡Œ <code>go install go_demo</code></li></ol><blockquote><p>ç»“æœ:æœ¬åœ°å¼€å‘ç¯å¢ƒä¸º 1.19,éªŒè¯ä¸ºåœ¨è¯¥ç‰ˆæœ¬ä¸Šæ— æ•ˆ,æŠ¥é”™åŒå°è¯• 1</p></blockquote><h4 id="å°è¯•-1"><a href="#å°è¯•-1" class="headerlink" title="å°è¯• 1:"></a>å°è¯• 1:</h4><pre><code class="go">import (    &quot;fmt&quot;    &quot;go_demo/mathClass&quot;)</code></pre><p>ç»“æœ:</p><blockquote><p>package go_demo&#x2F;mathClass is not in GOROOT</p></blockquote><h4 id="å°è¯•-2"><a href="#å°è¯•-2" class="headerlink" title="å°è¯• 2:"></a>å°è¯• 2:</h4><p>èœé¸Ÿæ•™ç¨‹ä¸Šæœ‰ä¸€ä¸ªç¬”è®°è¯´åŒ…åå’Œæ–‡ä»¶å¤¹åç§°æ— å…³,äºæ˜¯åŸºäºå°è¯• 1,å°† package åç§°å’Œå¯¹åº”çš„æ–‡ä»¶å¤¹åç§°ä¿®æ”¹ä¸€è‡´<br>ç»“æœ:æˆåŠŸ,ä½†æ˜¯ä¸çŸ¥é“ä¸ºå•¥â€¦</p><p>è¡¥å……ï¼šå¦‚æœè§‰å¾—åŒ…åå’Œæ–‡ä»¶å¤¹åç§°å¿…é¡»ä¸€è‡´å¾ˆéº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨åˆ«åçš„æ–¹å¼</p><pre><code class="go">import (    &quot;fmt&quot;    complex &quot;test_mod/ArrayDemo&quot;    &quot;test_mod/functionList&quot;)func init() &#123;    fmt.Println(&quot;init me first!&quot;)    complex.GetAddress()&#125;</code></pre><img src="/2022/10/08/02-go-hello-world/package.png" class="" title="packageå’Œæ–‡ä»¶å¤¹åç§°ä¸ä¸€æ ·çš„æ—¶å€™çš„å¤„ç†"><h2 id="å‚è€ƒæ–‡ç« "><a href="#å‚è€ƒæ–‡ç« " class="headerlink" title="å‚è€ƒæ–‡ç« :"></a>å‚è€ƒæ–‡ç« :</h2><p><a href="https://github.com/golang/go/issues/38812">issue#38812</a></p>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>01-Goè¯­è¨€ç¯å¢ƒçš„å®‰è£…</title>
      <link href="/2022/10/01/01-golang-proxy/"/>
      <url>/2022/10/01/01-golang-proxy/</url>
      
        <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><h3 id="windows"><a href="#windows" class="headerlink" title="windows:"></a>windows:</h3><p>ä¸‹è½½<a href="https://golang.google.cn/dl/go1.19.2.windows-amd64.msi">æ–‡ä»¶</a>ï¼Œç›´æ¥ next ç›´è‡³å®Œæˆ</p><h3 id="Linuxï¼š"><a href="#Linuxï¼š" class="headerlink" title="Linuxï¼š"></a>Linuxï¼š</h3><h4 id="é€šç”¨æ­¥éª¤"><a href="#é€šç”¨æ­¥éª¤" class="headerlink" title="é€šç”¨æ­¥éª¤"></a>é€šç”¨æ­¥éª¤</h4><ol><li>å®‰è£…å¿…è¦çš„åŒ…</li></ol><pre><code class="bash">yum install mercurialyum install gityum install gcc</code></pre><ol start="2"><li>ä¸‹è½½ go çš„å‹ç¼©åŒ…å¹¶è§£å‹ç¼©</li></ol><pre><code class="bash">cd /usr/local/wget https://go.dev/dl/go1.19.2.linux-amd64.tar.gz</code></pre><blockquote><p>å¦‚æœè¯¥åœ°å€ä¸å¯ç”¨ 443ï¼Œå¯ä»¥ä½¿ç”¨ <font color="red"><code>https://golang.google.cn/dl/go1.19.2.linux-amd64.tar.gz</code></font> ä»£æ›¿</p></blockquote><ol start="3"><li>æ·»åŠ  PATH ç¯å¢ƒå˜é‡</li></ol><pre><code class="bash">vi ~/.bash_profile# ~/.bash_profileæ·»åŠ å†…å®¹export GOROOT=/usr/local/go ##Golangå®‰è£…ç›®å½•export PATH=$PATH:$GOROOT/bin# åˆ·æ–°ç¯å¢ƒå˜é‡source ~/.bash_profile</code></pre><ol start="4"><li>éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ<img src="/2022/10/01/01-golang-proxy/go_version.jpg" class="" title="å®‰è£…æˆåŠŸ"></li></ol><h4 id="v1-11-ä»¥å‰"><a href="#v1-11-ä»¥å‰" class="headerlink" title="v1.11 ä»¥å‰"></a>v1.11 ä»¥å‰</h4><ol><li>è®¾ç½® GOPATH ç¯å¢ƒå˜é‡ï¼ˆgo 1.11 åä¸å¿…è®¾ç½®,å¯ä½¿ç”¨ go moduleï¼‰</li></ol><pre><code class="bash">export GOPATH=xxxx(å³ä½¿æ‰‹åŠ¨è®¾ç½®ä¸ºç©ºï¼Œä¹Ÿä¼šé»˜è®¤ä¸º/root/go)</code></pre><ol start="2"><li>å»ºç«‹ Go çš„å·¥ä½œç©ºé—´ï¼ˆworkspaceï¼Œä¹Ÿå°±æ˜¯ GOPATH ç¯å¢ƒå˜é‡æŒ‡å‘çš„ç›®å½•ï¼‰ã€‘<blockquote><p>GO ä»£ç å¿…é¡»åœ¨å·¥ä½œç©ºé—´å†…ã€‚å·¥ä½œç©ºé—´æ˜¯ä¸€ä¸ªç›®å½•ï¼Œå…¶ä¸­åŒ…å«ä¸‰ä¸ªå­ç›®å½•ï¼š</p><ul><li>src â€”- å­˜æ”¾ golang é¡¹ç›®ä»£ç çš„ä½ç½®,é‡Œé¢æ¯ä¸€ä¸ªå­ç›®å½•ï¼Œå°±æ˜¯ä¸€ä¸ªåŒ…ã€‚</li><li>pkg â€”- ç¼–è¯‘åç”Ÿæˆçš„ï¼ŒåŒ…çš„ç›®æ ‡æ–‡ä»¶</li><li>bin â€”- ç”Ÿæˆçš„å¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ¯”å¦‚æ‰§è¡Œ <code>go get github.com/google/gops</code>,bin ç›®å½•ä¼šç”Ÿæˆ gops çš„äºŒè¿›åˆ¶æ–‡ä»¶ã€‚</li></ul></blockquote></li></ol><pre><code class="bash">cd /rootmkdir gocd go/mkdir binmkdir srcmkdir pkg</code></pre><h4 id="v1-11-ä»¥å"><a href="#v1-11-ä»¥å" class="headerlink" title="v1.11 ä»¥å"></a>v1.11 ä»¥å</h4><ol><li>è®¾ç½®ç¯å¢ƒå˜é‡ GO111MODULE è¿›è¡Œå¼€å¯æˆ–è€…å…³é—­ go modules æ¨¡å¼</li></ol><pre><code class="bash">go env -w GO111MODULE=on #go env -wä¼šå°†é…ç½®å†™åˆ° GOENV æ–‡ä»¶ä¸­å»</code></pre><blockquote><p>GO111MODULE çš„æšä¸¾å€¼:</p><ul><li>ç©ºï¼š auto è‡ªåŠ¨æ¨¡å¼ï¼Œå½“é¡¹ç›®æ ¹ç›®å½•æœ‰ go.mod æ–‡ä»¶ï¼Œå¯ç”¨ Go modules</li><li>offï¼š å…³é—­ go mod æ¨¡å¼</li><li>onï¼š å¼€å¯ go mod æ¨¡å¼</li></ul></blockquote><h2 id="GOPATH-ç¼ºç‚¹"><a href="#GOPATH-ç¼ºç‚¹" class="headerlink" title="GOPATH ç¼ºç‚¹"></a>GOPATH ç¼ºç‚¹</h2><img src="/2022/10/01/01-golang-proxy/GOPATH.jfif" class="" title="GOPATH"><ol><li>GOPATH æ¨¡å¼ä¸‹ï¼Œå¿…é¡»æŒ‡å®šç›®å½•,é¡¹ç›®ä»£ç ä¸èƒ½æƒ³æ”¾å“ªé‡Œå°±æ”¾å“ªé‡Œ</li><li>go get å‘½ä»¤çš„æ—¶å€™ï¼Œæ— æ³•æŒ‡å®šè·å–çš„ç‰ˆæœ¬</li><li>å¼•ç”¨ç¬¬ä¸‰æ–¹é¡¹ç›®çš„æ—¶å€™ï¼Œæ— æ³•å¤„ç† v1ã€v2ã€v3 ç­‰ä¸åŒç‰ˆæœ¬çš„å¼•ç”¨é—®é¢˜ï¼Œå› ä¸ºåœ¨ GOPATH æ¨¡å¼ä¸‹é¡¹ç›®è·¯å¾„éƒ½æ˜¯ github.com&#x2F;foo&#x2F;project</li><li>æ— æ³•åŒæ­¥ä¸€è‡´ç¬¬ä¸‰æ–¹ç‰ˆæœ¬å·ï¼Œåœ¨è¿è¡Œ Go åº”ç”¨ç¨‹åºçš„æ—¶å€™ï¼Œæ— æ³•ä¿è¯å…¶å®ƒäººä¸æ‰€æœŸæœ›ä¾èµ–çš„ç¬¬ä¸‰æ–¹åº“æ˜¯ç›¸åŒçš„ç‰ˆæœ¬ã€‚</li></ol><h2 id="é—®é¢˜"><a href="#é—®é¢˜" class="headerlink" title="é—®é¢˜"></a>é—®é¢˜</h2><p>èƒŒæ™¯ï¼šå›½å†…å› ä¸ºå¢™çš„åŸå› ï¼Œæ‰€ä»¥ä¸‹è½½ä¸€äº›åŒ…çš„æ—¶å€™ä¼šäº§ç”Ÿ 443 æŠ¥é”™</p><img src="/2022/10/01/01-golang-proxy/go_443.jpg" class="" title="ä¸‹è½½åŒ…æŠ¥é”™"><p>è§£å†³æ–¹æ³•ï¼šè®¾ç½®ä»£ç†<br>å¸¸ç”¨ä»£ç†ï¼š</p><ul><li>GOPROXY.IOï¼š<a href="https://goproxy.io/zh/">https://goproxy.io/zh/</a></li><li>ä¸ƒç‰›äº‘ï¼š<a href="https://goproxy.cn/">https://goproxy.cn</a></li><li>é˜¿é‡Œäº‘ï¼š<a href="https://mirrors.aliyun.com/goproxy/">https://mirrors.aliyun.com/goproxy/</a></li></ul><p>è®¾ç½®æ­¥éª¤ï¼š</p><pre><code class="bash">go env -w GOPROXY=https://goproxy.cn,direct</code></pre><img src="/2022/10/01/01-golang-proxy/go_success.jpg" class="" title="æˆåŠŸä¸‹è½½"><p><a href="https://proxy.golang.com/">https://proxy.golang.com</a> è®¾ç½®ä¸ºä»£ç†åæ‹‰åŒ…ä¾æ—§å¤±è´¥åŸå› ï¼šè¯¥åœ°å€åœ¨ä¸­å›½å¤§é™†å·²è¢«å±è”½ï¼Œæ‰€ä»¥ä¸å¯ç”¨</p><pre><code class="bash">export GOPROXY=https://proxy.golang.com.cn,directexport GOPROXY=https://goproxy.io,direct</code></pre><h4 id="ç¯å¢ƒå˜é‡"><a href="#ç¯å¢ƒå˜é‡" class="headerlink" title="ç¯å¢ƒå˜é‡"></a>ç¯å¢ƒå˜é‡</h4><img src="/2022/10/01/01-golang-proxy/go_env.webp" class="" title="ç¯å¢ƒå˜é‡å«ä¹‰"><p>å¼•ç”¨åŒ…ï¼š(æŒ‡æ˜æœ¬åœ°è·¯å¾„)</p><pre><code>go mod edit -replace example.com/greetings=../greetings</code></pre><blockquote><p>å‚è€ƒæ–‡ç« </p><ol><li><a href="https://segmentfault.com/a/1190000041720288">ç®€å•èŠèŠ GOPATH ä¸ Go Modules</a></li></ol></blockquote>]]></content>
      
      
      <categories>
          
          <category> åç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> GoLang </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux-error</title>
      <link href="/2022/09/23/linux-error/"/>
      <url>/2022/09/23/linux-error/</url>
      
        <content type="html"><![CDATA[<h2 id="æŠ¥é”™ä¿¡æ¯"><a href="#æŠ¥é”™ä¿¡æ¯" class="headerlink" title="æŠ¥é”™ä¿¡æ¯"></a>æŠ¥é”™ä¿¡æ¯</h2><blockquote><p>Failed to download metadata for repo â€˜AppStreamâ€™ [CentOS8]</p></blockquote><h3 id="è§£å†³æ–¹æ³•"><a href="#è§£å†³æ–¹æ³•" class="headerlink" title="è§£å†³æ–¹æ³•"></a>è§£å†³æ–¹æ³•</h3><ol><li>è¿›å…¥ç›®å½• <code>cd /etc/yum.repos.d/</code></li><li>æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</li></ol><ul><li><code>sed -i &#39;s/mirrorlist/#mirrorlist/g&#39; /etc/yum.repos.d/CentOS-*</code></li><li><code>sed -i &#39;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#39; /etc/yum.repos.d/CentOS-*</code></li></ul><ol start="3"><li>æ›´æ–° <code>yum update -y</code></li></ol><h2 id="ç£ç›˜è¿‡æ»¡æ€ä¹ˆå¤„ç†"><a href="#ç£ç›˜è¿‡æ»¡æ€ä¹ˆå¤„ç†" class="headerlink" title="ç£ç›˜è¿‡æ»¡æ€ä¹ˆå¤„ç†"></a>ç£ç›˜è¿‡æ»¡æ€ä¹ˆå¤„ç†</h2><ol><li><code>docker volume prune -f</code></li><li><a href="https://blog.csdn.net/a854517900/article/details/80824966">https://blog.csdn.net/a854517900/article/details/80824966</a></li></ol><h2 id="Linux-ä¿®æ”¹ç¯å¢ƒå˜é‡å¤±è´¥"><a href="#Linux-ä¿®æ”¹ç¯å¢ƒå˜é‡å¤±è´¥" class="headerlink" title="Linux ä¿®æ”¹ç¯å¢ƒå˜é‡å¤±è´¥"></a>Linux ä¿®æ”¹ç¯å¢ƒå˜é‡å¤±è´¥</h2><ol><li>&#x2F;etc&#x2F;profile</li><li>&#x2F;root&#x2F;.bash_profileï¼ˆæ¨èï¼‰</li><li><strong>_ ä¿®æ”¹å®Œä¹‹åé‡å¯æœºå™¨ï¼Œç¯å¢ƒå˜é‡çš„ä¿®æ”¹æ‰ä¼šçœŸæ­£ç”Ÿæ•ˆ_</strong></li></ol><h2 id="æŠŠ-centos7-ç³»ç»Ÿæ‰“åŒ…æˆ-docker-é•œåƒ"><a href="#æŠŠ-centos7-ç³»ç»Ÿæ‰“åŒ…æˆ-docker-é•œåƒ" class="headerlink" title="æŠŠ centos7 ç³»ç»Ÿæ‰“åŒ…æˆ docker é•œåƒ"></a>æŠŠ centos7 ç³»ç»Ÿæ‰“åŒ…æˆ docker é•œåƒ</h2><ol><li><p>å®‰è£… docker</p></li><li><p>åˆ‡æ¢åˆ°ç³»ç»Ÿæ ¹ç›®å½•ï¼Œå¯¹å½“å‰æ–‡ä»¶è¿›è¡Œå‹ç¼©<br><code>tar -cvpf /tmp/system.tar --directory=/ --exclude=proc --exclude=sys --exclude=dev --exclude=run --exclude=boot . </code></p><blockquote><p>&#x2F;procã€&#x2F;sysã€&#x2F;runã€&#x2F;dev è¿™å‡ ä¸ªç›®å½•éƒ½æ˜¯ç³»ç»Ÿå¯åŠ¨æ—¶è‡ªåŠ¨ç”Ÿæˆçš„ï¼Œè™½ç„¶ä¹Ÿå±äºæ–‡ä»¶ç³»ç»Ÿä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯ä»–ä»¬æ¯æ¬¡å¼€æœºéƒ½ä¼šæœ‰å˜åŒ–ï¼Œæ‰€ä»¥æ‰“åŒ…çš„æ—¶å€™å°±åº”è¯¥å¿½ç•¥å®ƒä»¬</p></blockquote></li><li><p>å¯¼å…¥ docker<br><code>docker import /tmp/system.tar linux:10.1</code></p></li><li><p>ç™»å½•å¹¶æ–°å»ºä»“åº“ emailforcodeyy&#x2F;centos7_iam</p></li><li><p>å°†ç”Ÿæˆçš„é•œåƒæ¨é€åˆ° docker hub</p><pre><code class="bash">docker logindocker push emailforcodeyy/centos7_iam:v1.0.0</code></pre></li></ol><blockquote><p>å‚è€ƒé“¾æ¥:<a href="https://cloud.tencent.com/developer/article/1920079">https://cloud.tencent.com/developer/article/1920079</a></p></blockquote>]]></content>
      
      
      <categories>
          
          <category> è™šæ‹Ÿæœº </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CentOS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>backTopAndBottom</title>
      <link href="/2022/09/23/backtopandbottom/"/>
      <url>/2022/09/23/backtopandbottom/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼ºé™·é“¾æ¥"><a href="#ç¼ºé™·é“¾æ¥" class="headerlink" title="ç¼ºé™·é“¾æ¥"></a>ç¼ºé™·é“¾æ¥</h2><p><a href="http://10.186.18.11/jira/browse/DMP-13892">http://10.186.18.11/jira/browse/DMP-13892</a></p><h2 id="éœ€æ±‚"><a href="#éœ€æ±‚" class="headerlink" title="éœ€æ±‚"></a>éœ€æ±‚</h2><p>å·¡æ£€æŠ¥å‘Šé¡µé¢ã€åº“è¡¨æ£€æŸ¥é¡µé¢å¢åŠ ç½®é¡¶ã€ç½®åº•åŠŸèƒ½</p><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li>ä¸¤ä¸ªé¡µé¢éƒ½éœ€è¦å¢åŠ è¿™ä¸ªåŠŸèƒ½,é‚£å°±åšæˆä¸€ä¸ªç»„ä»¶,é¿å…å†™é‡å¤ä»£ç </li><li>umc-uié¡¹ç›®ä¸­å·²ç»æœ‰è¿™éƒ¨åˆ†åŠŸèƒ½çš„å®ç°,æ‰€ä»¥åªéœ€è¦æ•´åˆä¸€ä¸‹ç›¸å…³çš„ä»£ç å°è£…æˆç»„ä»¶</li><li>ç½®é¡¶åŠŸèƒ½åœ¨antdä¸­å·²ç»å®ç°,æ‰€ä»¥éœ€è¦æˆ‘ä»¬è‡ªå·±å®ç°çš„åªæœ‰ç½®åº•åŠŸèƒ½</li><li>é€šè¿‡scrollInViewæ–¹æ³•å®ç°</li></ol><h2 id="ç›¸å…³ä»£ç "><a href="#ç›¸å…³ä»£ç " class="headerlink" title="ç›¸å…³ä»£ç "></a>ç›¸å…³ä»£ç </h2><pre><code class="React">import &#123;  VerticalAlignBottomOutlined,  VerticalAlignTopOutlined,&#125; from &#39;@ant-design/icons&#39;;import &#123; BackTop, Button &#125; from &#39;antd&#39;;import &#123; useEffect, useState &#125; from &#39;react&#39;;const BackTopAndBottom: React.FC&lt;&#123; contentRef: HTMLDivElement | null &#125;&gt; = (&#123;  contentRef,&#125;) =&gt; &#123;  const [toBottomButtonVisible, setToBottomButtonVisible] = useState(true);  const moveToBottom = () =&gt; &#123;    if (contentRef) &#123;      contentRef.scrollIntoView(&#123;        block: &#39;end&#39;,        behavior: &#39;smooth&#39;,      &#125;);    &#125;  &#125;;  useEffect(() =&gt; &#123;    const dom = document.querySelector(      &#39;#root main.ant-layout-content.action-content&#39;    );    const handleScrollChange = () =&gt; &#123;      const interval =        (dom?.scrollHeight ?? 0) -        (dom?.scrollTop ?? 0) -        (dom?.clientHeight ?? 0);      setToBottomButtonVisible(interval &gt; 80);    &#125;;    dom?.addEventListener(&#39;scroll&#39;, handleScrollChange);    return () =&gt; &#123;      dom?.removeEventListener(&#39;scroll&#39;, handleScrollChange);    &#125;;  &#125;, []);  return (    &lt;&gt;      &#123;toBottomButtonVisible &amp;&amp; (        &lt;Button          shape=&quot;circle&quot;          icon=&#123;&lt;VerticalAlignBottomOutlined /&gt;&#125;          onClick=&#123;moveToBottom&#125;          type=&quot;primary&quot;        /&gt;      )&#125;      &lt;BackTop        visibilityHeight=&#123;250&#125;        className=&quot;back-top&quot;        target=&#123;() =&gt; document.querySelector(&#39;.action-content&#39;) as HTMLElement&#125;      &gt;        &lt;Button          shape=&quot;circle&quot;          type=&quot;primary&quot;          icon=&#123;&lt;VerticalAlignTopOutlined /&gt;&#125;        &gt;&lt;/Button&gt;      &lt;/BackTop&gt;    &lt;/&gt;  );&#125;;export default BackTopAndBottom;</code></pre><h2 id="é‡åˆ°çš„é—®é¢˜"><a href="#é‡åˆ°çš„é—®é¢˜" class="headerlink" title="é‡åˆ°çš„é—®é¢˜"></a>é‡åˆ°çš„é—®é¢˜</h2><p>è¿™ä¸ªç»„ä»¶æ·»åŠ ä»¥å,åœ¨åº“è¡¨æ£€æŸ¥é¡µé¢æ²¡æœ‰é—®é¢˜,ä½†æ˜¯åœ¨å·¡æ£€æŠ¥å‘Šé¡µé¢,å‡ºç°äº†ä¸‹é¢çš„bug:</p><pre><code class="TypeScript">  contentRef.scrollIntoView(&#123;    block: &#39;end&#39;,    behavior: &#39;smooth&#39;,  &#125;);</code></pre><p>å½“behaviorè®¾ç½®ä¸ºsmoothçš„æ—¶å€™ç‚¹å‡»ç½®åº•æŒ‰é’®,é¢„æœŸæ˜¯æ‹‰åˆ°é¡µé¢åº•éƒ¨,ä½†æ˜¯å®é™…æƒ…å†µæ˜¯åœåœ¨äº†é¡µé¢çš„ç¬¬ä¸€å¼ canvaså›¾éƒ¨åˆ†,å¹¶æ²¡æœ‰ä¸€ç›´æ‹‰åˆ°é¡µé¢åº•éƒ¨;ä½†æ˜¯è®¾ç½®ä¸ºautoä»¥å,å³å–æ¶ˆåŠ¨ç”»,ç‚¹å‡»å¯ä»¥æ‹‰åˆ°é¡µé¢åº•éƒ¨ã€‚</p><h2 id="é—®é¢˜è§£å†³"><a href="#é—®é¢˜è§£å†³" class="headerlink" title="é—®é¢˜è§£å†³"></a>é—®é¢˜è§£å†³</h2><p>æ¯”è¾ƒä¸¤ä¸ªé¡µé¢è°ƒç”¨ç»„ä»¶çš„çˆ¶ç»„ä»¶çš„ä»£ç ï¼Œå‘ç°å·¡æ£€æŠ¥å‘Šé¡µé¢ç›‘å¬äº†é¡µé¢çš„æ»šåŠ¨äº‹ä»¶ï¼Œè€Œåº“è¡¨æ£€æŸ¥é¡µé¢æ²¡æœ‰,äºæ˜¯æ³¨é‡Šäº†å¯¹åº”çš„ä»£ç ï¼Œå‘ç°é—®é¢˜è¢«è§£å†³äº†ã€‚</p><pre><code class="TypeScript">  let setScroll = true;  useLayoutEffect(() =&gt; &#123;    const content = document.querySelector&lt;HTMLElement&gt;(&#39;.action-content&#39;);    if (setScroll &amp;&amp; content) &#123;      setScroll = false;      // æ­¤å¤„æ˜¯é—®é¢˜äº§ç”Ÿçš„åŸå› ï¼Œå¢åŠ é˜²æŠ–å¯è§£å†³é—®é¢˜      content.addEventListener(&#39;scroll&#39;,scrollChange);      // ä¿®æ”¹å       content.addEventListener(&#39;scroll&#39;,lodash.debounce(scrollChange,100));    &#125;    return () =&gt; &#123;      if (content) &#123;        content.removeEventListener(&#39;scroll&#39;, scrollChange);      &#125;    &#125;;  &#125;);  const scrollChange = () =&gt; &#123;    const ball = document.querySelector&lt;HTMLSpanElement&gt;(      &#39;.ant-anchor-ink-ball&#39;    );    if (ball) &#123;      const top = Number.parseInt(ball.style.top || &#39;&#39;);      const wrapper = document.querySelector&lt;HTMLDivElement&gt;(        &#39;.ant-anchor-wrapper&#39;      );      const height = wrapper ? wrapper.clientHeight : 0;      if (wrapper) &#123;        if (top &gt; height) &#123;          wrapper.scrollTop = top - height + 100;        &#125; else if (top &lt; wrapper.scrollTop) &#123;          wrapper.scrollTop = top - 100;        &#125;      &#125;    &#125;  &#125;;</code></pre><h2 id="çŒœæƒ³"><a href="#çŒœæƒ³" class="headerlink" title="çŒœæƒ³"></a>çŒœæƒ³</h2><p>å­ç»„ä»¶å’Œçˆ¶ç»„ä»¶éƒ½ç›‘å¬äº†action-contentå®¹å™¨çš„æ»šåŠ¨äº‹ä»¶ï¼Œå¹¶ä¸”æœ‰ä¸åŒçš„å›è°ƒå‡½æ•°ï¼ŒåŒæ—¶æ‰§è¡Œä¼šå¯¼è‡´å†²çªï¼Œæœ€ç»ˆæ»šåŠ¨çš„é«˜åº¦æ²¡æœ‰è¾¾åˆ°é¢„æœŸã€‚ä½¿ç”¨debounceé˜²æŠ–ï¼Œå»¶è¿Ÿæ‰§è¡Œï¼Œå¯ä»¥æ¶ˆé™¤è¿™ä¸€é—®é¢˜</p><h2 id="çŸ¥è¯†ç‚¹"><a href="#çŸ¥è¯†ç‚¹" class="headerlink" title="çŸ¥è¯†ç‚¹"></a>çŸ¥è¯†ç‚¹</h2><ul><li>debounce é˜²æŠ–<blockquote><ul><li>_.debounce(func, [wait&#x3D;0], [options&#x3D;])</li><li>åœ¨ä¸€æ®µè¿ç»­æ“ä½œç»“æŸåï¼Œå¤„ç†å›è°ƒ</li><li>åˆ›å»ºä¸€ä¸ª debouncedï¼ˆé˜²æŠ–åŠ¨ï¼‰å‡½æ•°ï¼Œè¯¥å‡½æ•°ä¼šä»ä¸Šä¸€æ¬¡è¢«è°ƒç”¨åï¼Œå»¶è¿Ÿ wait æ¯«ç§’åè°ƒç”¨ func æ–¹æ³•</li><li>å¦‚æœ wait ä¸º 0 å¹¶ä¸” leading ä¸º false, funcè°ƒç”¨å°†è¢«æ¨è¿Ÿåˆ°ä¸‹ä¸€ä¸ªç‚¹ï¼Œç±»ä¼¼setTimeoutä¸º0çš„è¶…æ—¶</li></ul></blockquote></li><li>throttle èŠ‚æµ<blockquote><ul><li>_.throttle(func, [wait&#x3D;0], [options&#x3D;])</li><li>åˆ›å»ºä¸€ä¸ªèŠ‚æµå‡½æ•°ï¼Œåœ¨ wait ç§’å†…æœ€å¤šæ‰§è¡Œ func ä¸€æ¬¡çš„å‡½æ•°</li><li>åœ¨ä¸€æ®µè¿ç»­æ“ä½œä¸­ï¼Œæ¯ä¸€æ®µæ—¶é—´åªæ‰§è¡Œä¸€æ¬¡</li></ul></blockquote></li><li>åŸç”ŸJSå®ç°</li></ul><pre><code class="TypeScript">//é˜²æŠ– debouncefunction debounce(fn, delay) &#123;    var timer; // ç»´æŠ¤ä¸€ä¸ª timer    return function () &#123;        var _this = this; // å–debounceæ‰§è¡Œä½œç”¨åŸŸçš„this        var args = arguments;        if (timer) &#123;            clearTimeout(timer);        &#125;        timer = setTimeout(function () &#123;            fn.apply(_this, args); // ç”¨applyæŒ‡å‘è°ƒç”¨debounceçš„å¯¹è±¡ï¼Œç›¸å½“äº_this.fn(args);        &#125;, delay);    &#125;;&#125;//èŠ‚æµ throttlefunction throttle(fn, delay) &#123;    var timer;    return function () &#123;        var _this = this;        var args = arguments;        if (timer) &#123;            return;        &#125;        timer = setTimeout(function () &#123;            fn.apply(_this, args);            timer = null; // åœ¨delayåæ‰§è¡Œå®Œfnä¹‹åæ¸…ç©ºtimerï¼Œæ­¤æ—¶timerä¸ºå‡ï¼Œthrottleè§¦å‘å¯ä»¥è¿›å…¥è®¡æ—¶å™¨        &#125;, delay)    &#125;&#125;</code></pre><h2 id="å‚è€ƒæ–‡ç« é“¾æ¥"><a href="#å‚è€ƒæ–‡ç« é“¾æ¥" class="headerlink" title="å‚è€ƒæ–‡ç« é“¾æ¥"></a>å‚è€ƒæ–‡ç« é“¾æ¥</h2><ol><li><a href="https://juejin.cn/post/6844903669389885453">https://juejin.cn/post/6844903669389885453</a></li><li><a href="https://segmentfault.com/a/1190000018445196">https://segmentfault.com/a/1190000018445196</a></li></ol>]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ç½®é¡¶åŠŸèƒ½å®ç° </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>ã€è¯‘ã€‘The Evolution of the Modern Web Application Development</title>
      <link href="/2022/09/19/web-ying-yong-kai-fa-de-yan-bian/"/>
      <url>/2022/09/19/web-ying-yong-kai-fa-de-yan-bian/</url>
      
        <content type="html"><![CDATA[<blockquote><p> æœ¬æ–‡åŸæ–‡é“¾æ¥ï¼š<a href="https://blog.bitsrc.io/the-evolution-of-the-modern-web-application-development-18aa95b7c1a">https://blog.bitsrc.io/the-evolution-of-the-modern-web-application-development-18aa95b7c1a</a></p></blockquote><h2 id="ç°ä»£webåº”ç”¨å¼€å‘çš„è¿›åŒ–"><a href="#ç°ä»£webåº”ç”¨å¼€å‘çš„è¿›åŒ–" class="headerlink" title="ç°ä»£webåº”ç”¨å¼€å‘çš„è¿›åŒ–"></a>ç°ä»£webåº”ç”¨å¼€å‘çš„è¿›åŒ–</h2><h3 id="é‚£æ—¶å€™å¼€å‘äººå‘˜çš„å·¥ä½œå’Œç°åœ¨å¤§ä¸ç›¸åŒ"><a href="#é‚£æ—¶å€™å¼€å‘äººå‘˜çš„å·¥ä½œå’Œç°åœ¨å¤§ä¸ç›¸åŒ" class="headerlink" title="é‚£æ—¶å€™å¼€å‘äººå‘˜çš„å·¥ä½œå’Œç°åœ¨å¤§ä¸ç›¸åŒ"></a>é‚£æ—¶å€™å¼€å‘äººå‘˜çš„å·¥ä½œå’Œç°åœ¨å¤§ä¸ç›¸åŒ</h3><p><img src="https://cdn-images-1.medium.com/max/8208/1*47wUIbkat0g69vKjxm-rOg.jpeg" alt="äººç±»è¿›åŒ–"></p><p>ä½ å¯èƒ½ä¼šéå¸¸å¥½å¥‡: ä»€ä¹ˆæ ·çš„å¼€å‘è€…ä¼šå†™å‡ºåƒè¿™æ ·çš„æ–‡ç« ?</p><p>é‚£ä¹ˆæˆ‘å¯ä»¥å›ç­”è¿™ä¸ªé—®é¢˜: <em>ä¸€ä¸ªè€ç¨‹åºå‘˜</em>.</p><p><img src="https://cdn-images-1.medium.com/max/2416/1*cH7VoyCKrOykiUr5wDr0KA.png" alt="æ¨ç‰¹ç»™äº†æˆ‘å†™è¿™ç¯‡æ–‡ç« çš„çµæ„Ÿ(è¿™è®©æˆ‘è§‰å¾—è‡ªå·±è€çš„è¦å‘½)"></p><p>ä¸å¼€ç©ç¬‘äº†,æˆ‘ä¸å¹´è½»äº†,ä¸”åˆ°ç›®å‰ä¸ºæ­¢å·²ç»åœ¨ IT è¡Œä¸šå·¥ä½œäº†20å¹´. å¥½å¤„å°±æ˜¯å½“æˆ‘å¹´çºªå¤§åˆ°å¯ä»¥å†™è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæˆ‘è¿˜å¾ˆå¹´è½»ï¼Œæˆ‘ä»ç„¶è®°å¾—æˆ‘ä»¬è¿‡å»çš„å·¥ä½œæœ‰å“ªäº›ä¸åŒã€‚æ‰€ä»¥ï¼Œæˆ‘æ¥å—äº†æˆ‘åœ¨åŒä¸€æ—¶é—´å¯ä»¥æ—¢å¹´è½»åˆå¹´è¿ˆã€‚</p><p>ä¹Ÿå°±æ˜¯è¯´, â€œä»¥å‰â€ æˆ‘ä»¬å¸¸å¸¸ä½¿ç”¨ä¸åŒçš„å·¥å…·ã€æ¨¡å¼ã€heckç”šè‡³æ ‡å‡†å·¥ä½œï¼Œé‚£æ—¶å€™å…¼å®¹ IE è¿˜ä¸æ˜¯ä¸€ä¸ªç¬‘è¯, äº‹å®ä¸Š, å…¼å®¹æ‰€æœ‰ä¸»æµæµè§ˆå™¨ä¹Ÿä¸å®¹æ˜“ã€‚</p><p>è®©æˆ‘ä»¬æ²¿ç€è®°å¿†çš„å°è·¯æ…¢æ…¢å‰è¡Œ,æ…¢æ…¢å›å¿†è¿‡å»çš„æƒ…å½¢,è¿™æ ·æˆ‘ä»¬å¯ä»¥æ›´å¥½çš„ç†è§£ç°åœ¨ä½¿ç”¨çš„å·¥å…·ã€‚</p><h2 id="Netlify-Vercel-AWS-è¿™æ˜¯ä»€ä¹ˆ"><a href="#Netlify-Vercel-AWS-è¿™æ˜¯ä»€ä¹ˆ" class="headerlink" title="Netlify? Vercel? AWS? è¿™æ˜¯ä»€ä¹ˆ?"></a>Netlify? Vercel? AWS? è¿™æ˜¯ä»€ä¹ˆ?</h2><p>å½“æˆ‘20å¹´å‰å…¥è¡Œçš„æ—¶å€™ï¼ŒæŠŠå¹³å°ç”šè‡³è½¯ä»¶ä½œä¸ºä¸€ä¸ª Service è¿™ä»¶äº‹è¿˜ä¸å­˜åœ¨ã€‚</p><p>é‚£æ—¶å€™å¼€å‘è½¯ä»¶æœ‰å¤šä¸åŒå‘¢? äº‹å®ä¸Š,  â€œAPI Everythingâ€ æ€æƒ³é‚£æ—¶å€™è¿˜æ²¡æœ‰çœŸæ­£å®ç°ã€‚ å¯åŠ¨å¹¶è¿è¡Œä¸€ä¸ª Service éœ€è¦å¤§é‡ç²¾åŠ›å’Œé‡‘é’±ï¼Œæ‰€ä»¥é™¤éæœ‰å¿…è¦çš„ç†ç”±ï¼Œå¦åˆ™æ²¡æœ‰äººä¼šå»åšã€‚</p><p>é™¤æ­¤ä¹‹å¤–, æˆ‘ä»¬è¿‡å»ä½¿ç”¨çš„å·¥å…·ä¹Ÿä¸ä¸€æ ·, Node.js è¿˜æ²¡å‡ºç°, æ‰€ä»¥æƒ³ä½¿ç”¨åƒ Next.js è¿™æ ·çš„æ¡†æ¶ä¹Ÿæ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘ä¸€å¼€å§‹ä½¿ç”¨ PHP 4, å®ƒå’Œç°åœ¨çš„ Node.js(æˆ–å…¶ä»–å·¥å…·) ä¸ä¸€æ ·ï¼Œä¸èƒ½åˆ›å»ºä½ è‡ªå·±çš„ web æœåŠ¡å™¨ã€‚ç›¸å, æˆ‘ä»¬å¿…é¡»å®‰è£… <a href="https://httpd.apache.org/">Apache Web Server</a>,æˆ–è€…å¦‚æœä½ æ˜¯ä¸€ä¸ªå†’é™©è€…,å¹¶ä¸”æƒ³æ‹¥æœ‰ä¸€ä¸ªåŸºäº Windows çš„ web æœåŠ¡å™¨, Internet Information Service(IIS) ä¹Ÿå¯ä»¥, å®ƒæ›¾ç»æ˜¯(æˆ–è®¸ç°åœ¨ä¹Ÿæ˜¯ï¼Ÿ) Microsoft æä¾›çš„ä¸€ä¸ªé€‰æ‹©(è¿™åœ¨è¿‡å»å¹¶ä¸ç†æƒ³)ã€‚</p><p>å…³äºè¿™ç§å·¥ä½œæ–¹å¼å¾ˆæœ‰è¶£çš„ä¸€ç‚¹æ˜¯ï¼šä½ çš„åº”ç”¨æ˜¯ä¸€ç³»åˆ—çš„è„šæœ¬ï¼Œå®ƒä»¬ä¼šåœ¨æ¯æ¬¡æœåŠ¡å™¨æ¥æ”¶åˆ°ä¸€ä¸ªè¯·æ±‚çš„æ—¶å€™è¢«æ‰§è¡Œã€‚ è¿™æ„å‘³ç€ä½ çš„æœåŠ¡å™¨ä¸Šæ²¡æœ‰è¿è¡Œä¸­çš„ appã€‚ æ¯ä¸€ä¸ªæ–°çš„è¯·æ±‚æœ€ç»ˆéƒ½ä¼šå˜æˆä¸€ä¸ªæ–°çš„è¿›ç¨‹ï¼Œè¿è¡Œåœ¨æœåŠ¡å™¨å†…éƒ¨ã€‚è¿™æ„å‘³ç€æœåŠ¡å™¨å¿…é¡»è¶³å¤Ÿå¼ºå¤§ï¼Œèƒ½å¤Ÿå¤„ç†å¾ˆå¤šè¯·æ±‚ï¼Œå› ä¸ºæ¯ä¸ªè¯·æ±‚éƒ½æ˜¯ä¸€ä¸ªå¹¶è¡Œè¿›ç¨‹ï¼Œä¼šå ç”¨ä¸€å—å†…å­˜å’Œ CPU æ—¶é—´ã€‚</p><p>å½“ç„¶, æ•°æ®åº“è¿æ¥ (å’Œå…¶ä»–çš„æœåŠ¡) ä¹Ÿå¿…é¡»åœ¨è„šæœ¬çš„ç”Ÿå‘½å‘¨æœŸå†…è¢«å»ºç«‹å’Œå…³é—­(æ¯”å¦‚åœ¨è¯·æ±‚æœŸé—´)ã€‚</p><p>å¦‚æœä½ æƒ³è¦æ‰©å®¹, â€œè‡ªåŠ¨æ‰©å®¹â€æ˜¯ä¸å¯èƒ½çš„ã€‚æˆ‘è¿˜è®°å¾—ç‰¹å®šèŠ‚å‡æ—¥å¿…é¡»è¯„ä¼°è¿è¡Œç”µå•†ç½‘ç«™éœ€è¦çš„æœåŠ¡å™¨æ•°é‡æ˜¯å¤šä¹ˆç—›è‹¦ã€‚ å½“ç„¶, æ€»æ˜¯æœ‰ä¸è¶³ä¹‹å¤„ï¼Œä»¥è‡³äºå¼€å‘è€…ä»¬å‘¨æœ«æœŸé—´ä¸å¾—ä¸è¿›è¡Œç´§æ€¥ä¿®å¤å¤„ç†(æ¯”å¦‚é‡æ–°å¯åŠ¨æŒ‚æ‰çš„æ•°æ®åº“,æˆ–è€…æ¸…ç†å¤§åˆ°å……æ»¡æ•´ä¸ªç¡¬ç›˜çš„æ—¥å¿—æ–‡ä»¶)ã€‚</p><h3 id="å‰ç«¯æŠ€æœ¯æ ˆæ¯”ç°åœ¨æ›´ç®€å•"><a href="#å‰ç«¯æŠ€æœ¯æ ˆæ¯”ç°åœ¨æ›´ç®€å•" class="headerlink" title="å‰ç«¯æŠ€æœ¯æ ˆæ¯”ç°åœ¨æ›´ç®€å•"></a>å‰ç«¯æŠ€æœ¯æ ˆæ¯”ç°åœ¨æ›´ç®€å•</h3><p>å› ä¸ºä¸‹é¢çš„ä¸€äº›åŸå› ï¼Œé‚£æ—¶å€™çš„å‰ç«¯åœºæ™¯éå¸¸ä¸åŒï¼š</p><ol><li><p>æˆ‘è®¤ä¸ºæœ€é‡è¦çš„ä¸€ç‚¹æ˜¯é‚£æ—¶å€™çš„ HTML, CSS å’Œ JavaScript è¿˜æ²¡æœ‰ç°åœ¨è¿™ä¹ˆæ ‡å‡†åŒ–ã€‚ å°¤å…¶æ˜¯åè€…, æ¯ä¸ªæµè§ˆå™¨éƒ½éµå¾ªè‡ªå·±çš„æŒ‡å¯¼æ–¹é’ˆå®ç°äº†å„è‡ªçš„ç‰ˆæœ¬, å¹¶æ²¡æœ‰è€ƒè™‘åˆ°å…¶ä»–çš„æµè§ˆå™¨. å®ƒæ›´åƒä¸€åœºæ¯”èµ›è€Œä¸æ˜¯åˆä½œã€‚æ‰€ä»¥ Chrome æœ‰çš„åŠŸèƒ½åœ¨   Firefox æˆ–è€… IE ä¸­å¯èƒ½å¹¶ä¸å¯ç”¨ï¼Œåä¹‹äº¦ç„¶ã€‚ è¿™æ„å‘³ç€æ„å»ºä»»ä½•äººéƒ½èƒ½ä½¿ç”¨çš„ Web åº”ç”¨ï¼Œå°±å¿…é¡»å¢åŠ è®¸å¤šä»£ç å¤„ç†è¿™äº›å·®å¼‚ã€‚</p></li><li><p>é‚£æ—¶å€™ä¹Ÿæ²¡æœ‰ UI æ¡†æ¶, åªæœ‰å„ç§åº“. å¯¹æˆ‘æ¥è¯´, è¿™ä¸ªåŒºåˆ«éå¸¸é‡è¦, å› ä¸ºç°åœ¨åƒ React å’Œ Vue è¿™æ ·çš„æ¡†æ¶æä¾›äº†ä¸€ä¸ªä½“ç³»æ¶æ„ï¼Œå®šä¹‰äº†ä¸€ç³»åˆ—ä½ å¯ä»¥éµå¾ªçš„å·¥å…·å’Œæ¨¡å¼ã€‚å¦‚æœä½ åŸºäºä»–ä»¬å»æ„å»ºï¼Œå°±åƒ Next, Nuxt å’Œ å…¶ä»–ä¸€äº›åº”ç”¨åšçš„é‚£æ ·ï¼Œé‚£ä¹ˆä»–ä»¬å°±ä¸ºä½ æä¾›äº†ä¸€æ¡å¯éµå¾ªçš„è·¯å¾„ã€‚è¿‡å»æˆ‘ä»¬æœ‰ jQuery,<a href="https://underscorejs.org/">underscore</a>(ä¹‹åå‡ ä¹è¢«<a href="https://lodash.com/">lodash</a>å–ä»£)ï¼Œä»¥åŠ <a href="https://mootools.net/">Mootools</a>ã€‚è¿™äº›éƒ½æ˜¯å¾ˆå¥½çš„åº“ï¼Œä½†æ˜¯æ²¡æœ‰çœŸæ­£å¼ºåˆ¶æ¨è¡Œä¸€ç§å·¥ä½œæ–¹å¼ï¼Œè¿™å¯¼è‡´äººä»¬è®¤ä¸ºå‰ç«¯å¼€å‘ä¸éœ€è¦ä½¿ç”¨ä»»ä½•å…ˆè¿›çš„å¼€å‘æ–¹æ³•å’ŒæŠ€æœ¯ã€‚æˆ‘è®°å¾—æˆ‘æ›¾ç»è®¤ä¸º JavaScript å°±æ˜¯å¢åŠ è¡¨å•éªŒè¯,ä¸ç„¶å°±æ˜¯ä¸ºé™æ€ç½‘ç«™æ·»åŠ ä¸€äº›æ„šè ¢çš„åŠ¨ç”»ã€‚</p></li></ol><p>ä½ å¿…é¡»è®°ä½, â€œè¿‡å»é‚£æ—¶å€™â€, æˆ‘ä»¬ç”šè‡³ä¸èƒ½å¼‚æ­¥åŠ è½½æ•°æ®ã€‚ç›´åˆ°æœ¯è¯­ AJAX æµè¡Œèµ·æ¥ï¼Œæ‰å‘ç°äº†è¿™ç§èƒ½åŠ› (å¹¶ä¸”å¼€å§‹å­¦ä¹ å¼‚æ­¥è¡Œä¸ºçš„æ¦‚å¿µ)ã€‚è¿™äº›åœ¨ç°åœ¨çœ‹æ¥å¾ˆæ™®é€šçš„äº‹æƒ…å¯¹äºå½“æ—¶æ¥è¯´æ˜¯å·¥ä½œæ¨¡å¼çš„è½¬å˜ã€‚</p><h3 id="ç°åœ¨å®ƒå®¹æ˜“å¤šäº†"><a href="#ç°åœ¨å®ƒå®¹æ˜“å¤šäº†" class="headerlink" title="ç°åœ¨å®ƒå®¹æ˜“å¤šäº†"></a>ç°åœ¨å®ƒå®¹æ˜“å¤šäº†</h3><p>ç°åœ¨å¼€å‘ä¸€ä¸ªåº”ç”¨ç®€å•å¤šäº†,éå¸¸æ–¹ä¾¿,ä¸ä¼šè®©æˆ‘æ‹…å¿ƒã€‚</p><p>ä½ å¯ä»¥æŠŠä½ çš„ Github è´¦å·å’Œä¸€ä¸ª Netlify (æˆ–è€…ç±»ä¼¼çš„å¹³å°) è´¦å·è¿æ¥èµ·æ¥ï¼Œåœ¨ä¸–ç•Œçš„<em>æŸä¸ªåœ°æ–¹</em>è‡ªåŠ¨éƒ¨ç½²åº”ç”¨ã€‚Heck ä½ å¯ä»¥åˆ©ç”¨ç±»ä¼¼ Supabase, æˆ–è€… AWS DynamoDB çš„æœåŠ¡ï¼Œåœ¨è¿™é‡Œä½ éƒ½ä¸ç”¨æ‹…å¿ƒç»´æŠ¤æ•°æ®åº“æˆ–è€…è®¤è¯æœåŠ¡ã€‚</p><p>ç”šè‡³ä¸€äº›æœåŠ¡ä¼šé›†ä¸­æ§åˆ¶ä½ çš„æ—¥å¿—æ–‡ä»¶, åƒ <a href="https://www.loggly.com/">Loggly</a> å’Œ <a href="https://www.splunk.com/">Splunk</a>, æ‰€ä»¥å¦‚æœä½ çš„æ—¥å¿—è½®æ¢é…ç½®ä¸æ˜¯æœ€ä¼˜çš„è¯ï¼Œä¹Ÿä¸éœ€è¦æ‹…å¿ƒç¡¬ç›˜ç©ºé—´è¢«å…¨éƒ¨å ç”¨ã€‚</p><p>é‚£æ—¶å€™ç‹¬ç«‹å·¥ä½œæ˜¯å¾ˆå›°éš¾çš„ï¼Œä½†æ˜¯ç°åœ¨ä½ å¯ä»¥çœŸæ­£åœ°æ¥è¿‘ç‹¬ç«‹å·¥ä½œ(å¦‚æœä½ æ„¿æ„ä¸ºæ­¤ä»˜å‡ºæŠ¥é…¬çš„è¯)ã€‚</p><h3 id="å‰ç«¯æŠ€æœ¯æ ˆå˜å¾—æ›´æœ‰éš¾åº¦äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä»¶å¥½äº‹"><a href="#å‰ç«¯æŠ€æœ¯æ ˆå˜å¾—æ›´æœ‰éš¾åº¦äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä»¶å¥½äº‹" class="headerlink" title="å‰ç«¯æŠ€æœ¯æ ˆå˜å¾—æ›´æœ‰éš¾åº¦äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä»¶å¥½äº‹"></a>å‰ç«¯æŠ€æœ¯æ ˆå˜å¾—æ›´æœ‰éš¾åº¦äº†ï¼Œä½†æ˜¯è¿™æ˜¯ä¸€ä»¶å¥½äº‹</h3><p>å‰ç«¯ç”Ÿæ€ç³»ç»Ÿç°åœ¨å¾ˆå¤§ï¼ŒReactã€Vueã€Svelte ç”šè‡³æ˜¯ Angular,ä»–ä»¬å¯å‘äº†è®¸å¤šæ¡†æ¶çš„è¯ç”Ÿï¼Œè¿™äº›æ¡†æ¶è®©å‰ç«¯æ›´ä¸Šä¸€å±‚æ¥¼ã€‚</p><p>æˆ‘è¿™ä¹ˆè¯´å§,è¿‡å»å½“æˆ‘å¼€å§‹å·¥ä½œçš„æ—¶å€™,web å¼€å‘çš„åº§å³é“­å¸¸å¸¸æ˜¯ â€œç˜¦å®¢æˆ·ç«¯,èƒ–æœåŠ¡ç«¯â€æˆ–è€…æ˜¯â€œè®©ä½ çš„å®¢æˆ·ç«¯å˜å‚»â€åˆæˆ–è€…æ˜¯è¿™äº›æ€æƒ³çš„å˜ä½“ã€‚æœ¬è´¨ä¸Šæ¥è¯´,ä½ çš„å®¢æˆ·ç«¯ä»£ç åªæ˜¯ç®€å•çš„è¡¨ç¤ºå±‚ï¼Œä¸åº”è¯¥åœ¨ä¸Šé¢åšä»»ä½•â€œå›°éš¾â€çš„äº‹æƒ…ï¼Œå› ä¸ºæµè§ˆå™¨è¿˜æ²¡æœ‰åšå¥½å‡†å¤‡ã€‚ç›¸åï¼Œæˆ‘ä»¬å°†â€œå¤æ‚çš„â€é€»è¾‘ç»´æŠ¤åœ¨åç«¯ï¼Œåªä½¿ç”¨ JavaScript æ˜¾ç¤ºæ¼‚äº®çš„é¢œè‰²å’Œä¸€äº›è­¦å‘Šæ¡†ã€‚</p><p>ä»é‚£æ—¶èµ·ï¼Œæˆ‘ä»¬å·²ç»èµ°è¿‡äº†ä¸€æ¡æ¼«é•¿çš„è·¯ã€‚å½“ç„¶,è¿™äº›ä¸æ˜¯æ²¡æœ‰ä»£ä»·çš„ã€‚è¿‡å»æˆ‘ä»¬çš„â€œbundlerâ€æ˜¯ä¸€ç³»åˆ—çš„è„šæœ¬æ ‡ç­¾ï¼Œæ·»åŠ åœ¨ HTML é¡¶éƒ¨ï¼Œå¹¶ä¸”è¿™å°±æ˜¯æ‰€æœ‰äº†ã€‚</p><p>ç°åœ¨é©±åŠ¨ä¸€ä¸ªç°ä»£ app çš„ JS æ•°é‡å·²ç»å¢é•¿äº†å¦‚æ­¤ä¹‹å¤šï¼Œç”¨äºä¼˜åŒ–å®ƒçš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿä¹Ÿéšä¹‹å¢é•¿ã€‚</p><p>ç°åœ¨ä½ éœ€è¦ï¼š</p><ol><li><p>å¦‚æœä½ ä½¿ç”¨çš„ä¸æ˜¯çº¯ JavaScript çš„è¯ï¼Œå°±éœ€è¦ä¸€ä¸ªè½¬è¯‘å™¨ã€‚</p></li><li><p>æ‰“åŒ…å·¥å…·æŠŠæ‰€æœ‰çš„ä»£ç æ”¾åœ¨ä¸€èµ·ï¼Œç§»é™¤ä¸å¿…è¦çš„éƒ¨åˆ†,ä»¥ä¸€ç§å¯¹ç”¨æˆ·æ¥è¯´ä½â€œå¼€é”€â€çš„æ–¹å¼ä¼ è¾“å’Œå‘å¸ƒã€‚</p></li><li><p>lintç¨‹åºï¼Œç¡®ä¿10ä¸‡è¡ŒJSä»£ç ä¸­çš„æ¯ä¸€è¡Œéƒ½éµå¾ªå›¢é˜Ÿä¸­ç›¸åŒçš„æ ‡å‡†ã€‚</p></li><li><p>ä¸€ä¸ªæ‹¥æœ‰çƒ­æ›´æ–°å’Œæ–‡ä»¶ç›‘å¬åŠŸèƒ½çš„ webserver,ä¼˜åŒ–å¼€å‘ä½“éªŒã€‚å¦åˆ™ä¿®æ”¹å•ç‹¬ä¸€è¡Œä»£ç ä¹Ÿä¼šèŠ±è´¹å¤§é‡æ—¶é—´å»æ›´æ–°ã€‚</p></li><li><p>ä¸€ä¸ªåŒ…ç®¡ç†å™¨, å› ä¸ºä½œä¸ºå¼€å‘è€…ï¼Œæˆ‘ä»¬å·²ç»å®Œæˆäº†é‡å¤é€ è½®å­çš„å·¥ä½œã€‚</p></li><li><p>ä¸€ä¸ªç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ (é€šå¸¸æ˜¯ Git + Github ä½†æ˜¯ä¹Ÿæœ‰å…¶ä»–ä¸€äº›é€‰æ‹©) ç¡®ä¿å›¢é˜Ÿæˆå‘˜å¯ä»¥å¾ˆå®¹æ˜“å°±åŒä¸€ä¸ªé¡¹ç›®åˆä½œã€‚</p></li><li><p>ä¸€ä¸ªæµ‹è¯•è¿è¡Œå™¨,å› ä¸ºç°åœ¨ä½ çš„å‰ç«¯ä¸šåŠ¡é€»è¾‘å·²ç»å¦‚æ­¤å¤æ‚ï¼ˆé¡ºä¾¿è¯´ä¸€ä¸‹ä¹Ÿå¾ˆä¼Ÿå¤§ï¼‰ï¼Œä»¥è‡³äºéœ€è¦ä¸€ä¸ªæ–¹æ³•ç¡®ä¿æ‰€æœ‰çš„äº‹æƒ…éƒ½å’Œé¢„æœŸä¸€æ ·è¿è¡Œã€‚</p></li></ol><p>æˆ‘æ‰“èµŒä½ å¯èƒ½ä¼šæƒ³åˆ°æ›´å¤šã€‚è¿™å¯¹åˆšèµ·æ­¥çš„äººæ¥è¯´å¯èƒ½ä¼šæœ‰ä¸€ç‚¹ä¸çŸ¥æ‰€æªã€‚</p><p>æˆ‘çŸ¥é“è¿™æ˜¯æˆ‘åœ¨å¤šå¹´ä¸ç¼–ç¨‹åé‡æ–°ä¸Šé©¬çš„åŸå› ã€‚<br>I know it was for me when getting back on the horse after years of not coding.</p><p>å€¼å¾—åº†å¹¸çš„æ˜¯ï¼Œè¡Œä¸šä»ç„¶åœ¨è¿›åŒ–ã€‚è™½ç„¶å®ƒä»¬ä»ç„¶æ˜¯æ–°çš„ï¼Œå¹¶è¯•å›¾è¿›å…¥ï¼Œä½†äººä»¬æ­£åœ¨å¼€å‘ä¸“é—¨ç”¨äºå†æ¬¡ç®€åŒ–æŠ€æœ¯æ ˆçš„å·¥å…·ï¼ŒåŒæ—¶ä¿ç•™å½“ä»Šå¤æ‚è§£å†³æ–¹æ¡ˆçš„åŠŸèƒ½å’Œèƒ½åŠ›ã€‚</p><h3 id="web-å¼€å‘å·¥å…·ç”Ÿæ€ç³»ç»Ÿçš„æœªæ¥"><a href="#web-å¼€å‘å·¥å…·ç”Ÿæ€ç³»ç»Ÿçš„æœªæ¥" class="headerlink" title="web å¼€å‘å·¥å…·ç”Ÿæ€ç³»ç»Ÿçš„æœªæ¥"></a>web å¼€å‘å·¥å…·ç”Ÿæ€ç³»ç»Ÿçš„æœªæ¥</h3><p>æ—…ç¨‹è¿˜æœªç»“æŸï¼Œè¿™æ˜¯å¥½äº‹æƒ…ã€‚</p><p>å¦‚æœä½ ä»”ç»†æ€è€ƒè¿™ä»¶äº‹æƒ…ï¼Œæˆ‘ä»¬åœ¨ä»£ç ä¸­ä¹Ÿæ˜¯è¿™ä¹ˆåšçš„ï¼š</p><ol><li><p>æˆ‘ä»¬é’ˆå¯¹ä¸€ä¸ªé—®é¢˜å†™äº†ç®€å•çš„è§£å†³æ–¹æ³•ã€‚</p></li><li><p>æˆ‘ä»¬æ„è¯†åˆ°è¿™ä¸ªè§£å†³æ–¹æ³•å¹¶æ²¡æœ‰è¦†ç›–æ‰€æœ‰æ½œåœ¨çš„è¾¹é™…æ¡ˆä¾‹ï¼Œæ‰€ä»¥éœ€è¦åœ¨æ­¤åŸºç¡€ä¸Šæ·»åŠ æ›´å¤šä»£ç ï¼Œç›´åˆ°å®ƒèƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</p></li><li><p>æˆ‘ä»¬æ„è¯†åˆ°å®ƒæ˜¯ä¸€ä¸ªå¯æ¶çš„ Frankenstein ç±»å‹çš„ä»£ç ï¼Œä¸å¯ç»´æŠ¤å¹¶ä¸”éš¾ä»¥ç†è§£ï¼Œæ‰€ä»¥æˆ‘ä»¬å¼€å§‹é‡æ„å’Œç®€åŒ–ã€‚</p></li></ol><p>æˆ‘ä»¬çš„å·¥å…·é“¾æ­£åœ¨ç»å†åŒæ ·çš„è¿‡ç¨‹ã€‚æˆ‘ä»¬ç°åœ¨å¼€å§‹çœ‹åˆ°æ­¥éª¤ #3ã€‚æˆ‘ä»¬çœ‹åˆ°åƒæ¥è‡ª<a href="https://bit.dev/">bit.dev</a>çš„<a href="https://bit.dev/">Bit</a> è¿™æ ·çš„å·¥å…·æ­£åœ¨å°è¯•é›†ä¸­åŒ–ç®¡ç†å¼€å‘å‘¨æœŸä¸­çš„æ‰€æœ‰ä»»åŠ¡ã€‚</p><p>äº‹å®ä¸Š, ä½¿ç”¨ Bit, ä½ å¯ä»¥ç®¡ç†ä»£ç çš„ç‰ˆæœ¬å¹¶ä¸”æµ‹è¯•ä»£ç , å¹¶ä¸”ä½œä¸ºä¸ªäººåŒ…å‘å¸ƒã€‚ä½ ç”šè‡³å¯ä»¥ç”¨å®ƒç®¡ç†ä¸€ä¸ª Monorepo è€Œä¸éœ€è¦æ‹…å¿ƒå…¶ä»–å·¥å…·ã€‚</p><p>å½“ç„¶ï¼Œè¿™ä¹Ÿä¸æ˜¯è¯´å·¥å…·ä¼šä¸ºä½ åšå®Œæ‰€æœ‰çš„äº‹æƒ…ï¼Œäº‹å®ä¸Šï¼Œä»–åªæ˜¯ç®¡ç†äº†æ•´ä¸ªä½ é€šå¸¸ä¼šéœ€è¦æ‹…å¿ƒçš„å·¥å…·ç”Ÿæ€ç³»ç»Ÿã€‚å¦‚æœä½ é—®æˆ‘ï¼Œæˆ‘ä¼šè§‰å¾—è¿™æ˜¯ä¸ªèªæ˜çš„åšæ³•ã€‚</p><p>å¦å¤–, ç±»ä¼¼æ‰“åŒ…å·¥å…·è¿™æ ·çš„å·¥å…·å¼€å§‹è§è¯ä¸€ä¸ªä¸å†éœ€è¦ä»–ä»¬çš„è¶‹åŠ¿ã€‚å¬æˆ‘è¯´, æˆ‘åœ¨ä¸»æŒçš„ <a href="https://podcast.20minjs.com/">20MinJS podcast</a> èŠ‚ç›®ä¸­é‡‡è®¿äº† <a href="https://twitter.com/MicheleRivaCode">Michele Riva</a>(ä»–æ˜¯æ¥è‡ª Nearform çš„é«˜çº§è½¯ä»¶æ¶æ„å¸ˆ),åœ¨é‚£ä¸€é›†ä¸­,Michele æåŠäº† <a href="https://vitejs.dev/">Vite</a> è¿™æ ·çš„æ–°ä¸€ä»£æ‰“åŒ…å·¥å…·æ˜¯å¦‚ä½•åˆ©ç”¨æµè§ˆå™¨çš„æ–°èƒ½åŠ›ï¼š<a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/import">ECMA Script import è¯­å¥</a>,å¼‚æ­¥åŠ è½½æ–‡ä»¶,å› æ­¤æå‡äº† JavaScript çš„åŠ è½½é€Ÿåº¦(è€Œä¸æ˜¯å¿…é¡»åŠ è½½ä¸€ä¸ªæˆ–å¤šä¸ªå¤§çš„è¢«æ‰“åŒ…çš„æ–‡ä»¶)ã€‚</p><p>æ‰€ä»¥å¦‚æœä½ é—®æˆ‘çš„è¯ï¼Œæœªæ¥çœ‹ä¸Šå»æ˜¯éå¸¸å…‰æ˜çš„ã€‚ä»ç„¶æœ‰è®¸å¤šå·¥ä½œè¦åšï¼Œä½†æ˜¯æ‹…å¿§å¿…é¡»ä¸ºåº”ç”¨æ‰‹åŠ¨è®¾ç½®å¹³å°çš„æ—¥å­å·²ç»ä¸€å»ä¸è¿”äº†ã€‚å·¥å…·ç”Ÿæ€ç³»ç»Ÿæ­£åœ¨è¿›åŒ–è‡³ä¸€ä¸ªç‚¹ï¼šæˆ‘ä»¬å¯ä»¥å¿«é€Ÿåˆ¶ä½œåŸå‹å’Œéƒ¨ç½²æƒ³æ³•,ç„¶åå°†å®ƒä»¬å‘å±•æˆæˆç†Ÿçš„åº”ç”¨ç¨‹åºï¼Œè€Œæ— éœ€æ”¹å˜å¤ªå¤šï¼Œåªéœ€è¦æ”¹å˜æˆ‘ä»¬ä½¿ç”¨çš„æœåŠ¡æˆ–æˆ‘ä»¬æ”¯ä»˜çš„å±‚ã€‚å¦‚æœæˆ‘ä»¬æƒ³è¦æ‰©å®¹ï¼Œå› ä¸ºå®ƒä»¬æœ€ç»ˆè·å¾—äº†æˆåŠŸï¼Œåªè¦æˆ‘ä»¬å‡†å¤‡å¥½ä¸ºå®ƒä»˜è´¹ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥è·å¾—ã€‚</p><p>æˆ‘è®¤ä¸º web å¼€å‘è¡Œä¸šçš„å½“å‰çŠ¶æ€çš„é­…åŠ›åœ¨äºæˆ‘ä»¬æ‹¥æœ‰é€‰æ‹©çš„æƒåˆ©ã€‚</p><p>æˆ‘ä»¬ä»ç„¶å¯ä»¥ä½¿ç”¨â€œold school æ–¹å¼â€æ‰‹åŠ¨å»åšæ¯ä¸€ä»¶äº‹æƒ…ï¼Œç®¡ç†æˆ‘ä»¬è‡ªå·±çš„æœåŠ¡å™¨,è§„åˆ’åº”ç”¨æ‰€éœ€çš„æµé‡å’Œå·¥ä½œé‡ï¼Œå¹¶å¢åŠ å¯¹åº”çš„åŸºç¡€è®¾æ–½ã€‚</p><p>æˆ–è€…å¦‚æœæ„¿æ„ä¿¡ä»»å·²ç»è¯•ç”¨å¹¶ä¸”ç»è¿‡æµ‹è¯•çš„å¤–éƒ¨å¹³å°å’ŒæœåŠ¡ï¼Œæˆ‘ä»¬å¯ä»¥æ”¯ä»˜ä»–ä»¬æŠ¥é…¬ä¸ºæˆ‘ä»¬å·¥ä½œã€‚æˆ‘ä»¬ä»æœ¬è´¨ä¸Šç”¨æœåŠ¡æ›¿ä»£äº†åŸæœ¬å¿…é¡»æˆç†Ÿçš„ IT å›¢é˜Ÿï¼Œè¿™å¯¹ä¸€äº›å…¬å¸æ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„å¼•å¯¼ç­–ç•¥ã€‚æ˜¯çš„ï¼Œæœ€ç»ˆä½ ä¼šéœ€è¦ IT å›¢é˜Ÿå’Œä½ ä¸€èµ·å·¥ä½œï¼Œè¿™æ˜¯ä¸å¯å¦è®¤çš„ï¼Œä½†æ˜¯æ²¡æœ‰ IT å›¢é˜Ÿï¼Œæ‚¨å¯ä»¥æ¯”ä»¥å‰èµ°å¾—æ›´è¿œã€‚</p><p>é™¤æ­¤ä¹‹å¤–,å·¥å…·æœ¬èº«ä¹Ÿä¼šæˆé•¿å’Œé€‚åº”ç¤¾åŒºçš„åé¦ˆã€‚<strong>Developer Experience</strong> æ˜¯ä¸€ä¸ªä¼šåœ¨æ—¥å¸¸å·¥å…·è®¾è®¡ä¸­é¢‘ç¹æŠ›å‡ºçš„æœ¯è¯­ï¼Œå¹¶ä¸”æˆ‘ä»¬å¯ä»¥ä»ä½¿ç”¨è¿™äº›å·¥å…·çš„ç®€å•ç¨‹åº¦ä¸­çœ‹å‡ºè¿™ä¸€ç‚¹ã€‚æˆ‘è®¤ä¸ºè¿™æ˜¯éå¸¸èªæ˜çš„ä¸€æ­¥ï¼Œå®ƒå°†è¿›ä¸€æ­¥æ¨åŠ¨å¼€å‘é€Ÿåº¦å’Œèƒ½åŠ›ã€‚</p><p>ä½ è®¤ä¸ºå‘¢? ä»ä½ çš„è§’åº¦æ¥çœ‹ï¼Œæœªæ¥æ˜¯å…‰æ˜çš„å—?</p><h2 id="å¯ç»„åˆ-åƒä¹é«˜ä¸€æ ·æ›´å¿«åœ°æ„å»ºåº”ç”¨"><a href="#å¯ç»„åˆ-åƒä¹é«˜ä¸€æ ·æ›´å¿«åœ°æ„å»ºåº”ç”¨" class="headerlink" title="å¯ç»„åˆ: åƒä¹é«˜ä¸€æ ·æ›´å¿«åœ°æ„å»ºåº”ç”¨"></a>å¯ç»„åˆ: åƒä¹é«˜ä¸€æ ·æ›´å¿«åœ°æ„å»ºåº”ç”¨</h2><p><img src="https://cdn-images-1.medium.com/max/2400/1*x2l8LRH1nbC1FQZUdt50RQ.jpeg"></p><p><a href="https://bit.cloud/">Bit</a> æ˜¯ä¸€ä¸ªä»¥æ¨¡å—åŒ–å’Œåä½œæ–¹å¼æ„å»º app çš„å¼€æºå·¥å…·ã€‚é€šè¿‡å¯ç»„åˆçš„æ–¹å¼æ›´å¿«,æ›´ä¸€è‡´å¹¶ä¸”æ›´å®¹æ˜“æ‰©å®¹ã€‚</p><p>â†’ <a href="https://bit.dev/">äº†è§£æ›´å¤š</a></p><p>æ„å»ºåº”ç”¨,é¡µé¢,ç”¨æˆ·ä½“éªŒå’Œ UI ä½œä¸ºç‹¬ç«‹çš„ç»„ä»¶ã€‚ä½¿ç”¨å®ƒä»¬æ›´å¿«åœ°ç»„æˆæ–°çš„åº”ç”¨å’Œä½“éªŒã€‚å°†ä»»æ„æ¡†æ¶å’Œå·¥å…·å¼•è¿›ä½ çš„å·¥ä½œæµç¨‹ä¸­ã€‚å…±äº«ã€å¤ç”¨å’Œåä½œä»¥ä¸€èµ·æ„å»ºåº”ç”¨ã€‚</p><p>å¸®åŠ©ä½ çš„å›¢é˜Ÿäº†è§£:</p><p><strong>â†’ <a href="https://blog.bitsrc.io/how-we-build-micro-front-ends-d3eeeac0acfc">Micro-Frontends</a></strong></p><p><strong>â†’ <a href="https://blog.bitsrc.io/how-we-build-our-design-system-15713a1f1833">Design Systems</a></strong></p><p><strong>â†’ <a href="https://bit.cloud/blog/how-to-reuse-react-components-across-your-projects-l4pz83f4">Code-Sharing and reuse</a></strong></p><p><strong>â†’ <a href="https://www.youtube.com/watch?v=5wxyDLXRho4&t=2041s">Monorepos</a></strong></p><h2 id="äº†è§£æ›´å¤š"><a href="#äº†è§£æ›´å¤š" class="headerlink" title="äº†è§£æ›´å¤š"></a>äº†è§£æ›´å¤š</h2><p><a href="https://blog.bitsrc.io/how-we-build-micro-front-ends-d3eeeac0acfc"><strong>How We Build Micro Frontends</strong></a><br><a href="https://blog.bitsrc.io/how-we-build-our-design-system-15713a1f1833"><strong>How we Build a Component Design System</strong></a><br><a href="https://bit.cloud/blog/how-to-reuse-react-components-across-your-projects-l3bhezsg"><strong>How to reuse React components across your projects</strong></a><br><a href="https://blog.bitsrc.io/5-ways-to-build-a-react-monorepo-a294b6c5b0ac"><strong>5 Ways to Build a React Monorepo</strong></a></p>]]></content>
      
      
      <categories>
          
          <category> ç¿»è¯‘ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å‰ç«¯ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-deploy-github-443</title>
      <link href="/2022/09/14/hexo-deploy-github-443/"/>
      <url>/2022/09/14/hexo-deploy-github-443/</url>
      
        <content type="html"><![CDATA[<blockquote><p>18 files changed, 191 insertions(+), 191 deletions(-)<br>ERROR: Repository not found.<br>fatal: Could not read from remote repository.<br>Please make sure you have the correct access rights<br>and the repository exists.<br>FATAL Somethingâ€™s wrong. Maybe you can find the solution here: <a href="https://hexo.io/docs/troubleshooting.html">https://hexo.io/docs/troubleshooting.html</a><br>error Command failed with exit code 2.<br>info Visit <a href="https://yarnpkg.com/en/docs/cli/run">https://yarnpkg.com/en/docs/cli/run</a> for documentation about this command.<br>é—®é¢˜:ä½¿ç”¨äº†https<br>è§£å†³æ–¹æ³•:<br>ä¿®æ”¹.config.ymlæ–‡ä»¶,ä½¿ç”¨ssh</p></blockquote><pre><code class="yml">deploy:  type: &#39;git&#39;  repo:    github: git@github.com:earthaYan/earthaYan.github.io.git  branch: master</code></pre><p>å¯¹æ¯”å›¾:</p><img src="/2022/09/14/hexo-deploy-github-443/diff.jpg" class="" title="å¯¹æ¯”">]]></content>
      
      
      <categories>
          
          <category> hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> éƒ¨ç½² </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>å…³äºantv/g2çš„ç¼ºé™·ä¿®å¤</title>
      <link href="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/"/>
      <url>/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/</url>
      
        <content type="html"><![CDATA[<h2 id="ç¼ºé™·é“¾æ¥"><a href="#ç¼ºé™·é“¾æ¥" class="headerlink" title="ç¼ºé™·é“¾æ¥"></a>ç¼ºé™·é“¾æ¥</h2><p><a href="http://10.186.18.11/jira/browse/DMP-13821">http://10.186.18.11/jira/browse/DMP-13821</a></p><h2 id="é—®é¢˜å¤ç°å’Œè§£å†³é“¾æ¥"><a href="#é—®é¢˜å¤ç°å’Œè§£å†³é“¾æ¥" class="headerlink" title="é—®é¢˜å¤ç°å’Œè§£å†³é“¾æ¥"></a>é—®é¢˜å¤ç°å’Œè§£å†³é“¾æ¥</h2><p><a href="https://codesandbox.io/s/tu-biao-xiu-fu-forked-1rqvwe?file=/src/index.data.ts">https://codesandbox.io/s/tu-biao-xiu-fu-forked-1rqvwe?file=/src/index.data.ts</a></p><h2 id="é—®é¢˜å¤ç°æˆªå›¾"><a href="#é—®é¢˜å¤ç°æˆªå›¾" class="headerlink" title="é—®é¢˜å¤ç°æˆªå›¾"></a>é—®é¢˜å¤ç°æˆªå›¾</h2><img src="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/error.png" class="" title="æµ‹è¯•æä¾›æˆªå›¾"><h2 id="å®šä½é—®é¢˜"><a href="#å®šä½é—®é¢˜" class="headerlink" title="å®šä½é—®é¢˜"></a>å®šä½é—®é¢˜</h2><ol><li>é€šè¿‡æŸ¥çœ‹æ¥å£è¿”å›ï¼Œå‘ç°æ¥å£è¿”å›æ•°æ®æ˜¯ç¬¦åˆè¦æ±‚çš„ï¼Œé‚£ä¹ˆé—®é¢˜å°±æ˜¯å‡ºåœ¨å‰ç«¯äº†</li><li>æŸ¥çœ‹ç›¸å…³ä»£ç ï¼Œå‘ç°æ˜¯ä½¿ç”¨antv&#x2F;g2çš„Chartå®ç°çš„</li><li>æ€è€ƒå¯èƒ½æ˜¯ä¼ å…¥æ•°æ®çš„åŸå› å¯¼è‡´çš„ï¼štypeè½´å€¼é‡å¤äº†</li><li>æœ‰ä¸¤ç§ä¿®å¤æ–¹æ³•ï¼š<br>a. dataé‡Œæ–°å¢å±æ€§idï¼Œç”±type+device<br>b. ä¿®æ”¹å¯¹åº”çš„typeå€¼ï¼Œä½¿å®ƒå”¯ä¸€ï¼Œç„¶åå†é€šè¿‡formatteré€‰é¡¹è®¾ç½®typeè½´çš„æ˜¾ç¤º</li><li>å°è¯•äº†æ–¹æ³•aï¼Œå‘ç°BarChartè¿™ä¸ªç»„ä»¶åœ¨å¤šä¸ªçˆ¶ç»„ä»¶ä¸­è¢«è°ƒç”¨ï¼Œå¦‚æœä½¿ç”¨è¯¥æ–¹æ¡ˆéœ€è¦ä¿®æ”¹æ‰€æœ‰çš„çˆ¶ç»„ä»¶çš„dataï¼Œæ‰€ä»¥æœ€ç»ˆé€‰æ‹©æ–¹æ¡ˆ2</li></ol><h2 id="ä¿®å¤å‰åä»£ç å¯¹æ¯”"><a href="#ä¿®å¤å‰åä»£ç å¯¹æ¯”" class="headerlink" title="ä¿®å¤å‰åä»£ç å¯¹æ¯”"></a>ä¿®å¤å‰åä»£ç å¯¹æ¯”</h2><img src="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/%E4%BF%AE%E5%A4%8D1.jpg" class="" title="BarChartç»„ä»¶"><img src="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/%E4%BF%AE%E5%A4%8D2.jpg" class="" title="è°ƒç”¨BarChartçš„çˆ¶ç»„ä»¶"><h3 id="ä½¿ç”¨antv-x2F-g2å®ç°ä¸€ä¸ªæ¡å½¢å›¾çš„è¿‡ç¨‹"><a href="#ä½¿ç”¨antv-x2F-g2å®ç°ä¸€ä¸ªæ¡å½¢å›¾çš„è¿‡ç¨‹" class="headerlink" title="ä½¿ç”¨antv&#x2F;g2å®ç°ä¸€ä¸ªæ¡å½¢å›¾çš„è¿‡ç¨‹"></a>ä½¿ç”¨antv&#x2F;g2å®ç°ä¸€ä¸ªæ¡å½¢å›¾çš„è¿‡ç¨‹</h3><pre><code class="TypeScript">  // åˆå§‹åŒ–å›¾è¡¨  const initChart = () =&gt; &#123;    chart.current = new Chart(&#123;      container: `$&#123;titleKey&#125;_chart`,      autoFit: true,      height: 295,      padding: [30, 50, 30, 200],    &#125;);  &#125;;</code></pre><pre><code class="TypeScript">  // ç»˜åˆ¶å›¾è¡¨  const drawChart = (data: IChartData[]) =&gt; &#123;    chart.current?.data(data);    chart.current?.axis(&#39;type&#39;, &#123;      label: &#123;        autoEllipsis: true,        style: &#123;          fill: currentThemeData.chart.linkColor,          textAlign: &#39;left&#39;,          fontSize: 14,        &#125;,        offsetX: -180,        formatter: (val) =&gt; getIp(val),      &#125;,      tickLine: null,      line: null,      verticalLimitLength: 180,    &#125;);    chart.current?.axis(&#39;value&#39;, &#123;      grid: null,      label: null,    &#125;);    chart.current?.tooltip(false);    chart.current?.legend(false);    chart.current?.coordinate(&#39;rect&#39;).transpose();    if (percent) &#123;      chart.current        ?.interval()        .adjust(&#39;stack&#39;)        .position(&#39;type*value&#39;)        .color(&#39;barType*value&#39;, (barType: string, value: string[]) =&gt; &#123;          if (barType === barTypeEnum.background) &#123;            return &#39;#ebedf0&#39;;          &#125; else &#123;            return getTypeColor(Number(value[1]));          &#125;        &#125;)        .size(15)        .label(&#39;showValue*barType&#39;, (val, barType) =&gt; &#123;          if (barType === barTypeEnum.background) &#123;            return null;          &#125;          if (titleKey === &#39;disk_top10&#39;) &#123;            return &#123;              content: (data) =&gt; &#123;                let deviceStr = data.device;                if (deviceStr.length &gt; 20) &#123;                  deviceStr = data.device.substr(0, 20) + &#39;...&#39;;                &#125;                return `$&#123;Number(val) &gt; 20 ? val : &#39;&lt;20&#39;&#125;% $&#123;deviceStr ?? &#39;&#39;&#125;`;              &#125;,              offset: Number(val) &lt; 20 ? 2 : 10,              position: &#39;left&#39;,              style: &#123;                fill: &#39;#000&#39;,              &#125;,            &#125;;          &#125;          return &#123;            content: val + &#39;%&#39;,            style: &#123;              fill: Number(val) &lt; 20 ? &#39;#000&#39; : &#39;#fff&#39;,            &#125;,            position: &#39;left&#39;,          &#125;;        &#125;);    &#125; else &#123;      chart.current        ?.interval()        .position(&#39;type*value&#39;)        .size(15)        .color(barColor)        .label(&#39;value&#39;, &#123;          style: &#123;            fill: currentThemeData.chart.guideColor,          &#125;,          offset: 20,        &#125;);    &#125;  &#125;;</code></pre><pre><code class="TypeScript">  // æ¸²æŸ“å›¾è¡¨  React.useEffect(() =&gt; &#123;    initChart();    chart.current?.on(&#39;axis-label:click&#39;, jumpAction);    return () =&gt; &#123;      chart.current?.off(&#39;axis-label:click&#39;, jumpAction);    &#125;;  &#125;, []);  React.useEffect(() =&gt; &#123;    if (data?.length) &#123;      drawChart(data);      chart.current?.render();    &#125;    chart.current?.render(true);  &#125;, [data, currentThemeData]);</code></pre><pre><code class="TypeScript">  // ç›‘å¬é‡ç»˜  React.useEffect(() =&gt; &#123;    const MutationObserver = window.MutationObserver;    let observer: MutationObserver;    const e = document.getElementById(`$&#123;titleKey&#125;`);    if (e) &#123;      observer = new MutationObserver(() =&gt; &#123;        chart.current?.forceFit();        chart.current?.render(true);        chart.current?.changeSize(e.scrollWidth, e.scrollHeight - 30);      &#125;);      observer.observe(e, &#123;        attributes: true,        attributeFilter: [&#39;style&#39;],        attributeOldValue: true,      &#125;);    &#125;    return () =&gt; &#123;      if (observer) &#123;        observer.disconnect();      &#125;    &#125;;  &#125;, []); </code></pre><h2 id="é—ç•™é—®é¢˜"><a href="#é—ç•™é—®é¢˜" class="headerlink" title="é—ç•™é—®é¢˜"></a>é—ç•™é—®é¢˜</h2><p>ä¿®å¤å‰getIpè¿”å›çš„æ˜¯xxx.target,ä½†æ˜¯ä¿®å¤ååªèƒ½é€šè¿‡xx.typeå»è·å–,åŸå› ä¸æ˜</p><h3 id="ä¿®å¤åä½¿ç”¨target"><a href="#ä¿®å¤åä½¿ç”¨target" class="headerlink" title="ä¿®å¤åä½¿ç”¨target"></a>ä¿®å¤åä½¿ç”¨target</h3><img src="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/%E4%BF%AE%E5%A4%8D%E5%90%8Etarget.jpg" class="" title="ä¿®å¤åä½¿ç”¨target"><p>æ•ˆæœå¦‚ä¸‹:</p><img src="/2022/09/14/guan-yu-antv-g2-de-que-xian-xiu-fu/result.jpg" class="" title="ä¿®å¤åä½¿ç”¨targetæ•ˆæœå›¾">]]></content>
      
      
      <categories>
          
          <category> å·¥ä½œ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> å›¾è¡¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>TypeScriptå­¦ä¹ ç¬”è®°</title>
      <link href="/2022/08/31/typescript-xue-xi-bi-ji/"/>
      <url>/2022/08/31/typescript-xue-xi-bi-ji/</url>
      
        <content type="html"><![CDATA[<h2 id="TypeScriptç±»å‹æ¥æºï¼š"><a href="#TypeScriptç±»å‹æ¥æºï¼š" class="headerlink" title="TypeScriptç±»å‹æ¥æºï¼š"></a>TypeScriptç±»å‹æ¥æºï¼š</h2><ul><li><p>é€šè¿‡èµ‹çš„å€¼è‡ªåŠ¨è¿›è¡Œç±»å‹æ¨è®º</p></li><li><p>é€šè¿‡ <code>interface</code> å’Œ <code>type</code> å®šä¹‰ç±»å‹</p><blockquote><p>JSè‡ªå¸¦çš„åŸºç¡€ç±»å‹ï¼š<br><code>boolean, bigint, null, number, string, symbol,undefined</code></p></blockquote></li><li><p>å¤šä¸ªç®€å•ç±»å‹ç»„åˆæˆå¤æ‚çš„ç±»å‹</p><ul><li>Unionsï¼šè”åˆç±»å‹</li></ul><img src="/2022/08/31/typescript-xue-xi-bi-ji/typeof.jpg" class="" title="typeof ç»“æœ"><pre><code class="TypeScript">type WindowStates = &quot;open&quot; | &quot;closed&quot; | &quot;minimized&quot;;function wrapInArray(obj: string | string[]) &#123;  if (typeof obj === &quot;string&quot;) &#123;    return [obj];  &#125;  return obj;&#125; </code></pre><ul><li>Genericsï¼šæ³›å‹</li></ul></li></ul><pre><code class="TypeScript">type StringArray = Array&lt;string&gt;;interface Backpack&lt;Type&gt; &#123;  add: (obj: Type) =&gt; void;  get: () =&gt; Type;&#125;// å‘Šè¯‰TypeScript æœ‰ä¸€ä¸ªå¸¸é‡å«åš `backpack` declare const backpack: Backpack&lt;string&gt;;// object æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ç±»å‹, å› ä¸ºåœ¨ä¸Šé¢å£°æ˜äº†Backpackçš„å˜é‡const object = backpack.get();//ç”±äºbackpack å˜é‡æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸², ä¸èƒ½ä¼ ä¸€ä¸ªnumberç»™addæ–¹æ³•backpack.add(23);//æŠ¥é”™ï¼šArgument of type &#39;number&#39; is not assignable to parameter of type &#39;string&#39;.</code></pre><h2 id="TypeScriptçš„é¸­å­ç±»å‹-structural-typing"><a href="#TypeScriptçš„é¸­å­ç±»å‹-structural-typing" class="headerlink" title="TypeScriptçš„é¸­å­ç±»å‹(structural typing)"></a>TypeScriptçš„é¸­å­ç±»å‹(structural typing)</h2><p><strong>å®šä¹‰</strong>ï¼šå¦‚æœä¸¤ä¸ªå¯¹è±¡æœ‰ä¸€æ ·çš„shape,ä»–ä»¬å°±ä¼šè¢«è®¤ä¸ºæ˜¯ä¸€æ ·çš„ç±»å‹</p><pre><code class="TypeScript">interface Point &#123;  x: number;  y: number;&#125;function logPoint(p: Point) &#123;  console.log(`$&#123;p.x&#125;, $&#123;p.y&#125;`);&#125;// logs &quot;12, 26&quot;const point = &#123; x: 12, y: 26 &#125;;logPoint(point);</code></pre><p>å¦‚ä¸Šè¿°ä»£ç æ‰€ç¤ºï¼šå˜é‡pointä»æ¥æ²¡æœ‰è¢«å£°æ˜ä¸ºPointç±»å‹ã€‚ä½†æ˜¯TypeScriptåœ¨ç±»å‹æ£€æŸ¥ä¸­æ¯”è¾ƒäº†Pointå’Œpointçš„shape,å®Œå…¨ä¸€è‡´ï¼Œæ‰€ä»¥ä»£ç ä¸ä¼šæŠ¥é”™</p><p><strong>æ³¨æ„</strong>:shape-matching åŒ¹é…å¯¹è±¡å­—æ®µçš„ä¸€ä¸ªå­é›†ã€‚</p><pre><code class="TypeScript">interface Point &#123;  x: number;  y: number;&#125;function logPoint(p: Point) &#123;  console.log(`$&#123;p.x&#125;, $&#123;p.y&#125;`);&#125;const point3 = &#123; x: 12, y: 26, z: 89 &#125;;logPoint(point3); // logs &quot;12, 26&quot;const color = &#123;  x: 33,hex: &quot;#187ABF&quot; &#125;;logPoint(color);//æ­¤å¤„æŠ¥é”™ï¼Œå› ä¸ºç¼ºå°‘ç¼ºå°‘y</code></pre><h2 id="TypeScriptçš„é¢å¤–åŠŸèƒ½"><a href="#TypeScriptçš„é¢å¤–åŠŸèƒ½" class="headerlink" title="TypeScriptçš„é¢å¤–åŠŸèƒ½"></a>TypeScriptçš„é¢å¤–åŠŸèƒ½</h2><ul><li>è¾“å…¥çš„æ—¶å€™æä¾›é”™è¯¯æ¶ˆæ¯</li><li>ä»£ç è¡¥å…¨åŠŸèƒ½</li><li>é€šè¿‡é‡æ„æ¥è½»æ¾åœ°é‡æ–°ç»„ç»‡ä»£ç </li><li>é€šè¿‡å¯¼èˆªåŠŸèƒ½æ¥è·³è½¬åˆ°å˜é‡çš„å®šä¹‰</li><li>æŸ¥æ‰¾ç»™å®šå˜é‡çš„æ‰€æœ‰å¼•ç”¨</li></ul><h2 id="TypeScriptç¼–è¯‘å™¨â€”â€”tsc"><a href="#TypeScriptç¼–è¯‘å™¨â€”â€”tsc" class="headerlink" title="TypeScriptç¼–è¯‘å™¨â€”â€”tsc"></a>TypeScriptç¼–è¯‘å™¨â€”â€”tsc</h2><pre><code class="bash">npm install -g typescripttsc hello.tstsc --noEmitOnError hello.ts //æŠ¥é”™æ—¶ä¸ç”Ÿæˆè¾“å‡ºæ–‡ä»¶</code></pre><h2 id="tsconfig-jsoné…ç½®æ–‡ä»¶"><a href="#tsconfig-jsoné…ç½®æ–‡ä»¶" class="headerlink" title="tsconfig.jsoné…ç½®æ–‡ä»¶"></a>tsconfig.jsoné…ç½®æ–‡ä»¶</h2><pre><code class="json">&#123;  &quot;compilerOptions&quot;: &#123;    &quot;target&quot;: &quot;es5&quot;,    &quot;lib&quot;: [&quot;dom&quot;,&quot;dom.iterable&quot;,&quot;esnext&quot;],    &quot;allowJs&quot;: true,    &quot;skipLibCheck&quot;: true,    &quot;esModuleInterop&quot;: true,    &quot;allowSyntheticDefaultImports&quot;: true,    &quot;strict&quot;: true,    &quot;forceConsistentCasingInFileNames&quot;: true,    &quot;noFallthroughCasesInSwitch&quot;: true,    &quot;module&quot;: &quot;esnext&quot;,    &quot;moduleResolution&quot;: &quot;node&quot;,    &quot;resolveJsonModule&quot;: true,    &quot;isolatedModules&quot;: true,    &quot;noEmit&quot;: true,    &quot;jsx&quot;: &quot;react-jsx&quot;,    &quot;experimentalDecorators&quot;: true,    &quot;downlevelIteration&quot;:true  &#125;,  &quot;include&quot;: [    &quot;src&quot;,  ]&#125; </code></pre><h2 id="æ—¥å¸¸ç±»å‹"><a href="#æ—¥å¸¸ç±»å‹" class="headerlink" title="æ—¥å¸¸ç±»å‹"></a>æ—¥å¸¸ç±»å‹</h2><ul><li>åŸå§‹ç±»å‹ï¼š<ul><li>boolean</li><li>number</li><li>string</li><li>bigint</li><li>symbol</li></ul></li><li>Array<ul><li>Array&lt;T&gt;</li><li>T[]</li></ul></li><li>any:<ul><li>ä»»æ„ç±»å‹ï¼Œä¸æ¨èä½¿ç”¨</li><li>åœ¨tsconfig.jsonä¸­è®¾ç½®{â€œnoImplicitAnyâ€: true}å¯ä½¿å¾—å®ƒæŠ¥é”™</li></ul></li><li>Function<ul><li>éœ€è¦æŒ‡å®š å…¥å‚ç±»å‹ï¼Œè¿”å›å€¼ç±»å‹</li><li>åŒ¿åå‡½æ•°:å½“ä¸€ä¸ªå‡½æ•°å‡ºç°åœ¨TypeScriptå¯ä»¥å†³å®šå¦‚ä½•è°ƒç”¨å®ƒçš„åœ°æ–¹æ—¶ï¼Œè¯¥å‡½æ•°çš„å‚æ•°ä¼šè‡ªåŠ¨æŒ‡å®šç±»å‹ï¼Œä¸éœ€è¦æŒ‡å®šå…¥å‚å’Œè¿”å›å€¼</li></ul></li><li>å¯¹è±¡ç±»å‹<ul><li>å¯é€‰å±æ€§,<code>name?:string</code></li></ul></li><li>è”åˆç±»å‹unions<ul><li>ç±»å‹1|ç±»å‹2|ç±»å‹3</li><li>ç±»å‹åˆ«å <code>type UserInputSanitizedString = string;</code></li></ul></li></ul><h2 id="interfaceå’Œtypeçš„åŒºåˆ«"><a href="#interfaceå’Œtypeçš„åŒºåˆ«" class="headerlink" title="interfaceå’Œtypeçš„åŒºåˆ«"></a>interfaceå’Œtypeçš„åŒºåˆ«</h2><ul><li>typeåˆ›å»ºç±»å‹åä¸èƒ½è¢«ä¿®æ”¹æ·»åŠ æ–°çš„å±æ€§<img src="/2022/08/31/typescript-xue-xi-bi-ji/interface.jpg" class="" title="interface"><img src="/2022/08/31/typescript-xue-xi-bi-ji/error.jpg" class="" title="error"></li></ul><p>ä¸Šå›¾ä¸­å·¦è¾¹ç­‰ä»·äºï¼š</p><pre><code class="TypeScript">interface Window&#123;  title:string;  ts:TypeScriptAPI&#125;</code></pre><h2 id="ç±»å‹æ–­è¨€"><a href="#ç±»å‹æ–­è¨€" class="headerlink" title="ç±»å‹æ–­è¨€"></a>ç±»å‹æ–­è¨€</h2><ol><li>ä½¿ç”¨aså…³é”®å­—</li></ol><pre><code class="TypeScript">const myCanvas = document.getElementById(&quot;main_canvas&quot;) as HTMLCanvasElement;</code></pre><ol start="2"><li>ä½¿ç”¨å°–è§’æ‹¬å· â€”â€” ä»£ç åœ¨.tsxæ–‡ä»¶ä¸­</li></ol><pre><code class="TypeScript">const myCanvas = &lt;HTMLCanvasElement&gt;document.getElementById(&quot;main_canvas&quot;);</code></pre><ol start="3"><li>ç±»å‹è½¬æ¢ä½¿ç”¨ as any&#x2F;unknown as</li></ol><pre><code class="TypeScript">const expr=2type T = &#123; a: 1; b: 2; c: 3 &#125;;// ---cut---const a = (expr) as unknown as T;</code></pre><h2 id="å­—é¢é‡ç±»å‹"><a href="#å­—é¢é‡ç±»å‹" class="headerlink" title="å­—é¢é‡ç±»å‹"></a>å­—é¢é‡ç±»å‹</h2><ol><li>å¦‚æœæ˜¯let,varå®šä¹‰çš„å˜é‡ï¼Œä»–ä¼šè¢«è®¤ä¸ºæ˜¯åŸºç¡€ç±»å‹-ç±»å‹æ¨è®º</li><li>å¦‚æœæ˜¯const å®šä¹‰çš„å¸¸é‡ï¼Œå®ƒçš„ç±»å‹å°±æ˜¯å¸¸é‡å€¼ï¼Œä¸å¯ä¿®æ”¹</li><li>å¦‚æœconst å­—é¢é‡ç±»å‹æ¨è®ºä¸ç¬¦åˆé¢„æœŸï¼Œå¯é€šè¿‡ä»¥ä¸‹æ–¹æ³•è§£å†³</li></ol><pre><code class="TypeScript">// Change 1:const req = &#123; url: &quot;https://example.com&quot;, method: &quot;GET&quot; as &quot;GET&quot; &#125;;// change 2:const req = &#123; url: &quot;https://example.com&quot;, method: &quot;GET&quot; &#125; as const;handleRequest(req.url, req.method);</code></pre><h2 id="Nullå’ŒUndefined"><a href="#Nullå’ŒUndefined" class="headerlink" title="Nullå’ŒUndefined"></a>Nullå’ŒUndefined</h2><ul><li>Nullï¼šä¸å­˜åœ¨ï¼Œç©ºå¯¹è±¡</li><li>undefinedï¼šæ²¡æœ‰åˆå§‹åŒ–</li><li>énullçš„æ–­è¨€æ“ä½œï¼šä½¿ç”¨åç¼€!ï¼ˆçŸ¥é“ç±»å‹ä¸å¯èƒ½ä¸ºnullæˆ–è€…undefinedï¼‰</li></ul><pre><code class="TypeScript">function liveDangerously(x?: number | null) &#123;  //ä¸æŠ¥é”™  console.log(x!.toFixed());&#125;</code></pre><h2 id="ç¼©å°"><a href="#ç¼©å°" class="headerlink" title="ç¼©å°"></a>ç¼©å°</h2><h3 id="ç±»å‹ä¿æŠ¤-typeof"><a href="#ç±»å‹ä¿æŠ¤-typeof" class="headerlink" title="ç±»å‹ä¿æŠ¤ typeof"></a>ç±»å‹ä¿æŠ¤ typeof</h3><p><code>typeof null ==== &#39;object&#39;ï¼Œtypeof undefined===&#39;undefined&#39;</code></p><h3 id="ifæ£€æŸ¥"><a href="#ifæ£€æŸ¥" class="headerlink" title="ifæ£€æŸ¥"></a>ifæ£€æŸ¥</h3><pre><code class="TypeScript">function padLeft(padding: number | string, input: string) &#123;  if (typeof padding === &quot;number&quot;) &#123;    return &quot; &quot;.repeat(padding) + input;//æ­¤æ—¶paddingç±»å‹åªæœ‰number  &#125;  return padding + input;//æ­¤æ—¶paddingç±»å‹åªæœ‰string&#125;</code></pre><h3 id="Truthinessæ£€æŸ¥ï¼š"><a href="#Truthinessæ£€æŸ¥ï¼š" class="headerlink" title="Truthinessæ£€æŸ¥ï¼š"></a>Truthinessæ£€æŸ¥ï¼š</h3><ul><li><code>&amp;&amp;</code>,<code>||</code>,<code>!</code>,ifè¯­å¥</li><li><font color="red">0,NaN,â€â€ (the empty string),0n (the bigint version of zero),null,undefined</font>è½¬æ¢ä¸ºå¸ƒå°”å€¼éƒ½æ˜¯false</li></ul><h3 id="ä½¿ç”¨-x3D-x3D-x3D-x3D-x3D-x3D-x3D-x3D"><a href="#ä½¿ç”¨-x3D-x3D-x3D-x3D-x3D-x3D-x3D-x3D" class="headerlink" title="ä½¿ç”¨&#x3D;&#x3D;&#x3D;, !&#x3D;&#x3D;, &#x3D;&#x3D;,  !&#x3D;"></a>ä½¿ç”¨&#x3D;&#x3D;&#x3D;, !&#x3D;&#x3D;, &#x3D;&#x3D;,  !&#x3D;</h3><pre><code class="TypeScript">function example(x: string | number, y: string | boolean) &#123;  if (x === y) &#123;    x.toUpperCase();    y.toLowerCase();  &#125; else &#123;    console.log(x);    console.log(y);  &#125;&#125;</code></pre><h3 id="inæ“ä½œç¬¦ï¼šåˆ¤æ–­å¯¹è±¡ä¸­æ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§"><a href="#inæ“ä½œç¬¦ï¼šåˆ¤æ–­å¯¹è±¡ä¸­æ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§" class="headerlink" title="inæ“ä½œç¬¦ï¼šåˆ¤æ–­å¯¹è±¡ä¸­æ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§"></a>inæ“ä½œç¬¦ï¼šåˆ¤æ–­å¯¹è±¡ä¸­æ˜¯å¦æœ‰æŒ‡å®šçš„å±æ€§</h3><pre><code class="TypeScript">type Fish = &#123; swim: () =&gt; void &#125;;type Bird = &#123; fly: () =&gt; void &#125;;type Human = &#123; swim?: () =&gt; void; fly?: () =&gt; void &#125;;function move(animal: Fish | Bird | Human) &#123;  if (&quot;swim&quot; in animal) &#123;    animal;//Fish|Human  &#125; else &#123;    animal;//bird/human  &#125;&#125;</code></pre><img src="/2022/08/31/typescript-xue-xi-bi-ji/in.jpg" class="" title="inæ“ä½œç¬¦"><h3 id="instanceof"><a href="#instanceof" class="headerlink" title="instanceof"></a>instanceof</h3><p>x instanceof Foo :æ£€æµ‹ xçš„åŸå‹é“¾ æ˜¯å¦åŒ…å« Foo.prototype</p><h3 id="æ§åˆ¶æµåˆ†æï¼ˆç±»å‹æ¨æ–­ï¼‰"><a href="#æ§åˆ¶æµåˆ†æï¼ˆç±»å‹æ¨æ–­ï¼‰" class="headerlink" title="æ§åˆ¶æµåˆ†æï¼ˆç±»å‹æ¨æ–­ï¼‰"></a>æ§åˆ¶æµåˆ†æï¼ˆç±»å‹æ¨æ–­ï¼‰</h3><h3 id="ç±»å‹åˆ¤æ–­ï¼šparameterName-is-Type"><a href="#ç±»å‹åˆ¤æ–­ï¼šparameterName-is-Type" class="headerlink" title="ç±»å‹åˆ¤æ–­ï¼šparameterName is Type"></a>ç±»å‹åˆ¤æ–­ï¼šparameterName is Type</h3><pre><code class="TypeScript">type Fish = &#123; swim: () =&gt; void &#125;;type Bird = &#123; fly: () =&gt; void &#125;;declare function getSmallPet(): Fish | Bird;function isFish(pet: Fish | Bird): pet is Fish &#123;  return (pet as Fish).swim !== undefined;&#125;let pet = getSmallPet();if (isFish(pet)) &#123;  pet.swim();&#125; else &#123;  pet.fly();&#125;</code></pre><h3 id="å¯åŒºåˆ†è”åˆç±»å‹"><a href="#å¯åŒºåˆ†è”åˆç±»å‹" class="headerlink" title="å¯åŒºåˆ†è”åˆç±»å‹"></a>å¯åŒºåˆ†è”åˆç±»å‹</h3><pre><code class="TypeScript">interface Circle &#123;  kind: &quot;circle&quot;;  radius: number;&#125;interface Square &#123;  kind: &quot;square&quot;;  sideLength: number;&#125;type Shape = Circle | Square;function getArea(shape: Shape) &#123;  switch (shape.kind) &#123;    case &quot;circle&quot;:      return Math.PI * shape.radius ** 2;    case &quot;square&quot;:      return shape.sideLength ** 2;  &#125;&#125;</code></pre><hr><h2 id="Function"><a href="#Function" class="headerlink" title="Function"></a>Function</h2><h3 id="è°ƒç”¨ç­¾å"><a href="#è°ƒç”¨ç­¾å" class="headerlink" title="è°ƒç”¨ç­¾å"></a>è°ƒç”¨ç­¾å</h3><p>åŸå› ï¼šè§£å†³æ— æ³•åœ¨å‡½æ•°ç±»å‹è¡¨è¾¾å¼å£°æ˜å…¶ä»–å±æ€§<br>å†™æ³•ï¼š</p><pre><code class="TypeScript">type DescribableFunction = &#123;  description: string;  (someArg: number): boolean;&#125;;function doSomething(fn: DescribableFunction) &#123;  console.log(fn.description + &quot; returned &quot; + fn(6));&#125;</code></pre><h3 id="æ„é€ å‡½æ•°ç­¾å"><a href="#æ„é€ å‡½æ•°ç­¾å" class="headerlink" title="æ„é€ å‡½æ•°ç­¾å"></a>æ„é€ å‡½æ•°ç­¾å</h3><pre><code class="TypeScript">type SomeConstructor = &#123;  new (s: string): SomeObject;&#125;;function fn(ctor: SomeConstructor) &#123;  return new ctor(&quot;hello&quot;);&#125;</code></pre><h3 id="Functionçš„æ³›å‹"><a href="#Functionçš„æ³›å‹" class="headerlink" title="Functionçš„æ³›å‹"></a>Functionçš„æ³›å‹</h3><p>åŸå› ï¼šå¤„ç†å‡½æ•°è¾“å…¥å’Œè¾“å‡ºæœ‰å…³è”çš„æƒ…å†µæˆ–è€…ä¸¤ä¸ªå‡½æ•°è¾“å…¥æœ‰æŸç§å…³è”å…³ç³»</p><pre><code class="TypeScript">function map&lt;Input, Output&gt;(arr: Input[], func: (arg: Input) =&gt; Output): Output[] &#123;  return arr.map(func);&#125;// Parameter &#39;n&#39; is of type &#39;string&#39;// &#39;parsed&#39; is of type &#39;number[]&#39;const parsed = map([&quot;1&quot;, &quot;2&quot;, &quot;3&quot;], (n) =&gt; parseInt(n));</code></pre><h3 id="æ³›å‹çš„çº¦æŸ"><a href="#æ³›å‹çš„çº¦æŸ" class="headerlink" title="æ³›å‹çš„çº¦æŸ"></a>æ³›å‹çš„çº¦æŸ</h3><ul><li>ä½¿ç”¨extends</li></ul><pre><code class="TypeScript">function minimumLength&lt;Type extends &#123; length: number &#125;&gt;(  obj: Type,  minimum: number): Type &#123;  if (obj.length &gt;= minimum) &#123;    return obj;  &#125; else &#123;    return &#123; length: minimum &#125;;//æŠ¥é”™ï¼ŒåŸå› æ˜¯ä¸èƒ½è¿”å›åªè¿”å›ç¬¦åˆçº¦æŸçš„å¯¹è±¡  &#125;&#125;</code></pre><blockquote><p>Type â€˜{ length: number; }â€™ is not assignable to type â€˜Typeâ€™.<br>â€˜{ length: number; }â€™ is assignable to the constraint of type â€˜Typeâ€™,<br>but â€˜Typeâ€™ could be instantiated with a different subtype of constraint â€˜{ length: number; }â€™.</p></blockquote><h3 id="å¯é€‰å‚æ•°"><a href="#å¯é€‰å‚æ•°" class="headerlink" title="å¯é€‰å‚æ•°"></a>å¯é€‰å‚æ•°</h3><p>ä½¿ç”¨ <code>name?:type</code></p><h3 id="å‡½æ•°é‡è½½"><a href="#å‡½æ•°é‡è½½" class="headerlink" title="å‡½æ•°é‡è½½"></a>å‡½æ•°é‡è½½</h3><p>ä½œç”¨ï¼šéœ€è¦è°ƒç”¨ä¸åŒå‚æ•°ä¸ªæ•°å’Œç±»å‹çš„å‡½æ•°å®ç°åŒä¸€ä¸ªç›®çš„</p><pre><code class="TypeScript">function makeDate(timestamp: number): Date;function makeDate(m: number, d: string): Date;function makeDate(m: number, d: number, y: number): Date;function makeDate(mOrTimestamp: number, d?: number|string, y?: number): Date &#123;  if (d !== undefined &amp;&amp; y !== undefined) &#123;    return new Date(y, mOrTimestamp, d);  &#125; else &#123;    return new Date(mOrTimestamp);  &#125;&#125;const d1 = makeDate(12345678);const d2 = makeDate(5, 5, 5);const d3 = makeDate(1,&#39;3&#39;);</code></pre><h3 id="å‰©ä½™å‚æ•°"><a href="#å‰©ä½™å‚æ•°" class="headerlink" title="å‰©ä½™å‚æ•°"></a>å‰©ä½™å‚æ•°</h3><p>ä½¿ç”¨ <code>...å˜é‡å</code> è¡¨ç¤º</p><h3 id="è¿”å›ç±»å‹ä¸ºvoid"><a href="#è¿”å›ç±»å‹ä¸ºvoid" class="headerlink" title="è¿”å›ç±»å‹ä¸ºvoid"></a>è¿”å›ç±»å‹ä¸ºvoid</h3><p><code>type vf = () =&gt; void</code></p><ul><li>æ­¤æ—¶å¹¶ä¸å¼ºåˆ¶åªè¿”å›void,ä¹Ÿå¯ä»¥è¿”å›å…¶ä»–ç±»å‹å€¼ï¼Œä½†æ˜¯tsä¼šæ¨è®ºä¸ºvoid</li><li>ä½†æ˜¯ç›´æ¥ <code>function A():void</code> è¿”å›å…¶ä»–å€¼çš„æ—¶å€™ä¼šæŠ¥é”™</li></ul><hr><ul><li>åªè¯»å±æ€§ readOnly<br><code>interface SomeType &#123; readonly prop: string; &#125;</code></li><li>å¯é€‰å±æ€§</li></ul><pre><code class="TypeScript">interface PaintOptions &#123;  shape: Shape;  xPos?: number;  yPos?: number;&#125;`</code></pre><ul><li>ç´¢å¼•ç­¾å:å­—å…¸</li></ul><pre><code class="TypeScript">interface StringArray &#123;  [index: number]: string;&#125;</code></pre>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> TypeScript </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>link VS @import</title>
      <link href="/2022/08/17/link-he-import-de-qu-bie/"/>
      <url>/2022/08/17/link-he-import-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<ol><li>link æ˜¯ HTML æ ‡ç­¾ï¼Œä¸ä»…å¯ä»¥åŠ è½½ CSS æ–‡ä»¶ï¼Œè¿˜å¯ä»¥å®šä¹‰ RSSã€rel è¿æ¥å±æ€§ç­‰ï¼›@import æ˜¯ CSS æä¾›çš„è¯­æ³•ï¼Œåªæœ‰å¯¼å…¥æ ·å¼è¡¨çš„ä½œç”¨ã€‚</li><li>åŠ è½½é¡µé¢æ—¶ï¼Œlink æ ‡ç­¾å¼•å…¥çš„ CSS è¢«åŒæ—¶åŠ è½½ï¼›@import å¼•å…¥çš„ CSS å°†åœ¨é¡µé¢åŠ è½½å®Œæ¯•åè¢«åŠ è½½ã€‚</li><li>@import æ˜¯ CSS2.1 æ‰æœ‰çš„è¯­æ³•ï¼Œæ•…åªå¯åœ¨ IE5+ æ‰èƒ½è¯†åˆ«ï¼›link æ ‡ç­¾ä½œä¸º HTML å…ƒç´ ï¼Œä¸å­˜åœ¨å…¼å®¹æ€§é—®é¢˜ã€‚</li><li>å¯ä»¥é€šè¿‡ JS æ“ä½œ DOM ï¼Œæ’å…¥ link æ ‡ç­¾æ¥æ”¹å˜æ ·å¼ï¼›ç”±äº DOM æ–¹æ³•æ˜¯åŸºäºæ–‡æ¡£çš„ï¼Œæ— æ³•ä½¿ç”¨@import çš„æ–¹å¼æ’å…¥æ ·å¼ã€‚</li><li>link å¼•å…¥çš„æ ·å¼æƒé‡å¤§äº@import å¼•å…¥çš„æ ·å¼ã€‚</li></ol>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cssç›’æ¨¡å‹</title>
      <link href="/2022/08/17/css-he-mo-xing/"/>
      <url>/2022/08/17/css-he-mo-xing/</url>
      
        <content type="html"><![CDATA[<h2 id="cssç›’æ¨¡å‹"><a href="#cssç›’æ¨¡å‹" class="headerlink" title="cssç›’æ¨¡å‹"></a>cssç›’æ¨¡å‹</h2><ol><li>contentï¼šå†…å®¹ï¼Œå®¹çº³ç€å…ƒç´ çš„â€çœŸå®â€œå†…å®¹ï¼Œä¾‹å¦‚æ–‡æœ¬ï¼Œå›¾åƒæˆ–æ˜¯è§†é¢‘æ’­æ”¾å™¨</li><li>paddingï¼šå†…è¾¹è·</li><li>borderï¼šè¾¹æ¡†</li><li>marginï¼šå¤–è¾¹è·</li></ol><hr><h2 id="ä¸¤ç§ç›’æ¨¡å‹çš„åŒºåˆ«ï¼š"><a href="#ä¸¤ç§ç›’æ¨¡å‹çš„åŒºåˆ«ï¼š" class="headerlink" title="ä¸¤ç§ç›’æ¨¡å‹çš„åŒºåˆ«ï¼š"></a>ä¸¤ç§ç›’æ¨¡å‹çš„åŒºåˆ«ï¼š</h2><ul><li><p>W3C ç›’æ¨¡å‹ box-sizing: content-box</p><ul><li>W3C ç›’æ¨¡å‹ä¸­ï¼Œé€šè¿‡ CSS æ ·å¼è®¾ç½®çš„ width çš„å¤§å°åªæ˜¯ content çš„å¤§å°</li></ul></li><li><p>IE ç›’æ¨¡å‹ box-sizing: border-box</p><ul><li>IE ç›’æ¨¡å‹ä¸­ï¼Œé€šè¿‡ CSS æ ·å¼è®¾ç½®çš„ width çš„å¤§å°æ˜¯ content + padding + border çš„å’Œ</li></ul></li></ul><hr><h2 id="margin-x2F-padding-è®¾ç½®ç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹è°çš„"><a href="#margin-x2F-padding-è®¾ç½®ç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹è°çš„" class="headerlink" title="margin&#x2F;padding è®¾ç½®ç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹è°çš„"></a>margin&#x2F;padding è®¾ç½®ç™¾åˆ†æ¯”æ˜¯ç›¸å¯¹è°çš„</h2><p>margin&#x2F;padding è®¾ç½®ç™¾åˆ†æ¯”éƒ½æ˜¯ç›¸å¯¹äºçˆ¶ç›’å­çš„å®½åº¦(width å±æ€§)</p><hr><h2 id="æ¸…é™¤æµ®åŠ¨"><a href="#æ¸…é™¤æµ®åŠ¨" class="headerlink" title="æ¸…é™¤æµ®åŠ¨"></a>æ¸…é™¤æµ®åŠ¨</h2><h3 id="æ–¹æ³•"><a href="#æ–¹æ³•" class="headerlink" title="æ–¹æ³•"></a>æ–¹æ³•</h3><ol><li>åœ¨éœ€è¦æ¸…é™¤æµ®åŠ¨çš„å…ƒç´ åé¢æ·»åŠ ä¸€ä¸ªç©ºç™½æ ‡ç­¾ï¼Œè®¾ç½®ç±»å clearï¼Œè®¾ç½® <code>clear: both</code> </li><li>çˆ¶çº§å…ƒç´ æ·»åŠ  <code>overflow: hidden</code></li><li>çˆ¶å…ƒç´  <code>displayï¼štable</code></li><li>ä¼ªå…ƒç´ æ¸…é™¤æµ®åŠ¨</li></ol><pre><code class="css">.clearfix:after &#123;  /*æ­£å¸¸æµè§ˆå™¨ æ¸…é™¤æµ®åŠ¨*/  content: &#39;&#39;;  display: block;  height: 0;  clear: both;  visibility: hidden;&#125;</code></pre><h3 id="åŸç†"><a href="#åŸç†" class="headerlink" title="åŸç†"></a>åŸç†</h3><ul><li>clear å±æ€§æ¸…é™¤æµ®åŠ¨ï¼šclear å±æ€§è§„å®šå…ƒç´ ç›’å­çš„è¾¹ä¸èƒ½å’Œæµ®åŠ¨å…ƒç´ ç›¸é‚»ã€‚è¯¥å±æ€§åªèƒ½å½±å“ä½¿ç”¨æ¸…é™¤çš„å…ƒç´ æœ¬èº«ï¼Œä¸èƒ½å½±å“å…¶ä»–å…ƒç´ ã€‚æ¢è€Œè¨€ä¹‹ï¼Œå¦‚æœå·²ç»å­˜åœ¨æµ®åŠ¨å…ƒç´ çš„è¯ï¼Œé‚£ä¹ˆè¯¥å…ƒç´ å°±ä¸ä¼šåƒåŸæœ¬å…ƒç´ ä¸€æ ·å—å…¶å½±å“äº†ã€‚</li><li>å…¶ä»–çš„å¯ä»¥å½’ä¸ºä¸€ç±»ï¼Œéƒ½æ˜¯é€šè¿‡è§¦å‘ BFC æ¥å®ç°çš„</li></ul>]]></content>
      
      
      <categories>
          
          <category> å‰ç«¯ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> css </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>cookieå’Œsessionä»¥åŠwebStorageçš„åŒºåˆ«</title>
      <link href="/2022/08/17/cookie-he-session-yi-ji-webstorage-de-qu-bie/"/>
      <url>/2022/08/17/cookie-he-session-yi-ji-webstorage-de-qu-bie/</url>
      
        <content type="html"><![CDATA[<h1 id="cookie-VS-webStorage"><a href="#cookie-VS-webStorage" class="headerlink" title="cookie VS webStorage"></a>cookie VS webStorage</h1><ol><li>éƒ½ä¼šåœ¨æµè§ˆå™¨ç«¯ä¿å­˜ï¼Œæœ‰å¤§å°é™åˆ¶ï¼ŒåŒæºé™åˆ¶</li><li>cookie ä¼šåœ¨è¯·æ±‚æ—¶å‘é€åˆ°æœåŠ¡å™¨ï¼Œä½œä¸ºä¼šè¯æ ‡è¯†ï¼ŒæœåŠ¡å™¨å¯ä¿®æ”¹ cookieï¼›web storage ä¸ä¼šå‘é€åˆ°æœåŠ¡å™¨</li><li>cookie æœ‰ path æ¦‚å¿µï¼Œå­è·¯å¾„å¯ä»¥è®¿é—®çˆ¶è·¯å¾„ cookieï¼Œçˆ¶è·¯å¾„ä¸èƒ½è®¿é—®å­è·¯å¾„ cookie</li><li>æœ‰æ•ˆæœŸï¼šcookie åœ¨è®¾ç½®çš„æœ‰æ•ˆæœŸå†…æœ‰æ•ˆï¼Œé»˜è®¤ä¸ºæµè§ˆå™¨å…³é—­ï¼›sessionStorage åœ¨çª—å£å…³é—­å‰æœ‰æ•ˆï¼›localStorage é•¿æœŸæœ‰æ•ˆï¼Œç›´åˆ°ç”¨æˆ·åˆ é™¤</li><li>ä½œç”¨åŸŸä¸åŒ sessionStorageï¼šä¸åœ¨ä¸åŒçš„æµè§ˆå™¨çª—å£ä¸­å…±äº«ï¼Œå³ä½¿æ˜¯åŒä¸€ä¸ªé¡µé¢ï¼›localStorageï¼šåœ¨æ‰€æœ‰åŒæºçª—å£éƒ½æ˜¯å…±äº«çš„ï¼›cookieï¼šä¹Ÿæ˜¯åœ¨æ‰€æœ‰åŒæºçª—å£ä¸­å…±äº«çš„</li><li>å­˜å‚¨å¤§å°ä¸åŒï¼šcookie æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼›webStorage è™½ç„¶ä¹Ÿæœ‰å­˜å‚¨å¤§å°çš„é™åˆ¶ï¼Œä½†æ˜¯æ¯” cookie å¤§å¾—å¤šï¼Œå¯ä»¥è¾¾åˆ° 5M æˆ–æ›´å¤§</li></ol><hr><h1 id="cookie-VS-session"><a href="#cookie-VS-session" class="headerlink" title="cookie VS session"></a>cookie VS session</h1><ol><li>å­˜å‚¨ä½ç½®ä¸åŒï¼š</li></ol><ul><li>cookie æ•°æ®å­˜æ”¾åœ¨å®¢æˆ·çš„æµè§ˆå™¨ä¸Š</li><li>session æ•°æ®æ”¾åœ¨æœåŠ¡å™¨ä¸Šã€‚</li></ul><ol start="2"><li>å­˜å‚¨å®¹é‡ä¸åŒï¼š</li></ol><ul><li>å•ä¸ª cookie ä¿å­˜çš„æ•°æ®ä¸èƒ½è¶…è¿‡ 4Kï¼Œä¸€ä¸ªç«™ç‚¹æœ€å¤šä¿å­˜ 20 ä¸ª cookieã€‚</li><li>å¯¹äº session æ¥è¯´å¹¶æ²¡æœ‰ä¸Šé™ï¼Œä½†å‡ºäºå¯¹æœåŠ¡å™¨ç«¯çš„æ€§èƒ½è€ƒè™‘ï¼Œsession å†…ä¸è¦å­˜æ”¾è¿‡å¤šçš„ä¸œè¥¿ï¼Œå¹¶ä¸”è®¾ç½® session åˆ é™¤æœºåˆ¶ã€‚</li></ul><ol start="3"><li>å­˜å‚¨æ–¹å¼ä¸åŒï¼š</li></ol><ul><li><p>cookie ä¸­åªèƒ½ä¿ç®¡ ASCII å­—ç¬¦ä¸²ï¼Œå¹¶éœ€è¦é€šè¿‡ç¼–ç æ–¹å¼å­˜å‚¨ä¸º Unicode å­—ç¬¦æˆ–è€…äºŒè¿›åˆ¶æ•°æ®ã€‚</p></li><li><p>session ä¸­èƒ½å¤Ÿå­˜å‚¨ä»»ä½•ç±»å‹çš„æ•°æ®ï¼ŒåŒ…æ‹¬ä¸”ä¸é™äº stringï¼Œintegerï¼Œlistï¼Œmap ç­‰ã€‚</p></li></ul><ol start="4"><li>éšç§ç­–ç•¥ä¸åŒ</li></ol><ul><li><p>cookie å¯¹å®¢æˆ·ç«¯æ˜¯å¯è§çš„ï¼Œåˆ«æœ‰ç”¨å¿ƒçš„äººå¯ä»¥åˆ†æå­˜æ”¾åœ¨æœ¬åœ°çš„ cookie å¹¶è¿›è¡Œ cookie æ¬ºéª—ï¼Œæ‰€ä»¥å®ƒæ˜¯ä¸å®‰å…¨çš„ã€‚</p></li><li><p>session å­˜å‚¨åœ¨æœåŠ¡å™¨ä¸Šï¼Œä¸å­˜åœ¨æ•æ„Ÿä¿¡æ¯æ³„æ¼çš„é£é™©ã€‚</p></li></ul><ol start="5"><li>æœ‰æ•ˆæœŸä¸åŒ</li></ol><ul><li><p>cookie ä¿ç®¡åœ¨å®¢æˆ·ç«¯ï¼Œä¸å ç”¨æœåŠ¡å™¨èµ„æºã€‚å¯¹äºå¹¶å‘ç”¨æˆ·ååˆ†å¤šçš„ç½‘ç«™ï¼Œcookie æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</p></li><li><p>session æ˜¯ä¿ç®¡åœ¨æœåŠ¡å™¨ç«¯çš„ï¼Œæ¯ä¸ªç”¨æˆ·éƒ½ä¼šäº§ç”Ÿä¸€ä¸ª sessionã€‚å‡å¦‚å¹¶å‘è®¿é—®çš„ç”¨æˆ·ååˆ†å¤šï¼Œä¼šäº§ç”Ÿååˆ†å¤šçš„ sessionï¼Œè€—è´¹å¤§é‡çš„å†…å­˜</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æœ¬åœ°å­˜å‚¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æµè§ˆå™¨è¾“å…¥ URL ä¹‹åå‘ç”Ÿäº†ä»€ä¹ˆ</title>
      <link href="/2022/08/17/after-input-url/"/>
      <url>/2022/08/17/after-input-url/</url>
      
        <content type="html"><![CDATA[<ol><li>DNS è§£æ</li><li>TCP è¿æ¥</li><li>å‘é€ HTTP è¯·æ±‚</li><li>æœåŠ¡å™¨å¤„ç†è¯·æ±‚å¹¶è¿”å› HTTP æŠ¥æ–‡</li><li>æµè§ˆå™¨è§£ææ¸²æŸ“é¡µé¢</li><li>è¿æ¥ç»“æŸ</li></ol>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> æµè§ˆå™¨ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>http çŠ¶æ€ç </title>
      <link href="/2022/08/17/http-status-code/"/>
      <url>/2022/08/17/http-status-code/</url>
      
        <content type="html"><![CDATA[<h1 id="HTTP-çŠ¶æ€ç "><a href="#HTTP-çŠ¶æ€ç " class="headerlink" title="HTTP çŠ¶æ€ç "></a>HTTP çŠ¶æ€ç </h1><ul><li>1XX ä¿¡æ¯æ€§çŠ¶æ€ç <ul><li>100 ç»§ç»­</li><li>101 åˆ‡æ¢åè®®</li></ul></li><li>2XX æˆåŠŸçŠ¶æ€ç <ul><li>200 OK æˆåŠŸå¤„ç†äº†è¯·æ±‚</li><li>204 No Content è¯·æ±‚å¤„ç†æˆåŠŸï¼Œä½†æ²¡æœ‰èµ„æºå¯è¿”å›</li><li>206 Partial Content è¯·æ±‚èµ„æºçš„æŸä¸€éƒ¨åˆ†</li></ul></li><li>3XX é‡å®šå‘çŠ¶æ€ç <ul><li>301 æ°¸ä¹…æ€§é‡å®šå‘ï¼Œè¡¨ç¤ºè¯·æ±‚çš„èµ„æºå·²è¢«åˆ†é…äº†æ–°çš„ URIï¼Œæ¯”å¦‚å¯ç”¨äº†æ–°åŸŸåã€æœåŠ¡å™¨åˆ‡æ¢åˆ°äº†æ–°æœºæˆ¿ã€ç½‘ç«™ç›®å½•å±‚æ¬¡é‡æ„ï¼Œè¿™äº›éƒ½ç®—æ˜¯â€œæ°¸ä¹…æ€§â€çš„æ”¹å˜ã€‚å“åº”çš„ Location é¦–éƒ¨ä¸­åº”è¯¥åŒ…å« èµ„æºç°åœ¨æ‰€å¤„çš„ URL</li><li>302 ä¸´æ—¶æ€§é‡å®šå‘ï¼Œèµ„æºçš„ URL å·²ä¸´æ—¶å®šä½åˆ°å…¶ä»–ä½ç½®ï¼Œå®¢æˆ·ç«¯åº”è¯¥ä½¿ç”¨ Location é¦–éƒ¨ç»™å‡ºçš„ URL æ¥ä¸´æ—¶å®šä½èµ„æºã€‚å°†æ¥çš„è¯·æ±‚ä»åº”ä½¿ç”¨è€çš„ URL</li><li>303 å‘Šè¯‰å®¢æˆ·ç«¯åº”è¯¥ç”¨å¦ä¸€ä¸ª URL è·å–èµ„æº</li><li>304 è¡¨ç¤ºå®¢æˆ·ç«¯å‘é€é™„å¸¦æ¡ä»¶çš„è¯·æ±‚æ—¶ï¼ŒæœåŠ¡å™¨ç«¯å…è®¸è¯·æ±‚è®¿é—®èµ„æºï¼Œä½†æœªæ»¡è¶³æ¡ä»¶çš„æƒ…å†µ</li></ul></li><li>4XX å®¢æˆ·ç«¯é”™è¯¯çŠ¶æ€ç <ul><li>400 è¡¨ç¤ºè¯·æ±‚æŠ¥æ–‡ä¸­å­˜åœ¨è¯­æ³•é”™è¯¯</li><li>401 æœªæˆæƒï¼Œå®¢æˆ·ç«¯æ²¡æœ‰å¸¦è®¤è¯ä¿¡æ¯æˆ–è€…å¸¦äº†é”™è¯¯çš„è®¤è¯ä¿¡æ¯, è¿™æ—¶å®¢æˆ·ç«¯å¯ä»¥ä¿®æ”¹è®¤è¯ä¿¡æ¯è¿›è¡Œé‡è¯•</li><li>403 æœåŠ¡å™¨æ‹’ç»äº†è¯·æ±‚ï¼Œå®¢æˆ·ç«¯å¸¦äº†æ­£ç¡®çš„è®¤è¯ä¿¡æ¯, ä½†æœåŠ¡å™¨è®¤ä¸ºè¿™ä¸ªè®¤è¯ä¿¡æ¯å¯¹åº”çš„ç”¨æˆ·æ˜¯æ²¡æœ‰å¯¹åº”èµ„æºçš„è®¿é—®æƒé™çš„, å› æ­¤, åœ¨å‘ç®¡ç†å‘˜è·å–ç›¸å…³æƒé™ä¹‹å‰, æ˜¯æ²¡æœ‰é‡è¯•çš„å¿…è¦çš„</li><li>404 æœåŠ¡å™¨æ— æ³•æ‰¾åˆ°æ‰€è¯·æ±‚çš„ URL</li></ul></li><li>5XX æœåŠ¡å™¨é”™è¯¯çŠ¶æ€ç <ul><li>500 å†…éƒ¨æœåŠ¡å™¨é”™è¯¯</li><li>502 é”™è¯¯ç½‘å…³</li><li>503 æœåŠ¡å™¨æš‚æ—¶å¤„äºè¶…è´Ÿè½½æˆ–æ­£åœ¨è¿›è¡Œåœæœºç»´æŠ¤ï¼Œç°åœ¨æ— æ³•å¤„ç†è¯·æ±‚ã€‚</li><li>504 å“åº”è¶…æ—¶</li></ul></li></ul><hr><h1 id="HTTP1-0-å’Œ-HTTP1-1-å’Œ-HTTP2-0-çš„åŒºåˆ«"><a href="#HTTP1-0-å’Œ-HTTP1-1-å’Œ-HTTP2-0-çš„åŒºåˆ«" class="headerlink" title="HTTP1.0 å’Œ HTTP1.1 å’Œ HTTP2.0 çš„åŒºåˆ«"></a>HTTP1.0 å’Œ HTTP1.1 å’Œ HTTP2.0 çš„åŒºåˆ«</h1><p>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼ˆHTTPï¼‰ç”¨äºæµè§ˆå™¨ä¸æœåŠ¡å™¨ä¹‹é—´çš„é€šä¿¡</p><h2 id="HTTP1-0-å’Œ-HTTP1-1"><a href="#HTTP1-0-å’Œ-HTTP1-1" class="headerlink" title="HTTP1.0 å’Œ HTTP1.1"></a>HTTP1.0 å’Œ HTTP1.1</h2><ul><li>ç¼“å­˜å¤„ç†ï¼š<ul><li>1.0 çš„ header ä¸­ä¸»è¦æ˜¯é€šè¿‡ If-Modified-Sinceï¼ˆæ¯”è¾ƒèµ„æºçš„æœ€åçš„æ›´æ–°æ—¶é—´æ˜¯å¦ä¸€è‡´ï¼‰ï¼Œexpires(èµ„æºçš„è¿‡æœŸæ—¶é—´ï¼Œå–å†³äºå®¢æˆ·ç«¯æœ¬åœ°æ—¶é—´)</li><li>1.1 å¼•å…¥äº†å…¶ä»–çš„ If-Match(æ¯”è¾ƒ ETag æ˜¯å¦ä¸€è‡´), If-None-Match(æ¯”è¾ƒ ETag æ˜¯å¦ä¸ä¸€è‡´), If-Unmodified-Since(æ¯”è¾ƒèµ„æºæœ€åçš„æ›´æ–°æ—¶é—´æ˜¯å¦ä¸ä¸€è‡´), Entity tag(èµ„æºçš„åŒ¹é…ä¿¡æ¯)</li></ul></li><li>å¸¦å®½ä¼˜åŒ–<ul><li>1.0 å­˜åœ¨ä¸€äº›æµªè´¹å¸¦å®½çš„ç°è±¡ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯åªéœ€è¦æŸä¸ªå¯¹è±¡çš„ä¸€éƒ¨åˆ†ï¼Œä½†æ˜¯æœåŠ¡å™¨å°†æ•´ä¸ªå¯¹è±¡è¿”å›ã€‚</li><li>1.1 åˆ™åœ¨è¯·æ±‚å¤´å¼•å…¥äº† range å¤´åŸŸï¼Œå®ƒå…è®¸åªè¯·æ±‚èµ„æºçš„æŸä¸ªéƒ¨åˆ†ï¼Œå³è¿”å›ç æ˜¯ 206ï¼ˆPartial Contentï¼‰</li></ul></li><li>Host å¤´å¤„ç†<ul><li>1.0 ä¸­è®¤ä¸ºæ¯ä¸ªæœåŠ¡å™¨éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„ Ipï¼Œå› æ­¤è¯·æ±‚çš„ url ä¸­å¹¶æ²¡æœ‰ä¼ é€’ä¸»æœºåï¼ˆhostnameï¼‰</li><li>éšç€è™šæ‹ŸåŒ–æŠ€æœ¯çš„å‘å±•ï¼Œä¸€å°ç‰©ç†æœºä¸Šå¯ä»¥æœ‰å¤šä¸ªè™šæ‹Ÿæœºï¼Œå…±äº«åŒä¸€ä¸ª ipï¼Œ1.1 ä¸­çš„è¯·æ±‚æ¶ˆæ¯å’Œå“åº”æ¶ˆæ¯éƒ½æ”¯æŒ Hostï¼Œè¯·æ±‚æ¶ˆæ¯ä¸­å¦‚æœæ²¡æœ‰ Host å¤´åŸŸä¼šæŠ¥å‘Šä¸€ä¸ªé”™è¯¯ï¼ˆ400 Bad Requestï¼‰</li></ul></li><li>é•¿è¿æ¥<ul><li>http æ˜¯åŸºäº TCP&#x2F;IP åè®®çš„ï¼Œåˆ›å»ºä¸€ä¸ª TCP è¿æ¥æ˜¯éœ€è¦ç»è¿‡ä¸‰æ¬¡æ¡æ‰‹çš„,æœ‰ä¸€å®šçš„å¼€é”€ï¼Œå¦‚æœæ¯æ¬¡é€šè®¯éƒ½è¦é‡æ–°å»ºç«‹è¿æ¥çš„è¯ï¼Œå¯¹æ€§èƒ½æœ‰å½±å“ã€‚å› æ­¤æœ€å¥½èƒ½ç»´æŒä¸€ä¸ªé•¿è¿æ¥ï¼Œå¯ä»¥ç”¨ä¸ªé•¿è¿æ¥æ¥å‘å¤šä¸ªè¯·æ±‚ã€‚</li><li>1.0 ä¸­æ¯æ¬¡éœ€è¦ä½¿ç”¨ keep-alive å‚æ•°æ¥å‘ŠçŸ¥æœåŠ¡å™¨ç«¯è¦å»ºç«‹ä¸€ä¸ªé•¿è¿æ¥</li><li>1.1 é»˜è®¤æ”¯æŒé•¿è¿æ¥ï¼Œä¸€å®šç¨‹åº¦ä¸Šå¼¥è¡¥äº† HTTP1.0 æ¯æ¬¡è¯·æ±‚éƒ½è¦åˆ›å»ºè¿æ¥çš„ç¼ºç‚¹</li></ul></li><li>æ–°å¢çŠ¶æ€ç <ul><li>1.1 ä¸­æ–°å¢äº† 24 ä¸ªé”™è¯¯çŠ¶æ€å“åº”ç ï¼Œå¦‚ 409ï¼ˆConflictï¼‰è¡¨ç¤ºè¯·æ±‚çš„èµ„æºä¸èµ„æºçš„å½“å‰çŠ¶æ€å‘ç”Ÿå†²çªï¼›410ï¼ˆGoneï¼‰è¡¨ç¤ºæœåŠ¡å™¨ä¸Šçš„æŸä¸ªèµ„æºè¢«æ°¸ä¹…æ€§çš„åˆ é™¤</li></ul></li><li>æ–°å¢è¯·æ±‚æ–¹å¼<ul><li>PUTï¼ŒDELETEï¼ŒOPTIONS ç­‰</li></ul></li></ul><h2 id="http2-0-ä¸-http1-X-åŒºåˆ«"><a href="#http2-0-ä¸-http1-X-åŒºåˆ«" class="headerlink" title="http2.0 ä¸ http1.X åŒºåˆ«"></a>http2.0 ä¸ http1.X åŒºåˆ«</h2><ol><li>header å‹ç¼©: header å¤´éƒ¨å¸¦æœ‰å¤§é‡çš„ä¿¡æ¯ï¼Œè€Œä¸”æ¯æ¬¡ä½¿ç”¨æŠ¥å¤´å‹ç¼©ï¼Œé™ä½å¼€é”€ï¼Œå¯¹äºç›¸åŒçš„ header æ•°æ®ï¼Œä¸å†é€šè¿‡æ¯æ¬¡è¯·æ±‚å’Œå“åº”å‘é€ï¼Œå·®é‡æ›´æ–° HTTP å¤´éƒ¨ï¼Œæ—¢é¿å…äº†é‡å¤ header çš„ä¼ è¾“ï¼Œåˆå‡å°äº†éœ€è¦ä¼ è¾“çš„å¤§å°</li><li>å¤šè·¯å¤ç”¨:åœ¨ä¸€ä¸ªè¿æ¥é‡Œï¼Œå®¢æˆ·ç«¯å’Œæµè§ˆå™¨éƒ½å¯ä»¥åŒæ—¶å‘é€å¤šä¸ªè¯·æ±‚æˆ–å›åº”ï¼Œè€Œä¸”ä¸ç”¨æŒ‰ç…§é¡ºåº<br>äºŒè¿›åˆ¶åˆ†å¸§:æ¶ˆæ¯ç”±ä¸€ä¸ªæˆ–å¤šä¸ªå¸§ç»„æˆã€‚å¤šä¸ªå¸§ä¹‹é—´å¯ä»¥ä¹±åºå‘é€</li><li>æœåŠ¡ç«¯æ¨é€:HTTP2 å¼•å…¥æœåŠ¡å™¨æ¨é€ï¼Œå…è®¸æœåŠ¡ç«¯æ¨é€èµ„æºç»™å®¢æˆ·ç«¯,æœåŠ¡å™¨ä¼šé¡ºä¾¿æŠŠä¸€äº›å®¢æˆ·ç«¯éœ€è¦çš„èµ„æºä¸€èµ·æ¨é€åˆ°å®¢æˆ·ç«¯</li></ol><hr><h1 id="HTTP-ä¸-HTTPS-çš„åŒºåˆ«"><a href="#HTTP-ä¸-HTTPS-çš„åŒºåˆ«" class="headerlink" title="HTTP ä¸ HTTPS çš„åŒºåˆ«"></a>HTTP ä¸ HTTPS çš„åŒºåˆ«</h1><ol><li>HTTP ä¼ è¾“çš„æ•°æ®éƒ½æ˜¯æœªåŠ å¯†çš„ï¼Œä¹Ÿå°±æ˜¯æ˜æ–‡çš„ï¼ŒHTTPS åè®®æ˜¯ç”± HTTP å’Œ SSL åè®®æ„å»ºçš„å¯è¿›è¡ŒåŠ å¯†ä¼ è¾“å’Œèº«ä»½è®¤è¯çš„ç½‘ç»œåè®®ï¼Œæ¯” HTTP åè®®çš„å®‰å…¨æ€§æ›´é«˜ã€‚</li><li>HTTPS åè®®éœ€è¦ CA è¯ä¹¦ï¼›</li><li>ä½¿ç”¨ä¸åŒçš„é“¾æ¥æ–¹å¼ï¼Œç«¯å£ä¹Ÿä¸åŒï¼Œä¸€èˆ¬è€Œè¨€ï¼ŒHTTP åè®®çš„ç«¯å£ä¸º 80ï¼ŒHTTPS çš„ç«¯å£ä¸º 443ï¼›</li></ol><hr><h1 id="HTTPS-åè®®çš„å·¥ä½œåŸç†"><a href="#HTTPS-åè®®çš„å·¥ä½œåŸç†" class="headerlink" title="HTTPS åè®®çš„å·¥ä½œåŸç†"></a>HTTPS åè®®çš„å·¥ä½œåŸç†</h1><ol><li>å®¢æˆ·ä½¿ç”¨ HTTPS URL è®¿é—®æœåŠ¡å™¨ï¼Œåˆ™è¦æ±‚ web æœåŠ¡å™¨å»ºç«‹ SSL é“¾æ¥ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨å‘é€çš„æŠ¥æ–‡åŒ…æ‹¬å®¢æˆ·ç«¯æ‰€æ”¯æŒçš„ ssl ç‰ˆæœ¬ï¼Œæ”¯æŒçš„åŠ å¯†ç®—æ³•ä»¥åŠå¯†é’¥çš„é•¿åº¦ã€‚</li><li>web æœåŠ¡å™¨æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„è¯·æ±‚ä¹‹åï¼Œä¹Ÿåœ¨æŠ¥æ–‡ä¸­åŒ…å« SSL ç‰ˆæœ¬ä»¥åŠåŠ å¯†ç»„ä»¶ï¼ŒæœåŠ¡å™¨çš„åŠ å¯†ç»„ä»¶å†…å®¹æ—¶ä»æ¥æ”¶åˆ°çš„å®¢æˆ·ç«¯åŠ å¯†ç»„ä»¶å†…ç­›é€‰å‡ºæ¥çš„ã€‚</li><li>åŒæ—¶ï¼Œweb æœåŠ¡å™¨ä¼šå°†ç½‘ç«™çš„ CA è¯ä¹¦ï¼ˆè¯ä¹¦ä¸­åŒ…å«äº†å…¬é’¥ï¼‰ï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ã€‚</li><li>å®¢æˆ·ç«¯é€šè¿‡ CA è¯ä¹¦æ¥éªŒè¯æœåŠ¡ç«¯çš„èº«ä»½ï¼Œå…¬é’¥æ˜¯å¦æœ‰æ•ˆï¼Œæ¯”å¦‚é¢å‘æœºæ„ï¼Œè¿‡æœŸæ—¶é—´ï¼Œå¹¶éšæœºç”Ÿæˆå¯¹ç§°åŠ å¯†çš„å¯†é’¥ X ç”¨å…¬é’¥åŠ å¯†å‘ç»™æœåŠ¡ç«¯ã€‚</li><li>æœåŠ¡å™¨æ‹¿åˆ°å®¢æˆ·ç«¯å‘è¿‡æ¥çš„åŠ å¯†å†…å®¹ç”¨è‡ªå·±çš„ç§é’¥è§£å¯†è·å–åˆ°å¯†é’¥ Xã€‚</li><li>åŒæ–¹éƒ½æ‹¿åˆ°äº†å¯†é’¥ Xï¼ŒSSL é€šé“å»ºç«‹å®Œæˆï¼Œé€šè¿‡å¯†é’¥ X åŠ å¯†ä¿¡æ¯æ¥è¿›è¡Œé€šä¿¡ã€‚ æ€»ç»“ï¼šHTTPS åè®®ä½¿ç”¨äº†éå¯¹ç§°åŠ å¯† + å¯¹ç§°åŠ å¯†çš„æ–¹å¼ï¼Œå³åˆ©ç”¨äº†éå¯¹ç§°åŠ å¯†å®‰å…¨æ€§é«˜çš„ç‰¹ç‚¹ï¼Œåˆåˆ©ç”¨äº†å¯¹ç§°åŠ å¯†é€Ÿåº¦å¿«ï¼Œæ•ˆç‡é«˜çš„å¥½å¤„</li></ol>]]></content>
      
      
      <categories>
          
          <category> æµè§ˆå™¨ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> http </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
