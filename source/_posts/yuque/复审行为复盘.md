---
title: 复审行为复盘
urlname: db2lgv
date: '2022-06-14 20:37:40 +0800'
tags: []
categories: []
---

1. 没有严格执行复审文档中的第一步（复审者在开始复审之前应先看一下 gitlab runner 的运行结果,确认无报错或告警）,在[第一个 MR](http://10.186.18.21/universe/umc-ui/-/merge_requests/1161)复审确认无问题后，因为 pipline 显示通过，就直接合并到主分支并在 gitlab 创建了 cherry-pick 到 06 的 MR，随后在 cherry-pick 的 MR 发现 code-style-lint-check 有大量此次修改产生的 import 的内容未使用告警，所以关闭了 cherry-pick 到 06 分支的 MR，并且在 gitlab 上 revert 了主分支上本次的 MR,告知作者告警未处理，建议处理完提交一个新的 MR 复审
1. 作者提交了[新的 MR](http://10.186.18.21/universe/umc-ui/-/merge_requests/1168)，复审前确认 pipline 通过且相关告警已经消失，此时 changes 的文件数比原来少了，但是在 changes 里的点击查看具体文件，修改的文件内容符合预期【同时删除了 import 语句和调用的地方】，所以合并到主分支上，并在 gitlab 创建了 cherry-pick 到 06 的 MR
1. 当创建了 cherry-pick 到 06 的 MR 之后，显示 pipline 未通过，点击查看 changes 中的具体文件，发现此时代码中只删除了 import 语句，但是没有删除调用的地方
1. 关闭 cherry-pick 到 06 的 MR 并 revert 主分支上的代码

目前问题：

- 该问题导致另外一位同事的 [MR-1173](http://10.186.18.21/universe/umc-ui/-/merge_requests/1173) 的 pipline 一直不通过，但是点击查看当前 MR 最新 commit 的代码导致报错的代码也不存在
- 不确定对目前还没有合并但是 pipline 通过的 MR 有无其他影响
  - [MR-1171](http://10.186.18.21/universe/umc-ui/-/merge_requests/1171)[只需要合并到 master]：再次 pipline 通过
  - [MR-1170](http://10.186.18.21/universe/umc-ui/-/merge_requests/1170)[本身已合并到主分支上，但是还没 cherry-pick 到 06 分支]

---

新的 MR 产生问题的原因猜测是由于新 MR 不是基于最新的 master 分支 checkout 出来的，而是通过第一个 MR 拉出来的分支，导致代码被覆盖
该过程中可以避免问题的行为节点：
