---
title: 开发一个网页版的简历生成器系列-4
date: 2023-08-22 14:20:03
tags: [实践]
categories: 实践
---

## 后端

后端尝试使用了 MVC 架构
├─controllers
│ └─resumeController
├─docs
├─models
├─repositories
└─router

- Model 层:定义表示数据库实体的 Go 结构体
- Controller 层:处理业务逻辑，处理请求逻辑,与 Model、Repository 层交互。直接返回 JSON 格式数据给前端
- Repositories 层：基于 Model 操作数据库,使用 database/sql 直接执行 SQL 查询,并手动转换结果到 Model 对象。

### main.go

```go
	// 初始化数据库
	repositories.InitMysql()
	// 初始化gin
	r := gin.Default()
	router := r.Group("/api")
	ReadRouters(router)
	docs.SwaggerInfo.BasePath = "/"
	r.GET("/swagger/*any", ginSwagger.WrapHandler(swaggerfiles.Handler))
	r.Run(":3000")
```

读取 router 下的路由组

```go
// ReadRouters 读取router下的路由组
func ReadRouters(g *gin.RouterGroup) {
  routes := router.Router{}
  val := reflect.ValueOf(routes)
  // 获取到该结构体有多少个方法
  numOfMethod := val.NumMethod()
  for i := 0; i < numOfMethod; i++ {
    // 断言特定类型的方法
    fn, ok := val.Method(i).Interface().(func(g *gin.RouterGroup))
    if !ok {
      continue
    }
    fn(g)
  }
}
```

resume 模块

```go
func (r Router) Resume(g *gin.RouterGroup) {
	rg := g.Group("/resume")
	{
		// 查看简历列表
		rg.GET("/list", resumeController.GetResumeList)
		// 查询简历详情
		rg.GET("/:id", resumeController.GetSingleResume)
		// 添加简历
		rg.POST("/add", resumeController.CreateResume)
		// 修改简历
		rg.POST("/update", resumeController.UpdateResume)
		// 删除简历
		rg.DELETE("/:id", resumeController.DeleteResume)
	}
}
```

上面这些功能的具体实现逻辑都放在 Controller 层


如何构建一个简单的 REST API https://blog.techchee.com/build-a-rest-api-with-golang-gin-and-mysql/

reflect 反射-待补充 https://juejin.cn/post/6844903559335526407
